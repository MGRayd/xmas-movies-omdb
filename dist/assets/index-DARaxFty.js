function Gw(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function Kw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qw={exports:{}},ld={},Xw={exports:{}},qe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gu=Symbol.for("react.element"),WI=Symbol.for("react.portal"),GI=Symbol.for("react.fragment"),KI=Symbol.for("react.strict_mode"),qI=Symbol.for("react.profiler"),XI=Symbol.for("react.provider"),YI=Symbol.for("react.context"),QI=Symbol.for("react.forward_ref"),JI=Symbol.for("react.suspense"),ZI=Symbol.for("react.memo"),eC=Symbol.for("react.lazy"),Gx=Symbol.iterator;function tC(t){return t===null||typeof t!="object"?null:(t=Gx&&t[Gx]||t["@@iterator"],typeof t=="function"?t:null)}var Yw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Qw=Object.assign,Jw={};function vl(t,e,r){this.props=t,this.context=e,this.refs=Jw,this.updater=r||Yw}vl.prototype.isReactComponent={};vl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};vl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Zw(){}Zw.prototype=vl.prototype;function Um(t,e,r){this.props=t,this.context=e,this.refs=Jw,this.updater=r||Yw}var Bm=Um.prototype=new Zw;Bm.constructor=Um;Qw(Bm,vl.prototype);Bm.isPureReactComponent=!0;var Kx=Array.isArray,eE=Object.prototype.hasOwnProperty,zm={current:null},tE={key:!0,ref:!0,__self:!0,__source:!0};function rE(t,e,r){var n,s={},i=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)eE.call(e,n)&&!tE.hasOwnProperty(n)&&(s[n]=e[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:gu,type:t,key:i,ref:a,props:s,_owner:zm.current}}function rC(t,e){return{$$typeof:gu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function $m(t){return typeof t=="object"&&t!==null&&t.$$typeof===gu}function nC(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var qx=/\/+/g;function o0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?nC(""+t.key):e.toString(36)}function Of(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case gu:case WI:a=!0}}if(a)return a=t,s=s(a),t=n===""?"."+o0(a,0):n,Kx(s)?(r="",t!=null&&(r=t.replace(qx,"$&/")+"/"),Of(s,e,r,"",function(c){return c})):s!=null&&($m(s)&&(s=rC(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(qx,"$&/")+"/")+t)),e.push(s)),1;if(a=0,n=n===""?".":n+":",Kx(t))for(var o=0;o<t.length;o++){i=t[o];var l=n+o0(i,o);a+=Of(i,e,r,l,s)}else if(l=tC(t),typeof l=="function")for(t=l.call(t),o=0;!(i=t.next()).done;)i=i.value,l=n+o0(i,o++),a+=Of(i,e,r,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function tf(t,e,r){if(t==null)return t;var n=[],s=0;return Of(t,n,"","",function(i){return e.call(r,i,s++)}),n}function sC(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Jr={current:null},Mf={transition:null},iC={ReactCurrentDispatcher:Jr,ReactCurrentBatchConfig:Mf,ReactCurrentOwner:zm};function nE(){throw Error("act(...) is not supported in production builds of React.")}qe.Children={map:tf,forEach:function(t,e,r){tf(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return tf(t,function(){e++}),e},toArray:function(t){return tf(t,function(e){return e})||[]},only:function(t){if(!$m(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};qe.Component=vl;qe.Fragment=GI;qe.Profiler=qI;qe.PureComponent=Um;qe.StrictMode=KI;qe.Suspense=JI;qe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iC;qe.act=nE;qe.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Qw({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=zm.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)eE.call(e,l)&&!tE.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:gu,type:t.type,key:s,ref:i,props:n,_owner:a}};qe.createContext=function(t){return t={$$typeof:YI,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:XI,_context:t},t.Consumer=t};qe.createElement=rE;qe.createFactory=function(t){var e=rE.bind(null,t);return e.type=t,e};qe.createRef=function(){return{current:null}};qe.forwardRef=function(t){return{$$typeof:QI,render:t}};qe.isValidElement=$m;qe.lazy=function(t){return{$$typeof:eC,_payload:{_status:-1,_result:t},_init:sC}};qe.memo=function(t,e){return{$$typeof:ZI,type:t,compare:e===void 0?null:e}};qe.startTransition=function(t){var e=Mf.transition;Mf.transition={};try{t()}finally{Mf.transition=e}};qe.unstable_act=nE;qe.useCallback=function(t,e){return Jr.current.useCallback(t,e)};qe.useContext=function(t){return Jr.current.useContext(t)};qe.useDebugValue=function(){};qe.useDeferredValue=function(t){return Jr.current.useDeferredValue(t)};qe.useEffect=function(t,e){return Jr.current.useEffect(t,e)};qe.useId=function(){return Jr.current.useId()};qe.useImperativeHandle=function(t,e,r){return Jr.current.useImperativeHandle(t,e,r)};qe.useInsertionEffect=function(t,e){return Jr.current.useInsertionEffect(t,e)};qe.useLayoutEffect=function(t,e){return Jr.current.useLayoutEffect(t,e)};qe.useMemo=function(t,e){return Jr.current.useMemo(t,e)};qe.useReducer=function(t,e,r){return Jr.current.useReducer(t,e,r)};qe.useRef=function(t){return Jr.current.useRef(t)};qe.useState=function(t){return Jr.current.useState(t)};qe.useSyncExternalStore=function(t,e,r){return Jr.current.useSyncExternalStore(t,e,r)};qe.useTransition=function(){return Jr.current.useTransition()};qe.version="18.3.1";Xw.exports=qe;var W=Xw.exports;const Hm=Kw(W),aC=Gw({__proto__:null,default:Hm},[W]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oC=W,lC=Symbol.for("react.element"),cC=Symbol.for("react.fragment"),uC=Object.prototype.hasOwnProperty,fC=oC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hC={key:!0,ref:!0,__self:!0,__source:!0};function sE(t,e,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)uC.call(e,n)&&!hC.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:lC,type:t,key:i,ref:a,props:s,_owner:fC.current}}ld.Fragment=cC;ld.jsx=sE;ld.jsxs=sE;qw.exports=ld;var p=qw.exports,ip={},iE={exports:{}},Tn={},aE={exports:{}},oE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(oe,K){var he=oe.length;oe.push(K);e:for(;0<he;){var we=he-1>>>1,U=oe[we];if(0<s(U,K))oe[we]=K,oe[he]=U,he=we;else break e}}function r(oe){return oe.length===0?null:oe[0]}function n(oe){if(oe.length===0)return null;var K=oe[0],he=oe.pop();if(he!==K){oe[0]=he;e:for(var we=0,U=oe.length,q=U>>>1;we<q;){var Y=2*(we+1)-1,G=oe[Y],le=Y+1,xe=oe[le];if(0>s(G,he))le<U&&0>s(xe,G)?(oe[we]=xe,oe[le]=he,we=le):(oe[we]=G,oe[Y]=he,we=Y);else if(le<U&&0>s(xe,he))oe[we]=xe,oe[le]=he,we=le;else break e}}return K}function s(oe,K){var he=oe.sortIndex-K.sortIndex;return he!==0?he:oe.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,h=null,d=3,m=!1,v=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(oe){for(var K=r(c);K!==null;){if(K.callback===null)n(c);else if(K.startTime<=oe)n(c),K.sortIndex=K.expirationTime,e(l,K);else break;K=r(c)}}function F(oe){if(g=!1,w(oe),!v)if(r(l)!==null)v=!0,fe(B);else{var K=r(c);K!==null&&ge(F,K.startTime-oe)}}function B(oe,K){v=!1,g&&(g=!1,S(E),E=-1),m=!0;var he=d;try{for(w(K),h=r(l);h!==null&&(!(h.expirationTime>K)||oe&&!P());){var we=h.callback;if(typeof we=="function"){h.callback=null,d=h.priorityLevel;var U=we(h.expirationTime<=K);K=t.unstable_now(),typeof U=="function"?h.callback=U:h===r(l)&&n(l),w(K)}else n(l);h=r(l)}if(h!==null)var q=!0;else{var Y=r(c);Y!==null&&ge(F,Y.startTime-K),q=!1}return q}finally{h=null,d=he,m=!1}}var V=!1,x=null,E=-1,T=5,I=-1;function P(){return!(t.unstable_now()-I<T)}function N(){if(x!==null){var oe=t.unstable_now();I=oe;var K=!0;try{K=x(!0,oe)}finally{K?R():(V=!1,x=null)}}else V=!1}var R;if(typeof k=="function")R=function(){k(N)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,ae=se.port2;se.port1.onmessage=N,R=function(){ae.postMessage(null)}}else R=function(){y(N,0)};function fe(oe){x=oe,V||(V=!0,R())}function ge(oe,K){E=y(function(){oe(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(oe){oe.callback=null},t.unstable_continueExecution=function(){v||m||(v=!0,fe(B))},t.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<oe?Math.floor(1e3/oe):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(oe){switch(d){case 1:case 2:case 3:var K=3;break;default:K=d}var he=d;d=K;try{return oe()}finally{d=he}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(oe,K){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var he=d;d=oe;try{return K()}finally{d=he}},t.unstable_scheduleCallback=function(oe,K,he){var we=t.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?we+he:we):he=we,oe){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=he+U,oe={id:u++,callback:K,priorityLevel:oe,startTime:he,expirationTime:U,sortIndex:-1},he>we?(oe.sortIndex=he,e(c,oe),r(l)===null&&oe===r(c)&&(g?(S(E),E=-1):g=!0,ge(F,he-we))):(oe.sortIndex=U,e(l,oe),v||m||(v=!0,fe(B))),oe},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(oe){var K=d;return function(){var he=d;d=K;try{return oe.apply(this,arguments)}finally{d=he}}}})(oE);aE.exports=oE;var dC=aE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pC=W,wn=dC;function _e(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var lE=new Set,Pc={};function Qa(t,e){Qo(t,e),Qo(t+"Capture",e)}function Qo(t,e){for(Pc[t]=e,t=0;t<e.length;t++)lE.add(e[t])}var si=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ap=Object.prototype.hasOwnProperty,mC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Xx={},Yx={};function gC(t){return ap.call(Yx,t)?!0:ap.call(Xx,t)?!1:mC.test(t)?Yx[t]=!0:(Xx[t]=!0,!1)}function vC(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function xC(t,e,r,n){if(e===null||typeof e>"u"||vC(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Zr(t,e,r,n,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var kr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){kr[t]=new Zr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];kr[e]=new Zr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){kr[t]=new Zr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){kr[t]=new Zr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){kr[t]=new Zr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){kr[t]=new Zr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){kr[t]=new Zr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){kr[t]=new Zr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){kr[t]=new Zr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Wm=/[\-:]([a-z])/g;function Gm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Wm,Gm);kr[e]=new Zr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Wm,Gm);kr[e]=new Zr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Wm,Gm);kr[e]=new Zr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){kr[t]=new Zr(t,1,!1,t.toLowerCase(),null,!1,!1)});kr.xlinkHref=new Zr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){kr[t]=new Zr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Km(t,e,r,n){var s=kr.hasOwnProperty(e)?kr[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(xC(e,r,s,n)&&(r=null),n||s===null?gC(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var mi=pC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,rf=Symbol.for("react.element"),ko=Symbol.for("react.portal"),So=Symbol.for("react.fragment"),qm=Symbol.for("react.strict_mode"),op=Symbol.for("react.profiler"),cE=Symbol.for("react.provider"),uE=Symbol.for("react.context"),Xm=Symbol.for("react.forward_ref"),lp=Symbol.for("react.suspense"),cp=Symbol.for("react.suspense_list"),Ym=Symbol.for("react.memo"),Ai=Symbol.for("react.lazy"),fE=Symbol.for("react.offscreen"),Qx=Symbol.iterator;function Ll(t){return t===null||typeof t!="object"?null:(t=Qx&&t[Qx]||t["@@iterator"],typeof t=="function"?t:null)}var Ot=Object.assign,l0;function Xl(t){if(l0===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);l0=e&&e[1]||""}return`
`+l0+t}var c0=!1;function u0(t,e){if(!t||c0)return"";c0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){n=c}t.call(e.prototype)}else{try{throw Error()}catch(c){n=c}t()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==i[o]){var l=`
`+s[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{c0=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Xl(t):""}function _C(t){switch(t.tag){case 5:return Xl(t.type);case 16:return Xl("Lazy");case 13:return Xl("Suspense");case 19:return Xl("SuspenseList");case 0:case 2:case 15:return t=u0(t.type,!1),t;case 11:return t=u0(t.type.render,!1),t;case 1:return t=u0(t.type,!0),t;default:return""}}function up(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case So:return"Fragment";case ko:return"Portal";case op:return"Profiler";case qm:return"StrictMode";case lp:return"Suspense";case cp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case uE:return(t.displayName||"Context")+".Consumer";case cE:return(t._context.displayName||"Context")+".Provider";case Xm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ym:return e=t.displayName||null,e!==null?e:up(t.type)||"Memo";case Ai:e=t._payload,t=t._init;try{return up(t(e))}catch{}}return null}function yC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return up(e);case 8:return e===qm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ji(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function hE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function wC(t){var e=hE(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function nf(t){t._valueTracker||(t._valueTracker=wC(t))}function dE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=hE(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function nh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function fp(t,e){var r=e.checked;return Ot({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Jx(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Ji(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function pE(t,e){e=e.checked,e!=null&&Km(t,"checked",e,!1)}function hp(t,e){pE(t,e);var r=Ji(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?dp(t,e.type,r):e.hasOwnProperty("defaultValue")&&dp(t,e.type,Ji(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Zx(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function dp(t,e,r){(e!=="number"||nh(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Yl=Array.isArray;function Lo(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Ji(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function pp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(_e(91));return Ot({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function e1(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(_e(92));if(Yl(r)){if(1<r.length)throw Error(_e(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Ji(r)}}function mE(t,e){var r=Ji(e.value),n=Ji(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function t1(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function gE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function mp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?gE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var sf,vE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(sf=sf||document.createElement("div"),sf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=sf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Dc(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var lc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},EC=["Webkit","ms","Moz","O"];Object.keys(lc).forEach(function(t){EC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),lc[e]=lc[t]})});function xE(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||lc.hasOwnProperty(t)&&lc[t]?(""+e).trim():e+"px"}function _E(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=xE(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var TC=Ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gp(t,e){if(e){if(TC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(_e(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(_e(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(_e(61))}if(e.style!=null&&typeof e.style!="object")throw Error(_e(62))}}function vp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xp=null;function Qm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var _p=null,jo=null,Vo=null;function r1(t){if(t=_u(t)){if(typeof _p!="function")throw Error(_e(280));var e=t.stateNode;e&&(e=dd(e),_p(t.stateNode,t.type,e))}}function yE(t){jo?Vo?Vo.push(t):Vo=[t]:jo=t}function wE(){if(jo){var t=jo,e=Vo;if(Vo=jo=null,r1(t),e)for(t=0;t<e.length;t++)r1(e[t])}}function EE(t,e){return t(e)}function TE(){}var f0=!1;function kE(t,e,r){if(f0)return t(e,r);f0=!0;try{return EE(t,e,r)}finally{f0=!1,(jo!==null||Vo!==null)&&(TE(),wE())}}function Fc(t,e){var r=t.stateNode;if(r===null)return null;var n=dd(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(_e(231,e,typeof r));return r}var yp=!1;if(si)try{var jl={};Object.defineProperty(jl,"passive",{get:function(){yp=!0}}),window.addEventListener("test",jl,jl),window.removeEventListener("test",jl,jl)}catch{yp=!1}function kC(t,e,r,n,s,i,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(r,c)}catch(u){this.onError(u)}}var cc=!1,sh=null,ih=!1,wp=null,SC={onError:function(t){cc=!0,sh=t}};function AC(t,e,r,n,s,i,a,o,l){cc=!1,sh=null,kC.apply(SC,arguments)}function IC(t,e,r,n,s,i,a,o,l){if(AC.apply(this,arguments),cc){if(cc){var c=sh;cc=!1,sh=null}else throw Error(_e(198));ih||(ih=!0,wp=c)}}function Ja(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function SE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function n1(t){if(Ja(t)!==t)throw Error(_e(188))}function CC(t){var e=t.alternate;if(!e){if(e=Ja(t),e===null)throw Error(_e(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return n1(s),t;if(i===n)return n1(s),e;i=i.sibling}throw Error(_e(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a)throw Error(_e(189))}}if(r.alternate!==n)throw Error(_e(190))}if(r.tag!==3)throw Error(_e(188));return r.stateNode.current===r?t:e}function AE(t){return t=CC(t),t!==null?IE(t):null}function IE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=IE(t);if(e!==null)return e;t=t.sibling}return null}var CE=wn.unstable_scheduleCallback,s1=wn.unstable_cancelCallback,RC=wn.unstable_shouldYield,NC=wn.unstable_requestPaint,$t=wn.unstable_now,PC=wn.unstable_getCurrentPriorityLevel,Jm=wn.unstable_ImmediatePriority,RE=wn.unstable_UserBlockingPriority,ah=wn.unstable_NormalPriority,DC=wn.unstable_LowPriority,NE=wn.unstable_IdlePriority,cd=null,_s=null;function FC(t){if(_s&&typeof _s.onCommitFiberRoot=="function")try{_s.onCommitFiberRoot(cd,t,void 0,(t.current.flags&128)===128)}catch{}}var ts=Math.clz32?Math.clz32:MC,bC=Math.log,OC=Math.LN2;function MC(t){return t>>>=0,t===0?32:31-(bC(t)/OC|0)|0}var af=64,of=4194304;function Ql(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function oh(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~s;o!==0?n=Ql(o):(i&=a,i!==0&&(n=Ql(i)))}else a=r&~s,a!==0?n=Ql(a):i!==0&&(n=Ql(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-ts(e),s=1<<r,n|=t[r],e&=~s;return n}function LC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-ts(i),o=1<<a,l=s[a];l===-1?(!(o&r)||o&n)&&(s[a]=LC(o,e)):l<=e&&(t.expiredLanes|=o),i&=~o}}function Ep(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function PE(){var t=af;return af<<=1,!(af&4194240)&&(af=64),t}function h0(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function vu(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ts(e),t[e]=r}function VC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-ts(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function Zm(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-ts(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var mt=0;function DE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var FE,eg,bE,OE,ME,Tp=!1,lf=[],Ui=null,Bi=null,zi=null,bc=new Map,Oc=new Map,Ci=[],UC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function i1(t,e){switch(t){case"focusin":case"focusout":Ui=null;break;case"dragenter":case"dragleave":Bi=null;break;case"mouseover":case"mouseout":zi=null;break;case"pointerover":case"pointerout":bc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oc.delete(e.pointerId)}}function Vl(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=_u(e),e!==null&&eg(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function BC(t,e,r,n,s){switch(e){case"focusin":return Ui=Vl(Ui,t,e,r,n,s),!0;case"dragenter":return Bi=Vl(Bi,t,e,r,n,s),!0;case"mouseover":return zi=Vl(zi,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return bc.set(i,Vl(bc.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Oc.set(i,Vl(Oc.get(i)||null,t,e,r,n,s)),!0}return!1}function LE(t){var e=Ta(t.target);if(e!==null){var r=Ja(e);if(r!==null){if(e=r.tag,e===13){if(e=SE(r),e!==null){t.blockedOn=e,ME(t.priority,function(){bE(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Lf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=kp(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);xp=n,r.target.dispatchEvent(n),xp=null}else return e=_u(r),e!==null&&eg(e),t.blockedOn=r,!1;e.shift()}return!0}function a1(t,e,r){Lf(t)&&r.delete(e)}function zC(){Tp=!1,Ui!==null&&Lf(Ui)&&(Ui=null),Bi!==null&&Lf(Bi)&&(Bi=null),zi!==null&&Lf(zi)&&(zi=null),bc.forEach(a1),Oc.forEach(a1)}function Ul(t,e){t.blockedOn===e&&(t.blockedOn=null,Tp||(Tp=!0,wn.unstable_scheduleCallback(wn.unstable_NormalPriority,zC)))}function Mc(t){function e(s){return Ul(s,t)}if(0<lf.length){Ul(lf[0],t);for(var r=1;r<lf.length;r++){var n=lf[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Ui!==null&&Ul(Ui,t),Bi!==null&&Ul(Bi,t),zi!==null&&Ul(zi,t),bc.forEach(e),Oc.forEach(e),r=0;r<Ci.length;r++)n=Ci[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Ci.length&&(r=Ci[0],r.blockedOn===null);)LE(r),r.blockedOn===null&&Ci.shift()}var Uo=mi.ReactCurrentBatchConfig,lh=!0;function $C(t,e,r,n){var s=mt,i=Uo.transition;Uo.transition=null;try{mt=1,tg(t,e,r,n)}finally{mt=s,Uo.transition=i}}function HC(t,e,r,n){var s=mt,i=Uo.transition;Uo.transition=null;try{mt=4,tg(t,e,r,n)}finally{mt=s,Uo.transition=i}}function tg(t,e,r,n){if(lh){var s=kp(t,e,r,n);if(s===null)E0(t,e,n,ch,r),i1(t,n);else if(BC(s,t,e,r,n))n.stopPropagation();else if(i1(t,n),e&4&&-1<UC.indexOf(t)){for(;s!==null;){var i=_u(s);if(i!==null&&FE(i),i=kp(t,e,r,n),i===null&&E0(t,e,n,ch,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else E0(t,e,n,null,r)}}var ch=null;function kp(t,e,r,n){if(ch=null,t=Qm(n),t=Ta(t),t!==null)if(e=Ja(t),e===null)t=null;else if(r=e.tag,r===13){if(t=SE(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ch=t,null}function jE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(PC()){case Jm:return 1;case RE:return 4;case ah:case DC:return 16;case NE:return 536870912;default:return 16}default:return 16}}var bi=null,rg=null,jf=null;function VE(){if(jf)return jf;var t,e=rg,r=e.length,n,s="value"in bi?bi.value:bi.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===s[i-n];n++);return jf=s.slice(t,1<n?1-n:void 0)}function Vf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function cf(){return!0}function o1(){return!1}function kn(t){function e(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?cf:o1,this.isPropagationStopped=o1,this}return Ot(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=cf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=cf)},persist:function(){},isPersistent:cf}),e}var xl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ng=kn(xl),xu=Ot({},xl,{view:0,detail:0}),WC=kn(xu),d0,p0,Bl,ud=Ot({},xu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Bl&&(Bl&&t.type==="mousemove"?(d0=t.screenX-Bl.screenX,p0=t.screenY-Bl.screenY):p0=d0=0,Bl=t),d0)},movementY:function(t){return"movementY"in t?t.movementY:p0}}),l1=kn(ud),GC=Ot({},ud,{dataTransfer:0}),KC=kn(GC),qC=Ot({},xu,{relatedTarget:0}),m0=kn(qC),XC=Ot({},xl,{animationName:0,elapsedTime:0,pseudoElement:0}),YC=kn(XC),QC=Ot({},xl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),JC=kn(QC),ZC=Ot({},xl,{data:0}),c1=kn(ZC),e4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},t4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},r4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function n4(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=r4[t])?!!e[t]:!1}function sg(){return n4}var s4=Ot({},xu,{key:function(t){if(t.key){var e=e4[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Vf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?t4[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sg,charCode:function(t){return t.type==="keypress"?Vf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Vf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),i4=kn(s4),a4=Ot({},ud,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),u1=kn(a4),o4=Ot({},xu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sg}),l4=kn(o4),c4=Ot({},xl,{propertyName:0,elapsedTime:0,pseudoElement:0}),u4=kn(c4),f4=Ot({},ud,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),h4=kn(f4),d4=[9,13,27,32],ig=si&&"CompositionEvent"in window,uc=null;si&&"documentMode"in document&&(uc=document.documentMode);var p4=si&&"TextEvent"in window&&!uc,UE=si&&(!ig||uc&&8<uc&&11>=uc),f1=" ",h1=!1;function BE(t,e){switch(t){case"keyup":return d4.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ao=!1;function m4(t,e){switch(t){case"compositionend":return zE(e);case"keypress":return e.which!==32?null:(h1=!0,f1);case"textInput":return t=e.data,t===f1&&h1?null:t;default:return null}}function g4(t,e){if(Ao)return t==="compositionend"||!ig&&BE(t,e)?(t=VE(),jf=rg=bi=null,Ao=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return UE&&e.locale!=="ko"?null:e.data;default:return null}}var v4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function d1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!v4[t.type]:e==="textarea"}function $E(t,e,r,n){yE(n),e=uh(e,"onChange"),0<e.length&&(r=new ng("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var fc=null,Lc=null;function x4(t){eT(t,0)}function fd(t){var e=Ro(t);if(dE(e))return t}function _4(t,e){if(t==="change")return e}var HE=!1;if(si){var g0;if(si){var v0="oninput"in document;if(!v0){var p1=document.createElement("div");p1.setAttribute("oninput","return;"),v0=typeof p1.oninput=="function"}g0=v0}else g0=!1;HE=g0&&(!document.documentMode||9<document.documentMode)}function m1(){fc&&(fc.detachEvent("onpropertychange",WE),Lc=fc=null)}function WE(t){if(t.propertyName==="value"&&fd(Lc)){var e=[];$E(e,Lc,t,Qm(t)),kE(x4,e)}}function y4(t,e,r){t==="focusin"?(m1(),fc=e,Lc=r,fc.attachEvent("onpropertychange",WE)):t==="focusout"&&m1()}function w4(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return fd(Lc)}function E4(t,e){if(t==="click")return fd(e)}function T4(t,e){if(t==="input"||t==="change")return fd(e)}function k4(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var is=typeof Object.is=="function"?Object.is:k4;function jc(t,e){if(is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!ap.call(e,s)||!is(t[s],e[s]))return!1}return!0}function g1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function v1(t,e){var r=g1(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=g1(r)}}function GE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?GE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function KE(){for(var t=window,e=nh();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=nh(t.document)}return e}function ag(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function S4(t){var e=KE(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&GE(r.ownerDocument.documentElement,r)){if(n!==null&&ag(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=v1(r,i);var a=v1(r,n);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var A4=si&&"documentMode"in document&&11>=document.documentMode,Io=null,Sp=null,hc=null,Ap=!1;function x1(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ap||Io==null||Io!==nh(n)||(n=Io,"selectionStart"in n&&ag(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),hc&&jc(hc,n)||(hc=n,n=uh(Sp,"onSelect"),0<n.length&&(e=new ng("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Io)))}function uf(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Co={animationend:uf("Animation","AnimationEnd"),animationiteration:uf("Animation","AnimationIteration"),animationstart:uf("Animation","AnimationStart"),transitionend:uf("Transition","TransitionEnd")},x0={},qE={};si&&(qE=document.createElement("div").style,"AnimationEvent"in window||(delete Co.animationend.animation,delete Co.animationiteration.animation,delete Co.animationstart.animation),"TransitionEvent"in window||delete Co.transitionend.transition);function hd(t){if(x0[t])return x0[t];if(!Co[t])return t;var e=Co[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in qE)return x0[t]=e[r];return t}var XE=hd("animationend"),YE=hd("animationiteration"),QE=hd("animationstart"),JE=hd("transitionend"),ZE=new Map,_1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function aa(t,e){ZE.set(t,e),Qa(e,[t])}for(var _0=0;_0<_1.length;_0++){var y0=_1[_0],I4=y0.toLowerCase(),C4=y0[0].toUpperCase()+y0.slice(1);aa(I4,"on"+C4)}aa(XE,"onAnimationEnd");aa(YE,"onAnimationIteration");aa(QE,"onAnimationStart");aa("dblclick","onDoubleClick");aa("focusin","onFocus");aa("focusout","onBlur");aa(JE,"onTransitionEnd");Qo("onMouseEnter",["mouseout","mouseover"]);Qo("onMouseLeave",["mouseout","mouseover"]);Qo("onPointerEnter",["pointerout","pointerover"]);Qo("onPointerLeave",["pointerout","pointerover"]);Qa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),R4=new Set("cancel close invalid load scroll toggle".split(" ").concat(Jl));function y1(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,IC(n,e,void 0,t),t.currentTarget=null}function eT(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&s.isPropagationStopped())break e;y1(s,o,c),i=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==i&&s.isPropagationStopped())break e;y1(s,o,c),i=l}}}if(ih)throw t=wp,ih=!1,wp=null,t}function It(t,e){var r=e[Pp];r===void 0&&(r=e[Pp]=new Set);var n=t+"__bubble";r.has(n)||(tT(e,t,2,!1),r.add(n))}function w0(t,e,r){var n=0;e&&(n|=4),tT(r,t,n,e)}var ff="_reactListening"+Math.random().toString(36).slice(2);function Vc(t){if(!t[ff]){t[ff]=!0,lE.forEach(function(r){r!=="selectionchange"&&(R4.has(r)||w0(r,!1,t),w0(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ff]||(e[ff]=!0,w0("selectionchange",!1,e))}}function tT(t,e,r,n){switch(jE(e)){case 1:var s=$C;break;case 4:s=HC;break;default:s=tg}r=s.bind(null,e,r,t),s=void 0,!yp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function E0(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;a=a.return}for(;o!==null;){if(a=Ta(o),a===null)return;if(l=a.tag,l===5||l===6){n=i=a;continue e}o=o.parentNode}}n=n.return}kE(function(){var c=i,u=Qm(r),h=[];e:{var d=ZE.get(t);if(d!==void 0){var m=ng,v=t;switch(t){case"keypress":if(Vf(r)===0)break e;case"keydown":case"keyup":m=i4;break;case"focusin":v="focus",m=m0;break;case"focusout":v="blur",m=m0;break;case"beforeblur":case"afterblur":m=m0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=l1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=KC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=l4;break;case XE:case YE:case QE:m=YC;break;case JE:m=u4;break;case"scroll":m=WC;break;case"wheel":m=h4;break;case"copy":case"cut":case"paste":m=JC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=u1}var g=(e&4)!==0,y=!g&&t==="scroll",S=g?d!==null?d+"Capture":null:d;g=[];for(var k=c,w;k!==null;){w=k;var F=w.stateNode;if(w.tag===5&&F!==null&&(w=F,S!==null&&(F=Fc(k,S),F!=null&&g.push(Uc(k,F,w)))),y)break;k=k.return}0<g.length&&(d=new m(d,v,null,r,u),h.push({event:d,listeners:g}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",d&&r!==xp&&(v=r.relatedTarget||r.fromElement)&&(Ta(v)||v[ii]))break e;if((m||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,m?(v=r.relatedTarget||r.toElement,m=c,v=v?Ta(v):null,v!==null&&(y=Ja(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=c),m!==v)){if(g=l1,F="onMouseLeave",S="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(g=u1,F="onPointerLeave",S="onPointerEnter",k="pointer"),y=m==null?d:Ro(m),w=v==null?d:Ro(v),d=new g(F,k+"leave",m,r,u),d.target=y,d.relatedTarget=w,F=null,Ta(u)===c&&(g=new g(S,k+"enter",v,r,u),g.target=w,g.relatedTarget=y,F=g),y=F,m&&v)t:{for(g=m,S=v,k=0,w=g;w;w=vo(w))k++;for(w=0,F=S;F;F=vo(F))w++;for(;0<k-w;)g=vo(g),k--;for(;0<w-k;)S=vo(S),w--;for(;k--;){if(g===S||S!==null&&g===S.alternate)break t;g=vo(g),S=vo(S)}g=null}else g=null;m!==null&&w1(h,d,m,g,!1),v!==null&&y!==null&&w1(h,y,v,g,!0)}}e:{if(d=c?Ro(c):window,m=d.nodeName&&d.nodeName.toLowerCase(),m==="select"||m==="input"&&d.type==="file")var B=_4;else if(d1(d))if(HE)B=T4;else{B=w4;var V=y4}else(m=d.nodeName)&&m.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(B=E4);if(B&&(B=B(t,c))){$E(h,B,r,u);break e}V&&V(t,d,c),t==="focusout"&&(V=d._wrapperState)&&V.controlled&&d.type==="number"&&dp(d,"number",d.value)}switch(V=c?Ro(c):window,t){case"focusin":(d1(V)||V.contentEditable==="true")&&(Io=V,Sp=c,hc=null);break;case"focusout":hc=Sp=Io=null;break;case"mousedown":Ap=!0;break;case"contextmenu":case"mouseup":case"dragend":Ap=!1,x1(h,r,u);break;case"selectionchange":if(A4)break;case"keydown":case"keyup":x1(h,r,u)}var x;if(ig)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Ao?BE(t,r)&&(E="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(UE&&r.locale!=="ko"&&(Ao||E!=="onCompositionStart"?E==="onCompositionEnd"&&Ao&&(x=VE()):(bi=u,rg="value"in bi?bi.value:bi.textContent,Ao=!0)),V=uh(c,E),0<V.length&&(E=new c1(E,t,null,r,u),h.push({event:E,listeners:V}),x?E.data=x:(x=zE(r),x!==null&&(E.data=x)))),(x=p4?m4(t,r):g4(t,r))&&(c=uh(c,"onBeforeInput"),0<c.length&&(u=new c1("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=x))}eT(h,e)})}function Uc(t,e,r){return{instance:t,listener:e,currentTarget:r}}function uh(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Fc(t,r),i!=null&&n.unshift(Uc(t,i,s)),i=Fc(t,e),i!=null&&n.push(Uc(t,i,s))),t=t.return}return n}function vo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function w1(t,e,r,n,s){for(var i=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,s?(l=Fc(r,i),l!=null&&a.unshift(Uc(r,l,o))):s||(l=Fc(r,i),l!=null&&a.push(Uc(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var N4=/\r\n?/g,P4=/\u0000|\uFFFD/g;function E1(t){return(typeof t=="string"?t:""+t).replace(N4,`
`).replace(P4,"")}function hf(t,e,r){if(e=E1(e),E1(t)!==e&&r)throw Error(_e(425))}function fh(){}var Ip=null,Cp=null;function Rp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Np=typeof setTimeout=="function"?setTimeout:void 0,D4=typeof clearTimeout=="function"?clearTimeout:void 0,T1=typeof Promise=="function"?Promise:void 0,F4=typeof queueMicrotask=="function"?queueMicrotask:typeof T1<"u"?function(t){return T1.resolve(null).then(t).catch(b4)}:Np;function b4(t){setTimeout(function(){throw t})}function T0(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),Mc(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Mc(e)}function $i(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function k1(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var _l=Math.random().toString(36).slice(2),gs="__reactFiber$"+_l,Bc="__reactProps$"+_l,ii="__reactContainer$"+_l,Pp="__reactEvents$"+_l,O4="__reactListeners$"+_l,M4="__reactHandles$"+_l;function Ta(t){var e=t[gs];if(e)return e;for(var r=t.parentNode;r;){if(e=r[ii]||r[gs]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=k1(t);t!==null;){if(r=t[gs])return r;t=k1(t)}return e}t=r,r=t.parentNode}return null}function _u(t){return t=t[gs]||t[ii],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ro(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(_e(33))}function dd(t){return t[Bc]||null}var Dp=[],No=-1;function oa(t){return{current:t}}function Ct(t){0>No||(t.current=Dp[No],Dp[No]=null,No--)}function wt(t,e){No++,Dp[No]=t.current,t.current=e}var Zi={},Ur=oa(Zi),cn=oa(!1),La=Zi;function Jo(t,e){var r=t.type.contextTypes;if(!r)return Zi;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function un(t){return t=t.childContextTypes,t!=null}function hh(){Ct(cn),Ct(Ur)}function S1(t,e,r){if(Ur.current!==Zi)throw Error(_e(168));wt(Ur,e),wt(cn,r)}function rT(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(_e(108,yC(t)||"Unknown",s));return Ot({},r,n)}function dh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Zi,La=Ur.current,wt(Ur,t),wt(cn,cn.current),!0}function A1(t,e,r){var n=t.stateNode;if(!n)throw Error(_e(169));r?(t=rT(t,e,La),n.__reactInternalMemoizedMergedChildContext=t,Ct(cn),Ct(Ur),wt(Ur,t)):Ct(cn),wt(cn,r)}var Hs=null,pd=!1,k0=!1;function nT(t){Hs===null?Hs=[t]:Hs.push(t)}function L4(t){pd=!0,nT(t)}function la(){if(!k0&&Hs!==null){k0=!0;var t=0,e=mt;try{var r=Hs;for(mt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Hs=null,pd=!1}catch(s){throw Hs!==null&&(Hs=Hs.slice(t+1)),CE(Jm,la),s}finally{mt=e,k0=!1}}return null}var Po=[],Do=0,ph=null,mh=0,Pn=[],Dn=0,ja=null,Ws=1,Gs="";function va(t,e){Po[Do++]=mh,Po[Do++]=ph,ph=t,mh=e}function sT(t,e,r){Pn[Dn++]=Ws,Pn[Dn++]=Gs,Pn[Dn++]=ja,ja=t;var n=Ws;t=Gs;var s=32-ts(n)-1;n&=~(1<<s),r+=1;var i=32-ts(e)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,Ws=1<<32-ts(e)+s|r<<s|n,Gs=i+t}else Ws=1<<i|r<<s|n,Gs=t}function og(t){t.return!==null&&(va(t,1),sT(t,1,0))}function lg(t){for(;t===ph;)ph=Po[--Do],Po[Do]=null,mh=Po[--Do],Po[Do]=null;for(;t===ja;)ja=Pn[--Dn],Pn[Dn]=null,Gs=Pn[--Dn],Pn[Dn]=null,Ws=Pn[--Dn],Pn[Dn]=null}var yn=null,xn=null,Pt=!1,Xn=null;function iT(t,e){var r=Fn(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function I1(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,yn=t,xn=$i(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,yn=t,xn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=ja!==null?{id:Ws,overflow:Gs}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Fn(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,yn=t,xn=null,!0):!1;default:return!1}}function Fp(t){return(t.mode&1)!==0&&(t.flags&128)===0}function bp(t){if(Pt){var e=xn;if(e){var r=e;if(!I1(t,e)){if(Fp(t))throw Error(_e(418));e=$i(r.nextSibling);var n=yn;e&&I1(t,e)?iT(n,r):(t.flags=t.flags&-4097|2,Pt=!1,yn=t)}}else{if(Fp(t))throw Error(_e(418));t.flags=t.flags&-4097|2,Pt=!1,yn=t}}}function C1(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;yn=t}function df(t){if(t!==yn)return!1;if(!Pt)return C1(t),Pt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Rp(t.type,t.memoizedProps)),e&&(e=xn)){if(Fp(t))throw aT(),Error(_e(418));for(;e;)iT(t,e),e=$i(e.nextSibling)}if(C1(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(_e(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){xn=$i(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}xn=null}}else xn=yn?$i(t.stateNode.nextSibling):null;return!0}function aT(){for(var t=xn;t;)t=$i(t.nextSibling)}function Zo(){xn=yn=null,Pt=!1}function cg(t){Xn===null?Xn=[t]:Xn.push(t)}var j4=mi.ReactCurrentBatchConfig;function zl(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(_e(309));var n=r.stateNode}if(!n)throw Error(_e(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var o=s.refs;a===null?delete o[i]:o[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(_e(284));if(!r._owner)throw Error(_e(290,t))}return t}function pf(t,e){throw t=Object.prototype.toString.call(e),Error(_e(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function R1(t){var e=t._init;return e(t._payload)}function oT(t){function e(S,k){if(t){var w=S.deletions;w===null?(S.deletions=[k],S.flags|=16):w.push(k)}}function r(S,k){if(!t)return null;for(;k!==null;)e(S,k),k=k.sibling;return null}function n(S,k){for(S=new Map;k!==null;)k.key!==null?S.set(k.key,k):S.set(k.index,k),k=k.sibling;return S}function s(S,k){return S=Ki(S,k),S.index=0,S.sibling=null,S}function i(S,k,w){return S.index=w,t?(w=S.alternate,w!==null?(w=w.index,w<k?(S.flags|=2,k):w):(S.flags|=2,k)):(S.flags|=1048576,k)}function a(S){return t&&S.alternate===null&&(S.flags|=2),S}function o(S,k,w,F){return k===null||k.tag!==6?(k=P0(w,S.mode,F),k.return=S,k):(k=s(k,w),k.return=S,k)}function l(S,k,w,F){var B=w.type;return B===So?u(S,k,w.props.children,F,w.key):k!==null&&(k.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Ai&&R1(B)===k.type)?(F=s(k,w.props),F.ref=zl(S,k,w),F.return=S,F):(F=Gf(w.type,w.key,w.props,null,S.mode,F),F.ref=zl(S,k,w),F.return=S,F)}function c(S,k,w,F){return k===null||k.tag!==4||k.stateNode.containerInfo!==w.containerInfo||k.stateNode.implementation!==w.implementation?(k=D0(w,S.mode,F),k.return=S,k):(k=s(k,w.children||[]),k.return=S,k)}function u(S,k,w,F,B){return k===null||k.tag!==7?(k=Pa(w,S.mode,F,B),k.return=S,k):(k=s(k,w),k.return=S,k)}function h(S,k,w){if(typeof k=="string"&&k!==""||typeof k=="number")return k=P0(""+k,S.mode,w),k.return=S,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case rf:return w=Gf(k.type,k.key,k.props,null,S.mode,w),w.ref=zl(S,null,k),w.return=S,w;case ko:return k=D0(k,S.mode,w),k.return=S,k;case Ai:var F=k._init;return h(S,F(k._payload),w)}if(Yl(k)||Ll(k))return k=Pa(k,S.mode,w,null),k.return=S,k;pf(S,k)}return null}function d(S,k,w,F){var B=k!==null?k.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return B!==null?null:o(S,k,""+w,F);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case rf:return w.key===B?l(S,k,w,F):null;case ko:return w.key===B?c(S,k,w,F):null;case Ai:return B=w._init,d(S,k,B(w._payload),F)}if(Yl(w)||Ll(w))return B!==null?null:u(S,k,w,F,null);pf(S,w)}return null}function m(S,k,w,F,B){if(typeof F=="string"&&F!==""||typeof F=="number")return S=S.get(w)||null,o(k,S,""+F,B);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case rf:return S=S.get(F.key===null?w:F.key)||null,l(k,S,F,B);case ko:return S=S.get(F.key===null?w:F.key)||null,c(k,S,F,B);case Ai:var V=F._init;return m(S,k,w,V(F._payload),B)}if(Yl(F)||Ll(F))return S=S.get(w)||null,u(k,S,F,B,null);pf(k,F)}return null}function v(S,k,w,F){for(var B=null,V=null,x=k,E=k=0,T=null;x!==null&&E<w.length;E++){x.index>E?(T=x,x=null):T=x.sibling;var I=d(S,x,w[E],F);if(I===null){x===null&&(x=T);break}t&&x&&I.alternate===null&&e(S,x),k=i(I,k,E),V===null?B=I:V.sibling=I,V=I,x=T}if(E===w.length)return r(S,x),Pt&&va(S,E),B;if(x===null){for(;E<w.length;E++)x=h(S,w[E],F),x!==null&&(k=i(x,k,E),V===null?B=x:V.sibling=x,V=x);return Pt&&va(S,E),B}for(x=n(S,x);E<w.length;E++)T=m(x,S,E,w[E],F),T!==null&&(t&&T.alternate!==null&&x.delete(T.key===null?E:T.key),k=i(T,k,E),V===null?B=T:V.sibling=T,V=T);return t&&x.forEach(function(P){return e(S,P)}),Pt&&va(S,E),B}function g(S,k,w,F){var B=Ll(w);if(typeof B!="function")throw Error(_e(150));if(w=B.call(w),w==null)throw Error(_e(151));for(var V=B=null,x=k,E=k=0,T=null,I=w.next();x!==null&&!I.done;E++,I=w.next()){x.index>E?(T=x,x=null):T=x.sibling;var P=d(S,x,I.value,F);if(P===null){x===null&&(x=T);break}t&&x&&P.alternate===null&&e(S,x),k=i(P,k,E),V===null?B=P:V.sibling=P,V=P,x=T}if(I.done)return r(S,x),Pt&&va(S,E),B;if(x===null){for(;!I.done;E++,I=w.next())I=h(S,I.value,F),I!==null&&(k=i(I,k,E),V===null?B=I:V.sibling=I,V=I);return Pt&&va(S,E),B}for(x=n(S,x);!I.done;E++,I=w.next())I=m(x,S,E,I.value,F),I!==null&&(t&&I.alternate!==null&&x.delete(I.key===null?E:I.key),k=i(I,k,E),V===null?B=I:V.sibling=I,V=I);return t&&x.forEach(function(N){return e(S,N)}),Pt&&va(S,E),B}function y(S,k,w,F){if(typeof w=="object"&&w!==null&&w.type===So&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case rf:e:{for(var B=w.key,V=k;V!==null;){if(V.key===B){if(B=w.type,B===So){if(V.tag===7){r(S,V.sibling),k=s(V,w.props.children),k.return=S,S=k;break e}}else if(V.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Ai&&R1(B)===V.type){r(S,V.sibling),k=s(V,w.props),k.ref=zl(S,V,w),k.return=S,S=k;break e}r(S,V);break}else e(S,V);V=V.sibling}w.type===So?(k=Pa(w.props.children,S.mode,F,w.key),k.return=S,S=k):(F=Gf(w.type,w.key,w.props,null,S.mode,F),F.ref=zl(S,k,w),F.return=S,S=F)}return a(S);case ko:e:{for(V=w.key;k!==null;){if(k.key===V)if(k.tag===4&&k.stateNode.containerInfo===w.containerInfo&&k.stateNode.implementation===w.implementation){r(S,k.sibling),k=s(k,w.children||[]),k.return=S,S=k;break e}else{r(S,k);break}else e(S,k);k=k.sibling}k=D0(w,S.mode,F),k.return=S,S=k}return a(S);case Ai:return V=w._init,y(S,k,V(w._payload),F)}if(Yl(w))return v(S,k,w,F);if(Ll(w))return g(S,k,w,F);pf(S,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,k!==null&&k.tag===6?(r(S,k.sibling),k=s(k,w),k.return=S,S=k):(r(S,k),k=P0(w,S.mode,F),k.return=S,S=k),a(S)):r(S,k)}return y}var el=oT(!0),lT=oT(!1),gh=oa(null),vh=null,Fo=null,ug=null;function fg(){ug=Fo=vh=null}function hg(t){var e=gh.current;Ct(gh),t._currentValue=e}function Op(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Bo(t,e){vh=t,ug=Fo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ln=!0),t.firstContext=null)}function Ln(t){var e=t._currentValue;if(ug!==t)if(t={context:t,memoizedValue:e,next:null},Fo===null){if(vh===null)throw Error(_e(308));Fo=t,vh.dependencies={lanes:0,firstContext:t}}else Fo=Fo.next=t;return e}var ka=null;function dg(t){ka===null?ka=[t]:ka.push(t)}function cT(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,dg(e)):(r.next=s.next,s.next=r),e.interleaved=r,ai(t,n)}function ai(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Ii=!1;function pg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uT(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Js(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Hi(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,st&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,ai(t,r)}return s=n.interleaved,s===null?(e.next=e,dg(n)):(e.next=s.next,s.next=e),n.interleaved=e,ai(t,r)}function Uf(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Zm(t,r)}}function N1(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function xh(t,e,r,n){var s=t.updateQueue;Ii=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?i=c:a.next=c,a=l;var u=t.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;a=0,u=c=l=null,o=i;do{var d=o.lane,m=o.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=t,g=o;switch(d=e,m=r,g.tag){case 1:if(v=g.payload,typeof v=="function"){h=v.call(m,h,d);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,d=typeof v=="function"?v.call(m,h,d):v,d==null)break e;h=Ot({},h,d);break e;case 2:Ii=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,d=s.effects,d===null?s.effects=[o]:d.push(o))}else m={eventTime:m,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=m,l=h):u=u.next=m,a|=d;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;d=o,o=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(!0);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ua|=a,t.lanes=a,t.memoizedState=h}}function P1(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(_e(191,s));s.call(n)}}}var yu={},ys=oa(yu),zc=oa(yu),$c=oa(yu);function Sa(t){if(t===yu)throw Error(_e(174));return t}function mg(t,e){switch(wt($c,e),wt(zc,t),wt(ys,yu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:mp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=mp(e,t)}Ct(ys),wt(ys,e)}function tl(){Ct(ys),Ct(zc),Ct($c)}function fT(t){Sa($c.current);var e=Sa(ys.current),r=mp(e,t.type);e!==r&&(wt(zc,t),wt(ys,r))}function gg(t){zc.current===t&&(Ct(ys),Ct(zc))}var Ft=oa(0);function _h(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var S0=[];function vg(){for(var t=0;t<S0.length;t++)S0[t]._workInProgressVersionPrimary=null;S0.length=0}var Bf=mi.ReactCurrentDispatcher,A0=mi.ReactCurrentBatchConfig,Va=0,bt=null,tr=null,fr=null,yh=!1,dc=!1,Hc=0,V4=0;function Rr(){throw Error(_e(321))}function xg(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!is(t[r],e[r]))return!1;return!0}function _g(t,e,r,n,s,i){if(Va=i,bt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Bf.current=t===null||t.memoizedState===null?$4:H4,t=r(n,s),dc){i=0;do{if(dc=!1,Hc=0,25<=i)throw Error(_e(301));i+=1,fr=tr=null,e.updateQueue=null,Bf.current=W4,t=r(n,s)}while(dc)}if(Bf.current=wh,e=tr!==null&&tr.next!==null,Va=0,fr=tr=bt=null,yh=!1,e)throw Error(_e(300));return t}function yg(){var t=Hc!==0;return Hc=0,t}function ms(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fr===null?bt.memoizedState=fr=t:fr=fr.next=t,fr}function jn(){if(tr===null){var t=bt.alternate;t=t!==null?t.memoizedState:null}else t=tr.next;var e=fr===null?bt.memoizedState:fr.next;if(e!==null)fr=e,tr=t;else{if(t===null)throw Error(_e(310));tr=t,t={memoizedState:tr.memoizedState,baseState:tr.baseState,baseQueue:tr.baseQueue,queue:tr.queue,next:null},fr===null?bt.memoizedState=fr=t:fr=fr.next=t}return fr}function Wc(t,e){return typeof e=="function"?e(t):e}function I0(t){var e=jn(),r=e.queue;if(r===null)throw Error(_e(311));r.lastRenderedReducer=t;var n=tr,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=a=null,l=null,c=i;do{var u=c.lane;if((Va&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:t(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,bt.lanes|=u,Ua|=u}c=c.next}while(c!==null&&c!==i);l===null?a=n:l.next=o,is(n,e.memoizedState)||(ln=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,bt.lanes|=i,Ua|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function C0(t){var e=jn(),r=e.queue;if(r===null)throw Error(_e(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);is(i,e.memoizedState)||(ln=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function hT(){}function dT(t,e){var r=bt,n=jn(),s=e(),i=!is(n.memoizedState,s);if(i&&(n.memoizedState=s,ln=!0),n=n.queue,wg(gT.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||fr!==null&&fr.memoizedState.tag&1){if(r.flags|=2048,Gc(9,mT.bind(null,r,n,s,e),void 0,null),hr===null)throw Error(_e(349));Va&30||pT(r,e,s)}return s}function pT(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=bt.updateQueue,e===null?(e={lastEffect:null,stores:null},bt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function mT(t,e,r,n){e.value=r,e.getSnapshot=n,vT(e)&&xT(t)}function gT(t,e,r){return r(function(){vT(e)&&xT(t)})}function vT(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!is(t,r)}catch{return!0}}function xT(t){var e=ai(t,1);e!==null&&rs(e,t,1,-1)}function D1(t){var e=ms();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Wc,lastRenderedState:t},e.queue=t,t=t.dispatch=z4.bind(null,bt,t),[e.memoizedState,t]}function Gc(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=bt.updateQueue,e===null?(e={lastEffect:null,stores:null},bt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function _T(){return jn().memoizedState}function zf(t,e,r,n){var s=ms();bt.flags|=t,s.memoizedState=Gc(1|e,r,void 0,n===void 0?null:n)}function md(t,e,r,n){var s=jn();n=n===void 0?null:n;var i=void 0;if(tr!==null){var a=tr.memoizedState;if(i=a.destroy,n!==null&&xg(n,a.deps)){s.memoizedState=Gc(e,r,i,n);return}}bt.flags|=t,s.memoizedState=Gc(1|e,r,i,n)}function F1(t,e){return zf(8390656,8,t,e)}function wg(t,e){return md(2048,8,t,e)}function yT(t,e){return md(4,2,t,e)}function wT(t,e){return md(4,4,t,e)}function ET(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function TT(t,e,r){return r=r!=null?r.concat([t]):null,md(4,4,ET.bind(null,e,t),r)}function Eg(){}function kT(t,e){var r=jn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&xg(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function ST(t,e){var r=jn();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&xg(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function AT(t,e,r){return Va&21?(is(r,e)||(r=PE(),bt.lanes|=r,Ua|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ln=!0),t.memoizedState=r)}function U4(t,e){var r=mt;mt=r!==0&&4>r?r:4,t(!0);var n=A0.transition;A0.transition={};try{t(!1),e()}finally{mt=r,A0.transition=n}}function IT(){return jn().memoizedState}function B4(t,e,r){var n=Gi(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},CT(t))RT(e,r);else if(r=cT(t,e,r,n),r!==null){var s=qr();rs(r,t,n,s),NT(r,e,n)}}function z4(t,e,r){var n=Gi(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(CT(t))RT(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,o=i(a,r);if(s.hasEagerState=!0,s.eagerState=o,is(o,a)){var l=e.interleaved;l===null?(s.next=s,dg(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}r=cT(t,e,s,n),r!==null&&(s=qr(),rs(r,t,n,s),NT(r,e,n))}}function CT(t){var e=t.alternate;return t===bt||e!==null&&e===bt}function RT(t,e){dc=yh=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function NT(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Zm(t,r)}}var wh={readContext:Ln,useCallback:Rr,useContext:Rr,useEffect:Rr,useImperativeHandle:Rr,useInsertionEffect:Rr,useLayoutEffect:Rr,useMemo:Rr,useReducer:Rr,useRef:Rr,useState:Rr,useDebugValue:Rr,useDeferredValue:Rr,useTransition:Rr,useMutableSource:Rr,useSyncExternalStore:Rr,useId:Rr,unstable_isNewReconciler:!1},$4={readContext:Ln,useCallback:function(t,e){return ms().memoizedState=[t,e===void 0?null:e],t},useContext:Ln,useEffect:F1,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,zf(4194308,4,ET.bind(null,e,t),r)},useLayoutEffect:function(t,e){return zf(4194308,4,t,e)},useInsertionEffect:function(t,e){return zf(4,2,t,e)},useMemo:function(t,e){var r=ms();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=ms();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=B4.bind(null,bt,t),[n.memoizedState,t]},useRef:function(t){var e=ms();return t={current:t},e.memoizedState=t},useState:D1,useDebugValue:Eg,useDeferredValue:function(t){return ms().memoizedState=t},useTransition:function(){var t=D1(!1),e=t[0];return t=U4.bind(null,t[1]),ms().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=bt,s=ms();if(Pt){if(r===void 0)throw Error(_e(407));r=r()}else{if(r=e(),hr===null)throw Error(_e(349));Va&30||pT(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,F1(gT.bind(null,n,i,t),[t]),n.flags|=2048,Gc(9,mT.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=ms(),e=hr.identifierPrefix;if(Pt){var r=Gs,n=Ws;r=(n&~(1<<32-ts(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Hc++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=V4++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},H4={readContext:Ln,useCallback:kT,useContext:Ln,useEffect:wg,useImperativeHandle:TT,useInsertionEffect:yT,useLayoutEffect:wT,useMemo:ST,useReducer:I0,useRef:_T,useState:function(){return I0(Wc)},useDebugValue:Eg,useDeferredValue:function(t){var e=jn();return AT(e,tr.memoizedState,t)},useTransition:function(){var t=I0(Wc)[0],e=jn().memoizedState;return[t,e]},useMutableSource:hT,useSyncExternalStore:dT,useId:IT,unstable_isNewReconciler:!1},W4={readContext:Ln,useCallback:kT,useContext:Ln,useEffect:wg,useImperativeHandle:TT,useInsertionEffect:yT,useLayoutEffect:wT,useMemo:ST,useReducer:C0,useRef:_T,useState:function(){return C0(Wc)},useDebugValue:Eg,useDeferredValue:function(t){var e=jn();return tr===null?e.memoizedState=t:AT(e,tr.memoizedState,t)},useTransition:function(){var t=C0(Wc)[0],e=jn().memoizedState;return[t,e]},useMutableSource:hT,useSyncExternalStore:dT,useId:IT,unstable_isNewReconciler:!1};function Gn(t,e){if(t&&t.defaultProps){e=Ot({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Mp(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Ot({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var gd={isMounted:function(t){return(t=t._reactInternals)?Ja(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=qr(),s=Gi(t),i=Js(n,s);i.payload=e,r!=null&&(i.callback=r),e=Hi(t,i,s),e!==null&&(rs(e,t,s,n),Uf(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=qr(),s=Gi(t),i=Js(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=Hi(t,i,s),e!==null&&(rs(e,t,s,n),Uf(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=qr(),n=Gi(t),s=Js(r,n);s.tag=2,e!=null&&(s.callback=e),e=Hi(t,s,n),e!==null&&(rs(e,t,n,r),Uf(e,t,n))}};function b1(t,e,r,n,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,a):e.prototype&&e.prototype.isPureReactComponent?!jc(r,n)||!jc(s,i):!0}function PT(t,e,r){var n=!1,s=Zi,i=e.contextType;return typeof i=="object"&&i!==null?i=Ln(i):(s=un(e)?La:Ur.current,n=e.contextTypes,i=(n=n!=null)?Jo(t,s):Zi),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=gd,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function O1(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&gd.enqueueReplaceState(e,e.state,null)}function Lp(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},pg(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Ln(i):(i=un(e)?La:Ur.current,s.context=Jo(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Mp(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&gd.enqueueReplaceState(s,s.state,null),xh(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function rl(t,e){try{var r="",n=e;do r+=_C(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function R0(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function jp(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var G4=typeof WeakMap=="function"?WeakMap:Map;function DT(t,e,r){r=Js(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Th||(Th=!0,qp=n),jp(t,e)},r}function FT(t,e,r){r=Js(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){jp(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){jp(t,e),typeof n!="function"&&(Wi===null?Wi=new Set([this]):Wi.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function M1(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new G4;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=aR.bind(null,t,e,r),e.then(t,t))}function L1(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function j1(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Js(-1,1),e.tag=2,Hi(r,e,1))),r.lanes|=1),t)}var K4=mi.ReactCurrentOwner,ln=!1;function Hr(t,e,r,n){e.child=t===null?lT(e,null,r,n):el(e,t.child,r,n)}function V1(t,e,r,n,s){r=r.render;var i=e.ref;return Bo(e,s),n=_g(t,e,r,n,i,s),r=yg(),t!==null&&!ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,oi(t,e,s)):(Pt&&r&&og(e),e.flags|=1,Hr(t,e,n,s),e.child)}function U1(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!Ng(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,bT(t,e,i,n,s)):(t=Gf(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:jc,r(a,n)&&t.ref===e.ref)return oi(t,e,s)}return e.flags|=1,t=Ki(i,n),t.ref=e.ref,t.return=e,e.child=t}function bT(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(jc(i,n)&&t.ref===e.ref)if(ln=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(ln=!0);else return e.lanes=t.lanes,oi(t,e,s)}return Vp(t,e,r,n,s)}function OT(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},wt(Oo,pn),pn|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,wt(Oo,pn),pn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,wt(Oo,pn),pn|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,wt(Oo,pn),pn|=n;return Hr(t,e,s,r),e.child}function MT(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Vp(t,e,r,n,s){var i=un(r)?La:Ur.current;return i=Jo(e,i),Bo(e,s),r=_g(t,e,r,n,i,s),n=yg(),t!==null&&!ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,oi(t,e,s)):(Pt&&n&&og(e),e.flags|=1,Hr(t,e,r,s),e.child)}function B1(t,e,r,n,s){if(un(r)){var i=!0;dh(e)}else i=!1;if(Bo(e,s),e.stateNode===null)$f(t,e),PT(e,r,n),Lp(e,r,n,s),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=Ln(c):(c=un(r)?La:Ur.current,c=Jo(e,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&O1(e,a,n,c),Ii=!1;var d=e.memoizedState;a.state=d,xh(e,n,a,s),l=e.memoizedState,o!==n||d!==l||cn.current||Ii?(typeof u=="function"&&(Mp(e,r,u,n),l=e.memoizedState),(o=Ii||b1(e,r,o,n,d,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,uT(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:Gn(e.type,o),a.props=c,h=e.pendingProps,d=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Ln(l):(l=un(r)?La:Ur.current,l=Jo(e,l));var m=r.getDerivedStateFromProps;(u=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&O1(e,a,n,l),Ii=!1,d=e.memoizedState,a.state=d,xh(e,n,a,s);var v=e.memoizedState;o!==h||d!==v||cn.current||Ii?(typeof m=="function"&&(Mp(e,r,m,n),v=e.memoizedState),(c=Ii||b1(e,r,c,n,d,v,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,v,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,v,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=v),a.props=n,a.state=v,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return Up(t,e,r,n,i,s)}function Up(t,e,r,n,s,i){MT(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return s&&A1(e,r,!1),oi(t,e,i);n=e.stateNode,K4.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=el(e,t.child,null,i),e.child=el(e,null,o,i)):Hr(t,e,o,i),e.memoizedState=n.state,s&&A1(e,r,!0),e.child}function LT(t){var e=t.stateNode;e.pendingContext?S1(t,e.pendingContext,e.pendingContext!==e.context):e.context&&S1(t,e.context,!1),mg(t,e.containerInfo)}function z1(t,e,r,n,s){return Zo(),cg(s),e.flags|=256,Hr(t,e,r,n),e.child}var Bp={dehydrated:null,treeContext:null,retryLane:0};function zp(t){return{baseLanes:t,cachePool:null,transitions:null}}function jT(t,e,r){var n=e.pendingProps,s=Ft.current,i=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),wt(Ft,s&1),t===null)return bp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,i?(n=e.mode,i=e.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=_d(a,n,0,null),t=Pa(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=zp(r),e.memoizedState=Bp,t):Tg(e,a));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return q4(t,e,a,n,o,s,r);if(i){i=n.fallback,a=e.mode,s=t.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Ki(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=Ki(o,i):(i=Pa(i,a,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,a=t.child.memoizedState,a=a===null?zp(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~r,e.memoizedState=Bp,n}return i=t.child,t=i.sibling,n=Ki(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Tg(t,e){return e=_d({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function mf(t,e,r,n){return n!==null&&cg(n),el(e,t.child,null,r),t=Tg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function q4(t,e,r,n,s,i,a){if(r)return e.flags&256?(e.flags&=-257,n=R0(Error(_e(422))),mf(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=_d({mode:"visible",children:n.children},s,0,null),i=Pa(i,s,a,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&el(e,t.child,null,a),e.child.memoizedState=zp(a),e.memoizedState=Bp,i);if(!(e.mode&1))return mf(t,e,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(_e(419)),n=R0(i,n,void 0),mf(t,e,a,n)}if(o=(a&t.childLanes)!==0,ln||o){if(n=hr,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ai(t,s),rs(n,t,s,-1))}return Rg(),n=R0(Error(_e(421))),mf(t,e,a,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=oR.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,xn=$i(s.nextSibling),yn=e,Pt=!0,Xn=null,t!==null&&(Pn[Dn++]=Ws,Pn[Dn++]=Gs,Pn[Dn++]=ja,Ws=t.id,Gs=t.overflow,ja=e),e=Tg(e,n.children),e.flags|=4096,e)}function $1(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Op(t.return,e,r)}function N0(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function VT(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(Hr(t,e,n.children,r),n=Ft.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&$1(t,r,e);else if(t.tag===19)$1(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(wt(Ft,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&_h(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),N0(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&_h(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}N0(e,!0,r,null,i);break;case"together":N0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function $f(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function oi(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ua|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(_e(153));if(e.child!==null){for(t=e.child,r=Ki(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Ki(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function X4(t,e,r){switch(e.tag){case 3:LT(e),Zo();break;case 5:fT(e);break;case 1:un(e.type)&&dh(e);break;case 4:mg(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;wt(gh,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(wt(Ft,Ft.current&1),e.flags|=128,null):r&e.child.childLanes?jT(t,e,r):(wt(Ft,Ft.current&1),t=oi(t,e,r),t!==null?t.sibling:null);wt(Ft,Ft.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return VT(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),wt(Ft,Ft.current),n)break;return null;case 22:case 23:return e.lanes=0,OT(t,e,r)}return oi(t,e,r)}var UT,$p,BT,zT;UT=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};$p=function(){};BT=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Sa(ys.current);var i=null;switch(r){case"input":s=fp(t,s),n=fp(t,n),i=[];break;case"select":s=Ot({},s,{value:void 0}),n=Ot({},n,{value:void 0}),i=[];break;case"textarea":s=pp(t,s),n=pp(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=fh)}gp(r,n);var a;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var o=s[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Pc.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(o=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(i||(i=[]),i.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Pc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&It("scroll",t),i||o===l||(i=[])):(i=i||[]).push(c,l))}r&&(i=i||[]).push("style",r);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};zT=function(t,e,r,n){r!==n&&(e.flags|=4)};function $l(t,e){if(!Pt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Nr(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function Y4(t,e,r){var n=e.pendingProps;switch(lg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nr(e),null;case 1:return un(e.type)&&hh(),Nr(e),null;case 3:return n=e.stateNode,tl(),Ct(cn),Ct(Ur),vg(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(df(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Xn!==null&&(Qp(Xn),Xn=null))),$p(t,e),Nr(e),null;case 5:gg(e);var s=Sa($c.current);if(r=e.type,t!==null&&e.stateNode!=null)BT(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(_e(166));return Nr(e),null}if(t=Sa(ys.current),df(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[gs]=e,n[Bc]=i,t=(e.mode&1)!==0,r){case"dialog":It("cancel",n),It("close",n);break;case"iframe":case"object":case"embed":It("load",n);break;case"video":case"audio":for(s=0;s<Jl.length;s++)It(Jl[s],n);break;case"source":It("error",n);break;case"img":case"image":case"link":It("error",n),It("load",n);break;case"details":It("toggle",n);break;case"input":Jx(n,i),It("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},It("invalid",n);break;case"textarea":e1(n,i),It("invalid",n)}gp(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&hf(n.textContent,o,t),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&hf(n.textContent,o,t),s=["children",""+o]):Pc.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&It("scroll",n)}switch(r){case"input":nf(n),Zx(n,i,!0);break;case"textarea":nf(n),t1(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=fh)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=gE(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[gs]=e,t[Bc]=n,UT(t,e,!1,!1),e.stateNode=t;e:{switch(a=vp(r,n),r){case"dialog":It("cancel",t),It("close",t),s=n;break;case"iframe":case"object":case"embed":It("load",t),s=n;break;case"video":case"audio":for(s=0;s<Jl.length;s++)It(Jl[s],t);s=n;break;case"source":It("error",t),s=n;break;case"img":case"image":case"link":It("error",t),It("load",t),s=n;break;case"details":It("toggle",t),s=n;break;case"input":Jx(t,n),s=fp(t,n),It("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=Ot({},n,{value:void 0}),It("invalid",t);break;case"textarea":e1(t,n),s=pp(t,n),It("invalid",t);break;default:s=n}gp(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?_E(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&vE(t,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Dc(t,l):typeof l=="number"&&Dc(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Pc.hasOwnProperty(i)?l!=null&&i==="onScroll"&&It("scroll",t):l!=null&&Km(t,i,l,a))}switch(r){case"input":nf(t),Zx(t,n,!1);break;case"textarea":nf(t),t1(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ji(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?Lo(t,!!n.multiple,i,!1):n.defaultValue!=null&&Lo(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=fh)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Nr(e),null;case 6:if(t&&e.stateNode!=null)zT(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(_e(166));if(r=Sa($c.current),Sa(ys.current),df(e)){if(n=e.stateNode,r=e.memoizedProps,n[gs]=e,(i=n.nodeValue!==r)&&(t=yn,t!==null))switch(t.tag){case 3:hf(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&hf(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[gs]=e,e.stateNode=n}return Nr(e),null;case 13:if(Ct(Ft),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Pt&&xn!==null&&e.mode&1&&!(e.flags&128))aT(),Zo(),e.flags|=98560,i=!1;else if(i=df(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(_e(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(_e(317));i[gs]=e}else Zo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Nr(e),i=!1}else Xn!==null&&(Qp(Xn),Xn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Ft.current&1?rr===0&&(rr=3):Rg())),e.updateQueue!==null&&(e.flags|=4),Nr(e),null);case 4:return tl(),$p(t,e),t===null&&Vc(e.stateNode.containerInfo),Nr(e),null;case 10:return hg(e.type._context),Nr(e),null;case 17:return un(e.type)&&hh(),Nr(e),null;case 19:if(Ct(Ft),i=e.memoizedState,i===null)return Nr(e),null;if(n=(e.flags&128)!==0,a=i.rendering,a===null)if(n)$l(i,!1);else{if(rr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=_h(t),a!==null){for(e.flags|=128,$l(i,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return wt(Ft,Ft.current&1|2),e.child}t=t.sibling}i.tail!==null&&$t()>nl&&(e.flags|=128,n=!0,$l(i,!1),e.lanes=4194304)}else{if(!n)if(t=_h(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),$l(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Pt)return Nr(e),null}else 2*$t()-i.renderingStartTime>nl&&r!==1073741824&&(e.flags|=128,n=!0,$l(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(r=i.last,r!==null?r.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=$t(),e.sibling=null,r=Ft.current,wt(Ft,n?r&1|2:r&1),e):(Nr(e),null);case 22:case 23:return Cg(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?pn&1073741824&&(Nr(e),e.subtreeFlags&6&&(e.flags|=8192)):Nr(e),null;case 24:return null;case 25:return null}throw Error(_e(156,e.tag))}function Q4(t,e){switch(lg(e),e.tag){case 1:return un(e.type)&&hh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return tl(),Ct(cn),Ct(Ur),vg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return gg(e),null;case 13:if(Ct(Ft),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(_e(340));Zo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ct(Ft),null;case 4:return tl(),null;case 10:return hg(e.type._context),null;case 22:case 23:return Cg(),null;case 24:return null;default:return null}}var gf=!1,Or=!1,J4=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function bo(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){jt(t,e,n)}else r.current=null}function Hp(t,e,r){try{r()}catch(n){jt(t,e,n)}}var H1=!1;function Z4(t,e){if(Ip=lh,t=KE(),ag(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,u=0,h=t,d=null;t:for(;;){for(var m;h!==r||s!==0&&h.nodeType!==3||(o=a+s),h!==i||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)d=h,h=m;for(;;){if(h===t)break t;if(d===r&&++c===s&&(o=a),d===i&&++u===n&&(l=a),(m=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Cp={focusedElem:t,selectionRange:r},lh=!1,Ne=e;Ne!==null;)if(e=Ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ne=t;else for(;Ne!==null;){e=Ne;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,y=v.memoizedState,S=e.stateNode,k=S.getSnapshotBeforeUpdate(e.elementType===e.type?g:Gn(e.type,g),y);S.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(_e(163))}}catch(F){jt(e,e.return,F)}if(t=e.sibling,t!==null){t.return=e.return,Ne=t;break}Ne=e.return}return v=H1,H1=!1,v}function pc(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Hp(e,r,i)}s=s.next}while(s!==n)}}function vd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Wp(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function $T(t){var e=t.alternate;e!==null&&(t.alternate=null,$T(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[gs],delete e[Bc],delete e[Pp],delete e[O4],delete e[M4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function HT(t){return t.tag===5||t.tag===3||t.tag===4}function W1(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||HT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Gp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=fh));else if(n!==4&&(t=t.child,t!==null))for(Gp(t,e,r),t=t.sibling;t!==null;)Gp(t,e,r),t=t.sibling}function Kp(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Kp(t,e,r),t=t.sibling;t!==null;)Kp(t,e,r),t=t.sibling}var gr=null,Kn=!1;function Ei(t,e,r){for(r=r.child;r!==null;)WT(t,e,r),r=r.sibling}function WT(t,e,r){if(_s&&typeof _s.onCommitFiberUnmount=="function")try{_s.onCommitFiberUnmount(cd,r)}catch{}switch(r.tag){case 5:Or||bo(r,e);case 6:var n=gr,s=Kn;gr=null,Ei(t,e,r),gr=n,Kn=s,gr!==null&&(Kn?(t=gr,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):gr.removeChild(r.stateNode));break;case 18:gr!==null&&(Kn?(t=gr,r=r.stateNode,t.nodeType===8?T0(t.parentNode,r):t.nodeType===1&&T0(t,r),Mc(t)):T0(gr,r.stateNode));break;case 4:n=gr,s=Kn,gr=r.stateNode.containerInfo,Kn=!0,Ei(t,e,r),gr=n,Kn=s;break;case 0:case 11:case 14:case 15:if(!Or&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Hp(r,e,a),s=s.next}while(s!==n)}Ei(t,e,r);break;case 1:if(!Or&&(bo(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){jt(r,e,o)}Ei(t,e,r);break;case 21:Ei(t,e,r);break;case 22:r.mode&1?(Or=(n=Or)||r.memoizedState!==null,Ei(t,e,r),Or=n):Ei(t,e,r);break;default:Ei(t,e,r)}}function G1(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new J4),e.forEach(function(n){var s=lR.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function $n(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:gr=o.stateNode,Kn=!1;break e;case 3:gr=o.stateNode.containerInfo,Kn=!0;break e;case 4:gr=o.stateNode.containerInfo,Kn=!0;break e}o=o.return}if(gr===null)throw Error(_e(160));WT(i,a,s),gr=null,Kn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){jt(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)GT(e,t),e=e.sibling}function GT(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if($n(e,t),hs(t),n&4){try{pc(3,t,t.return),vd(3,t)}catch(g){jt(t,t.return,g)}try{pc(5,t,t.return)}catch(g){jt(t,t.return,g)}}break;case 1:$n(e,t),hs(t),n&512&&r!==null&&bo(r,r.return);break;case 5:if($n(e,t),hs(t),n&512&&r!==null&&bo(r,r.return),t.flags&32){var s=t.stateNode;try{Dc(s,"")}catch(g){jt(t,t.return,g)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=r!==null?r.memoizedProps:i,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&pE(s,i),vp(o,a);var c=vp(o,i);for(a=0;a<l.length;a+=2){var u=l[a],h=l[a+1];u==="style"?_E(s,h):u==="dangerouslySetInnerHTML"?vE(s,h):u==="children"?Dc(s,h):Km(s,u,h,c)}switch(o){case"input":hp(s,i);break;case"textarea":mE(s,i);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?Lo(s,!!i.multiple,m,!1):d!==!!i.multiple&&(i.defaultValue!=null?Lo(s,!!i.multiple,i.defaultValue,!0):Lo(s,!!i.multiple,i.multiple?[]:"",!1))}s[Bc]=i}catch(g){jt(t,t.return,g)}}break;case 6:if($n(e,t),hs(t),n&4){if(t.stateNode===null)throw Error(_e(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(g){jt(t,t.return,g)}}break;case 3:if($n(e,t),hs(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Mc(e.containerInfo)}catch(g){jt(t,t.return,g)}break;case 4:$n(e,t),hs(t);break;case 13:$n(e,t),hs(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Ag=$t())),n&4&&G1(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(Or=(c=Or)||u,$n(e,t),Or=c):$n(e,t),hs(t),n&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(Ne=t,u=t.child;u!==null;){for(h=Ne=u;Ne!==null;){switch(d=Ne,m=d.child,d.tag){case 0:case 11:case 14:case 15:pc(4,d,d.return);break;case 1:bo(d,d.return);var v=d.stateNode;if(typeof v.componentWillUnmount=="function"){n=d,r=d.return;try{e=n,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(g){jt(n,r,g)}}break;case 5:bo(d,d.return);break;case 22:if(d.memoizedState!==null){q1(h);continue}}m!==null?(m.return=d,Ne=m):q1(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=xE("display",a))}catch(g){jt(t,t.return,g)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){jt(t,t.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:$n(e,t),hs(t),n&4&&G1(t);break;case 21:break;default:$n(e,t),hs(t)}}function hs(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(HT(r)){var n=r;break e}r=r.return}throw Error(_e(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Dc(s,""),n.flags&=-33);var i=W1(t);Kp(t,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,o=W1(t);Gp(t,o,a);break;default:throw Error(_e(161))}}catch(l){jt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function eR(t,e,r){Ne=t,KT(t)}function KT(t,e,r){for(var n=(t.mode&1)!==0;Ne!==null;){var s=Ne,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||gf;if(!a){var o=s.alternate,l=o!==null&&o.memoizedState!==null||Or;o=gf;var c=Or;if(gf=a,(Or=l)&&!c)for(Ne=s;Ne!==null;)a=Ne,l=a.child,a.tag===22&&a.memoizedState!==null?X1(s):l!==null?(l.return=a,Ne=l):X1(s);for(;i!==null;)Ne=i,KT(i),i=i.sibling;Ne=s,gf=o,Or=c}K1(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Ne=i):K1(t)}}function K1(t){for(;Ne!==null;){var e=Ne;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Or||vd(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Or)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Gn(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&P1(e,i,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}P1(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Mc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(_e(163))}Or||e.flags&512&&Wp(e)}catch(d){jt(e,e.return,d)}}if(e===t){Ne=null;break}if(r=e.sibling,r!==null){r.return=e.return,Ne=r;break}Ne=e.return}}function q1(t){for(;Ne!==null;){var e=Ne;if(e===t){Ne=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Ne=r;break}Ne=e.return}}function X1(t){for(;Ne!==null;){var e=Ne;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{vd(4,e)}catch(l){jt(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(l){jt(e,s,l)}}var i=e.return;try{Wp(e)}catch(l){jt(e,i,l)}break;case 5:var a=e.return;try{Wp(e)}catch(l){jt(e,a,l)}}}catch(l){jt(e,e.return,l)}if(e===t){Ne=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ne=o;break}Ne=e.return}}var tR=Math.ceil,Eh=mi.ReactCurrentDispatcher,kg=mi.ReactCurrentOwner,bn=mi.ReactCurrentBatchConfig,st=0,hr=null,Qt=null,yr=0,pn=0,Oo=oa(0),rr=0,Kc=null,Ua=0,xd=0,Sg=0,mc=null,an=null,Ag=0,nl=1/0,$s=null,Th=!1,qp=null,Wi=null,vf=!1,Oi=null,kh=0,gc=0,Xp=null,Hf=-1,Wf=0;function qr(){return st&6?$t():Hf!==-1?Hf:Hf=$t()}function Gi(t){return t.mode&1?st&2&&yr!==0?yr&-yr:j4.transition!==null?(Wf===0&&(Wf=PE()),Wf):(t=mt,t!==0||(t=window.event,t=t===void 0?16:jE(t.type)),t):1}function rs(t,e,r,n){if(50<gc)throw gc=0,Xp=null,Error(_e(185));vu(t,r,n),(!(st&2)||t!==hr)&&(t===hr&&(!(st&2)&&(xd|=r),rr===4&&Ri(t,yr)),fn(t,n),r===1&&st===0&&!(e.mode&1)&&(nl=$t()+500,pd&&la()))}function fn(t,e){var r=t.callbackNode;jC(t,e);var n=oh(t,t===hr?yr:0);if(n===0)r!==null&&s1(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&s1(r),e===1)t.tag===0?L4(Y1.bind(null,t)):nT(Y1.bind(null,t)),F4(function(){!(st&6)&&la()}),r=null;else{switch(DE(n)){case 1:r=Jm;break;case 4:r=RE;break;case 16:r=ah;break;case 536870912:r=NE;break;default:r=ah}r=t2(r,qT.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function qT(t,e){if(Hf=-1,Wf=0,st&6)throw Error(_e(327));var r=t.callbackNode;if(zo()&&t.callbackNode!==r)return null;var n=oh(t,t===hr?yr:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Sh(t,n);else{e=n;var s=st;st|=2;var i=YT();(hr!==t||yr!==e)&&($s=null,nl=$t()+500,Na(t,e));do try{sR();break}catch(o){XT(t,o)}while(!0);fg(),Eh.current=i,st=s,Qt!==null?e=0:(hr=null,yr=0,e=rr)}if(e!==0){if(e===2&&(s=Ep(t),s!==0&&(n=s,e=Yp(t,s))),e===1)throw r=Kc,Na(t,0),Ri(t,n),fn(t,$t()),r;if(e===6)Ri(t,n);else{if(s=t.current.alternate,!(n&30)&&!rR(s)&&(e=Sh(t,n),e===2&&(i=Ep(t),i!==0&&(n=i,e=Yp(t,i))),e===1))throw r=Kc,Na(t,0),Ri(t,n),fn(t,$t()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(_e(345));case 2:xa(t,an,$s);break;case 3:if(Ri(t,n),(n&130023424)===n&&(e=Ag+500-$t(),10<e)){if(oh(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){qr(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Np(xa.bind(null,t,an,$s),e);break}xa(t,an,$s);break;case 4:if(Ri(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var a=31-ts(n);i=1<<a,a=e[a],a>s&&(s=a),n&=~i}if(n=s,n=$t()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*tR(n/1960))-n,10<n){t.timeoutHandle=Np(xa.bind(null,t,an,$s),n);break}xa(t,an,$s);break;case 5:xa(t,an,$s);break;default:throw Error(_e(329))}}}return fn(t,$t()),t.callbackNode===r?qT.bind(null,t):null}function Yp(t,e){var r=mc;return t.current.memoizedState.isDehydrated&&(Na(t,e).flags|=256),t=Sh(t,e),t!==2&&(e=an,an=r,e!==null&&Qp(e)),t}function Qp(t){an===null?an=t:an.push.apply(an,t)}function rR(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!is(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ri(t,e){for(e&=~Sg,e&=~xd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-ts(e),n=1<<r;t[r]=-1,e&=~n}}function Y1(t){if(st&6)throw Error(_e(327));zo();var e=oh(t,0);if(!(e&1))return fn(t,$t()),null;var r=Sh(t,e);if(t.tag!==0&&r===2){var n=Ep(t);n!==0&&(e=n,r=Yp(t,n))}if(r===1)throw r=Kc,Na(t,0),Ri(t,e),fn(t,$t()),r;if(r===6)throw Error(_e(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,xa(t,an,$s),fn(t,$t()),null}function Ig(t,e){var r=st;st|=1;try{return t(e)}finally{st=r,st===0&&(nl=$t()+500,pd&&la())}}function Ba(t){Oi!==null&&Oi.tag===0&&!(st&6)&&zo();var e=st;st|=1;var r=bn.transition,n=mt;try{if(bn.transition=null,mt=1,t)return t()}finally{mt=n,bn.transition=r,st=e,!(st&6)&&la()}}function Cg(){pn=Oo.current,Ct(Oo)}function Na(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,D4(r)),Qt!==null)for(r=Qt.return;r!==null;){var n=r;switch(lg(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&hh();break;case 3:tl(),Ct(cn),Ct(Ur),vg();break;case 5:gg(n);break;case 4:tl();break;case 13:Ct(Ft);break;case 19:Ct(Ft);break;case 10:hg(n.type._context);break;case 22:case 23:Cg()}r=r.return}if(hr=t,Qt=t=Ki(t.current,null),yr=pn=e,rr=0,Kc=null,Sg=xd=Ua=0,an=mc=null,ka!==null){for(e=0;e<ka.length;e++)if(r=ka[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}ka=null}return t}function XT(t,e){do{var r=Qt;try{if(fg(),Bf.current=wh,yh){for(var n=bt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}yh=!1}if(Va=0,fr=tr=bt=null,dc=!1,Hc=0,kg.current=null,r===null||r.return===null){rr=1,Kc=e,Qt=null;break}e:{var i=t,a=r.return,o=r,l=e;if(e=yr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=L1(a);if(m!==null){m.flags&=-257,j1(m,a,o,i,e),m.mode&1&&M1(i,c,e),e=m,l=c;var v=e.updateQueue;if(v===null){var g=new Set;g.add(l),e.updateQueue=g}else v.add(l);break e}else{if(!(e&1)){M1(i,c,e),Rg();break e}l=Error(_e(426))}}else if(Pt&&o.mode&1){var y=L1(a);if(y!==null){!(y.flags&65536)&&(y.flags|=256),j1(y,a,o,i,e),cg(rl(l,o));break e}}i=l=rl(l,o),rr!==4&&(rr=2),mc===null?mc=[i]:mc.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var S=DT(i,l,e);N1(i,S);break e;case 1:o=l;var k=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof k.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Wi===null||!Wi.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var F=FT(i,o,e);N1(i,F);break e}}i=i.return}while(i!==null)}JT(r)}catch(B){e=B,Qt===r&&r!==null&&(Qt=r=r.return);continue}break}while(!0)}function YT(){var t=Eh.current;return Eh.current=wh,t===null?wh:t}function Rg(){(rr===0||rr===3||rr===2)&&(rr=4),hr===null||!(Ua&268435455)&&!(xd&268435455)||Ri(hr,yr)}function Sh(t,e){var r=st;st|=2;var n=YT();(hr!==t||yr!==e)&&($s=null,Na(t,e));do try{nR();break}catch(s){XT(t,s)}while(!0);if(fg(),st=r,Eh.current=n,Qt!==null)throw Error(_e(261));return hr=null,yr=0,rr}function nR(){for(;Qt!==null;)QT(Qt)}function sR(){for(;Qt!==null&&!RC();)QT(Qt)}function QT(t){var e=e2(t.alternate,t,pn);t.memoizedProps=t.pendingProps,e===null?JT(t):Qt=e,kg.current=null}function JT(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=Q4(r,e),r!==null){r.flags&=32767,Qt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{rr=6,Qt=null;return}}else if(r=Y4(r,e,pn),r!==null){Qt=r;return}if(e=e.sibling,e!==null){Qt=e;return}Qt=e=t}while(e!==null);rr===0&&(rr=5)}function xa(t,e,r){var n=mt,s=bn.transition;try{bn.transition=null,mt=1,iR(t,e,r,n)}finally{bn.transition=s,mt=n}return null}function iR(t,e,r,n){do zo();while(Oi!==null);if(st&6)throw Error(_e(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(_e(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(VC(t,i),t===hr&&(Qt=hr=null,yr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||vf||(vf=!0,t2(ah,function(){return zo(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=bn.transition,bn.transition=null;var a=mt;mt=1;var o=st;st|=4,kg.current=null,Z4(t,r),GT(r,t),S4(Cp),lh=!!Ip,Cp=Ip=null,t.current=r,eR(r),NC(),st=o,mt=a,bn.transition=i}else t.current=r;if(vf&&(vf=!1,Oi=t,kh=s),i=t.pendingLanes,i===0&&(Wi=null),FC(r.stateNode),fn(t,$t()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Th)throw Th=!1,t=qp,qp=null,t;return kh&1&&t.tag!==0&&zo(),i=t.pendingLanes,i&1?t===Xp?gc++:(gc=0,Xp=t):gc=0,la(),null}function zo(){if(Oi!==null){var t=DE(kh),e=bn.transition,r=mt;try{if(bn.transition=null,mt=16>t?16:t,Oi===null)var n=!1;else{if(t=Oi,Oi=null,kh=0,st&6)throw Error(_e(331));var s=st;for(st|=4,Ne=t.current;Ne!==null;){var i=Ne,a=i.child;if(Ne.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ne=c;Ne!==null;){var u=Ne;switch(u.tag){case 0:case 11:case 15:pc(8,u,i)}var h=u.child;if(h!==null)h.return=u,Ne=h;else for(;Ne!==null;){u=Ne;var d=u.sibling,m=u.return;if($T(u),u===c){Ne=null;break}if(d!==null){d.return=m,Ne=d;break}Ne=m}}}var v=i.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}Ne=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Ne=a;else e:for(;Ne!==null;){if(i=Ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:pc(9,i,i.return)}var S=i.sibling;if(S!==null){S.return=i.return,Ne=S;break e}Ne=i.return}}var k=t.current;for(Ne=k;Ne!==null;){a=Ne;var w=a.child;if(a.subtreeFlags&2064&&w!==null)w.return=a,Ne=w;else e:for(a=k;Ne!==null;){if(o=Ne,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:vd(9,o)}}catch(B){jt(o,o.return,B)}if(o===a){Ne=null;break e}var F=o.sibling;if(F!==null){F.return=o.return,Ne=F;break e}Ne=o.return}}if(st=s,la(),_s&&typeof _s.onPostCommitFiberRoot=="function")try{_s.onPostCommitFiberRoot(cd,t)}catch{}n=!0}return n}finally{mt=r,bn.transition=e}}return!1}function Q1(t,e,r){e=rl(r,e),e=DT(t,e,1),t=Hi(t,e,1),e=qr(),t!==null&&(vu(t,1,e),fn(t,e))}function jt(t,e,r){if(t.tag===3)Q1(t,t,r);else for(;e!==null;){if(e.tag===3){Q1(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Wi===null||!Wi.has(n))){t=rl(r,t),t=FT(e,t,1),e=Hi(e,t,1),t=qr(),e!==null&&(vu(e,1,t),fn(e,t));break}}e=e.return}}function aR(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=qr(),t.pingedLanes|=t.suspendedLanes&r,hr===t&&(yr&r)===r&&(rr===4||rr===3&&(yr&130023424)===yr&&500>$t()-Ag?Na(t,0):Sg|=r),fn(t,e)}function ZT(t,e){e===0&&(t.mode&1?(e=of,of<<=1,!(of&130023424)&&(of=4194304)):e=1);var r=qr();t=ai(t,e),t!==null&&(vu(t,e,r),fn(t,r))}function oR(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),ZT(t,r)}function lR(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(_e(314))}n!==null&&n.delete(e),ZT(t,r)}var e2;e2=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||cn.current)ln=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return ln=!1,X4(t,e,r);ln=!!(t.flags&131072)}else ln=!1,Pt&&e.flags&1048576&&sT(e,mh,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;$f(t,e),t=e.pendingProps;var s=Jo(e,Ur.current);Bo(e,r),s=_g(null,e,n,t,s,r);var i=yg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,un(n)?(i=!0,dh(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,pg(e),s.updater=gd,e.stateNode=s,s._reactInternals=e,Lp(e,n,t,r),e=Up(null,e,n,!0,i,r)):(e.tag=0,Pt&&i&&og(e),Hr(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch($f(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=uR(n),t=Gn(n,t),s){case 0:e=Vp(null,e,n,t,r);break e;case 1:e=B1(null,e,n,t,r);break e;case 11:e=V1(null,e,n,t,r);break e;case 14:e=U1(null,e,n,Gn(n.type,t),r);break e}throw Error(_e(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Gn(n,s),Vp(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Gn(n,s),B1(t,e,n,s,r);case 3:e:{if(LT(e),t===null)throw Error(_e(387));n=e.pendingProps,i=e.memoizedState,s=i.element,uT(t,e),xh(e,n,null,r);var a=e.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=rl(Error(_e(423)),e),e=z1(t,e,n,r,s);break e}else if(n!==s){s=rl(Error(_e(424)),e),e=z1(t,e,n,r,s);break e}else for(xn=$i(e.stateNode.containerInfo.firstChild),yn=e,Pt=!0,Xn=null,r=lT(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Zo(),n===s){e=oi(t,e,r);break e}Hr(t,e,n,r)}e=e.child}return e;case 5:return fT(e),t===null&&bp(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Rp(n,s)?a=null:i!==null&&Rp(n,i)&&(e.flags|=32),MT(t,e),Hr(t,e,a,r),e.child;case 6:return t===null&&bp(e),null;case 13:return jT(t,e,r);case 4:return mg(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=el(e,null,n,r):Hr(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Gn(n,s),V1(t,e,n,s,r);case 7:return Hr(t,e,e.pendingProps,r),e.child;case 8:return Hr(t,e,e.pendingProps.children,r),e.child;case 12:return Hr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,wt(gh,n._currentValue),n._currentValue=a,i!==null)if(is(i.value,a)){if(i.children===s.children&&!cn.current){e=oi(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=Js(-1,r&-r),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),Op(i.return,r,e),o.lanes|=r;break}l=l.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(_e(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Op(a,r,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Hr(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,Bo(e,r),s=Ln(s),n=n(s),e.flags|=1,Hr(t,e,n,r),e.child;case 14:return n=e.type,s=Gn(n,e.pendingProps),s=Gn(n.type,s),U1(t,e,n,s,r);case 15:return bT(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Gn(n,s),$f(t,e),e.tag=1,un(n)?(t=!0,dh(e)):t=!1,Bo(e,r),PT(e,n,s),Lp(e,n,s,r),Up(null,e,n,!0,t,r);case 19:return VT(t,e,r);case 22:return OT(t,e,r)}throw Error(_e(156,e.tag))};function t2(t,e){return CE(t,e)}function cR(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fn(t,e,r,n){return new cR(t,e,r,n)}function Ng(t){return t=t.prototype,!(!t||!t.isReactComponent)}function uR(t){if(typeof t=="function")return Ng(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Xm)return 11;if(t===Ym)return 14}return 2}function Ki(t,e){var r=t.alternate;return r===null?(r=Fn(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Gf(t,e,r,n,s,i){var a=2;if(n=t,typeof t=="function")Ng(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case So:return Pa(r.children,s,i,e);case qm:a=8,s|=8;break;case op:return t=Fn(12,r,e,s|2),t.elementType=op,t.lanes=i,t;case lp:return t=Fn(13,r,e,s),t.elementType=lp,t.lanes=i,t;case cp:return t=Fn(19,r,e,s),t.elementType=cp,t.lanes=i,t;case fE:return _d(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case cE:a=10;break e;case uE:a=9;break e;case Xm:a=11;break e;case Ym:a=14;break e;case Ai:a=16,n=null;break e}throw Error(_e(130,t==null?t:typeof t,""))}return e=Fn(a,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function Pa(t,e,r,n){return t=Fn(7,t,n,e),t.lanes=r,t}function _d(t,e,r,n){return t=Fn(22,t,n,e),t.elementType=fE,t.lanes=r,t.stateNode={isHidden:!1},t}function P0(t,e,r){return t=Fn(6,t,null,e),t.lanes=r,t}function D0(t,e,r){return e=Fn(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function fR(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=h0(0),this.expirationTimes=h0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=h0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Pg(t,e,r,n,s,i,a,o,l){return t=new fR(t,e,r,o,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Fn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},pg(i),t}function hR(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ko,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function r2(t){if(!t)return Zi;t=t._reactInternals;e:{if(Ja(t)!==t||t.tag!==1)throw Error(_e(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(un(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(_e(171))}if(t.tag===1){var r=t.type;if(un(r))return rT(t,r,e)}return e}function n2(t,e,r,n,s,i,a,o,l){return t=Pg(r,n,!0,t,s,i,a,o,l),t.context=r2(null),r=t.current,n=qr(),s=Gi(r),i=Js(n,s),i.callback=e??null,Hi(r,i,s),t.current.lanes=s,vu(t,s,n),fn(t,n),t}function yd(t,e,r,n){var s=e.current,i=qr(),a=Gi(s);return r=r2(r),e.context===null?e.context=r:e.pendingContext=r,e=Js(i,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Hi(s,e,a),t!==null&&(rs(t,s,a,i),Uf(t,s,a)),a}function Ah(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function J1(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Dg(t,e){J1(t,e),(t=t.alternate)&&J1(t,e)}function dR(){return null}var s2=typeof reportError=="function"?reportError:function(t){console.error(t)};function Fg(t){this._internalRoot=t}wd.prototype.render=Fg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(_e(409));yd(t,e,null,null)};wd.prototype.unmount=Fg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ba(function(){yd(null,t,null,null)}),e[ii]=null}};function wd(t){this._internalRoot=t}wd.prototype.unstable_scheduleHydration=function(t){if(t){var e=OE();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Ci.length&&e!==0&&e<Ci[r].priority;r++);Ci.splice(r,0,t),r===0&&LE(t)}};function bg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ed(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Z1(){}function pR(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=Ah(a);i.call(c)}}var a=n2(e,n,t,0,null,!1,!1,"",Z1);return t._reactRootContainer=a,t[ii]=a.current,Vc(t.nodeType===8?t.parentNode:t),Ba(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var c=Ah(l);o.call(c)}}var l=Pg(t,0,!1,null,null,!1,!1,"",Z1);return t._reactRootContainer=l,t[ii]=l.current,Vc(t.nodeType===8?t.parentNode:t),Ba(function(){yd(e,l,r,n)}),l}function Td(t,e,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var o=s;s=function(){var l=Ah(a);o.call(l)}}yd(e,a,t,s)}else a=pR(r,e,t,s,n);return Ah(a)}FE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Ql(e.pendingLanes);r!==0&&(Zm(e,r|1),fn(e,$t()),!(st&6)&&(nl=$t()+500,la()))}break;case 13:Ba(function(){var n=ai(t,1);if(n!==null){var s=qr();rs(n,t,1,s)}}),Dg(t,1)}};eg=function(t){if(t.tag===13){var e=ai(t,134217728);if(e!==null){var r=qr();rs(e,t,134217728,r)}Dg(t,134217728)}};bE=function(t){if(t.tag===13){var e=Gi(t),r=ai(t,e);if(r!==null){var n=qr();rs(r,t,e,n)}Dg(t,e)}};OE=function(){return mt};ME=function(t,e){var r=mt;try{return mt=t,e()}finally{mt=r}};_p=function(t,e,r){switch(e){case"input":if(hp(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=dd(n);if(!s)throw Error(_e(90));dE(n),hp(n,s)}}}break;case"textarea":mE(t,r);break;case"select":e=r.value,e!=null&&Lo(t,!!r.multiple,e,!1)}};EE=Ig;TE=Ba;var mR={usingClientEntryPoint:!1,Events:[_u,Ro,dd,yE,wE,Ig]},Hl={findFiberByHostInstance:Ta,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},gR={bundleType:Hl.bundleType,version:Hl.version,rendererPackageName:Hl.rendererPackageName,rendererConfig:Hl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:mi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=AE(t),t===null?null:t.stateNode},findFiberByHostInstance:Hl.findFiberByHostInstance||dR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xf.isDisabled&&xf.supportsFiber)try{cd=xf.inject(gR),_s=xf}catch{}}Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mR;Tn.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bg(e))throw Error(_e(200));return hR(t,e,null,r)};Tn.createRoot=function(t,e){if(!bg(t))throw Error(_e(299));var r=!1,n="",s=s2;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Pg(t,1,!1,null,null,r,!1,n,s),t[ii]=e.current,Vc(t.nodeType===8?t.parentNode:t),new Fg(e)};Tn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(_e(188)):(t=Object.keys(t).join(","),Error(_e(268,t)));return t=AE(e),t=t===null?null:t.stateNode,t};Tn.flushSync=function(t){return Ba(t)};Tn.hydrate=function(t,e,r){if(!Ed(e))throw Error(_e(200));return Td(null,t,e,!0,r)};Tn.hydrateRoot=function(t,e,r){if(!bg(t))throw Error(_e(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=s2;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=n2(e,null,t,1,r??null,s,!1,i,a),t[ii]=e.current,Vc(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new wd(e)};Tn.render=function(t,e,r){if(!Ed(e))throw Error(_e(200));return Td(null,t,e,!1,r)};Tn.unmountComponentAtNode=function(t){if(!Ed(t))throw Error(_e(40));return t._reactRootContainer?(Ba(function(){Td(null,null,t,!1,function(){t._reactRootContainer=null,t[ii]=null})}),!0):!1};Tn.unstable_batchedUpdates=Ig;Tn.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Ed(r))throw Error(_e(200));if(t==null||t._reactInternals===void 0)throw Error(_e(38));return Td(t,e,r,!1,n)};Tn.version="18.3.1-next-f1338f8080-20240426";function i2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i2)}catch(t){console.error(t)}}i2(),iE.exports=Tn;var Og=iE.exports;const vR=Kw(Og),xR=Gw({__proto__:null,default:vR},[Og]);var e_=Og;ip.createRoot=e_.createRoot,ip.hydrateRoot=e_.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rt(){return Rt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Rt.apply(this,arguments)}var Yt;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Yt||(Yt={}));const t_="popstate";function _R(t){t===void 0&&(t={});function e(n,s){let{pathname:i,search:a,hash:o}=n.location;return qc("",{pathname:i,search:a,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:za(s)}return wR(e,r,null,t)}function Ge(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function sl(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function yR(){return Math.random().toString(36).substr(2,8)}function r_(t,e){return{usr:t.state,key:t.key,idx:e}}function qc(t,e,r,n){return r===void 0&&(r=null),Rt({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ca(e):e,{state:r,key:e&&e.key||n||yR()})}function za(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function ca(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function wR(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,a=s.history,o=Yt.Pop,l=null,c=u();c==null&&(c=0,a.replaceState(Rt({},a.state,{idx:c}),""));function u(){return(a.state||{idx:null}).idx}function h(){o=Yt.Pop;let y=u(),S=y==null?null:y-c;c=y,l&&l({action:o,location:g.location,delta:S})}function d(y,S){o=Yt.Push;let k=qc(g.location,y,S);c=u()+1;let w=r_(k,c),F=g.createHref(k);try{a.pushState(w,"",F)}catch(B){if(B instanceof DOMException&&B.name==="DataCloneError")throw B;s.location.assign(F)}i&&l&&l({action:o,location:g.location,delta:1})}function m(y,S){o=Yt.Replace;let k=qc(g.location,y,S);c=u();let w=r_(k,c),F=g.createHref(k);a.replaceState(w,"",F),i&&l&&l({action:o,location:g.location,delta:0})}function v(y){let S=s.location.origin!=="null"?s.location.origin:s.location.href,k=typeof y=="string"?y:za(y);return k=k.replace(/ $/,"%20"),Ge(S,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,S)}let g={get action(){return o},get location(){return t(s,a)},listen(y){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(t_,h),l=y,()=>{s.removeEventListener(t_,h),l=null}},createHref(y){return e(s,y)},createURL:v,encodeLocation(y){let S=v(y);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:d,replace:m,go(y){return a.go(y)}};return g}var pt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(pt||(pt={}));const ER=new Set(["lazy","caseSensitive","path","id","index","children"]);function TR(t){return t.index===!0}function Ih(t,e,r,n){return r===void 0&&(r=[]),n===void 0&&(n={}),t.map((s,i)=>{let a=[...r,String(i)],o=typeof s.id=="string"?s.id:a.join("-");if(Ge(s.index!==!0||!s.children,"Cannot specify children on an index route"),Ge(!n[o],'Found a route id collision on id "'+o+`".  Route id's must be globally unique within Data Router usages`),TR(s)){let l=Rt({},s,e(s),{id:o});return n[o]=l,l}else{let l=Rt({},s,e(s),{id:o,children:void 0});return n[o]=l,s.children&&(l.children=Ih(s.children,e,a,n)),l}})}function ya(t,e,r){return r===void 0&&(r="/"),Kf(t,e,r,!1)}function Kf(t,e,r,n){let s=typeof e=="string"?ca(e):e,i=li(s.pathname||"/",r);if(i==null)return null;let a=a2(t);SR(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let c=MR(i);o=bR(a[l],c,n)}return o}function kR(t,e){let{route:r,pathname:n,params:s}=t;return{id:r.id,pathname:n,params:s,data:e[r.id],handle:r.handle}}function a2(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,a,o)=>{let l={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};l.relativePath.startsWith("/")&&(Ge(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Zs([n,l.relativePath]),u=r.concat(l);i.children&&i.children.length>0&&(Ge(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),a2(i.children,e,u,c)),!(i.path==null&&!i.index)&&e.push({path:c,score:DR(c,i.index),routesMeta:u})};return t.forEach((i,a)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))s(i,a);else for(let l of o2(i.path))s(i,a,l)}),e}function o2(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let a=o2(n.join("/")),o=[];return o.push(...a.map(l=>l===""?i:[i,l].join("/"))),s&&o.push(...a),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function SR(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:FR(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const AR=/^:[\w-]+$/,IR=3,CR=2,RR=1,NR=10,PR=-2,n_=t=>t==="*";function DR(t,e){let r=t.split("/"),n=r.length;return r.some(n_)&&(n+=PR),e&&(n+=CR),r.filter(s=>!n_(s)).reduce((s,i)=>s+(AR.test(i)?IR:i===""?RR:NR),n)}function FR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function bR(t,e,r){r===void 0&&(r=!1);let{routesMeta:n}=t,s={},i="/",a=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=i==="/"?e:e.slice(i.length)||"/",h=Ch({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),d=l.route;if(!h&&c&&r&&!n[n.length-1].route.index&&(h=Ch({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!h)return null;Object.assign(s,h.params),a.push({params:s,pathname:Zs([i,h.pathname]),pathnameBase:VR(Zs([i,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(i=Zs([i,h.pathnameBase]))}return a}function Ch(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=OR(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((c,u,h)=>{let{paramName:d,isOptional:m}=u;if(d==="*"){let g=o[h]||"";a=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const v=o[h];return m&&!v?c[d]=void 0:c[d]=(v||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:a,pattern:t}}function OR(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),sl(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function MR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return sl(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function li(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function LR(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?ca(t):t;return{pathname:r?r.startsWith("/")?r:jR(r,e):e,search:UR(n),hash:BR(s)}}function jR(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function F0(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function l2(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function kd(t,e){let r=l2(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Sd(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=ca(t):(s=Rt({},t),Ge(!s.pathname||!s.pathname.includes("?"),F0("?","pathname","search",s)),Ge(!s.pathname||!s.pathname.includes("#"),F0("#","pathname","hash",s)),Ge(!s.search||!s.search.includes("#"),F0("#","search","hash",s)));let i=t===""||s.pathname==="",a=i?"/":s.pathname,o;if(a==null)o=r;else{let h=e.length-1;if(!n&&a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),h-=1;s.pathname=d.join("/")}o=h>=0?e[h]:"/"}let l=LR(s,o),c=a&&a!=="/"&&a.endsWith("/"),u=(i||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Zs=t=>t.join("/").replace(/\/\/+/g,"/"),VR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),UR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,BR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Rh{constructor(e,r,n,s){s===void 0&&(s=!1),this.status=e,this.statusText=r||"",this.internal=s,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}}function Xc(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const c2=["post","put","patch","delete"],zR=new Set(c2),$R=["get",...c2],HR=new Set($R),WR=new Set([301,302,303,307,308]),GR=new Set([307,308]),b0={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},KR={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Wl={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Mg=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,qR=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),u2="remix-router-transitions";function XR(t){const e=t.window?t.window:typeof window<"u"?window:void 0,r=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",n=!r;Ge(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let H=t.detectErrorBoundary;s=J=>({hasErrorBoundary:H(J)})}else s=qR;let i={},a=Ih(t.routes,s,void 0,i),o,l=t.basename||"/",c=t.dataStrategy||ZR,u=t.patchRoutesOnNavigation,h=Rt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),d=null,m=new Set,v=null,g=null,y=null,S=t.hydrationData!=null,k=ya(a,t.history.location,l),w=!1,F=null;if(k==null&&!u){let H=nn(404,{pathname:t.history.location.pathname}),{matches:J,route:ne}=p_(a);k=J,F={[ne.id]:H}}k&&!t.hydrationData&&Us(k,a,t.history.location.pathname).active&&(k=null);let B;if(k)if(k.some(H=>H.route.lazy))B=!1;else if(!k.some(H=>H.route.loader))B=!0;else if(h.v7_partialHydration){let H=t.hydrationData?t.hydrationData.loaderData:null,J=t.hydrationData?t.hydrationData.errors:null;if(J){let ne=k.findIndex(de=>J[de.route.id]!==void 0);B=k.slice(0,ne+1).every(de=>!Zp(de.route,H,J))}else B=k.every(ne=>!Zp(ne.route,H,J))}else B=t.hydrationData!=null;else if(B=!1,k=[],h.v7_partialHydration){let H=Us(null,a,t.history.location.pathname);H.active&&H.matches&&(w=!0,k=H.matches)}let V,x={historyAction:t.history.action,location:t.history.location,matches:k,initialized:B,navigation:b0,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||F,fetchers:new Map,blockers:new Map},E=Yt.Pop,T=!1,I,P=!1,N=new Map,R=null,se=!1,ae=!1,fe=[],ge=new Set,oe=new Map,K=0,he=-1,we=new Map,U=new Set,q=new Map,Y=new Map,G=new Set,le=new Map,xe=new Map,Re;function Te(){if(d=t.history.listen(H=>{let{action:J,location:ne,delta:de}=H;if(Re){Re(),Re=void 0;return}sl(xe.size===0||de!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Se=_i({currentLocation:x.location,nextLocation:ne,historyAction:J});if(Se&&de!=null){let C=new Promise(L=>{Re=L});t.history.go(de*-1),cs(Se,{state:"blocked",location:ne,proceed(){cs(Se,{state:"proceeding",proceed:void 0,reset:void 0,location:ne}),C.then(()=>t.history.go(de))},reset(){let L=new Map(x.blockers);L.set(Se,Wl),z({blockers:L})}});return}return be(J,ne)}),r){dN(e,N);let H=()=>pN(e,N);e.addEventListener("pagehide",H),R=()=>e.removeEventListener("pagehide",H)}return x.initialized||be(Yt.Pop,x.location,{initialHydration:!0}),V}function ve(){d&&d(),R&&R(),m.clear(),I&&I.abort(),x.fetchers.forEach((H,J)=>xt(J)),x.blockers.forEach((H,J)=>Ls(J))}function $e(H){return m.add(H),()=>m.delete(H)}function z(H,J){J===void 0&&(J={}),x=Rt({},x,H);let ne=[],de=[];h.v7_fetcherPersist&&x.fetchers.forEach((Se,C)=>{Se.state==="idle"&&(G.has(C)?de.push(C):ne.push(C))}),G.forEach(Se=>{!x.fetchers.has(Se)&&!oe.has(Se)&&de.push(Se)}),[...m].forEach(Se=>Se(x,{deletedFetchers:de,viewTransitionOpts:J.viewTransitionOpts,flushSync:J.flushSync===!0})),h.v7_fetcherPersist?(ne.forEach(Se=>x.fetchers.delete(Se)),de.forEach(Se=>xt(Se))):de.forEach(Se=>G.delete(Se))}function at(H,J,ne){var de,Se;let{flushSync:C}=ne===void 0?{}:ne,L=x.actionData!=null&&x.navigation.formMethod!=null&&qn(x.navigation.formMethod)&&x.navigation.state==="loading"&&((de=H.state)==null?void 0:de._isRedirect)!==!0,D;J.actionData?Object.keys(J.actionData).length>0?D=J.actionData:D=null:L?D=x.actionData:D=null;let b=J.loaderData?h_(x.loaderData,J.loaderData,J.matches||[],J.errors):x.loaderData,O=x.blockers;O.size>0&&(O=new Map(O),O.forEach((te,ee)=>O.set(ee,Wl)));let M=T===!0||x.navigation.formMethod!=null&&qn(x.navigation.formMethod)&&((Se=H.state)==null?void 0:Se._isRedirect)!==!0;o&&(a=o,o=void 0),se||E===Yt.Pop||(E===Yt.Push?t.history.push(H,H.state):E===Yt.Replace&&t.history.replace(H,H.state));let X;if(E===Yt.Pop){let te=N.get(x.location.pathname);te&&te.has(H.pathname)?X={currentLocation:x.location,nextLocation:H}:N.has(H.pathname)&&(X={currentLocation:H,nextLocation:x.location})}else if(P){let te=N.get(x.location.pathname);te?te.add(H.pathname):(te=new Set([H.pathname]),N.set(x.location.pathname,te)),X={currentLocation:x.location,nextLocation:H}}z(Rt({},J,{actionData:D,loaderData:b,historyAction:E,location:H,initialized:!0,navigation:b0,revalidation:"idle",restoreScrollPosition:Vs(H,J.matches||x.matches),preventScrollReset:M,blockers:O}),{viewTransitionOpts:X,flushSync:C===!0}),E=Yt.Pop,T=!1,P=!1,se=!1,ae=!1,fe=[]}async function We(H,J){if(typeof H=="number"){t.history.go(H);return}let ne=Jp(x.location,x.matches,l,h.v7_prependBasename,H,h.v7_relativeSplatPath,J==null?void 0:J.fromRouteId,J==null?void 0:J.relative),{path:de,submission:Se,error:C}=s_(h.v7_normalizeFormMethod,!1,ne,J),L=x.location,D=qc(x.location,de,J&&J.state);D=Rt({},D,t.history.encodeLocation(D));let b=J&&J.replace!=null?J.replace:void 0,O=Yt.Push;b===!0?O=Yt.Replace:b===!1||Se!=null&&qn(Se.formMethod)&&Se.formAction===x.location.pathname+x.location.search&&(O=Yt.Replace);let M=J&&"preventScrollReset"in J?J.preventScrollReset===!0:void 0,X=(J&&J.flushSync)===!0,te=_i({currentLocation:L,nextLocation:D,historyAction:O});if(te){cs(te,{state:"blocked",location:D,proceed(){cs(te,{state:"proceeding",proceed:void 0,reset:void 0,location:D}),We(H,J)},reset(){let ee=new Map(x.blockers);ee.set(te,Wl),z({blockers:ee})}});return}return await be(O,D,{submission:Se,pendingError:C,preventScrollReset:M,replace:J&&J.replace,enableViewTransition:J&&J.viewTransition,flushSync:X})}function rt(){if(St(),z({revalidation:"loading"}),x.navigation.state!=="submitting"){if(x.navigation.state==="idle"){be(x.historyAction,x.location,{startUninterruptedRevalidation:!0});return}be(E||x.historyAction,x.navigation.location,{overrideNavigation:x.navigation,enableViewTransition:P===!0})}}async function be(H,J,ne){I&&I.abort(),I=null,E=H,se=(ne&&ne.startUninterruptedRevalidation)===!0,fo(x.location,x.matches),T=(ne&&ne.preventScrollReset)===!0,P=(ne&&ne.enableViewTransition)===!0;let de=o||a,Se=ne&&ne.overrideNavigation,C=ne!=null&&ne.initialHydration&&x.matches&&x.matches.length>0&&!w?x.matches:ya(de,J,l),L=(ne&&ne.flushSync)===!0;if(C&&x.initialized&&!ae&&iN(x.location,J)&&!(ne&&ne.submission&&qn(ne.submission.formMethod))){at(J,{matches:C},{flushSync:L});return}let D=Us(C,de,J.pathname);if(D.active&&D.matches&&(C=D.matches),!C){let{error:Z,notFoundMatches:Q,route:ce}=Bn(J.pathname);at(J,{matches:Q,loaderData:{},errors:{[ce.id]:Z}},{flushSync:L});return}I=new AbortController;let b=xo(t.history,J,I.signal,ne&&ne.submission),O;if(ne&&ne.pendingError)O=[wa(C).route.id,{type:pt.error,error:ne.pendingError}];else if(ne&&ne.submission&&qn(ne.submission.formMethod)){let Z=await Ae(b,J,ne.submission,C,D.active,{replace:ne.replace,flushSync:L});if(Z.shortCircuited)return;if(Z.pendingActionResult){let[Q,ce]=Z.pendingActionResult;if(mn(ce)&&Xc(ce.error)&&ce.error.status===404){I=null,at(J,{matches:Z.matches,loaderData:{},errors:{[Q]:ce.error}});return}}C=Z.matches||C,O=Z.pendingActionResult,Se=O0(J,ne.submission),L=!1,D.active=!1,b=xo(t.history,b.url,b.signal)}let{shortCircuited:M,matches:X,loaderData:te,errors:ee}=await Tt(b,J,C,D.active,Se,ne&&ne.submission,ne&&ne.fetcherSubmission,ne&&ne.replace,ne&&ne.initialHydration===!0,L,O);M||(I=null,at(J,Rt({matches:X||C},d_(O),{loaderData:te,errors:ee})))}async function Ae(H,J,ne,de,Se,C){C===void 0&&(C={}),St();let L=fN(J,ne);if(z({navigation:L},{flushSync:C.flushSync===!0}),Se){let O=await An(de,J.pathname,H.signal);if(O.type==="aborted")return{shortCircuited:!0};if(O.type==="error"){let M=wa(O.partialMatches).route.id;return{matches:O.partialMatches,pendingActionResult:[M,{type:pt.error,error:O.error}]}}else if(O.matches)de=O.matches;else{let{notFoundMatches:M,error:X,route:te}=Bn(J.pathname);return{matches:M,pendingActionResult:[te.id,{type:pt.error,error:X}]}}}let D,b=Zl(de,J);if(!b.route.action&&!b.route.lazy)D={type:pt.error,error:nn(405,{method:H.method,pathname:J.pathname,routeId:b.route.id})};else if(D=(await lr("action",x,H,[b],de,null))[b.route.id],H.signal.aborted)return{shortCircuited:!0};if(Aa(D)){let O;return C&&C.replace!=null?O=C.replace:O=c_(D.response.headers.get("Location"),new URL(H.url),l)===x.location.pathname+x.location.search,await kt(H,D,!0,{submission:ne,replace:O}),{shortCircuited:!0}}if(Mi(D))throw nn(400,{type:"defer-action"});if(mn(D)){let O=wa(de,b.route.id);return(C&&C.replace)!==!0&&(E=Yt.Push),{matches:de,pendingActionResult:[O.route.id,D]}}return{matches:de,pendingActionResult:[b.route.id,D]}}async function Tt(H,J,ne,de,Se,C,L,D,b,O,M){let X=Se||O0(J,C),te=C||L||g_(X),ee=!se&&(!h.v7_partialHydration||!b);if(de){if(ee){let ft=or(M);z(Rt({navigation:X},ft!==void 0?{actionData:ft}:{}),{flushSync:O})}let He=await An(ne,J.pathname,H.signal);if(He.type==="aborted")return{shortCircuited:!0};if(He.type==="error"){let ft=wa(He.partialMatches).route.id;return{matches:He.partialMatches,loaderData:{},errors:{[ft]:He.error}}}else if(He.matches)ne=He.matches;else{let{error:ft,notFoundMatches:pr,route:In}=Bn(J.pathname);return{matches:pr,loaderData:{},errors:{[In.id]:ft}}}}let Z=o||a,[Q,ce]=a_(t.history,x,ne,te,J,h.v7_partialHydration&&b===!0,h.v7_skipActionErrorRevalidation,ae,fe,ge,G,q,U,Z,l,M);if(js(He=>!(ne&&ne.some(ft=>ft.route.id===He))||Q&&Q.some(ft=>ft.route.id===He)),he=++K,Q.length===0&&ce.length===0){let He=Ms();return at(J,Rt({matches:ne,loaderData:{},errors:M&&mn(M[1])?{[M[0]]:M[1].error}:null},d_(M),He?{fetchers:new Map(x.fetchers)}:{}),{flushSync:O}),{shortCircuited:!0}}if(ee){let He={};if(!de){He.navigation=X;let ft=or(M);ft!==void 0&&(He.actionData=ft)}ce.length>0&&(He.fetchers=Ar(ce)),z(He,{flushSync:O})}ce.forEach(He=>{ut(He.key),He.controller&&oe.set(He.key,He.controller)});let ye=()=>ce.forEach(He=>ut(He.key));I&&I.signal.addEventListener("abort",ye);let{loaderResults:Ie,fetcherResults:pe}=await vt(x,ne,Q,ce,H);if(H.signal.aborted)return{shortCircuited:!0};I&&I.signal.removeEventListener("abort",ye),ce.forEach(He=>oe.delete(He.key));let Ee=_f(Ie);if(Ee)return await kt(H,Ee.result,!0,{replace:D}),{shortCircuited:!0};if(Ee=_f(pe),Ee)return U.add(Ee.key),await kt(H,Ee.result,!0,{replace:D}),{shortCircuited:!0};let{loaderData:Fe,errors:nt}=f_(x,ne,Ie,M,ce,pe,le);le.forEach((He,ft)=>{He.subscribe(pr=>{(pr||He.done)&&le.delete(ft)})}),h.v7_partialHydration&&b&&x.errors&&(nt=Rt({},x.errors,nt));let Ke=Ms(),dt=uo(he),rn=Ke||dt||ce.length>0;return Rt({matches:ne,loaderData:Fe,errors:nt},rn?{fetchers:new Map(x.fetchers)}:{})}function or(H){if(H&&!mn(H[1]))return{[H[0]]:H[1].data};if(x.actionData)return Object.keys(x.actionData).length===0?null:x.actionData}function Ar(H){return H.forEach(J=>{let ne=x.fetchers.get(J.key),de=Gl(void 0,ne?ne.data:void 0);x.fetchers.set(J.key,de)}),new Map(x.fetchers)}function en(H,J,ne,de){if(n)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");ut(H);let Se=(de&&de.flushSync)===!0,C=o||a,L=Jp(x.location,x.matches,l,h.v7_prependBasename,ne,h.v7_relativeSplatPath,J,de==null?void 0:de.relative),D=ya(C,L,l),b=Us(D,C,L);if(b.active&&b.matches&&(D=b.matches),!D){Dt(H,J,nn(404,{pathname:L}),{flushSync:Se});return}let{path:O,submission:M,error:X}=s_(h.v7_normalizeFormMethod,!0,L,de);if(X){Dt(H,J,X,{flushSync:Se});return}let te=Zl(D,O),ee=(de&&de.preventScrollReset)===!0;if(M&&qn(M.formMethod)){Os(H,J,O,te,D,b.active,Se,ee,M);return}q.set(H,{routeId:J,path:O}),tn(H,J,O,te,D,b.active,Se,ee,M)}async function Os(H,J,ne,de,Se,C,L,D,b){St(),q.delete(H);function O(Je){if(!Je.route.action&&!Je.route.lazy){let fs=nn(405,{method:b.formMethod,pathname:ne,routeId:J});return Dt(H,J,fs,{flushSync:L}),!0}return!1}if(!C&&O(de))return;let M=x.fetchers.get(H);ht(H,hN(b,M),{flushSync:L});let X=new AbortController,te=xo(t.history,ne,X.signal,b);if(C){let Je=await An(Se,new URL(te.url).pathname,te.signal,H);if(Je.type==="aborted")return;if(Je.type==="error"){Dt(H,J,Je.error,{flushSync:L});return}else if(Je.matches){if(Se=Je.matches,de=Zl(Se,ne),O(de))return}else{Dt(H,J,nn(404,{pathname:ne}),{flushSync:L});return}}oe.set(H,X);let ee=K,Q=(await lr("action",x,te,[de],Se,H))[de.route.id];if(te.signal.aborted){oe.get(H)===X&&oe.delete(H);return}if(h.v7_fetcherPersist&&G.has(H)){if(Aa(Q)||mn(Q)){ht(H,Si(void 0));return}}else{if(Aa(Q))if(oe.delete(H),he>ee){ht(H,Si(void 0));return}else return U.add(H),ht(H,Gl(b)),kt(te,Q,!1,{fetcherSubmission:b,preventScrollReset:D});if(mn(Q)){Dt(H,J,Q.error);return}}if(Mi(Q))throw nn(400,{type:"defer-action"});let ce=x.navigation.location||x.location,ye=xo(t.history,ce,X.signal),Ie=o||a,pe=x.navigation.state!=="idle"?ya(Ie,x.navigation.location,l):x.matches;Ge(pe,"Didn't find any matches after fetcher action");let Ee=++K;we.set(H,Ee);let Fe=Gl(b,Q.data);x.fetchers.set(H,Fe);let[nt,Ke]=a_(t.history,x,pe,b,ce,!1,h.v7_skipActionErrorRevalidation,ae,fe,ge,G,q,U,Ie,l,[de.route.id,Q]);Ke.filter(Je=>Je.key!==H).forEach(Je=>{let fs=Je.key,Rl=x.fetchers.get(fs),$u=Gl(void 0,Rl?Rl.data:void 0);x.fetchers.set(fs,$u),ut(fs),Je.controller&&oe.set(fs,Je.controller)}),z({fetchers:new Map(x.fetchers)});let dt=()=>Ke.forEach(Je=>ut(Je.key));X.signal.addEventListener("abort",dt);let{loaderResults:rn,fetcherResults:He}=await vt(x,pe,nt,Ke,ye);if(X.signal.aborted)return;X.signal.removeEventListener("abort",dt),we.delete(H),oe.delete(H),Ke.forEach(Je=>oe.delete(Je.key));let ft=_f(rn);if(ft)return kt(ye,ft.result,!1,{preventScrollReset:D});if(ft=_f(He),ft)return U.add(ft.key),kt(ye,ft.result,!1,{preventScrollReset:D});let{loaderData:pr,errors:In}=f_(x,pe,rn,void 0,Ke,He,le);if(x.fetchers.has(H)){let Je=Si(Q.data);x.fetchers.set(H,Je)}uo(Ee),x.navigation.state==="loading"&&Ee>he?(Ge(E,"Expected pending action"),I&&I.abort(),at(x.navigation.location,{matches:pe,loaderData:pr,errors:In,fetchers:new Map(x.fetchers)})):(z({errors:In,loaderData:h_(x.loaderData,pr,pe,In),fetchers:new Map(x.fetchers)}),ae=!1)}async function tn(H,J,ne,de,Se,C,L,D,b){let O=x.fetchers.get(H);ht(H,Gl(b,O?O.data:void 0),{flushSync:L});let M=new AbortController,X=xo(t.history,ne,M.signal);if(C){let Q=await An(Se,new URL(X.url).pathname,X.signal,H);if(Q.type==="aborted")return;if(Q.type==="error"){Dt(H,J,Q.error,{flushSync:L});return}else if(Q.matches)Se=Q.matches,de=Zl(Se,ne);else{Dt(H,J,nn(404,{pathname:ne}),{flushSync:L});return}}oe.set(H,M);let te=K,Z=(await lr("loader",x,X,[de],Se,H))[de.route.id];if(Mi(Z)&&(Z=await Lg(Z,X.signal,!0)||Z),oe.get(H)===M&&oe.delete(H),!X.signal.aborted){if(G.has(H)){ht(H,Si(void 0));return}if(Aa(Z))if(he>te){ht(H,Si(void 0));return}else{U.add(H),await kt(X,Z,!1,{preventScrollReset:D});return}if(mn(Z)){Dt(H,J,Z.error);return}Ge(!Mi(Z),"Unhandled fetcher deferred data"),ht(H,Si(Z.data))}}async function kt(H,J,ne,de){let{submission:Se,fetcherSubmission:C,preventScrollReset:L,replace:D}=de===void 0?{}:de;J.response.headers.has("X-Remix-Revalidate")&&(ae=!0);let b=J.response.headers.get("Location");Ge(b,"Expected a Location header on the redirect Response"),b=c_(b,new URL(H.url),l);let O=qc(x.location,b,{_isRedirect:!0});if(r){let Q=!1;if(J.response.headers.has("X-Remix-Reload-Document"))Q=!0;else if(Mg.test(b)){const ce=t.history.createURL(b);Q=ce.origin!==e.location.origin||li(ce.pathname,l)==null}if(Q){D?e.location.replace(b):e.location.assign(b);return}}I=null;let M=D===!0||J.response.headers.has("X-Remix-Replace")?Yt.Replace:Yt.Push,{formMethod:X,formAction:te,formEncType:ee}=x.navigation;!Se&&!C&&X&&te&&ee&&(Se=g_(x.navigation));let Z=Se||C;if(GR.has(J.response.status)&&Z&&qn(Z.formMethod))await be(M,O,{submission:Rt({},Z,{formAction:b}),preventScrollReset:L||T,enableViewTransition:ne?P:void 0});else{let Q=O0(O,Se);await be(M,O,{overrideNavigation:Q,fetcherSubmission:C,preventScrollReset:L||T,enableViewTransition:ne?P:void 0})}}async function lr(H,J,ne,de,Se,C){let L,D={};try{L=await eN(c,H,J,ne,de,Se,C,i,s)}catch(b){return de.forEach(O=>{D[O.route.id]={type:pt.error,error:b}}),D}for(let[b,O]of Object.entries(L))if(aN(O)){let M=O.result;D[b]={type:pt.redirect,response:nN(M,ne,b,Se,l,h.v7_relativeSplatPath)}}else D[b]=await rN(O);return D}async function vt(H,J,ne,de,Se){let C=H.matches,L=lr("loader",H,Se,ne,J,null),D=Promise.all(de.map(async M=>{if(M.matches&&M.match&&M.controller){let te=(await lr("loader",H,xo(t.history,M.path,M.controller.signal),[M.match],M.matches,M.key))[M.match.route.id];return{[M.key]:te}}else return Promise.resolve({[M.key]:{type:pt.error,error:nn(404,{pathname:M.path})}})})),b=await L,O=(await D).reduce((M,X)=>Object.assign(M,X),{});return await Promise.all([cN(J,b,Se.signal,C,H.loaderData),uN(J,O,de)]),{loaderResults:b,fetcherResults:O}}function St(){ae=!0,fe.push(...js()),q.forEach((H,J)=>{oe.has(J)&&ge.add(J),ut(J)})}function ht(H,J,ne){ne===void 0&&(ne={}),x.fetchers.set(H,J),z({fetchers:new Map(x.fetchers)},{flushSync:(ne&&ne.flushSync)===!0})}function Dt(H,J,ne,de){de===void 0&&(de={});let Se=wa(x.matches,J);xt(H),z({errors:{[Se.route.id]:ne},fetchers:new Map(x.fetchers)},{flushSync:(de&&de.flushSync)===!0})}function je(H){return Y.set(H,(Y.get(H)||0)+1),G.has(H)&&G.delete(H),x.fetchers.get(H)||KR}function xt(H){let J=x.fetchers.get(H);oe.has(H)&&!(J&&J.state==="loading"&&we.has(H))&&ut(H),q.delete(H),we.delete(H),U.delete(H),h.v7_fetcherPersist&&G.delete(H),ge.delete(H),x.fetchers.delete(H)}function Wt(H){let J=(Y.get(H)||0)-1;J<=0?(Y.delete(H),G.add(H),h.v7_fetcherPersist||xt(H)):Y.set(H,J),z({fetchers:new Map(x.fetchers)})}function ut(H){let J=oe.get(H);J&&(J.abort(),oe.delete(H))}function hn(H){for(let J of H){let ne=je(J),de=Si(ne.data);x.fetchers.set(J,de)}}function Ms(){let H=[],J=!1;for(let ne of U){let de=x.fetchers.get(ne);Ge(de,"Expected fetcher: "+ne),de.state==="loading"&&(U.delete(ne),H.push(ne),J=!0)}return hn(H),J}function uo(H){let J=[];for(let[ne,de]of we)if(de<H){let Se=x.fetchers.get(ne);Ge(Se,"Expected fetcher: "+ne),Se.state==="loading"&&(ut(ne),we.delete(ne),J.push(ne))}return hn(J),J.length>0}function Cl(H,J){let ne=x.blockers.get(H)||Wl;return xe.get(H)!==J&&xe.set(H,J),ne}function Ls(H){x.blockers.delete(H),xe.delete(H)}function cs(H,J){let ne=x.blockers.get(H)||Wl;Ge(ne.state==="unblocked"&&J.state==="blocked"||ne.state==="blocked"&&J.state==="blocked"||ne.state==="blocked"&&J.state==="proceeding"||ne.state==="blocked"&&J.state==="unblocked"||ne.state==="proceeding"&&J.state==="unblocked","Invalid blocker state transition: "+ne.state+" -> "+J.state);let de=new Map(x.blockers);de.set(H,J),z({blockers:de})}function _i(H){let{currentLocation:J,nextLocation:ne,historyAction:de}=H;if(xe.size===0)return;xe.size>1&&sl(!1,"A router only supports one blocker at a time");let Se=Array.from(xe.entries()),[C,L]=Se[Se.length-1],D=x.blockers.get(C);if(!(D&&D.state==="proceeding")&&L({currentLocation:J,nextLocation:ne,historyAction:de}))return C}function Bn(H){let J=nn(404,{pathname:H}),ne=o||a,{matches:de,route:Se}=p_(ne);return js(),{notFoundMatches:de,route:Se,error:J}}function js(H){let J=[];return le.forEach((ne,de)=>{(!H||H(de))&&(ne.cancel(),J.push(de),le.delete(de))}),J}function us(H,J,ne){if(v=H,y=J,g=ne||null,!S&&x.navigation===b0){S=!0;let de=Vs(x.location,x.matches);de!=null&&z({restoreScrollPosition:de})}return()=>{v=null,y=null,g=null}}function Sn(H,J){return g&&g(H,J.map(de=>kR(de,x.loaderData)))||H.key}function fo(H,J){if(v&&y){let ne=Sn(H,J);v[ne]=y()}}function Vs(H,J){if(v){let ne=Sn(H,J),de=v[ne];if(typeof de=="number")return de}return null}function Us(H,J,ne){if(u)if(H){if(Object.keys(H[0].params).length>0)return{active:!0,matches:Kf(J,ne,l,!0)}}else return{active:!0,matches:Kf(J,ne,l,!0)||[]};return{active:!1,matches:null}}async function An(H,J,ne,de){if(!u)return{type:"success",matches:H};let Se=H;for(;;){let C=o==null,L=o||a,D=i;try{await u({signal:ne,path:J,matches:Se,fetcherKey:de,patch:(M,X)=>{ne.aborted||l_(M,X,L,D,s)}})}catch(M){return{type:"error",error:M,partialMatches:Se}}finally{C&&!ne.aborted&&(a=[...a])}if(ne.aborted)return{type:"aborted"};let b=ya(L,J,l);if(b)return{type:"success",matches:b};let O=Kf(L,J,l,!0);if(!O||Se.length===O.length&&Se.every((M,X)=>M.route.id===O[X].route.id))return{type:"success",matches:null};Se=O}}function ho(H){i={},o=Ih(H,s,void 0,i)}function Zt(H,J){let ne=o==null;l_(H,J,o||a,i,s),ne&&(a=[...a],z({}))}return V={get basename(){return l},get future(){return h},get state(){return x},get routes(){return a},get window(){return e},initialize:Te,subscribe:$e,enableScrollRestoration:us,navigate:We,fetch:en,revalidate:rt,createHref:H=>t.history.createHref(H),encodeLocation:H=>t.history.encodeLocation(H),getFetcher:je,deleteFetcher:Wt,dispose:ve,getBlocker:Cl,deleteBlocker:Ls,patchRoutes:Zt,_internalFetchControllers:oe,_internalActiveDeferreds:le,_internalSetRoutes:ho},V}function YR(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Jp(t,e,r,n,s,i,a,o){let l,c;if(a){l=[];for(let h of e)if(l.push(h),h.route.id===a){c=h;break}}else l=e,c=e[e.length-1];let u=Sd(s||".",kd(l,i),li(t.pathname,r)||t.pathname,o==="path");if(s==null&&(u.search=t.search,u.hash=t.hash),(s==null||s===""||s===".")&&c){let h=jg(u.search);if(c.route.index&&!h)u.search=u.search?u.search.replace(/^\?/,"?index&"):"?index";else if(!c.route.index&&h){let d=new URLSearchParams(u.search),m=d.getAll("index");d.delete("index"),m.filter(g=>g).forEach(g=>d.append("index",g));let v=d.toString();u.search=v?"?"+v:""}}return n&&r!=="/"&&(u.pathname=u.pathname==="/"?r:Zs([r,u.pathname])),za(u)}function s_(t,e,r,n){if(!n||!YR(n))return{path:r};if(n.formMethod&&!lN(n.formMethod))return{path:r,error:nn(405,{method:n.formMethod})};let s=()=>({path:r,error:nn(400,{type:"invalid-body"})}),i=n.formMethod||"get",a=t?i.toUpperCase():i.toLowerCase(),o=d2(r);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!qn(a))return s();let d=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((m,v)=>{let[g,y]=v;return""+m+g+"="+y+`
`},""):String(n.body);return{path:r,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:void 0,text:d}}}else if(n.formEncType==="application/json"){if(!qn(a))return s();try{let d=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:r,submission:{formMethod:a,formAction:o,formEncType:n.formEncType,formData:void 0,json:d,text:void 0}}}catch{return s()}}}Ge(typeof FormData=="function","FormData is not available in this environment");let l,c;if(n.formData)l=em(n.formData),c=n.formData;else if(n.body instanceof FormData)l=em(n.body),c=n.body;else if(n.body instanceof URLSearchParams)l=n.body,c=u_(l);else if(n.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(n.body),c=u_(l)}catch{return s()}let u={formMethod:a,formAction:o,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(qn(u.formMethod))return{path:r,submission:u};let h=ca(r);return e&&h.search&&jg(h.search)&&l.append("index",""),h.search="?"+l,{path:za(h),submission:u}}function i_(t,e,r){r===void 0&&(r=!1);let n=t.findIndex(s=>s.route.id===e);return n>=0?t.slice(0,r?n+1:n):t}function a_(t,e,r,n,s,i,a,o,l,c,u,h,d,m,v,g){let y=g?mn(g[1])?g[1].error:g[1].data:void 0,S=t.createURL(e.location),k=t.createURL(s),w=r;i&&e.errors?w=i_(r,Object.keys(e.errors)[0],!0):g&&mn(g[1])&&(w=i_(r,g[0]));let F=g?g[1].statusCode:void 0,B=a&&F&&F>=400,V=w.filter((E,T)=>{let{route:I}=E;if(I.lazy)return!0;if(I.loader==null)return!1;if(i)return Zp(I,e.loaderData,e.errors);if(QR(e.loaderData,e.matches[T],E)||l.some(R=>R===E.route.id))return!0;let P=e.matches[T],N=E;return o_(E,Rt({currentUrl:S,currentParams:P.params,nextUrl:k,nextParams:N.params},n,{actionResult:y,actionStatus:F,defaultShouldRevalidate:B?!1:o||S.pathname+S.search===k.pathname+k.search||S.search!==k.search||f2(P,N)}))}),x=[];return h.forEach((E,T)=>{if(i||!r.some(se=>se.route.id===E.routeId)||u.has(T))return;let I=ya(m,E.path,v);if(!I){x.push({key:T,routeId:E.routeId,path:E.path,matches:null,match:null,controller:null});return}let P=e.fetchers.get(T),N=Zl(I,E.path),R=!1;d.has(T)?R=!1:c.has(T)?(c.delete(T),R=!0):P&&P.state!=="idle"&&P.data===void 0?R=o:R=o_(N,Rt({currentUrl:S,currentParams:e.matches[e.matches.length-1].params,nextUrl:k,nextParams:r[r.length-1].params},n,{actionResult:y,actionStatus:F,defaultShouldRevalidate:B?!1:o})),R&&x.push({key:T,routeId:E.routeId,path:E.path,matches:I,match:N,controller:new AbortController})}),[V,x]}function Zp(t,e,r){if(t.lazy)return!0;if(!t.loader)return!1;let n=e!=null&&e[t.id]!==void 0,s=r!=null&&r[t.id]!==void 0;return!n&&s?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!n&&!s}function QR(t,e,r){let n=!e||r.route.id!==e.route.id,s=t[r.route.id]===void 0;return n||s}function f2(t,e){let r=t.route.path;return t.pathname!==e.pathname||r!=null&&r.endsWith("*")&&t.params["*"]!==e.params["*"]}function o_(t,e){if(t.route.shouldRevalidate){let r=t.route.shouldRevalidate(e);if(typeof r=="boolean")return r}return e.defaultShouldRevalidate}function l_(t,e,r,n,s){var i;let a;if(t){let c=n[t];Ge(c,"No route found to patch children into: routeId = "+t),c.children||(c.children=[]),a=c.children}else a=r;let o=e.filter(c=>!a.some(u=>h2(c,u))),l=Ih(o,s,[t||"_","patch",String(((i=a)==null?void 0:i.length)||"0")],n);a.push(...l)}function h2(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((r,n)=>{var s;return(s=e.children)==null?void 0:s.some(i=>h2(r,i))}):!1}async function JR(t,e,r){if(!t.lazy)return;let n=await t.lazy();if(!t.lazy)return;let s=r[t.id];Ge(s,"No route found in manifest");let i={};for(let a in n){let l=s[a]!==void 0&&a!=="hasErrorBoundary";sl(!l,'Route "'+s.id+'" has a static property "'+a+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+a+'" will be ignored.')),!l&&!ER.has(a)&&(i[a]=n[a])}Object.assign(s,i),Object.assign(s,Rt({},e(s),{lazy:void 0}))}async function ZR(t){let{matches:e}=t,r=e.filter(s=>s.shouldLoad);return(await Promise.all(r.map(s=>s.resolve()))).reduce((s,i,a)=>Object.assign(s,{[r[a].route.id]:i}),{})}async function eN(t,e,r,n,s,i,a,o,l,c){let u=i.map(m=>m.route.lazy?JR(m.route,l,o):void 0),h=i.map((m,v)=>{let g=u[v],y=s.some(k=>k.route.id===m.route.id);return Rt({},m,{shouldLoad:y,resolve:async k=>(k&&n.method==="GET"&&(m.route.lazy||m.route.loader)&&(y=!0),y?tN(e,n,m,g,k,c):Promise.resolve({type:pt.data,result:void 0}))})}),d=await t({matches:h,request:n,params:i[0].params,fetcherKey:a,context:c});try{await Promise.all(u)}catch{}return d}async function tN(t,e,r,n,s,i){let a,o,l=c=>{let u,h=new Promise((v,g)=>u=g);o=()=>u(),e.signal.addEventListener("abort",o);let d=v=>typeof c!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+r.route.id+"]"))):c({request:e,params:r.params,context:i},...v!==void 0?[v]:[]),m=(async()=>{try{return{type:"data",result:await(s?s(g=>d(g)):d())}}catch(v){return{type:"error",result:v}}})();return Promise.race([m,h])};try{let c=r.route[t];if(n)if(c){let u,[h]=await Promise.all([l(c).catch(d=>{u=d}),n]);if(u!==void 0)throw u;a=h}else if(await n,c=r.route[t],c)a=await l(c);else if(t==="action"){let u=new URL(e.url),h=u.pathname+u.search;throw nn(405,{method:e.method,pathname:h,routeId:r.route.id})}else return{type:pt.data,result:void 0};else if(c)a=await l(c);else{let u=new URL(e.url),h=u.pathname+u.search;throw nn(404,{pathname:h})}Ge(a.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+r.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(c){return{type:pt.error,result:c}}finally{o&&e.signal.removeEventListener("abort",o)}return a}async function rN(t){let{result:e,type:r}=t;if(p2(e)){let h;try{let d=e.headers.get("Content-Type");d&&/\bapplication\/json\b/.test(d)?e.body==null?h=null:h=await e.json():h=await e.text()}catch(d){return{type:pt.error,error:d}}return r===pt.error?{type:pt.error,error:new Rh(e.status,e.statusText,h),statusCode:e.status,headers:e.headers}:{type:pt.data,data:h,statusCode:e.status,headers:e.headers}}if(r===pt.error){if(m_(e)){var n,s;if(e.data instanceof Error){var i,a;return{type:pt.error,error:e.data,statusCode:(i=e.init)==null?void 0:i.status,headers:(a=e.init)!=null&&a.headers?new Headers(e.init.headers):void 0}}return{type:pt.error,error:new Rh(((n=e.init)==null?void 0:n.status)||500,void 0,e.data),statusCode:Xc(e)?e.status:void 0,headers:(s=e.init)!=null&&s.headers?new Headers(e.init.headers):void 0}}return{type:pt.error,error:e,statusCode:Xc(e)?e.status:void 0}}if(oN(e)){var o,l;return{type:pt.deferred,deferredData:e,statusCode:(o=e.init)==null?void 0:o.status,headers:((l=e.init)==null?void 0:l.headers)&&new Headers(e.init.headers)}}if(m_(e)){var c,u;return{type:pt.data,data:e.data,statusCode:(c=e.init)==null?void 0:c.status,headers:(u=e.init)!=null&&u.headers?new Headers(e.init.headers):void 0}}return{type:pt.data,data:e}}function nN(t,e,r,n,s,i){let a=t.headers.get("Location");if(Ge(a,"Redirects returned/thrown from loaders/actions must have a Location header"),!Mg.test(a)){let o=n.slice(0,n.findIndex(l=>l.route.id===r)+1);a=Jp(new URL(e.url),o,s,!0,a,i),t.headers.set("Location",a)}return t}function c_(t,e,r){if(Mg.test(t)){let n=t,s=n.startsWith("//")?new URL(e.protocol+n):new URL(n),i=li(s.pathname,r)!=null;if(s.origin===e.origin&&i)return s.pathname+s.search+s.hash}return t}function xo(t,e,r,n){let s=t.createURL(d2(e)).toString(),i={signal:r};if(n&&qn(n.formMethod)){let{formMethod:a,formEncType:o}=n;i.method=a.toUpperCase(),o==="application/json"?(i.headers=new Headers({"Content-Type":o}),i.body=JSON.stringify(n.json)):o==="text/plain"?i.body=n.text:o==="application/x-www-form-urlencoded"&&n.formData?i.body=em(n.formData):i.body=n.formData}return new Request(s,i)}function em(t){let e=new URLSearchParams;for(let[r,n]of t.entries())e.append(r,typeof n=="string"?n:n.name);return e}function u_(t){let e=new FormData;for(let[r,n]of t.entries())e.append(r,n);return e}function sN(t,e,r,n,s){let i={},a=null,o,l=!1,c={},u=r&&mn(r[1])?r[1].error:void 0;return t.forEach(h=>{if(!(h.route.id in e))return;let d=h.route.id,m=e[d];if(Ge(!Aa(m),"Cannot handle redirect results in processLoaderData"),mn(m)){let v=m.error;u!==void 0&&(v=u,u=void 0),a=a||{};{let g=wa(t,d);a[g.route.id]==null&&(a[g.route.id]=v)}i[d]=void 0,l||(l=!0,o=Xc(m.error)?m.error.status:500),m.headers&&(c[d]=m.headers)}else Mi(m)?(n.set(d,m.deferredData),i[d]=m.deferredData.data,m.statusCode!=null&&m.statusCode!==200&&!l&&(o=m.statusCode),m.headers&&(c[d]=m.headers)):(i[d]=m.data,m.statusCode&&m.statusCode!==200&&!l&&(o=m.statusCode),m.headers&&(c[d]=m.headers))}),u!==void 0&&r&&(a={[r[0]]:u},i[r[0]]=void 0),{loaderData:i,errors:a,statusCode:o||200,loaderHeaders:c}}function f_(t,e,r,n,s,i,a){let{loaderData:o,errors:l}=sN(e,r,n,a);return s.forEach(c=>{let{key:u,match:h,controller:d}=c,m=i[u];if(Ge(m,"Did not find corresponding fetcher result"),!(d&&d.signal.aborted))if(mn(m)){let v=wa(t.matches,h==null?void 0:h.route.id);l&&l[v.route.id]||(l=Rt({},l,{[v.route.id]:m.error})),t.fetchers.delete(u)}else if(Aa(m))Ge(!1,"Unhandled fetcher revalidation redirect");else if(Mi(m))Ge(!1,"Unhandled fetcher deferred data");else{let v=Si(m.data);t.fetchers.set(u,v)}}),{loaderData:o,errors:l}}function h_(t,e,r,n){let s=Rt({},e);for(let i of r){let a=i.route.id;if(e.hasOwnProperty(a)?e[a]!==void 0&&(s[a]=e[a]):t[a]!==void 0&&i.route.loader&&(s[a]=t[a]),n&&n.hasOwnProperty(a))break}return s}function d_(t){return t?mn(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function wa(t,e){return(e?t.slice(0,t.findIndex(n=>n.route.id===e)+1):[...t]).reverse().find(n=>n.route.hasErrorBoundary===!0)||t[0]}function p_(t){let e=t.length===1?t[0]:t.find(r=>r.index||!r.path||r.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function nn(t,e){let{pathname:r,routeId:n,method:s,type:i,message:a}=e===void 0?{}:e,o="Unknown Server Error",l="Unknown @remix-run/router error";return t===400?(o="Bad Request",s&&r&&n?l="You made a "+s+' request to "'+r+'" but '+('did not provide a `loader` for route "'+n+'", ')+"so there is no way to handle the request.":i==="defer-action"?l="defer() is not supported in actions":i==="invalid-body"&&(l="Unable to encode submission body")):t===403?(o="Forbidden",l='Route "'+n+'" does not match URL "'+r+'"'):t===404?(o="Not Found",l='No route matches URL "'+r+'"'):t===405&&(o="Method Not Allowed",s&&r&&n?l="You made a "+s.toUpperCase()+' request to "'+r+'" but '+('did not provide an `action` for route "'+n+'", ')+"so there is no way to handle the request.":s&&(l='Invalid request method "'+s.toUpperCase()+'"')),new Rh(t||500,o,new Error(l),!0)}function _f(t){let e=Object.entries(t);for(let r=e.length-1;r>=0;r--){let[n,s]=e[r];if(Aa(s))return{key:n,result:s}}}function d2(t){let e=typeof t=="string"?ca(t):t;return za(Rt({},e,{hash:""}))}function iN(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function aN(t){return p2(t.result)&&WR.has(t.result.status)}function Mi(t){return t.type===pt.deferred}function mn(t){return t.type===pt.error}function Aa(t){return(t&&t.type)===pt.redirect}function m_(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function oN(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function p2(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function lN(t){return HR.has(t.toLowerCase())}function qn(t){return zR.has(t.toLowerCase())}async function cN(t,e,r,n,s){let i=Object.entries(e);for(let a=0;a<i.length;a++){let[o,l]=i[a],c=t.find(d=>(d==null?void 0:d.route.id)===o);if(!c)continue;let u=n.find(d=>d.route.id===c.route.id),h=u!=null&&!f2(u,c)&&(s&&s[c.route.id])!==void 0;Mi(l)&&h&&await Lg(l,r,!1).then(d=>{d&&(e[o]=d)})}}async function uN(t,e,r){for(let n=0;n<r.length;n++){let{key:s,routeId:i,controller:a}=r[n],o=e[s];t.find(c=>(c==null?void 0:c.route.id)===i)&&Mi(o)&&(Ge(a,"Expected an AbortController for revalidating fetcher deferred result"),await Lg(o,a.signal,!0).then(c=>{c&&(e[s]=c)}))}}async function Lg(t,e,r){if(r===void 0&&(r=!1),!await t.deferredData.resolveData(e)){if(r)try{return{type:pt.data,data:t.deferredData.unwrappedData}}catch(s){return{type:pt.error,error:s}}return{type:pt.data,data:t.deferredData.data}}}function jg(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Zl(t,e){let r=typeof e=="string"?ca(e).search:e.search;if(t[t.length-1].route.index&&jg(r||""))return t[t.length-1];let n=l2(t);return n[n.length-1]}function g_(t){let{formMethod:e,formAction:r,formEncType:n,text:s,formData:i,json:a}=t;if(!(!e||!r||!n)){if(s!=null)return{formMethod:e,formAction:r,formEncType:n,formData:void 0,json:void 0,text:s};if(i!=null)return{formMethod:e,formAction:r,formEncType:n,formData:i,json:void 0,text:void 0};if(a!==void 0)return{formMethod:e,formAction:r,formEncType:n,formData:void 0,json:a,text:void 0}}}function O0(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function fN(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Gl(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function hN(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Si(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function dN(t,e){try{let r=t.sessionStorage.getItem(u2);if(r){let n=JSON.parse(r);for(let[s,i]of Object.entries(n||{}))i&&Array.isArray(i)&&e.set(s,new Set(i||[]))}}catch{}}function pN(t,e){if(e.size>0){let r={};for(let[n,s]of e)r[n]=[...s];try{t.sessionStorage.setItem(u2,JSON.stringify(r))}catch(n){sl(!1,"Failed to save applied view transitions in sessionStorage ("+n+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Nh(){return Nh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Nh.apply(this,arguments)}const wu=W.createContext(null),Vg=W.createContext(null),gi=W.createContext(null),Ug=W.createContext(null),Rs=W.createContext({outlet:null,matches:[],isDataRoute:!1}),m2=W.createContext(null);function mN(t,e){let{relative:r}=e===void 0?{}:e;yl()||Ge(!1);let{basename:n,navigator:s}=W.useContext(gi),{hash:i,pathname:a,search:o}=Ad(t,{relative:r}),l=a;return n!=="/"&&(l=a==="/"?n:Zs([n,a])),s.createHref({pathname:l,search:o,hash:i})}function yl(){return W.useContext(Ug)!=null}function ua(){return yl()||Ge(!1),W.useContext(Ug).location}function g2(t){W.useContext(gi).static||W.useLayoutEffect(t)}function Za(){let{isDataRoute:t}=W.useContext(Rs);return t?NN():gN()}function gN(){yl()||Ge(!1);let t=W.useContext(wu),{basename:e,future:r,navigator:n}=W.useContext(gi),{matches:s}=W.useContext(Rs),{pathname:i}=ua(),a=JSON.stringify(kd(s,r.v7_relativeSplatPath)),o=W.useRef(!1);return g2(()=>{o.current=!0}),W.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let h=Sd(c,JSON.parse(a),i,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Zs([e,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[e,n,a,i,t])}const vN=W.createContext(null);function xN(t){let e=W.useContext(Rs).outlet;return e&&W.createElement(vN.Provider,{value:t},e)}function _N(){let{matches:t}=W.useContext(Rs),e=t[t.length-1];return e?e.params:{}}function Ad(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=W.useContext(gi),{matches:s}=W.useContext(Rs),{pathname:i}=ua(),a=JSON.stringify(kd(s,n.v7_relativeSplatPath));return W.useMemo(()=>Sd(t,JSON.parse(a),i,r==="path"),[t,a,i,r])}function yN(t,e,r,n){yl()||Ge(!1);let{navigator:s}=W.useContext(gi),{matches:i}=W.useContext(Rs),a=i[i.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let c=ua(),u;u=c;let h=u.pathname||"/",d=h;if(l!=="/"){let g=l.replace(/^\//,"").split("/");d="/"+h.replace(/^\//,"").split("/").slice(g.length).join("/")}let m=ya(t,{pathname:d});return SN(m&&m.map(g=>Object.assign({},g,{params:Object.assign({},o,g.params),pathname:Zs([l,s.encodeLocation?s.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:Zs([l,s.encodeLocation?s.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,r,n)}function wN(){let t=RN(),e=Xc(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return W.createElement(W.Fragment,null,W.createElement("h2",null,"Unexpected Application Error!"),W.createElement("h3",{style:{fontStyle:"italic"}},e),r?W.createElement("pre",{style:s},r):null,null)}const EN=W.createElement(wN,null);class TN extends W.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?W.createElement(Rs.Provider,{value:this.props.routeContext},W.createElement(m2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function kN(t){let{routeContext:e,match:r,children:n}=t,s=W.useContext(wu);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),W.createElement(Rs.Provider,{value:e},n)}function SN(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var i;if(!r)return null;if(r.errors)t=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,o=(s=r)==null?void 0:s.errors;if(o!=null){let u=a.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);u>=0||Ge(!1),a=a.slice(0,Math.min(a.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<a.length;u++){let h=a[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:d,errors:m}=r,v=h.route.loader&&d[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||v){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((u,h,d)=>{let m,v=!1,g=null,y=null;r&&(m=o&&h.route.id?o[h.route.id]:void 0,g=h.route.errorElement||EN,l&&(c<0&&d===0?(PN("route-fallback"),v=!0,y=null):c===d&&(v=!0,y=h.route.hydrateFallbackElement||null)));let S=e.concat(a.slice(0,d+1)),k=()=>{let w;return m?w=g:v?w=y:h.route.Component?w=W.createElement(h.route.Component,null):h.route.element?w=h.route.element:w=u,W.createElement(kN,{match:h,routeContext:{outlet:u,matches:S,isDataRoute:r!=null},children:w})};return r&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?W.createElement(TN,{location:r.location,revalidation:r.revalidation,component:g,error:m,children:k(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):k()},null)}var v2=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(v2||{}),x2=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(x2||{});function AN(t){let e=W.useContext(wu);return e||Ge(!1),e}function IN(t){let e=W.useContext(Vg);return e||Ge(!1),e}function CN(t){let e=W.useContext(Rs);return e||Ge(!1),e}function _2(t){let e=CN(),r=e.matches[e.matches.length-1];return r.route.id||Ge(!1),r.route.id}function RN(){var t;let e=W.useContext(m2),r=IN(x2.UseRouteError),n=_2();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function NN(){let{router:t}=AN(v2.UseNavigateStable),e=_2(),r=W.useRef(!1);return g2(()=>{r.current=!0}),W.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Nh({fromRouteId:e},i)))},[t,e])}const v_={};function PN(t,e,r){v_[t]||(v_[t]=!0)}function DN(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function FN(t){let{to:e,replace:r,state:n,relative:s}=t;yl()||Ge(!1);let{future:i,static:a}=W.useContext(gi),{matches:o}=W.useContext(Rs),{pathname:l}=ua(),c=Za(),u=Sd(e,kd(o,i.v7_relativeSplatPath),l,s==="path"),h=JSON.stringify(u);return W.useEffect(()=>c(JSON.parse(h),{replace:r,state:n,relative:s}),[c,h,s,r,n]),null}function y2(t){return xN(t.context)}function bN(t){let{basename:e="/",children:r=null,location:n,navigationType:s=Yt.Pop,navigator:i,static:a=!1,future:o}=t;yl()&&Ge(!1);let l=e.replace(/^\/*/,"/"),c=W.useMemo(()=>({basename:l,navigator:i,static:a,future:Nh({v7_relativeSplatPath:!1},o)}),[l,o,i,a]);typeof n=="string"&&(n=ca(n));let{pathname:u="/",search:h="",hash:d="",state:m=null,key:v="default"}=n,g=W.useMemo(()=>{let y=li(u,l);return y==null?null:{location:{pathname:y,search:h,hash:d,state:m,key:v},navigationType:s}},[l,u,h,d,m,v,s]);return g==null?null:W.createElement(gi.Provider,{value:c},W.createElement(Ug.Provider,{children:r,value:g}))}new Promise(()=>{});function ON(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:W.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:W.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:W.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function il(){return il=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},il.apply(this,arguments)}function w2(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function MN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function LN(t,e){return t.button===0&&(!e||e==="_self")&&!MN(t)}const jN=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],VN=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],UN="6";try{window.__reactRouterVersion=UN}catch{}function BN(t,e){return XR({basename:void 0,future:il({},void 0,{v7_prependBasename:!0}),history:_R({window:void 0}),hydrationData:zN(),routes:t,mapRouteProperties:ON,dataStrategy:void 0,patchRoutesOnNavigation:void 0,window:void 0}).initialize()}function zN(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=il({},e,{errors:$N(e.errors)})),e}function $N(t){if(!t)return null;let e=Object.entries(t),r={};for(let[n,s]of e)if(s&&s.__type==="RouteErrorResponse")r[n]=new Rh(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let i=window[s.__subType];if(typeof i=="function")try{let a=new i(s.message);a.stack="",r[n]=a}catch{}}if(r[n]==null){let i=new Error(s.message);i.stack="",r[n]=i}}else r[n]=s;return r}const E2=W.createContext({isTransitioning:!1}),HN=W.createContext(new Map),WN="startTransition",x_=aC[WN],GN="flushSync",__=xR[GN];function KN(t){x_?x_(t):t()}function Kl(t){__?__(t):t()}let qN=class{constructor(){this.status="pending",this.promise=new Promise((e,r)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",r(n))}})}};function XN(t){let{fallbackElement:e,router:r,future:n}=t,[s,i]=W.useState(r.state),[a,o]=W.useState(),[l,c]=W.useState({isTransitioning:!1}),[u,h]=W.useState(),[d,m]=W.useState(),[v,g]=W.useState(),y=W.useRef(new Map),{v7_startTransition:S}=n||{},k=W.useCallback(E=>{S?KN(E):E()},[S]),w=W.useCallback((E,T)=>{let{deletedFetchers:I,flushSync:P,viewTransitionOpts:N}=T;E.fetchers.forEach((se,ae)=>{se.data!==void 0&&y.current.set(ae,se.data)}),I.forEach(se=>y.current.delete(se));let R=r.window==null||r.window.document==null||typeof r.window.document.startViewTransition!="function";if(!N||R){P?Kl(()=>i(E)):k(()=>i(E));return}if(P){Kl(()=>{d&&(u&&u.resolve(),d.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:N.currentLocation,nextLocation:N.nextLocation})});let se=r.window.document.startViewTransition(()=>{Kl(()=>i(E))});se.finished.finally(()=>{Kl(()=>{h(void 0),m(void 0),o(void 0),c({isTransitioning:!1})})}),Kl(()=>m(se));return}d?(u&&u.resolve(),d.skipTransition(),g({state:E,currentLocation:N.currentLocation,nextLocation:N.nextLocation})):(o(E),c({isTransitioning:!0,flushSync:!1,currentLocation:N.currentLocation,nextLocation:N.nextLocation}))},[r.window,d,u,y,k]);W.useLayoutEffect(()=>r.subscribe(w),[r,w]),W.useEffect(()=>{l.isTransitioning&&!l.flushSync&&h(new qN)},[l]),W.useEffect(()=>{if(u&&a&&r.window){let E=a,T=u.promise,I=r.window.document.startViewTransition(async()=>{k(()=>i(E)),await T});I.finished.finally(()=>{h(void 0),m(void 0),o(void 0),c({isTransitioning:!1})}),m(I)}},[k,a,u,r.window]),W.useEffect(()=>{u&&a&&s.location.key===a.location.key&&u.resolve()},[u,d,s.location,a]),W.useEffect(()=>{!l.isTransitioning&&v&&(o(v.state),c({isTransitioning:!0,flushSync:!1,currentLocation:v.currentLocation,nextLocation:v.nextLocation}),g(void 0))},[l.isTransitioning,v]),W.useEffect(()=>{},[]);let F=W.useMemo(()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:E=>r.navigate(E),push:(E,T,I)=>r.navigate(E,{state:T,preventScrollReset:I==null?void 0:I.preventScrollReset}),replace:(E,T,I)=>r.navigate(E,{replace:!0,state:T,preventScrollReset:I==null?void 0:I.preventScrollReset})}),[r]),B=r.basename||"/",V=W.useMemo(()=>({router:r,navigator:F,static:!1,basename:B}),[r,F,B]),x=W.useMemo(()=>({v7_relativeSplatPath:r.future.v7_relativeSplatPath}),[r.future.v7_relativeSplatPath]);return W.useEffect(()=>DN(n,r.future),[n,r.future]),W.createElement(W.Fragment,null,W.createElement(wu.Provider,{value:V},W.createElement(Vg.Provider,{value:s},W.createElement(HN.Provider,{value:y.current},W.createElement(E2.Provider,{value:l},W.createElement(bN,{basename:B,location:s.location,navigationType:s.historyAction,navigator:F,future:x},s.initialized||r.future.v7_partialHydration?W.createElement(YN,{routes:r.routes,future:r.future,state:s}):e))))),null)}const YN=W.memo(QN);function QN(t){let{routes:e,future:r,state:n}=t;return yN(e,void 0,n,r)}const JN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ZN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ct=W.forwardRef(function(e,r){let{onClick:n,relative:s,reloadDocument:i,replace:a,state:o,target:l,to:c,preventScrollReset:u,viewTransition:h}=e,d=w2(e,jN),{basename:m}=W.useContext(gi),v,g=!1;if(typeof c=="string"&&ZN.test(c)&&(v=c,JN))try{let w=new URL(window.location.href),F=c.startsWith("//")?new URL(w.protocol+c):new URL(c),B=li(F.pathname,m);F.origin===w.origin&&B!=null?c=B+F.search+F.hash:g=!0}catch{}let y=mN(c,{relative:s}),S=tP(c,{replace:a,state:o,target:l,preventScrollReset:u,relative:s,viewTransition:h});function k(w){n&&n(w),w.defaultPrevented||S(w)}return W.createElement("a",il({},d,{href:v||y,onClick:g||i?n:k,ref:r,target:l}))}),ga=W.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:s=!1,className:i="",end:a=!1,style:o,to:l,viewTransition:c,children:u}=e,h=w2(e,VN),d=Ad(l,{relative:h.relative}),m=ua(),v=W.useContext(Vg),{navigator:g,basename:y}=W.useContext(gi),S=v!=null&&rP(d)&&c===!0,k=g.encodeLocation?g.encodeLocation(d).pathname:d.pathname,w=m.pathname,F=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;s||(w=w.toLowerCase(),F=F?F.toLowerCase():null,k=k.toLowerCase()),F&&y&&(F=li(F,y)||F);const B=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let V=w===k||!a&&w.startsWith(k)&&w.charAt(B)==="/",x=F!=null&&(F===k||!a&&F.startsWith(k)&&F.charAt(k.length)==="/"),E={isActive:V,isPending:x,isTransitioning:S},T=V?n:void 0,I;typeof i=="function"?I=i(E):I=[i,V?"active":null,x?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let P=typeof o=="function"?o(E):o;return W.createElement(ct,il({},h,{"aria-current":T,className:I,ref:r,style:P,to:l,viewTransition:c}),typeof u=="function"?u(E):u)});var tm;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(tm||(tm={}));var y_;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(y_||(y_={}));function eP(t){let e=W.useContext(wu);return e||Ge(!1),e}function tP(t,e){let{target:r,replace:n,state:s,preventScrollReset:i,relative:a,viewTransition:o}=e===void 0?{}:e,l=Za(),c=ua(),u=Ad(t,{relative:a});return W.useCallback(h=>{if(LN(h,r)){h.preventDefault();let d=n!==void 0?n:za(c)===za(u);l(t,{replace:d,state:s,preventScrollReset:i,relative:a,viewTransition:o})}},[c,l,u,n,s,r,t,i,a,o])}function rP(t,e){e===void 0&&(e={});let r=W.useContext(E2);r==null&&Ge(!1);let{basename:n}=eP(tm.useViewTransitionState),s=Ad(t,{relative:e.relative});if(!r.isTransitioning)return!1;let i=li(r.currentLocation.pathname,n)||r.currentLocation.pathname,a=li(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Ch(s.pathname,a)!=null||Ch(s.pathname,i)!=null}var w_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T2=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},nP=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],a=t[r++],o=t[r++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},k2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,o=a?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=i>>2,h=(i&3)<<4|o>>4;let d=(o&15)<<2|c>>6,m=c&63;l||(m=64,a||(d=64)),n.push(r[u],r[h],r[d],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(T2(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):nP(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],o=s<t.length?r[t.charAt(s)]:0;++s;const c=s<t.length?r[t.charAt(s)]:64;++s;const h=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||o==null||c==null||h==null)throw new sP;const d=i<<2|o>>4;if(n.push(d),c!==64){const m=o<<4&240|c>>2;if(n.push(m),h!==64){const v=c<<6&192|h;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class sP extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const iP=function(t){const e=T2(t);return k2.encodeByteArray(e,!0)},Ph=function(t){return iP(t).replace(/\./g,"")},S2=function(t){try{return k2.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aP(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oP=()=>aP().__FIREBASE_DEFAULTS__,lP=()=>{if(typeof process>"u"||typeof w_>"u")return;const t=w_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},cP=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&S2(t[1]);return e&&JSON.parse(e)},Id=()=>{try{return oP()||lP()||cP()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},A2=t=>{var e,r;return(r=(e=Id())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},Bg=t=>{const e=A2(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},I2=()=>{var t;return(t=Id())===null||t===void 0?void 0:t.config},C2=t=>{var e;return(e=Id())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uP{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R2(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Ph(JSON.stringify(r)),Ph(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Br(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Br())}function hP(){var t;const e=(t=Id())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function dP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function pP(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function mP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function gP(){const t=Br();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function vP(){return!hP()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function xP(){try{return typeof indexedDB=="object"}catch{return!1}}function _P(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yP="FirebaseError";class Ns extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=yP,Object.setPrototypeOf(this,Ns.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Eu.prototype.create)}}class Eu{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?wP(i,n):"Error",o=`${this.serviceName}: ${a} (${s}).`;return new Ns(s,o,n)}}function wP(t,e){return t.replace(EP,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const EP=/\{\$([^}]+)}/g;function TP(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Dh(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],a=e[s];if(E_(i)&&E_(a)){if(!Dh(i,a))return!1}else if(i!==a)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function E_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tu(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function kP(t,e){const r=new SP(t,e);return r.subscribe.bind(r)}class SP{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");AP(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=M0),s.error===void 0&&(s.error=M0),s.complete===void 0&&(s.complete=M0);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function AP(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function M0(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(t){return t&&t._delegate?t._delegate:t}class ci{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new uP;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(RP(e))try{this.getOrInitializeService({instanceIdentifier:_a})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=_a){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=_a){return this.instances.has(e)}getOptions(e=_a){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);n===o&&a.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),i=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:CP(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=_a){return this.component?this.component.multipleInstances?e:_a:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function CP(t){return t===_a?void 0:t}function RP(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new IP(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ye||(Ye={}));const PP={debug:Ye.DEBUG,verbose:Ye.VERBOSE,info:Ye.INFO,warn:Ye.WARN,error:Ye.ERROR,silent:Ye.SILENT},DP=Ye.INFO,FP={[Ye.DEBUG]:"log",[Ye.VERBOSE]:"log",[Ye.INFO]:"info",[Ye.WARN]:"warn",[Ye.ERROR]:"error"},bP=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=FP[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class zg{constructor(e){this.name=e,this._logLevel=DP,this._logHandler=bP,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?PP[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ye.DEBUG,...e),this._logHandler(this,Ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ye.VERBOSE,...e),this._logHandler(this,Ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ye.INFO,...e),this._logHandler(this,Ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ye.WARN,...e),this._logHandler(this,Ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ye.ERROR,...e),this._logHandler(this,Ye.ERROR,...e)}}const OP=(t,e)=>e.some(r=>t instanceof r);let T_,k_;function MP(){return T_||(T_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function LP(){return k_||(k_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const N2=new WeakMap,rm=new WeakMap,P2=new WeakMap,L0=new WeakMap,$g=new WeakMap;function jP(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(qi(t.result)),s()},a=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&N2.set(r,t)}).catch(()=>{}),$g.set(e,t),e}function VP(t){if(rm.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),s()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});rm.set(t,e)}let nm={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return rm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||P2.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return qi(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function UP(t){nm=t(nm)}function BP(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(j0(this),e,...r);return P2.set(n,e.sort?e.sort():[e]),qi(n)}:LP().includes(t)?function(...e){return t.apply(j0(this),e),qi(N2.get(this))}:function(...e){return qi(t.apply(j0(this),e))}}function zP(t){return typeof t=="function"?BP(t):(t instanceof IDBTransaction&&VP(t),OP(t,MP())?new Proxy(t,nm):t)}function qi(t){if(t instanceof IDBRequest)return jP(t);if(L0.has(t))return L0.get(t);const e=zP(t);return e!==t&&(L0.set(t,e),$g.set(e,t)),e}const j0=t=>$g.get(t);function $P(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),o=qi(a);return n&&a.addEventListener("upgradeneeded",l=>{n(qi(a.result),l.oldVersion,l.newVersion,qi(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const HP=["get","getKey","getAll","getAllKeys","count"],WP=["put","add","delete","clear"],V0=new Map;function S_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(V0.get(e))return V0.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=WP.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||HP.includes(r)))return;const i=async function(a,...o){const l=this.transaction(a,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),s&&l.done]))[0]};return V0.set(e,i),i}UP(t=>({...t,get:(e,r,n)=>S_(e,r)||t.get(e,r,n),has:(e,r)=>!!S_(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(KP(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function KP(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const sm="@firebase/app",A_="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ui=new zg("@firebase/app"),qP="@firebase/app-compat",XP="@firebase/analytics-compat",YP="@firebase/analytics",QP="@firebase/app-check-compat",JP="@firebase/app-check",ZP="@firebase/auth",eD="@firebase/auth-compat",tD="@firebase/database",rD="@firebase/data-connect",nD="@firebase/database-compat",sD="@firebase/functions",iD="@firebase/functions-compat",aD="@firebase/installations",oD="@firebase/installations-compat",lD="@firebase/messaging",cD="@firebase/messaging-compat",uD="@firebase/performance",fD="@firebase/performance-compat",hD="@firebase/remote-config",dD="@firebase/remote-config-compat",pD="@firebase/storage",mD="@firebase/storage-compat",gD="@firebase/firestore",vD="@firebase/vertexai-preview",xD="@firebase/firestore-compat",_D="firebase",yD="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const im="[DEFAULT]",wD={[sm]:"fire-core",[qP]:"fire-core-compat",[YP]:"fire-analytics",[XP]:"fire-analytics-compat",[JP]:"fire-app-check",[QP]:"fire-app-check-compat",[ZP]:"fire-auth",[eD]:"fire-auth-compat",[tD]:"fire-rtdb",[rD]:"fire-data-connect",[nD]:"fire-rtdb-compat",[sD]:"fire-fn",[iD]:"fire-fn-compat",[aD]:"fire-iid",[oD]:"fire-iid-compat",[lD]:"fire-fcm",[cD]:"fire-fcm-compat",[uD]:"fire-perf",[fD]:"fire-perf-compat",[hD]:"fire-rc",[dD]:"fire-rc-compat",[pD]:"fire-gcs",[mD]:"fire-gcs-compat",[gD]:"fire-fst",[xD]:"fire-fst-compat",[vD]:"fire-vertex","fire-js":"fire-js",[_D]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fh=new Map,ED=new Map,am=new Map;function I_(t,e){try{t.container.addComponent(e)}catch(r){ui.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function ea(t){const e=t.name;if(am.has(e))return ui.debug(`There were multiple attempts to register component ${e}.`),!1;am.set(e,t);for(const r of Fh.values())I_(r,t);for(const r of ED.values())I_(r,t);return!0}function ku(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Ks(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Xi=new Eu("app","Firebase",TD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kD{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ci("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Xi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eo=yD;function D2(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:im,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw Xi.create("bad-app-name",{appName:String(s)});if(r||(r=I2()),!r)throw Xi.create("no-options");const i=Fh.get(s);if(i){if(Dh(r,i.options)&&Dh(n,i.config))return i;throw Xi.create("duplicate-app",{appName:s})}const a=new NP(s);for(const l of am.values())a.addComponent(l);const o=new kD(r,n,a);return Fh.set(s,o),o}function Cd(t=im){const e=Fh.get(t);if(!e&&t===im&&I2())return D2();if(!e)throw Xi.create("no-app",{appName:t});return e}function On(t,e,r){var n;let s=(n=wD[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${s}" with version "${e}":`];i&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ui.warn(o.join(" "));return}ea(new ci(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SD="firebase-heartbeat-database",AD=1,Yc="firebase-heartbeat-store";let U0=null;function F2(){return U0||(U0=$P(SD,AD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Yc)}catch(r){console.warn(r)}}}}).catch(t=>{throw Xi.create("idb-open",{originalErrorMessage:t.message})})),U0}async function ID(t){try{const r=(await F2()).transaction(Yc),n=await r.objectStore(Yc).get(b2(t));return await r.done,n}catch(e){if(e instanceof Ns)ui.warn(e.message);else{const r=Xi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ui.warn(r.message)}}}async function C_(t,e){try{const n=(await F2()).transaction(Yc,"readwrite");await n.objectStore(Yc).put(e,b2(t)),await n.done}catch(r){if(r instanceof Ns)ui.warn(r.message);else{const n=Xi.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});ui.warn(n.message)}}}function b2(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CD=1024,RD=30*24*60*60*1e3;class ND{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new DD(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=R_();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=RD}),this._storage.overwrite(this._heartbeatsCache))}catch(n){ui.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=R_(),{heartbeatsToSend:n,unsentEntries:s}=PD(this._heartbeatsCache.heartbeats),i=Ph(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return ui.warn(r),""}}}function R_(){return new Date().toISOString().substring(0,10)}function PD(t,e=CD){const r=[];let n=t.slice();for(const s of t){const i=r.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),N_(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),N_(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class DD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return xP()?_P().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await ID(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return C_(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return C_(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function N_(t){return Ph(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FD(t){ea(new ci("platform-logger",e=>new GP(e),"PRIVATE")),ea(new ci("heartbeat",e=>new ND(e),"PRIVATE")),On(sm,A_,t),On(sm,A_,"esm2017"),On("fire-js","")}FD("");function Hg(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function O2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const bD=O2,M2=new Eu("auth","Firebase",O2());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh=new zg("@firebase/auth");function OD(t,...e){bh.logLevel<=Ye.WARN&&bh.warn(`Auth (${eo}): ${t}`,...e)}function qf(t,...e){bh.logLevel<=Ye.ERROR&&bh.error(`Auth (${eo}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ss(t,...e){throw Gg(t,...e)}function ns(t,...e){return Gg(t,...e)}function Wg(t,e,r){const n=Object.assign(Object.assign({},bD()),{[e]:r});return new Eu("auth","Firebase",n).create(e,{appName:t.name})}function Da(t){return Wg(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function MD(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Ss(t,"argument-error"),Wg(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Gg(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return M2.create(t,...e)}function Me(t,e,...r){if(!t)throw Gg(e,...r)}function qs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw qf(e),new Error(e)}function fi(t,e){t||qs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function om(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function LD(){return P_()==="http:"||P_()==="https:"}function P_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(LD()||pP()||"connection"in navigator)?navigator.onLine:!0}function VD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e,r){this.shortDelay=e,this.longDelay=r,fi(r>e,"Short delay should be less than long delay!"),this.isMobile=fP()||mP()}get(){return jD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kg(t,e){fi(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;qs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;qs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;qs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BD=new Su(3e4,6e4);function qg(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function wl(t,e,r,n,s={}){return j2(t,s,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const o=Tu(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},i);return dP()||(c.referrerPolicy="no-referrer"),L2.fetch()(V2(t,t.config.apiHost,r,o),c)})}async function j2(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},UD),e);try{const s=new $D(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw yf(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw yf(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw yf(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw yf(t,"user-disabled",a);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Wg(t,u,c);Ss(t,u)}}catch(s){if(s instanceof Ns)throw s;Ss(t,"network-request-failed",{message:String(s)})}}async function zD(t,e,r,n,s={}){const i=await wl(t,e,r,n,s);return"mfaPendingCredential"in i&&Ss(t,"multi-factor-auth-required",{_serverResponse:i}),i}function V2(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?Kg(t.config,s):`${t.config.apiScheme}://${s}`}class $D{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(ns(this.auth,"network-request-failed")),BD.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function yf(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=ns(t,e,n);return s.customData._tokenResponse=r,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HD(t,e){return wl(t,"POST","/v1/accounts:delete",e)}async function U2(t,e){return wl(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function B2(t,e=!1){const r=Ht(t),n=await r.getIdToken(e),s=Xg(n);Me(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:vc(B0(s.auth_time)),issuedAtTime:vc(B0(s.iat)),expirationTime:vc(B0(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function B0(t){return Number(t)*1e3}function Xg(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return qf("JWT malformed, contained fewer than 3 sections"),null;try{const s=S2(r);return s?JSON.parse(s):(qf("Failed to decode base64 JWT payload"),null)}catch(s){return qf("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function D_(t){const e=Xg(t);return Me(e,"internal-error"),Me(typeof e.exp<"u","internal-error"),Me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qc(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ns&&WD(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function WD({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lm{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=vc(this.lastLoginAt),this.creationTime=vc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oh(t){var e;const r=t.auth,n=await t.getIdToken(),s=await Qc(t,U2(r,{idToken:n}));Me(s==null?void 0:s.users.length,r,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?z2(i.providerUserInfo):[],o=qD(t.providerData,a),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new lm(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function KD(t){const e=Ht(t);await Oh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function qD(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function z2(t){return t.map(e=>{var{providerId:r}=e,n=Hg(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XD(t,e){const r=await j2(t,{},async()=>{const n=Tu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=V2(t,s,"/v1/token",`key=${i}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",L2.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function YD(t,e){return wl(t,"POST","/v2/accounts:revokeToken",qg(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Me(e.idToken,"internal-error"),Me(typeof e.idToken<"u","internal-error"),Me(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):D_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Me(e.length!==0,"internal-error");const r=D_(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await XD(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,a=new $o;return n&&(Me(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),s&&(Me(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(Me(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $o,this.toJSON())}_performRefresh(){return qs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ti(t,e){Me(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Xs{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,i=Hg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new GD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new lm(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await Qc(this,this.stsTokenManager.getToken(this.auth,e));return Me(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return B2(this,e)}reload(){return KD(this)}_assign(e){this!==e&&(Me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Xs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Oh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ks(this.auth.app))return Promise.reject(Da(this.auth));const e=await this.getIdToken();return await Qc(this,HD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,i,a,o,l,c,u;const h=(n=r.displayName)!==null&&n!==void 0?n:void 0,d=(s=r.email)!==null&&s!==void 0?s:void 0,m=(i=r.phoneNumber)!==null&&i!==void 0?i:void 0,v=(a=r.photoURL)!==null&&a!==void 0?a:void 0,g=(o=r.tenantId)!==null&&o!==void 0?o:void 0,y=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,S=(c=r.createdAt)!==null&&c!==void 0?c:void 0,k=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:w,emailVerified:F,isAnonymous:B,providerData:V,stsTokenManager:x}=r;Me(w&&x,e,"internal-error");const E=$o.fromJSON(this.name,x);Me(typeof w=="string",e,"internal-error"),Ti(h,e.name),Ti(d,e.name),Me(typeof F=="boolean",e,"internal-error"),Me(typeof B=="boolean",e,"internal-error"),Ti(m,e.name),Ti(v,e.name),Ti(g,e.name),Ti(y,e.name),Ti(S,e.name),Ti(k,e.name);const T=new Xs({uid:w,auth:e,email:d,emailVerified:F,displayName:h,isAnonymous:B,photoURL:v,phoneNumber:m,tenantId:g,stsTokenManager:E,createdAt:S,lastLoginAt:k});return V&&Array.isArray(V)&&(T.providerData=V.map(I=>Object.assign({},I))),y&&(T._redirectEventId=y),T}static async _fromIdTokenResponse(e,r,n=!1){const s=new $o;s.updateFromServerResponse(r);const i=new Xs({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await Oh(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];Me(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?z2(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),o=new $o;o.updateFromIdToken(n);const l=new Xs({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new lm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_=new Map;function Ys(t){fi(t instanceof Function,"Expected a class definition");let e=F_.get(t);return e?(fi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,F_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}$2.type="NONE";const b_=$2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xf(t,e,r){return`firebase:${t}:${e}:${r}`}class Ho{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=Xf(this.userKey,s.apiKey,i),this.fullPersistenceKey=Xf("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Xs._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Ho(Ys(b_),e,n);const s=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Ys(b_);const a=Xf(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const u=await c._get(a);if(u){const h=Xs._fromJSON(e,u);c!==i&&(o=h),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Ho(i,e,n):(i=l[0],o&&await i._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==i)try{await c._remove(a)}catch{}})),new Ho(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(K2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(H2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(X2(e))return"Blackberry";if(Y2(e))return"Webos";if(W2(e))return"Safari";if((e.includes("chrome/")||G2(e))&&!e.includes("edge/"))return"Chrome";if(q2(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function H2(t=Br()){return/firefox\//i.test(t)}function W2(t=Br()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function G2(t=Br()){return/crios\//i.test(t)}function K2(t=Br()){return/iemobile/i.test(t)}function q2(t=Br()){return/android/i.test(t)}function X2(t=Br()){return/blackberry/i.test(t)}function Y2(t=Br()){return/webos/i.test(t)}function Yg(t=Br()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function QD(t=Br()){var e;return Yg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function JD(){return gP()&&document.documentMode===10}function Q2(t=Br()){return Yg(t)||q2(t)||Y2(t)||X2(t)||/windows phone/i.test(t)||K2(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J2(t,e=[]){let r;switch(t){case"Browser":r=O_(Br());break;case"Worker":r=`${O_(Br())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${eo}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZD{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,o)=>{try{const l=e(i);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eF(t,e={}){return wl(t,"GET","/v2/passwordPolicy",qg(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tF=6;class rF{constructor(e){var r,n,s,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:tF,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,i,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nF{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new M_(this),this.idTokenSubscription=new M_(this),this.beforeStateQueue=new ZD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=M2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ys(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await Ho.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await U2(this,{idToken:e}),n=await Xs._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Ks(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Oh(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=VD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ks(this.app))return Promise.reject(Da(this));const r=e?Ht(e):null;return r&&Me(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ks(this.app)?Promise.reject(Da(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ks(this.app)?Promise.reject(Da(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ys(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await eF(this),r=new rF(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Eu("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await YD(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ys(e)||this._popupRedirectResolver;Me(r,this,"argument-error"),this.redirectPersistenceManager=await Ho.create(this,[Ys(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Me(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,s);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=J2(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&OD(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Rd(t){return Ht(t)}class M_{constructor(e){this.auth=e,this.observer=null,this.addObserver=kP(r=>this.observer=r)}get next(){return Me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function sF(t){Qg=t}function iF(t){return Qg.loadJS(t)}function aF(){return Qg.gapiScript}function oF(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lF(t,e){const r=ku(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(Dh(i,e??{}))return s;Ss(s,"already-initialized")}return r.initialize({options:e})}function cF(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ys);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function uF(t,e,r){const n=Rd(t);Me(n._canInitEmulator,n,"emulator-config-failed"),Me(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=Z2(e),{host:a,port:o}=fF(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${i}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),hF()}function Z2(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function fF(t){const e=Z2(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:L_(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:L_(a)}}}function L_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function hF(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return qs("not implemented")}_getIdTokenResponse(e){return qs("not implemented")}_linkToIdToken(e,r){return qs("not implemented")}_getReauthenticationResolver(e){return qs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wo(t,e){return zD(t,"POST","/v1/accounts:signInWithIdp",qg(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dF="http://localhost";class $a extends ek{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new $a(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Ss("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,i=Hg(r,["providerId","signInMethod"]);if(!n||!s)return null;const a=new $a(n,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return Wo(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Wo(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Wo(e,r)}buildRequest(){const e={requestUri:dF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Tu(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au extends Jg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni extends Au{constructor(){super("facebook.com")}static credential(e){return $a._fromParams({providerId:Ni.PROVIDER_ID,signInMethod:Ni.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ni.credentialFromTaggedObject(e)}static credentialFromError(e){return Ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ni.credential(e.oauthAccessToken)}catch{return null}}}Ni.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ni.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs extends Au{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return $a._fromParams({providerId:vs.PROVIDER_ID,signInMethod:vs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return vs.credentialFromTaggedObject(e)}static credentialFromError(e){return vs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return vs.credential(r,n)}catch{return null}}}vs.GOOGLE_SIGN_IN_METHOD="google.com";vs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi extends Au{constructor(){super("github.com")}static credential(e){return $a._fromParams({providerId:Pi.PROVIDER_ID,signInMethod:Pi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Pi.credentialFromTaggedObject(e)}static credentialFromError(e){return Pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Pi.credential(e.oauthAccessToken)}catch{return null}}}Pi.GITHUB_SIGN_IN_METHOD="github.com";Pi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di extends Au{constructor(){super("twitter.com")}static credential(e,r){return $a._fromParams({providerId:Di.PROVIDER_ID,signInMethod:Di.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Di.credentialFromTaggedObject(e)}static credentialFromError(e){return Di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Di.credential(r,n)}catch{return null}}}Di.TWITTER_SIGN_IN_METHOD="twitter.com";Di.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await Xs._fromIdTokenResponse(e,n,s),a=j_(n);return new al({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=j_(n);return new al({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function j_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh extends Ns{constructor(e,r,n,s){var i;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Mh.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new Mh(e,r,n,s)}}function tk(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Mh._fromErrorAndOperation(t,i,e,n):i})}async function pF(t,e,r=!1){const n=await Qc(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return al._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mF(t,e,r=!1){const{auth:n}=t;if(Ks(n.app))return Promise.reject(Da(n));const s="reauthenticate";try{const i=await Qc(t,tk(n,s,e,t),r);Me(i.idToken,n,"internal-error");const a=Xg(i.idToken);Me(a,n,"internal-error");const{sub:o}=a;return Me(t.uid===o,n,"user-mismatch"),al._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Ss(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gF(t,e,r=!1){if(Ks(t.app))return Promise.reject(Da(t));const n="signIn",s=await tk(t,n,e),i=await al._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}function vF(t,e,r,n){return Ht(t).onIdTokenChanged(e,r,n)}function xF(t,e,r){return Ht(t).beforeAuthStateChanged(e,r)}function rk(t,e,r,n){return Ht(t).onAuthStateChanged(e,r,n)}function _F(t){return Ht(t).signOut()}const Lh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nk{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Lh,"1"),this.storage.removeItem(Lh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yF=1e3,wF=10;class sk extends nk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Q2(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);JD()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,wF):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},yF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}sk.type="LOCAL";const EF=sk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik extends nk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}ik.type="SESSION";const ak=ik;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new Nd(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(a).map(async c=>c(r.origin,i)),l=await TF(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Nd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zg(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((o,l)=>{const c=Zg("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(d.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ws(){return window}function SF(t){ws().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ok(){return typeof ws().WorkerGlobalScope<"u"&&typeof ws().importScripts=="function"}async function AF(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function IF(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function CF(){return ok()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lk="firebaseLocalStorageDb",RF=1,jh="firebaseLocalStorage",ck="fbase_key";class Iu{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Pd(t,e){return t.transaction([jh],e?"readwrite":"readonly").objectStore(jh)}function NF(){const t=indexedDB.deleteDatabase(lk);return new Iu(t).toPromise()}function cm(){const t=indexedDB.open(lk,RF);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(jh,{keyPath:ck})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(jh)?e(n):(n.close(),await NF(),e(await cm()))})})}async function V_(t,e,r){const n=Pd(t,!0).put({[ck]:e,value:r});return new Iu(n).toPromise()}async function PF(t,e){const r=Pd(t,!1).get(e),n=await new Iu(r).toPromise();return n===void 0?null:n.value}function U_(t,e){const r=Pd(t,!0).delete(e);return new Iu(r).toPromise()}const DF=800,FF=3;class uk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await cm(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>FF)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ok()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Nd._getInstance(CF()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await AF(),!this.activeServiceWorker)return;this.sender=new kF(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||IF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await cm();return await V_(e,Lh,"1"),await U_(e,Lh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>V_(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>PF(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>U_(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Pd(s,!1).getAll();return new Iu(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),DF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}uk.type="LOCAL";const bF=uk;new Su(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fk(t,e){return e?Ys(e):(Me(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ev extends ek{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Wo(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Wo(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Wo(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function OF(t){return gF(t.auth,new ev(t),t.bypassAuthState)}function MF(t){const{auth:e,user:r}=t;return Me(r,e,"internal-error"),mF(r,new ev(t),t.bypassAuthState)}async function LF(t){const{auth:e,user:r}=t;return Me(r,e,"internal-error"),pF(r,new ev(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return OF;case"linkViaPopup":case"linkViaRedirect":return LF;case"reauthViaPopup":case"reauthViaRedirect":return MF;default:Ss(this.auth,"internal-error")}}resolve(e){fi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){fi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jF=new Su(2e3,1e4);async function dk(t,e,r){if(Ks(t.app))return Promise.reject(ns(t,"operation-not-supported-in-this-environment"));const n=Rd(t);MD(t,e,Jg);const s=fk(n,r);return new Ia(n,"signInViaPopup",e,s).executeNotNull()}class Ia extends hk{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,Ia.currentPopupAction&&Ia.currentPopupAction.cancel(),Ia.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Me(e,this.auth,"internal-error"),e}async onExecution(){fi(this.filter.length===1,"Popup operations only handle one event");const e=Zg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ns(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ns(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ia.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ns(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,jF.get())};e()}}Ia.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VF="pendingRedirect",Yf=new Map;class UF extends hk{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Yf.get(this.auth._key());if(!e){try{const n=await BF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Yf.set(this.auth._key(),e)}return this.bypassAuthState||Yf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function BF(t,e){const r=HF(e),n=$F(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function zF(t,e){Yf.set(t._key(),e)}function $F(t){return Ys(t._redirectPersistence)}function HF(t){return Xf(VF,t.config.apiKey,t.name)}async function WF(t,e,r=!1){if(Ks(t.app))return Promise.reject(Da(t));const n=Rd(t),s=fk(n,e),a=await new UF(n,s,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GF=10*60*1e3;class KF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!qF(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!pk(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(ns(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=GF&&this.cachedEventUids.clear(),this.cachedEventUids.has(B_(e))}saveEventToCache(e){this.cachedEventUids.add(B_(e)),this.lastProcessedEventTime=Date.now()}}function B_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function pk({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function qF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return pk(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XF(t,e={}){return wl(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,QF=/^https?/;async function JF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await XF(t);for(const r of e)try{if(ZF(r))return}catch{}Ss(t,"unauthorized-domain")}function ZF(t){const e=om(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!QF.test(r))return!1;if(YF.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e3=new Su(3e4,6e4);function z_(){const t=ws().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function t3(t){return new Promise((e,r)=>{var n,s,i;function a(){z_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{z_(),r(ns(t,"network-request-failed"))},timeout:e3.get()})}if(!((s=(n=ws().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=ws().gapi)===null||i===void 0)&&i.load)a();else{const o=oF("iframefcb");return ws()[o]=()=>{gapi.load?a():r(ns(t,"network-request-failed"))},iF(`${aF()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw Qf=null,e})}let Qf=null;function r3(t){return Qf=Qf||t3(t),Qf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3=new Su(5e3,15e3),s3="__/auth/iframe",i3="emulator/auth/iframe",a3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},o3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function l3(t){const e=t.config;Me(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Kg(e,i3):`https://${t.config.authDomain}/${s3}`,n={apiKey:e.apiKey,appName:t.name,v:eo},s=o3.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${Tu(n).slice(1)}`}async function c3(t){const e=await r3(t),r=ws().gapi;return Me(r,t,"internal-error"),e.open({where:document.body,url:l3(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:a3,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const a=ns(t,"network-request-failed"),o=ws().setTimeout(()=>{i(a)},n3.get());function l(){ws().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},f3=500,h3=600,d3="_blank",p3="http://localhost";class $_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function m3(t,e,r,n=f3,s=h3){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},u3),{width:n.toString(),height:s.toString(),top:i,left:a}),c=Br().toLowerCase();r&&(o=G2(c)?d3:r),H2(c)&&(e=e||p3,l.scrollbars="yes");const u=Object.entries(l).reduce((d,[m,v])=>`${d}${m}=${v},`,"");if(QD(c)&&o!=="_self")return g3(e||"",o),new $_(null);const h=window.open(e||"",o,u);Me(h,t,"popup-blocked");try{h.focus()}catch{}return new $_(h)}function g3(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v3="__/auth/handler",x3="emulator/auth/handler",_3=encodeURIComponent("fac");async function H_(t,e,r,n,s,i){Me(t.config.authDomain,t,"auth-domain-config-required"),Me(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:eo,eventId:s};if(e instanceof Jg){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",TP(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries({}))a[u]=h}if(e instanceof Au){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(a.scopes=u.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await t._getAppCheckToken(),c=l?`#${_3}=${encodeURIComponent(l)}`:"";return`${y3(t)}?${Tu(o).slice(1)}${c}`}function y3({config:t}){return t.emulator?Kg(t,x3):`https://${t.authDomain}/${v3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z0="webStorageSupport";class w3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ak,this._completeRedirectFn=WF,this._overrideRedirectResult=zF}async _openPopup(e,r,n,s){var i;fi((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await H_(e,r,n,om(),s);return m3(e,a,Zg())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await H_(e,r,n,om(),s);return SF(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(fi(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await c3(e),n=new KF(e);return r.register("authEvent",s=>(Me(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(z0,{type:z0},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[z0];a!==void 0&&r(!!a),Ss(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=JF(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return Q2()||W2()||Yg()}}const E3=w3;var W_="@firebase/auth",G_="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k3(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function S3(t){ea(new ci("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Me(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:J2(t)},c=new nF(n,s,i,l);return cF(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),ea(new ci("auth-internal",e=>{const r=Rd(e.getProvider("auth").getImmediate());return(n=>new T3(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),On(W_,G_,k3(t)),On(W_,G_,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A3=5*60,I3=C2("authIdTokenMaxAge")||A3;let K_=null;const C3=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>I3)return;const s=r==null?void 0:r.token;K_!==s&&(K_=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function R3(t=Cd()){const e=ku(t,"auth");if(e.isInitialized())return e.getImmediate();const r=lF(t,{popupRedirectResolver:E3,persistence:[bF,EF,ak]}),n=C2("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=C3(i.toString());xF(r,a,()=>a(r.currentUser)),vF(r,o=>a(o))}}const s=A2("auth");return s&&uF(r,`http://${s}`),r}function N3(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}sF({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=ns("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",N3().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});S3("Browser");var q_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fa,mk;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,E){function T(){}T.prototype=E.prototype,x.D=E.prototype,x.prototype=new T,x.prototype.constructor=x,x.C=function(I,P,N){for(var R=Array(arguments.length-2),se=2;se<arguments.length;se++)R[se-2]=arguments[se];return E.prototype[P].apply(I,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(x,E,T){T||(T=0);var I=Array(16);if(typeof E=="string")for(var P=0;16>P;++P)I[P]=E.charCodeAt(T++)|E.charCodeAt(T++)<<8|E.charCodeAt(T++)<<16|E.charCodeAt(T++)<<24;else for(P=0;16>P;++P)I[P]=E[T++]|E[T++]<<8|E[T++]<<16|E[T++]<<24;E=x.g[0],T=x.g[1],P=x.g[2];var N=x.g[3],R=E+(N^T&(P^N))+I[0]+3614090360&4294967295;E=T+(R<<7&4294967295|R>>>25),R=N+(P^E&(T^P))+I[1]+3905402710&4294967295,N=E+(R<<12&4294967295|R>>>20),R=P+(T^N&(E^T))+I[2]+606105819&4294967295,P=N+(R<<17&4294967295|R>>>15),R=T+(E^P&(N^E))+I[3]+3250441966&4294967295,T=P+(R<<22&4294967295|R>>>10),R=E+(N^T&(P^N))+I[4]+4118548399&4294967295,E=T+(R<<7&4294967295|R>>>25),R=N+(P^E&(T^P))+I[5]+1200080426&4294967295,N=E+(R<<12&4294967295|R>>>20),R=P+(T^N&(E^T))+I[6]+2821735955&4294967295,P=N+(R<<17&4294967295|R>>>15),R=T+(E^P&(N^E))+I[7]+4249261313&4294967295,T=P+(R<<22&4294967295|R>>>10),R=E+(N^T&(P^N))+I[8]+1770035416&4294967295,E=T+(R<<7&4294967295|R>>>25),R=N+(P^E&(T^P))+I[9]+2336552879&4294967295,N=E+(R<<12&4294967295|R>>>20),R=P+(T^N&(E^T))+I[10]+4294925233&4294967295,P=N+(R<<17&4294967295|R>>>15),R=T+(E^P&(N^E))+I[11]+2304563134&4294967295,T=P+(R<<22&4294967295|R>>>10),R=E+(N^T&(P^N))+I[12]+1804603682&4294967295,E=T+(R<<7&4294967295|R>>>25),R=N+(P^E&(T^P))+I[13]+4254626195&4294967295,N=E+(R<<12&4294967295|R>>>20),R=P+(T^N&(E^T))+I[14]+2792965006&4294967295,P=N+(R<<17&4294967295|R>>>15),R=T+(E^P&(N^E))+I[15]+1236535329&4294967295,T=P+(R<<22&4294967295|R>>>10),R=E+(P^N&(T^P))+I[1]+4129170786&4294967295,E=T+(R<<5&4294967295|R>>>27),R=N+(T^P&(E^T))+I[6]+3225465664&4294967295,N=E+(R<<9&4294967295|R>>>23),R=P+(E^T&(N^E))+I[11]+643717713&4294967295,P=N+(R<<14&4294967295|R>>>18),R=T+(N^E&(P^N))+I[0]+3921069994&4294967295,T=P+(R<<20&4294967295|R>>>12),R=E+(P^N&(T^P))+I[5]+3593408605&4294967295,E=T+(R<<5&4294967295|R>>>27),R=N+(T^P&(E^T))+I[10]+38016083&4294967295,N=E+(R<<9&4294967295|R>>>23),R=P+(E^T&(N^E))+I[15]+3634488961&4294967295,P=N+(R<<14&4294967295|R>>>18),R=T+(N^E&(P^N))+I[4]+3889429448&4294967295,T=P+(R<<20&4294967295|R>>>12),R=E+(P^N&(T^P))+I[9]+568446438&4294967295,E=T+(R<<5&4294967295|R>>>27),R=N+(T^P&(E^T))+I[14]+3275163606&4294967295,N=E+(R<<9&4294967295|R>>>23),R=P+(E^T&(N^E))+I[3]+4107603335&4294967295,P=N+(R<<14&4294967295|R>>>18),R=T+(N^E&(P^N))+I[8]+1163531501&4294967295,T=P+(R<<20&4294967295|R>>>12),R=E+(P^N&(T^P))+I[13]+2850285829&4294967295,E=T+(R<<5&4294967295|R>>>27),R=N+(T^P&(E^T))+I[2]+4243563512&4294967295,N=E+(R<<9&4294967295|R>>>23),R=P+(E^T&(N^E))+I[7]+1735328473&4294967295,P=N+(R<<14&4294967295|R>>>18),R=T+(N^E&(P^N))+I[12]+2368359562&4294967295,T=P+(R<<20&4294967295|R>>>12),R=E+(T^P^N)+I[5]+4294588738&4294967295,E=T+(R<<4&4294967295|R>>>28),R=N+(E^T^P)+I[8]+2272392833&4294967295,N=E+(R<<11&4294967295|R>>>21),R=P+(N^E^T)+I[11]+1839030562&4294967295,P=N+(R<<16&4294967295|R>>>16),R=T+(P^N^E)+I[14]+4259657740&4294967295,T=P+(R<<23&4294967295|R>>>9),R=E+(T^P^N)+I[1]+2763975236&4294967295,E=T+(R<<4&4294967295|R>>>28),R=N+(E^T^P)+I[4]+1272893353&4294967295,N=E+(R<<11&4294967295|R>>>21),R=P+(N^E^T)+I[7]+4139469664&4294967295,P=N+(R<<16&4294967295|R>>>16),R=T+(P^N^E)+I[10]+3200236656&4294967295,T=P+(R<<23&4294967295|R>>>9),R=E+(T^P^N)+I[13]+681279174&4294967295,E=T+(R<<4&4294967295|R>>>28),R=N+(E^T^P)+I[0]+3936430074&4294967295,N=E+(R<<11&4294967295|R>>>21),R=P+(N^E^T)+I[3]+3572445317&4294967295,P=N+(R<<16&4294967295|R>>>16),R=T+(P^N^E)+I[6]+76029189&4294967295,T=P+(R<<23&4294967295|R>>>9),R=E+(T^P^N)+I[9]+3654602809&4294967295,E=T+(R<<4&4294967295|R>>>28),R=N+(E^T^P)+I[12]+3873151461&4294967295,N=E+(R<<11&4294967295|R>>>21),R=P+(N^E^T)+I[15]+530742520&4294967295,P=N+(R<<16&4294967295|R>>>16),R=T+(P^N^E)+I[2]+3299628645&4294967295,T=P+(R<<23&4294967295|R>>>9),R=E+(P^(T|~N))+I[0]+4096336452&4294967295,E=T+(R<<6&4294967295|R>>>26),R=N+(T^(E|~P))+I[7]+1126891415&4294967295,N=E+(R<<10&4294967295|R>>>22),R=P+(E^(N|~T))+I[14]+2878612391&4294967295,P=N+(R<<15&4294967295|R>>>17),R=T+(N^(P|~E))+I[5]+4237533241&4294967295,T=P+(R<<21&4294967295|R>>>11),R=E+(P^(T|~N))+I[12]+1700485571&4294967295,E=T+(R<<6&4294967295|R>>>26),R=N+(T^(E|~P))+I[3]+2399980690&4294967295,N=E+(R<<10&4294967295|R>>>22),R=P+(E^(N|~T))+I[10]+4293915773&4294967295,P=N+(R<<15&4294967295|R>>>17),R=T+(N^(P|~E))+I[1]+2240044497&4294967295,T=P+(R<<21&4294967295|R>>>11),R=E+(P^(T|~N))+I[8]+1873313359&4294967295,E=T+(R<<6&4294967295|R>>>26),R=N+(T^(E|~P))+I[15]+4264355552&4294967295,N=E+(R<<10&4294967295|R>>>22),R=P+(E^(N|~T))+I[6]+2734768916&4294967295,P=N+(R<<15&4294967295|R>>>17),R=T+(N^(P|~E))+I[13]+1309151649&4294967295,T=P+(R<<21&4294967295|R>>>11),R=E+(P^(T|~N))+I[4]+4149444226&4294967295,E=T+(R<<6&4294967295|R>>>26),R=N+(T^(E|~P))+I[11]+3174756917&4294967295,N=E+(R<<10&4294967295|R>>>22),R=P+(E^(N|~T))+I[2]+718787259&4294967295,P=N+(R<<15&4294967295|R>>>17),R=T+(N^(P|~E))+I[9]+3951481745&4294967295,x.g[0]=x.g[0]+E&4294967295,x.g[1]=x.g[1]+(P+(R<<21&4294967295|R>>>11))&4294967295,x.g[2]=x.g[2]+P&4294967295,x.g[3]=x.g[3]+N&4294967295}n.prototype.u=function(x,E){E===void 0&&(E=x.length);for(var T=E-this.blockSize,I=this.B,P=this.h,N=0;N<E;){if(P==0)for(;N<=T;)s(this,x,N),N+=this.blockSize;if(typeof x=="string"){for(;N<E;)if(I[P++]=x.charCodeAt(N++),P==this.blockSize){s(this,I),P=0;break}}else for(;N<E;)if(I[P++]=x[N++],P==this.blockSize){s(this,I),P=0;break}}this.h=P,this.o+=E},n.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var E=1;E<x.length-8;++E)x[E]=0;var T=8*this.o;for(E=x.length-8;E<x.length;++E)x[E]=T&255,T/=256;for(this.u(x),x=Array(16),E=T=0;4>E;++E)for(var I=0;32>I;I+=8)x[T++]=this.g[E]>>>I&255;return x};function i(x,E){var T=o;return Object.prototype.hasOwnProperty.call(T,x)?T[x]:T[x]=E(x)}function a(x,E){this.h=E;for(var T=[],I=!0,P=x.length-1;0<=P;P--){var N=x[P]|0;I&&N==E||(T[P]=N,I=!1)}this.g=T}var o={};function l(x){return-128<=x&&128>x?i(x,function(E){return new a([E|0],0>E?-1:0)}):new a([x|0],0>x?-1:0)}function c(x){if(isNaN(x)||!isFinite(x))return h;if(0>x)return y(c(-x));for(var E=[],T=1,I=0;x>=T;I++)E[I]=x/T|0,T*=4294967296;return new a(E,0)}function u(x,E){if(x.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(x.charAt(0)=="-")return y(u(x.substring(1),E));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=c(Math.pow(E,8)),I=h,P=0;P<x.length;P+=8){var N=Math.min(8,x.length-P),R=parseInt(x.substring(P,P+N),E);8>N?(N=c(Math.pow(E,N)),I=I.j(N).add(c(R))):(I=I.j(T),I=I.add(c(R)))}return I}var h=l(0),d=l(1),m=l(16777216);t=a.prototype,t.m=function(){if(g(this))return-y(this).m();for(var x=0,E=1,T=0;T<this.g.length;T++){var I=this.i(T);x+=(0<=I?I:4294967296+I)*E,E*=4294967296}return x},t.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(v(this))return"0";if(g(this))return"-"+y(this).toString(x);for(var E=c(Math.pow(x,6)),T=this,I="";;){var P=F(T,E).g;T=S(T,P.j(E));var N=((0<T.g.length?T.g[0]:T.h)>>>0).toString(x);if(T=P,v(T))return N+I;for(;6>N.length;)N="0"+N;I=N+I}},t.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function v(x){if(x.h!=0)return!1;for(var E=0;E<x.g.length;E++)if(x.g[E]!=0)return!1;return!0}function g(x){return x.h==-1}t.l=function(x){return x=S(this,x),g(x)?-1:v(x)?0:1};function y(x){for(var E=x.g.length,T=[],I=0;I<E;I++)T[I]=~x.g[I];return new a(T,~x.h).add(d)}t.abs=function(){return g(this)?y(this):this},t.add=function(x){for(var E=Math.max(this.g.length,x.g.length),T=[],I=0,P=0;P<=E;P++){var N=I+(this.i(P)&65535)+(x.i(P)&65535),R=(N>>>16)+(this.i(P)>>>16)+(x.i(P)>>>16);I=R>>>16,N&=65535,R&=65535,T[P]=R<<16|N}return new a(T,T[T.length-1]&-2147483648?-1:0)};function S(x,E){return x.add(y(E))}t.j=function(x){if(v(this)||v(x))return h;if(g(this))return g(x)?y(this).j(y(x)):y(y(this).j(x));if(g(x))return y(this.j(y(x)));if(0>this.l(m)&&0>x.l(m))return c(this.m()*x.m());for(var E=this.g.length+x.g.length,T=[],I=0;I<2*E;I++)T[I]=0;for(I=0;I<this.g.length;I++)for(var P=0;P<x.g.length;P++){var N=this.i(I)>>>16,R=this.i(I)&65535,se=x.i(P)>>>16,ae=x.i(P)&65535;T[2*I+2*P]+=R*ae,k(T,2*I+2*P),T[2*I+2*P+1]+=N*ae,k(T,2*I+2*P+1),T[2*I+2*P+1]+=R*se,k(T,2*I+2*P+1),T[2*I+2*P+2]+=N*se,k(T,2*I+2*P+2)}for(I=0;I<E;I++)T[I]=T[2*I+1]<<16|T[2*I];for(I=E;I<2*E;I++)T[I]=0;return new a(T,0)};function k(x,E){for(;(x[E]&65535)!=x[E];)x[E+1]+=x[E]>>>16,x[E]&=65535,E++}function w(x,E){this.g=x,this.h=E}function F(x,E){if(v(E))throw Error("division by zero");if(v(x))return new w(h,h);if(g(x))return E=F(y(x),E),new w(y(E.g),y(E.h));if(g(E))return E=F(x,y(E)),new w(y(E.g),E.h);if(30<x.g.length){if(g(x)||g(E))throw Error("slowDivide_ only works with positive integers.");for(var T=d,I=E;0>=I.l(x);)T=B(T),I=B(I);var P=V(T,1),N=V(I,1);for(I=V(I,2),T=V(T,2);!v(I);){var R=N.add(I);0>=R.l(x)&&(P=P.add(T),N=R),I=V(I,1),T=V(T,1)}return E=S(x,P.j(E)),new w(P,E)}for(P=h;0<=x.l(E);){for(T=Math.max(1,Math.floor(x.m()/E.m())),I=Math.ceil(Math.log(T)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),N=c(T),R=N.j(E);g(R)||0<R.l(x);)T-=I,N=c(T),R=N.j(E);v(N)&&(N=d),P=P.add(N),x=S(x,R)}return new w(P,x)}t.A=function(x){return F(this,x).h},t.and=function(x){for(var E=Math.max(this.g.length,x.g.length),T=[],I=0;I<E;I++)T[I]=this.i(I)&x.i(I);return new a(T,this.h&x.h)},t.or=function(x){for(var E=Math.max(this.g.length,x.g.length),T=[],I=0;I<E;I++)T[I]=this.i(I)|x.i(I);return new a(T,this.h|x.h)},t.xor=function(x){for(var E=Math.max(this.g.length,x.g.length),T=[],I=0;I<E;I++)T[I]=this.i(I)^x.i(I);return new a(T,this.h^x.h)};function B(x){for(var E=x.g.length+1,T=[],I=0;I<E;I++)T[I]=x.i(I)<<1|x.i(I-1)>>>31;return new a(T,x.h)}function V(x,E){var T=E>>5;E%=32;for(var I=x.g.length-T,P=[],N=0;N<I;N++)P[N]=0<E?x.i(N+T)>>>E|x.i(N+T+1)<<32-E:x.i(N+T);return new a(P,x.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,mk=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=u,Fa=a}).apply(typeof q_<"u"?q_:typeof self<"u"?self:typeof window<"u"?window:{});var wf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var gk,ec,vk,Jf,um,xk,_k,yk;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,_,A){return f==Array.prototype||f==Object.prototype||(f[_]=A.value),f};function r(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof wf=="object"&&wf];for(var _=0;_<f.length;++_){var A=f[_];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var n=r(this);function s(f,_){if(_)e:{var A=n;f=f.split(".");for(var j=0;j<f.length-1;j++){var re=f[j];if(!(re in A))break e;A=A[re]}f=f[f.length-1],j=A[f],_=_(j),_!=j&&_!=null&&e(A,f,{configurable:!0,writable:!0,value:_})}}function i(f,_){f instanceof String&&(f+="");var A=0,j=!1,re={next:function(){if(!j&&A<f.length){var ie=A++;return{value:_(ie,f[ie]),done:!1}}return j=!0,{done:!0,value:void 0}}};return re[Symbol.iterator]=function(){return re},re}s("Array.prototype.values",function(f){return f||function(){return i(this,function(_,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(f){var _=typeof f;return _=_!="object"?_:f?Array.isArray(f)?"array":_:"null",_=="array"||_=="object"&&typeof f.length=="number"}function c(f){var _=typeof f;return _=="object"&&f!=null||_=="function"}function u(f,_,A){return f.call.apply(f.bind,arguments)}function h(f,_,A){if(!f)throw Error();if(2<arguments.length){var j=Array.prototype.slice.call(arguments,2);return function(){var re=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(re,j),f.apply(_,re)}}return function(){return f.apply(_,arguments)}}function d(f,_,A){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:h,d.apply(null,arguments)}function m(f,_){var A=Array.prototype.slice.call(arguments,1);return function(){var j=A.slice();return j.push.apply(j,arguments),f.apply(this,j)}}function v(f,_){function A(){}A.prototype=_.prototype,f.aa=_.prototype,f.prototype=new A,f.prototype.constructor=f,f.Qb=function(j,re,ie){for(var ke=Array(arguments.length-2),_t=2;_t<arguments.length;_t++)ke[_t-2]=arguments[_t];return _.prototype[re].apply(j,ke)}}function g(f){const _=f.length;if(0<_){const A=Array(_);for(let j=0;j<_;j++)A[j]=f[j];return A}return[]}function y(f,_){for(let A=1;A<arguments.length;A++){const j=arguments[A];if(l(j)){const re=f.length||0,ie=j.length||0;f.length=re+ie;for(let ke=0;ke<ie;ke++)f[re+ke]=j[ke]}else f.push(j)}}class S{constructor(_,A){this.i=_,this.j=A,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function k(f){return/^[\s\xa0]*$/.test(f)}function w(){var f=o.navigator;return f&&(f=f.userAgent)?f:""}function F(f){return F[" "](f),f}F[" "]=function(){};var B=w().indexOf("Gecko")!=-1&&!(w().toLowerCase().indexOf("webkit")!=-1&&w().indexOf("Edge")==-1)&&!(w().indexOf("Trident")!=-1||w().indexOf("MSIE")!=-1)&&w().indexOf("Edge")==-1;function V(f,_,A){for(const j in f)_.call(A,f[j],j,f)}function x(f,_){for(const A in f)_.call(void 0,f[A],A,f)}function E(f){const _={};for(const A in f)_[A]=f[A];return _}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(f,_){let A,j;for(let re=1;re<arguments.length;re++){j=arguments[re];for(A in j)f[A]=j[A];for(let ie=0;ie<T.length;ie++)A=T[ie],Object.prototype.hasOwnProperty.call(j,A)&&(f[A]=j[A])}}function P(f){var _=1;f=f.split(":");const A=[];for(;0<_&&f.length;)A.push(f.shift()),_--;return f.length&&A.push(f.join(":")),A}function N(f){o.setTimeout(()=>{throw f},0)}function R(){var f=K;let _=null;return f.g&&(_=f.g,f.g=f.g.next,f.g||(f.h=null),_.next=null),_}class se{constructor(){this.h=this.g=null}add(_,A){const j=ae.get();j.set(_,A),this.h?this.h.next=j:this.g=j,this.h=j}}var ae=new S(()=>new fe,f=>f.reset());class fe{constructor(){this.next=this.g=this.h=null}set(_,A){this.h=_,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let ge,oe=!1,K=new se,he=()=>{const f=o.Promise.resolve(void 0);ge=()=>{f.then(we)}};var we=()=>{for(var f;f=R();){try{f.h.call(f.g)}catch(A){N(A)}var _=ae;_.j(f),100>_.h&&(_.h++,f.next=_.g,_.g=f)}oe=!1};function U(){this.s=this.s,this.C=this.C}U.prototype.s=!1,U.prototype.ma=function(){this.s||(this.s=!0,this.N())},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function q(f,_){this.type=f,this.g=this.target=_,this.defaultPrevented=!1}q.prototype.h=function(){this.defaultPrevented=!0};var Y=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var f=!1,_=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const A=()=>{};o.addEventListener("test",A,_),o.removeEventListener("test",A,_)}catch{}return f}();function G(f,_){if(q.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var A=this.type=f.type,j=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=_,_=f.relatedTarget){if(B){e:{try{F(_.nodeName);var re=!0;break e}catch{}re=!1}re||(_=null)}}else A=="mouseover"?_=f.fromElement:A=="mouseout"&&(_=f.toElement);this.relatedTarget=_,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:le[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&G.aa.h.call(this)}}v(G,q);var le={2:"touch",3:"pen",4:"mouse"};G.prototype.h=function(){G.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var xe="closure_listenable_"+(1e6*Math.random()|0),Re=0;function Te(f,_,A,j,re){this.listener=f,this.proxy=null,this.src=_,this.type=A,this.capture=!!j,this.ha=re,this.key=++Re,this.da=this.fa=!1}function ve(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function $e(f){this.src=f,this.g={},this.h=0}$e.prototype.add=function(f,_,A,j,re){var ie=f.toString();f=this.g[ie],f||(f=this.g[ie]=[],this.h++);var ke=at(f,_,j,re);return-1<ke?(_=f[ke],A||(_.fa=!1)):(_=new Te(_,this.src,ie,!!j,re),_.fa=A,f.push(_)),_};function z(f,_){var A=_.type;if(A in f.g){var j=f.g[A],re=Array.prototype.indexOf.call(j,_,void 0),ie;(ie=0<=re)&&Array.prototype.splice.call(j,re,1),ie&&(ve(_),f.g[A].length==0&&(delete f.g[A],f.h--))}}function at(f,_,A,j){for(var re=0;re<f.length;++re){var ie=f[re];if(!ie.da&&ie.listener==_&&ie.capture==!!A&&ie.ha==j)return re}return-1}var We="closure_lm_"+(1e6*Math.random()|0),rt={};function be(f,_,A,j,re){if(Array.isArray(_)){for(var ie=0;ie<_.length;ie++)be(f,_[ie],A,j,re);return null}return A=lr(A),f&&f[xe]?f.K(_,A,c(j)?!!j.capture:!1,re):Ae(f,_,A,!1,j,re)}function Ae(f,_,A,j,re,ie){if(!_)throw Error("Invalid event type");var ke=c(re)?!!re.capture:!!re,_t=tn(f);if(_t||(f[We]=_t=new $e(f)),A=_t.add(_,A,j,ke,ie),A.proxy)return A;if(j=Tt(),A.proxy=j,j.src=f,j.listener=A,f.addEventListener)Y||(re=ke),re===void 0&&(re=!1),f.addEventListener(_.toString(),j,re);else if(f.attachEvent)f.attachEvent(en(_.toString()),j);else if(f.addListener&&f.removeListener)f.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return A}function Tt(){function f(A){return _.call(f.src,f.listener,A)}const _=Os;return f}function or(f,_,A,j,re){if(Array.isArray(_))for(var ie=0;ie<_.length;ie++)or(f,_[ie],A,j,re);else j=c(j)?!!j.capture:!!j,A=lr(A),f&&f[xe]?(f=f.i,_=String(_).toString(),_ in f.g&&(ie=f.g[_],A=at(ie,A,j,re),-1<A&&(ve(ie[A]),Array.prototype.splice.call(ie,A,1),ie.length==0&&(delete f.g[_],f.h--)))):f&&(f=tn(f))&&(_=f.g[_.toString()],f=-1,_&&(f=at(_,A,j,re)),(A=-1<f?_[f]:null)&&Ar(A))}function Ar(f){if(typeof f!="number"&&f&&!f.da){var _=f.src;if(_&&_[xe])z(_.i,f);else{var A=f.type,j=f.proxy;_.removeEventListener?_.removeEventListener(A,j,f.capture):_.detachEvent?_.detachEvent(en(A),j):_.addListener&&_.removeListener&&_.removeListener(j),(A=tn(_))?(z(A,f),A.h==0&&(A.src=null,_[We]=null)):ve(f)}}}function en(f){return f in rt?rt[f]:rt[f]="on"+f}function Os(f,_){if(f.da)f=!0;else{_=new G(_,this);var A=f.listener,j=f.ha||f.src;f.fa&&Ar(f),f=A.call(j,_)}return f}function tn(f){return f=f[We],f instanceof $e?f:null}var kt="__closure_events_fn_"+(1e9*Math.random()>>>0);function lr(f){return typeof f=="function"?f:(f[kt]||(f[kt]=function(_){return f.handleEvent(_)}),f[kt])}function vt(){U.call(this),this.i=new $e(this),this.M=this,this.F=null}v(vt,U),vt.prototype[xe]=!0,vt.prototype.removeEventListener=function(f,_,A,j){or(this,f,_,A,j)};function St(f,_){var A,j=f.F;if(j)for(A=[];j;j=j.F)A.push(j);if(f=f.M,j=_.type||_,typeof _=="string")_=new q(_,f);else if(_ instanceof q)_.target=_.target||f;else{var re=_;_=new q(j,f),I(_,re)}if(re=!0,A)for(var ie=A.length-1;0<=ie;ie--){var ke=_.g=A[ie];re=ht(ke,j,!0,_)&&re}if(ke=_.g=f,re=ht(ke,j,!0,_)&&re,re=ht(ke,j,!1,_)&&re,A)for(ie=0;ie<A.length;ie++)ke=_.g=A[ie],re=ht(ke,j,!1,_)&&re}vt.prototype.N=function(){if(vt.aa.N.call(this),this.i){var f=this.i,_;for(_ in f.g){for(var A=f.g[_],j=0;j<A.length;j++)ve(A[j]);delete f.g[_],f.h--}}this.F=null},vt.prototype.K=function(f,_,A,j){return this.i.add(String(f),_,!1,A,j)},vt.prototype.L=function(f,_,A,j){return this.i.add(String(f),_,!0,A,j)};function ht(f,_,A,j){if(_=f.i.g[String(_)],!_)return!0;_=_.concat();for(var re=!0,ie=0;ie<_.length;++ie){var ke=_[ie];if(ke&&!ke.da&&ke.capture==A){var _t=ke.listener,mr=ke.ha||ke.src;ke.fa&&z(f.i,ke),re=_t.call(mr,j)!==!1&&re}}return re&&!j.defaultPrevented}function Dt(f,_,A){if(typeof f=="function")A&&(f=d(f,A));else if(f&&typeof f.handleEvent=="function")f=d(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:o.setTimeout(f,_||0)}function je(f){f.g=Dt(()=>{f.g=null,f.i&&(f.i=!1,je(f))},f.l);const _=f.h;f.h=null,f.m.apply(null,_)}class xt extends U{constructor(_,A){super(),this.m=_,this.l=A,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:je(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Wt(f){U.call(this),this.h=f,this.g={}}v(Wt,U);var ut=[];function hn(f){V(f.g,function(_,A){this.g.hasOwnProperty(A)&&Ar(_)},f),f.g={}}Wt.prototype.N=function(){Wt.aa.N.call(this),hn(this)},Wt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ms=o.JSON.stringify,uo=o.JSON.parse,Cl=class{stringify(f){return o.JSON.stringify(f,void 0)}parse(f){return o.JSON.parse(f,void 0)}};function Ls(){}Ls.prototype.h=null;function cs(f){return f.h||(f.h=f.i())}function _i(){}var Bn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function js(){q.call(this,"d")}v(js,q);function us(){q.call(this,"c")}v(us,q);var Sn={},fo=null;function Vs(){return fo=fo||new vt}Sn.La="serverreachability";function Us(f){q.call(this,Sn.La,f)}v(Us,q);function An(f){const _=Vs();St(_,new Us(_))}Sn.STAT_EVENT="statevent";function ho(f,_){q.call(this,Sn.STAT_EVENT,f),this.stat=_}v(ho,q);function Zt(f){const _=Vs();St(_,new ho(_,f))}Sn.Ma="timingevent";function H(f,_){q.call(this,Sn.Ma,f),this.size=_}v(H,q);function J(f,_){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){f()},_)}function ne(){this.g=!0}ne.prototype.xa=function(){this.g=!1};function de(f,_,A,j,re,ie){f.info(function(){if(f.g)if(ie)for(var ke="",_t=ie.split("&"),mr=0;mr<_t.length;mr++){var ot=_t[mr].split("=");if(1<ot.length){var Ir=ot[0];ot=ot[1];var Cr=Ir.split("_");ke=2<=Cr.length&&Cr[1]=="type"?ke+(Ir+"="+ot+"&"):ke+(Ir+"=redacted&")}}else ke=null;else ke=ie;return"XMLHTTP REQ ("+j+") [attempt "+re+"]: "+_+`
`+A+`
`+ke})}function Se(f,_,A,j,re,ie,ke){f.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+re+"]: "+_+`
`+A+`
`+ie+" "+ke})}function C(f,_,A,j){f.info(function(){return"XMLHTTP TEXT ("+_+"): "+D(f,A)+(j?" "+j:"")})}function L(f,_){f.info(function(){return"TIMEOUT: "+_})}ne.prototype.info=function(){};function D(f,_){if(!f.g)return _;if(!_)return null;try{var A=JSON.parse(_);if(A){for(f=0;f<A.length;f++)if(Array.isArray(A[f])){var j=A[f];if(!(2>j.length)){var re=j[1];if(Array.isArray(re)&&!(1>re.length)){var ie=re[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(var ke=1;ke<re.length;ke++)re[ke]=""}}}}return Ms(A)}catch{return _}}var b={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},O={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},M;function X(){}v(X,Ls),X.prototype.g=function(){return new XMLHttpRequest},X.prototype.i=function(){return{}},M=new X;function te(f,_,A,j){this.j=f,this.i=_,this.l=A,this.R=j||1,this.U=new Wt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ee}function ee(){this.i=null,this.g="",this.h=!1}var Z={},Q={};function ce(f,_,A){f.L=1,f.v=Gu(Bs(_)),f.m=A,f.P=!0,ye(f,null)}function ye(f,_){f.F=Date.now(),Ee(f),f.A=Bs(f.v);var A=f.A,j=f.R;Array.isArray(j)||(j=[String(j)]),kx(A.i,"t",j),f.C=0,A=f.j.J,f.h=new ee,f.g=zx(f.j,A?_:null,!f.m),0<f.O&&(f.M=new xt(d(f.Y,f,f.g),f.O)),_=f.U,A=f.g,j=f.ca;var re="readystatechange";Array.isArray(re)||(re&&(ut[0]=re.toString()),re=ut);for(var ie=0;ie<re.length;ie++){var ke=be(A,re[ie],j||_.handleEvent,!1,_.h||_);if(!ke)break;_.g[ke.key]=ke}_=f.H?E(f.H):{},f.m?(f.u||(f.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,_)):(f.u="GET",f.g.ea(f.A,f.u,null,_)),An(),de(f.i,f.u,f.A,f.l,f.R,f.m)}te.prototype.ca=function(f){f=f.target;const _=this.M;_&&zs(f)==3?_.j():this.Y(f)},te.prototype.Y=function(f){try{if(f==this.g)e:{const Cr=zs(this.g);var _=this.g.Ba();const go=this.g.Z();if(!(3>Cr)&&(Cr!=3||this.g&&(this.h.h||this.g.oa()||Px(this.g)))){this.J||Cr!=4||_==7||(_==8||0>=go?An(3):An(2)),nt(this);var A=this.g.Z();this.X=A;t:if(Ie(this)){var j=Px(this.g);f="";var re=j.length,ie=zs(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){dt(this),Ke(this);var ke="";break t}this.h.i=new o.TextDecoder}for(_=0;_<re;_++)this.h.h=!0,f+=this.h.i.decode(j[_],{stream:!(ie&&_==re-1)});j.length=0,this.h.g+=f,this.C=0,ke=this.h.g}else ke=this.g.oa();if(this.o=A==200,Se(this.i,this.u,this.A,this.l,this.R,Cr,A),this.o){if(this.T&&!this.K){t:{if(this.g){var _t,mr=this.g;if((_t=mr.g?mr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(_t)){var ot=_t;break t}}ot=null}if(A=ot)C(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,rn(this,A);else{this.o=!1,this.s=3,Zt(12),dt(this),Ke(this);break e}}if(this.P){A=!0;let zn;for(;!this.J&&this.C<ke.length;)if(zn=pe(this,ke),zn==Q){Cr==4&&(this.s=4,Zt(14),A=!1),C(this.i,this.l,null,"[Incomplete Response]");break}else if(zn==Z){this.s=4,Zt(15),C(this.i,this.l,ke,"[Invalid Chunk]"),A=!1;break}else C(this.i,this.l,zn,null),rn(this,zn);if(Ie(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Cr!=4||ke.length!=0||this.h.h||(this.s=1,Zt(16),A=!1),this.o=this.o&&A,!A)C(this.i,this.l,ke,"[Invalid Chunked Response]"),dt(this),Ke(this);else if(0<ke.length&&!this.W){this.W=!0;var Ir=this.j;Ir.g==this&&Ir.ba&&!Ir.M&&(Ir.j.info("Great, no buffering proxy detected. Bytes received: "+ke.length),i0(Ir),Ir.M=!0,Zt(11))}}else C(this.i,this.l,ke,null),rn(this,ke);Cr==4&&dt(this),this.o&&!this.J&&(Cr==4?jx(this.j,this):(this.o=!1,Ee(this)))}else $I(this.g),A==400&&0<ke.indexOf("Unknown SID")?(this.s=3,Zt(12)):(this.s=0,Zt(13)),dt(this),Ke(this)}}}catch{}finally{}};function Ie(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function pe(f,_){var A=f.C,j=_.indexOf(`
`,A);return j==-1?Q:(A=Number(_.substring(A,j)),isNaN(A)?Z:(j+=1,j+A>_.length?Q:(_=_.slice(j,j+A),f.C=j+A,_)))}te.prototype.cancel=function(){this.J=!0,dt(this)};function Ee(f){f.S=Date.now()+f.I,Fe(f,f.I)}function Fe(f,_){if(f.B!=null)throw Error("WatchDog timer not null");f.B=J(d(f.ba,f),_)}function nt(f){f.B&&(o.clearTimeout(f.B),f.B=null)}te.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(L(this.i,this.A),this.L!=2&&(An(),Zt(17)),dt(this),this.s=2,Ke(this)):Fe(this,this.S-f)};function Ke(f){f.j.G==0||f.J||jx(f.j,f)}function dt(f){nt(f);var _=f.M;_&&typeof _.ma=="function"&&_.ma(),f.M=null,hn(f.U),f.g&&(_=f.g,f.g=null,_.abort(),_.ma())}function rn(f,_){try{var A=f.j;if(A.G!=0&&(A.g==f||Je(A.h,f))){if(!f.K&&Je(A.h,f)&&A.G==3){try{var j=A.Da.g.parse(_)}catch{j=null}if(Array.isArray(j)&&j.length==3){var re=j;if(re[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<f.F)Ju(A),Yu(A);else break e;s0(A),Zt(18)}}else A.za=re[1],0<A.za-A.T&&37500>re[2]&&A.F&&A.v==0&&!A.C&&(A.C=J(d(A.Za,A),6e3));if(1>=In(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else ma(A,11)}else if((f.K||A.g==f)&&Ju(A),!k(_))for(re=A.Da.g.parse(_),_=0;_<re.length;_++){let ot=re[_];if(A.T=ot[0],ot=ot[1],A.G==2)if(ot[0]=="c"){A.K=ot[1],A.ia=ot[2];const Ir=ot[3];Ir!=null&&(A.la=Ir,A.j.info("VER="+A.la));const Cr=ot[4];Cr!=null&&(A.Aa=Cr,A.j.info("SVER="+A.Aa));const go=ot[5];go!=null&&typeof go=="number"&&0<go&&(j=1.5*go,A.L=j,A.j.info("backChannelRequestTimeoutMs_="+j)),j=A;const zn=f.g;if(zn){const ef=zn.g?zn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ef){var ie=j.h;ie.g||ef.indexOf("spdy")==-1&&ef.indexOf("quic")==-1&&ef.indexOf("h2")==-1||(ie.j=ie.l,ie.g=new Set,ie.h&&(fs(ie,ie.h),ie.h=null))}if(j.D){const a0=zn.g?zn.g.getResponseHeader("X-HTTP-Session-Id"):null;a0&&(j.ya=a0,At(j.I,j.D,a0))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-f.F,A.j.info("Handshake RTT: "+A.R+"ms")),j=A;var ke=f;if(j.qa=Bx(j,j.J?j.ia:null,j.W),ke.K){Rl(j.h,ke);var _t=ke,mr=j.L;mr&&(_t.I=mr),_t.B&&(nt(_t),Ee(_t)),j.g=ke}else Mx(j);0<A.i.length&&Qu(A)}else ot[0]!="stop"&&ot[0]!="close"||ma(A,7);else A.G==3&&(ot[0]=="stop"||ot[0]=="close"?ot[0]=="stop"?ma(A,7):n0(A):ot[0]!="noop"&&A.l&&A.l.ta(ot),A.v=0)}}An(4)}catch{}}var He=class{constructor(f,_){this.g=f,this.map=_}};function ft(f){this.l=f||10,o.PerformanceNavigationTiming?(f=o.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function pr(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function In(f){return f.h?1:f.g?f.g.size:0}function Je(f,_){return f.h?f.h==_:f.g?f.g.has(_):!1}function fs(f,_){f.g?f.g.add(_):f.h=_}function Rl(f,_){f.h&&f.h==_?f.h=null:f.g&&f.g.has(_)&&f.g.delete(_)}ft.prototype.cancel=function(){if(this.i=$u(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function $u(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let _=f.i;for(const A of f.g.values())_=_.concat(A.D);return _}return g(f.i)}function CI(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(l(f)){for(var _=[],A=f.length,j=0;j<A;j++)_.push(f[j]);return _}_=[],A=0;for(j in f)_[A++]=f[j];return _}function RI(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(l(f)||typeof f=="string"){var _=[];f=f.length;for(var A=0;A<f;A++)_.push(A);return _}_=[],A=0;for(const j in f)_[A++]=j;return _}}}function xx(f,_){if(f.forEach&&typeof f.forEach=="function")f.forEach(_,void 0);else if(l(f)||typeof f=="string")Array.prototype.forEach.call(f,_,void 0);else for(var A=RI(f),j=CI(f),re=j.length,ie=0;ie<re;ie++)_.call(void 0,j[ie],A&&A[ie],f)}var _x=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function NI(f,_){if(f){f=f.split("&");for(var A=0;A<f.length;A++){var j=f[A].indexOf("="),re=null;if(0<=j){var ie=f[A].substring(0,j);re=f[A].substring(j+1)}else ie=f[A];_(ie,re?decodeURIComponent(re.replace(/\+/g," ")):"")}}}function pa(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof pa){this.h=f.h,Hu(this,f.j),this.o=f.o,this.g=f.g,Wu(this,f.s),this.l=f.l;var _=f.i,A=new Dl;A.i=_.i,_.g&&(A.g=new Map(_.g),A.h=_.h),yx(this,A),this.m=f.m}else f&&(_=String(f).match(_x))?(this.h=!1,Hu(this,_[1]||"",!0),this.o=Nl(_[2]||""),this.g=Nl(_[3]||"",!0),Wu(this,_[4]),this.l=Nl(_[5]||"",!0),yx(this,_[6]||"",!0),this.m=Nl(_[7]||"")):(this.h=!1,this.i=new Dl(null,this.h))}pa.prototype.toString=function(){var f=[],_=this.j;_&&f.push(Pl(_,wx,!0),":");var A=this.g;return(A||_=="file")&&(f.push("//"),(_=this.o)&&f.push(Pl(_,wx,!0),"@"),f.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&f.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&f.push("/"),f.push(Pl(A,A.charAt(0)=="/"?FI:DI,!0))),(A=this.i.toString())&&f.push("?",A),(A=this.m)&&f.push("#",Pl(A,OI)),f.join("")};function Bs(f){return new pa(f)}function Hu(f,_,A){f.j=A?Nl(_,!0):_,f.j&&(f.j=f.j.replace(/:$/,""))}function Wu(f,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);f.s=_}else f.s=null}function yx(f,_,A){_ instanceof Dl?(f.i=_,MI(f.i,f.h)):(A||(_=Pl(_,bI)),f.i=new Dl(_,f.h))}function At(f,_,A){f.i.set(_,A)}function Gu(f){return At(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Nl(f,_){return f?_?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Pl(f,_,A){return typeof f=="string"?(f=encodeURI(f).replace(_,PI),A&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function PI(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var wx=/[#\/\?@]/g,DI=/[#\?:]/g,FI=/[#\?]/g,bI=/[#\?@]/g,OI=/#/g;function Dl(f,_){this.h=this.g=null,this.i=f||null,this.j=!!_}function yi(f){f.g||(f.g=new Map,f.h=0,f.i&&NI(f.i,function(_,A){f.add(decodeURIComponent(_.replace(/\+/g," ")),A)}))}t=Dl.prototype,t.add=function(f,_){yi(this),this.i=null,f=po(this,f);var A=this.g.get(f);return A||this.g.set(f,A=[]),A.push(_),this.h+=1,this};function Ex(f,_){yi(f),_=po(f,_),f.g.has(_)&&(f.i=null,f.h-=f.g.get(_).length,f.g.delete(_))}function Tx(f,_){return yi(f),_=po(f,_),f.g.has(_)}t.forEach=function(f,_){yi(this),this.g.forEach(function(A,j){A.forEach(function(re){f.call(_,re,j,this)},this)},this)},t.na=function(){yi(this);const f=Array.from(this.g.values()),_=Array.from(this.g.keys()),A=[];for(let j=0;j<_.length;j++){const re=f[j];for(let ie=0;ie<re.length;ie++)A.push(_[j])}return A},t.V=function(f){yi(this);let _=[];if(typeof f=="string")Tx(this,f)&&(_=_.concat(this.g.get(po(this,f))));else{f=Array.from(this.g.values());for(let A=0;A<f.length;A++)_=_.concat(f[A])}return _},t.set=function(f,_){return yi(this),this.i=null,f=po(this,f),Tx(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[_]),this.h+=1,this},t.get=function(f,_){return f?(f=this.V(f),0<f.length?String(f[0]):_):_};function kx(f,_,A){Ex(f,_),0<A.length&&(f.i=null,f.g.set(po(f,_),g(A)),f.h+=A.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],_=Array.from(this.g.keys());for(var A=0;A<_.length;A++){var j=_[A];const ie=encodeURIComponent(String(j)),ke=this.V(j);for(j=0;j<ke.length;j++){var re=ie;ke[j]!==""&&(re+="="+encodeURIComponent(String(ke[j]))),f.push(re)}}return this.i=f.join("&")};function po(f,_){return _=String(_),f.j&&(_=_.toLowerCase()),_}function MI(f,_){_&&!f.j&&(yi(f),f.i=null,f.g.forEach(function(A,j){var re=j.toLowerCase();j!=re&&(Ex(this,j),kx(this,re,A))},f)),f.j=_}function LI(f,_){const A=new ne;if(o.Image){const j=new Image;j.onload=m(wi,A,"TestLoadImage: loaded",!0,_,j),j.onerror=m(wi,A,"TestLoadImage: error",!1,_,j),j.onabort=m(wi,A,"TestLoadImage: abort",!1,_,j),j.ontimeout=m(wi,A,"TestLoadImage: timeout",!1,_,j),o.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=f}else _(!1)}function jI(f,_){const A=new ne,j=new AbortController,re=setTimeout(()=>{j.abort(),wi(A,"TestPingServer: timeout",!1,_)},1e4);fetch(f,{signal:j.signal}).then(ie=>{clearTimeout(re),ie.ok?wi(A,"TestPingServer: ok",!0,_):wi(A,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(re),wi(A,"TestPingServer: error",!1,_)})}function wi(f,_,A,j,re){try{re&&(re.onload=null,re.onerror=null,re.onabort=null,re.ontimeout=null),j(A)}catch{}}function VI(){this.g=new Cl}function UI(f,_,A){const j=A||"";try{xx(f,function(re,ie){let ke=re;c(re)&&(ke=Ms(re)),_.push(j+ie+"="+encodeURIComponent(ke))})}catch(re){throw _.push(j+"type="+encodeURIComponent("_badmap")),re}}function Ku(f){this.l=f.Ub||null,this.j=f.eb||!1}v(Ku,Ls),Ku.prototype.g=function(){return new qu(this.l,this.j)},Ku.prototype.i=function(f){return function(){return f}}({});function qu(f,_){vt.call(this),this.D=f,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(qu,vt),t=qu.prototype,t.open=function(f,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=_,this.readyState=1,bl(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(_.body=f),(this.D||o).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Fl(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,bl(this)),this.g&&(this.readyState=3,bl(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Sx(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function Sx(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var _=f.value?f.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!f.done}))&&(this.response=this.responseText+=_)}f.done?Fl(this):bl(this),this.readyState==3&&Sx(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,Fl(this))},t.Qa=function(f){this.g&&(this.response=f,Fl(this))},t.ga=function(){this.g&&Fl(this)};function Fl(f){f.readyState=4,f.l=null,f.j=null,f.v=null,bl(f)}t.setRequestHeader=function(f,_){this.u.append(f,_)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],_=this.h.entries();for(var A=_.next();!A.done;)A=A.value,f.push(A[0]+": "+A[1]),A=_.next();return f.join(`\r
`)};function bl(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(qu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Ax(f){let _="";return V(f,function(A,j){_+=j,_+=":",_+=A,_+=`\r
`}),_}function r0(f,_,A){e:{for(j in A){var j=!1;break e}j=!0}j||(A=Ax(A),typeof f=="string"?A!=null&&encodeURIComponent(String(A)):At(f,_,A))}function Lt(f){vt.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(Lt,vt);var BI=/^https?$/i,zI=["POST","PUT"];t=Lt.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,_,A,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);_=_?_.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():M.g(),this.v=this.o?cs(this.o):cs(M),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(_,String(f),!0),this.B=!1}catch(ie){Ix(this,ie);return}if(f=A||"",A=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var re in j)A.set(re,j[re]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const ie of j.keys())A.set(ie,j.get(ie));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(A.keys()).find(ie=>ie.toLowerCase()=="content-type"),re=o.FormData&&f instanceof o.FormData,!(0<=Array.prototype.indexOf.call(zI,_,void 0))||j||re||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ie,ke]of A)this.g.setRequestHeader(ie,ke);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Nx(this),this.u=!0,this.g.send(f),this.u=!1}catch(ie){Ix(this,ie)}};function Ix(f,_){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=_,f.m=5,Cx(f),Xu(f)}function Cx(f){f.A||(f.A=!0,St(f,"complete"),St(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,St(this,"complete"),St(this,"abort"),Xu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xu(this,!0)),Lt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Rx(this):this.bb())},t.bb=function(){Rx(this)};function Rx(f){if(f.h&&typeof a<"u"&&(!f.v[1]||zs(f)!=4||f.Z()!=2)){if(f.u&&zs(f)==4)Dt(f.Ea,0,f);else if(St(f,"readystatechange"),zs(f)==4){f.h=!1;try{const ke=f.Z();e:switch(ke){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var A;if(!(A=_)){var j;if(j=ke===0){var re=String(f.D).match(_x)[1]||null;!re&&o.self&&o.self.location&&(re=o.self.location.protocol.slice(0,-1)),j=!BI.test(re?re.toLowerCase():"")}A=j}if(A)St(f,"complete"),St(f,"success");else{f.m=6;try{var ie=2<zs(f)?f.g.statusText:""}catch{ie=""}f.l=ie+" ["+f.Z()+"]",Cx(f)}}finally{Xu(f)}}}}function Xu(f,_){if(f.g){Nx(f);const A=f.g,j=f.v[0]?()=>{}:null;f.g=null,f.v=null,_||St(f,"ready");try{A.onreadystatechange=j}catch{}}}function Nx(f){f.I&&(o.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function zs(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<zs(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var _=this.g.responseText;return f&&_.indexOf(f)==0&&(_=_.substring(f.length)),uo(_)}};function Px(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function $I(f){const _={};f=(f.g&&2<=zs(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<f.length;j++){if(k(f[j]))continue;var A=P(f[j]);const re=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const ie=_[re]||[];_[re]=ie,ie.push(A)}x(_,function(j){return j.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ol(f,_,A){return A&&A.internalChannelParams&&A.internalChannelParams[f]||_}function Dx(f){this.Aa=0,this.i=[],this.j=new ne,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ol("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ol("baseRetryDelayMs",5e3,f),this.cb=Ol("retryDelaySeedMs",1e4,f),this.Wa=Ol("forwardChannelMaxRetries",2,f),this.wa=Ol("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new ft(f&&f.concurrentRequestLimit),this.Da=new VI,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Dx.prototype,t.la=8,t.G=1,t.connect=function(f,_,A,j){Zt(0),this.W=f,this.H=_||{},A&&j!==void 0&&(this.H.OSID=A,this.H.OAID=j),this.F=this.X,this.I=Bx(this,null,this.W),Qu(this)};function n0(f){if(Fx(f),f.G==3){var _=f.U++,A=Bs(f.I);if(At(A,"SID",f.K),At(A,"RID",_),At(A,"TYPE","terminate"),Ml(f,A),_=new te(f,f.j,_),_.L=2,_.v=Gu(Bs(A)),A=!1,o.navigator&&o.navigator.sendBeacon)try{A=o.navigator.sendBeacon(_.v.toString(),"")}catch{}!A&&o.Image&&(new Image().src=_.v,A=!0),A||(_.g=zx(_.j,null),_.g.ea(_.v)),_.F=Date.now(),Ee(_)}Ux(f)}function Yu(f){f.g&&(i0(f),f.g.cancel(),f.g=null)}function Fx(f){Yu(f),f.u&&(o.clearTimeout(f.u),f.u=null),Ju(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&o.clearTimeout(f.s),f.s=null)}function Qu(f){if(!pr(f.h)&&!f.s){f.s=!0;var _=f.Ga;ge||he(),oe||(ge(),oe=!0),K.add(_,f),f.B=0}}function HI(f,_){return In(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=_.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=J(d(f.Ga,f,_),Vx(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const re=new te(this,this.j,f);let ie=this.o;if(this.S&&(ie?(ie=E(ie),I(ie,this.S)):ie=this.S),this.m!==null||this.O||(re.H=ie,ie=null),this.P)e:{for(var _=0,A=0;A<this.i.length;A++){t:{var j=this.i[A];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(_+=j,4096<_){_=A;break e}if(_===4096||A===this.i.length-1){_=A+1;break e}}_=1e3}else _=1e3;_=Ox(this,re,_),A=Bs(this.I),At(A,"RID",f),At(A,"CVER",22),this.D&&At(A,"X-HTTP-Session-Id",this.D),Ml(this,A),ie&&(this.O?_="headers="+encodeURIComponent(String(Ax(ie)))+"&"+_:this.m&&r0(A,this.m,ie)),fs(this.h,re),this.Ua&&At(A,"TYPE","init"),this.P?(At(A,"$req",_),At(A,"SID","null"),re.T=!0,ce(re,A,null)):ce(re,A,_),this.G=2}}else this.G==3&&(f?bx(this,f):this.i.length==0||pr(this.h)||bx(this))};function bx(f,_){var A;_?A=_.l:A=f.U++;const j=Bs(f.I);At(j,"SID",f.K),At(j,"RID",A),At(j,"AID",f.T),Ml(f,j),f.m&&f.o&&r0(j,f.m,f.o),A=new te(f,f.j,A,f.B+1),f.m===null&&(A.H=f.o),_&&(f.i=_.D.concat(f.i)),_=Ox(f,A,1e3),A.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),fs(f.h,A),ce(A,j,_)}function Ml(f,_){f.H&&V(f.H,function(A,j){At(_,j,A)}),f.l&&xx({},function(A,j){At(_,j,A)})}function Ox(f,_,A){A=Math.min(f.i.length,A);var j=f.l?d(f.l.Na,f.l,f):null;e:{var re=f.i;let ie=-1;for(;;){const ke=["count="+A];ie==-1?0<A?(ie=re[0].g,ke.push("ofs="+ie)):ie=0:ke.push("ofs="+ie);let _t=!0;for(let mr=0;mr<A;mr++){let ot=re[mr].g;const Ir=re[mr].map;if(ot-=ie,0>ot)ie=Math.max(0,re[mr].g-100),_t=!1;else try{UI(Ir,ke,"req"+ot+"_")}catch{j&&j(Ir)}}if(_t){j=ke.join("&");break e}}}return f=f.i.splice(0,A),_.D=f,j}function Mx(f){if(!f.g&&!f.u){f.Y=1;var _=f.Fa;ge||he(),oe||(ge(),oe=!0),K.add(_,f),f.v=0}}function s0(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=J(d(f.Fa,f),Vx(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,Lx(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=J(d(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Zt(10),Yu(this),Lx(this))};function i0(f){f.A!=null&&(o.clearTimeout(f.A),f.A=null)}function Lx(f){f.g=new te(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var _=Bs(f.qa);At(_,"RID","rpc"),At(_,"SID",f.K),At(_,"AID",f.T),At(_,"CI",f.F?"0":"1"),!f.F&&f.ja&&At(_,"TO",f.ja),At(_,"TYPE","xmlhttp"),Ml(f,_),f.m&&f.o&&r0(_,f.m,f.o),f.L&&(f.g.I=f.L);var A=f.g;f=f.ia,A.L=1,A.v=Gu(Bs(_)),A.m=null,A.P=!0,ye(A,f)}t.Za=function(){this.C!=null&&(this.C=null,Yu(this),s0(this),Zt(19))};function Ju(f){f.C!=null&&(o.clearTimeout(f.C),f.C=null)}function jx(f,_){var A=null;if(f.g==_){Ju(f),i0(f),f.g=null;var j=2}else if(Je(f.h,_))A=_.D,Rl(f.h,_),j=1;else return;if(f.G!=0){if(_.o)if(j==1){A=_.m?_.m.length:0,_=Date.now()-_.F;var re=f.B;j=Vs(),St(j,new H(j,A)),Qu(f)}else Mx(f);else if(re=_.s,re==3||re==0&&0<_.X||!(j==1&&HI(f,_)||j==2&&s0(f)))switch(A&&0<A.length&&(_=f.h,_.i=_.i.concat(A)),re){case 1:ma(f,5);break;case 4:ma(f,10);break;case 3:ma(f,6);break;default:ma(f,2)}}}function Vx(f,_){let A=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(A*=2),A*_}function ma(f,_){if(f.j.info("Error code "+_),_==2){var A=d(f.fb,f),j=f.Xa;const re=!j;j=new pa(j||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Hu(j,"https"),Gu(j),re?LI(j.toString(),A):jI(j.toString(),A)}else Zt(2);f.G=0,f.l&&f.l.sa(_),Ux(f),Fx(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),Zt(2)):(this.j.info("Failed to ping google.com"),Zt(1))};function Ux(f){if(f.G=0,f.ka=[],f.l){const _=$u(f.h);(_.length!=0||f.i.length!=0)&&(y(f.ka,_),y(f.ka,f.i),f.h.i.length=0,g(f.i),f.i.length=0),f.l.ra()}}function Bx(f,_,A){var j=A instanceof pa?Bs(A):new pa(A);if(j.g!="")_&&(j.g=_+"."+j.g),Wu(j,j.s);else{var re=o.location;j=re.protocol,_=_?_+"."+re.hostname:re.hostname,re=+re.port;var ie=new pa(null);j&&Hu(ie,j),_&&(ie.g=_),re&&Wu(ie,re),A&&(ie.l=A),j=ie}return A=f.D,_=f.ya,A&&_&&At(j,A,_),At(j,"VER",f.la),Ml(f,j),j}function zx(f,_,A){if(_&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=f.Ca&&!f.pa?new Lt(new Ku({eb:A})):new Lt(f.pa),_.Ha(f.J),_}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function $x(){}t=$x.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Zu(){}Zu.prototype.g=function(f,_){return new dn(f,_)};function dn(f,_){vt.call(this),this.g=new Dx(_),this.l=f,this.h=_&&_.messageUrlParams||null,f=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(f?f["X-WebChannel-Content-Type"]=_.messageContentType:f={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(f?f["X-WebChannel-Client-Profile"]=_.va:f={"X-WebChannel-Client-Profile":_.va}),this.g.S=f,(f=_&&_.Sb)&&!k(f)&&(this.g.m=f),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!k(_)&&(this.g.D=_,f=this.h,f!==null&&_ in f&&(f=this.h,_ in f&&delete f[_])),this.j=new mo(this)}v(dn,vt),dn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},dn.prototype.close=function(){n0(this.g)},dn.prototype.o=function(f){var _=this.g;if(typeof f=="string"){var A={};A.__data__=f,f=A}else this.u&&(A={},A.__data__=Ms(f),f=A);_.i.push(new He(_.Ya++,f)),_.G==3&&Qu(_)},dn.prototype.N=function(){this.g.l=null,delete this.j,n0(this.g),delete this.g,dn.aa.N.call(this)};function Hx(f){js.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var _=f.__sm__;if(_){e:{for(const A in _){f=A;break e}f=void 0}(this.i=f)&&(f=this.i,_=_!==null&&f in _?_[f]:void 0),this.data=_}else this.data=f}v(Hx,js);function Wx(){us.call(this),this.status=1}v(Wx,us);function mo(f){this.g=f}v(mo,$x),mo.prototype.ua=function(){St(this.g,"a")},mo.prototype.ta=function(f){St(this.g,new Hx(f))},mo.prototype.sa=function(f){St(this.g,new Wx)},mo.prototype.ra=function(){St(this.g,"b")},Zu.prototype.createWebChannel=Zu.prototype.g,dn.prototype.send=dn.prototype.o,dn.prototype.open=dn.prototype.m,dn.prototype.close=dn.prototype.close,yk=function(){return new Zu},_k=function(){return Vs()},xk=Sn,um={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},b.NO_ERROR=0,b.TIMEOUT=8,b.HTTP_ERROR=6,Jf=b,O.COMPLETE="complete",vk=O,_i.EventType=Bn,Bn.OPEN="a",Bn.CLOSE="b",Bn.ERROR="c",Bn.MESSAGE="d",vt.prototype.listen=vt.prototype.K,ec=_i,Lt.prototype.listenOnce=Lt.prototype.L,Lt.prototype.getLastError=Lt.prototype.Ka,Lt.prototype.getLastErrorCode=Lt.prototype.Ba,Lt.prototype.getStatus=Lt.prototype.Z,Lt.prototype.getResponseJson=Lt.prototype.Oa,Lt.prototype.getResponseText=Lt.prototype.oa,Lt.prototype.send=Lt.prototype.ea,Lt.prototype.setWithCredentials=Lt.prototype.Ha,gk=Lt}).apply(typeof wf<"u"?wf:typeof self<"u"?self:typeof window<"u"?window:{});const X_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Fr.UNAUTHENTICATED=new Fr(null),Fr.GOOGLE_CREDENTIALS=new Fr("google-credentials-uid"),Fr.FIRST_PARTY=new Fr("first-party-uid"),Fr.MOCK_USER=new Fr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let El="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ha=new zg("@firebase/firestore");function ql(){return Ha.logLevel}function Pe(t,...e){if(Ha.logLevel<=Ye.DEBUG){const r=e.map(tv);Ha.debug(`Firestore (${El}): ${t}`,...r)}}function hi(t,...e){if(Ha.logLevel<=Ye.ERROR){const r=e.map(tv);Ha.error(`Firestore (${El}): ${t}`,...r)}}function ol(t,...e){if(Ha.logLevel<=Ye.WARN){const r=e.map(tv);Ha.warn(`Firestore (${El}): ${t}`,...r)}}function tv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Le(t="Unexpected state"){const e=`FIRESTORE (${El}) INTERNAL ASSERTION FAILED: `+t;throw hi(e),new Error(e)}function gt(t,e){t||Le()}function Be(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ue={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ce extends Ns{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wk{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class P3{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Fr.UNAUTHENTICATED))}shutdown(){}}class D3{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class F3{constructor(e){this.t=e,this.currentUser=Fr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){gt(this.o===void 0);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let i=new ei;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ei,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{Pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ei)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(gt(typeof n.accessToken=="string"),new wk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return gt(e===null||typeof e=="string"),new Fr(e)}}class b3{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Fr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class O3{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new b3(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Fr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class M3{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class L3{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){gt(this.o===void 0);const n=i=>{i.error!=null&&Pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,Pe("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{Pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):Pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(gt(typeof r.token=="string"),this.R=r.token,new M3(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j3(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ek{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=j3(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%e.length))}return n}}function lt(t,e){return t<e?-1:t>e?1:0}function ll(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ce(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ce(ue.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Ce(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ce(ue.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return sr.fromMillis(Date.now())}static fromDate(e){return sr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new sr(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?lt(this.nanoseconds,e.nanoseconds):lt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ve(e)}static min(){return new Ve(new sr(0,0))}static max(){return new Ve(new sr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,r,n){r===void 0?r=0:r>e.length&&Le(),n===void 0?n=e.length-r:n>e.length-r&&Le(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Jc.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Jc?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=e.get(s),a=r.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class yt extends Jc{construct(e,r,n){return new yt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ce(ue.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new yt(r)}static emptyPath(){return new yt([])}}const V3=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _r extends Jc{construct(e,r,n){return new _r(e,r,n)}static isValidIdentifier(e){return V3.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_r.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new _r(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new Ce(ue.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new Ce(ue.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Ce(ue.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,s+=2}else o==="`"?(a=!a,s++):o!=="."||a?(n+=o,s++):(i(),s++)}if(i(),a)throw new Ce(ue.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new _r(r)}static emptyPath(){return new _r([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.path=e}static fromPath(e){return new De(yt.fromString(e))}static fromName(e){return new De(yt.fromString(e).popFirst(5))}static empty(){return new De(yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return yt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new De(new yt(e.slice()))}}function U3(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Ve.fromTimestamp(n===1e9?new sr(r+1,0):new sr(r,n));return new ta(s,De.empty(),e)}function B3(t){return new ta(t.readTime,t.key,-1)}class ta{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new ta(Ve.min(),De.empty(),-1)}static max(){return new ta(Ve.max(),De.empty(),-1)}}function z3(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=De.comparator(t.documentKey,e.documentKey),r!==0?r:lt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class H3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cu(t){if(t.code!==ue.FAILED_PRECONDITION||t.message!==$3)throw t;Pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Le(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new me((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof me?r:me.resolve(r)}catch(r){return me.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):me.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):me.reject(r)}static resolve(e){return new me((r,n)=>{r(e)})}static reject(e){return new me((r,n)=>{n(e)})}static waitFor(e){return new me((r,n)=>{let s=0,i=0,a=!1;e.forEach(o=>{++s,o.next(()=>{++i,a&&i===s&&r()},l=>n(l))}),a=!0,i===s&&r()})}static or(e){let r=me.resolve(!1);for(const n of e)r=r.next(s=>s?me.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new me((n,s)=>{const i=e.length,a=new Array(i);let o=0;for(let l=0;l<i;l++){const c=l;r(e[c]).next(u=>{a[c]=u,++o,o===i&&n(a)},u=>s(u))}})}static doWhile(e,r){return new me((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function W3(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Ru(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rv{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}rv.oe=-1;function Dd(t){return t==null}function Vh(t){return t===0&&1/t==-1/0}function G3(t){return typeof t=="number"&&Number.isInteger(t)&&!Vh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y_(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function to(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Tk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e,r){this.comparator=e,this.root=r||vr.EMPTY}insert(e,r){return new Mt(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,vr.BLACK,null,null))}remove(e){return new Mt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,vr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ef(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ef(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ef(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ef(this.root,e,this.comparator,!0)}}class Ef{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class vr{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??vr.RED,this.left=s??vr.EMPTY,this.right=i??vr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new vr(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return vr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return vr.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,vr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,vr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Le();const e=this.left.check();if(e!==this.right.check())throw Le();return e+(this.isRed()?0:1)}}vr.EMPTY=null,vr.RED=!0,vr.BLACK=!1;vr.EMPTY=new class{constructor(){this.size=0}get key(){throw Le()}get value(){throw Le()}get color(){throw Le()}get left(){throw Le()}get right(){throw Le()}copy(e,r,n,s,i){return this}insert(e,r,n){return new vr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e){this.comparator=e,this.data=new Mt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Q_(this.data.getIterator())}getIteratorFrom(e){return new Q_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof wr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new wr(this.comparator);return r.data=e,r}}class Q_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.fields=e,e.sort(_r.comparator)}static empty(){return new _n([])}unionWith(e){let r=new wr(_r.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new _n(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return ll(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new kk("Invalid base64 string: "+i):i}}(e);return new Sr(r)}static fromUint8Array(e){const r=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new Sr(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return lt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Sr.EMPTY_BYTE_STRING=new Sr("");const K3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ra(t){if(gt(!!t),typeof t=="string"){let e=0;const r=K3.exec(t);if(gt(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:zt(t.seconds),nanos:zt(t.nanos)}}function zt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Wa(t){return typeof t=="string"?Sr.fromBase64String(t):Sr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fd(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function nv(t){const e=t.mapValue.fields.__previous_value__;return Fd(e)?nv(e):e}function Zc(t){const e=ra(t.mapValue.fields.__local_write_time__.timestampValue);return new sr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q3{constructor(e,r,n,s,i,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class eu{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new eu("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof eu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tf={mapValue:{}};function Ga(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Fd(t)?4:Y3(t)?9007199254740991:X3(t)?10:11:Le()}function As(t,e){if(t===e)return!0;const r=Ga(t);if(r!==Ga(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Zc(t).isEqual(Zc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=ra(s.timestampValue),o=ra(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Wa(s.bytesValue).isEqual(Wa(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return zt(s.geoPointValue.latitude)===zt(i.geoPointValue.latitude)&&zt(s.geoPointValue.longitude)===zt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return zt(s.integerValue)===zt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=zt(s.doubleValue),o=zt(i.doubleValue);return a===o?Vh(a)===Vh(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return ll(t.arrayValue.values||[],e.arrayValue.values||[],As);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},o=i.mapValue.fields||{};if(Y_(a)!==Y_(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!As(a[l],o[l])))return!1;return!0}(t,e);default:return Le()}}function tu(t,e){return(t.values||[]).find(r=>As(r,e))!==void 0}function cl(t,e){if(t===e)return 0;const r=Ga(t),n=Ga(e);if(r!==n)return lt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return lt(t.booleanValue,e.booleanValue);case 2:return function(i,a){const o=zt(i.integerValue||i.doubleValue),l=zt(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return J_(t.timestampValue,e.timestampValue);case 4:return J_(Zc(t),Zc(e));case 5:return lt(t.stringValue,e.stringValue);case 6:return function(i,a){const o=Wa(i),l=Wa(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const o=i.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=lt(o[c],l[c]);if(u!==0)return u}return lt(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const o=lt(zt(i.latitude),zt(a.latitude));return o!==0?o:lt(zt(i.longitude),zt(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Z_(t.arrayValue,e.arrayValue);case 10:return function(i,a){var o,l,c,u;const h=i.fields||{},d=a.fields||{},m=(o=h.value)===null||o===void 0?void 0:o.arrayValue,v=(l=d.value)===null||l===void 0?void 0:l.arrayValue,g=lt(((c=m==null?void 0:m.values)===null||c===void 0?void 0:c.length)||0,((u=v==null?void 0:v.values)===null||u===void 0?void 0:u.length)||0);return g!==0?g:Z_(m,v)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Tf.mapValue&&a===Tf.mapValue)return 0;if(i===Tf.mapValue)return 1;if(a===Tf.mapValue)return-1;const o=i.fields||{},l=Object.keys(o),c=a.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let h=0;h<l.length&&h<u.length;++h){const d=lt(l[h],u[h]);if(d!==0)return d;const m=cl(o[l[h]],c[u[h]]);if(m!==0)return m}return lt(l.length,u.length)}(t.mapValue,e.mapValue);default:throw Le()}}function J_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return lt(t,e);const r=ra(t),n=ra(e),s=lt(r.seconds,n.seconds);return s!==0?s:lt(r.nanos,n.nanos)}function Z_(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=cl(r[s],n[s]);if(i)return i}return lt(r.length,n.length)}function ul(t){return fm(t)}function fm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=ra(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Wa(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return De.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=fm(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const a of n)i?i=!1:s+=",",s+=`${a}:${fm(r.fields[a])}`;return s+"}"}(t.mapValue):Le()}function Uh(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function hm(t){return!!t&&"integerValue"in t}function sv(t){return!!t&&"arrayValue"in t}function ey(t){return!!t&&"nullValue"in t}function ty(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Zf(t){return!!t&&"mapValue"in t}function X3(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function xc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return to(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=xc(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=xc(t.arrayValue.values[r]);return e}return Object.assign({},t)}function Y3(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.value=e}static empty(){return new on({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Zf(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=xc(r)}setAll(e){let r=_r.emptyPath(),n={},s=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}a?n[o.lastSegment()]=xc(a):s.push(o.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());Zf(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return As(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];Zf(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){to(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new on(xc(this.value))}}function Sk(t){const e=[];return to(t.fields,(r,n)=>{const s=new _r([r]);if(Zf(n)){const i=Sk(n.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new _n(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e,r,n,s,i,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Mr(e,0,Ve.min(),Ve.min(),Ve.min(),on.empty(),0)}static newFoundDocument(e,r,n,s){return new Mr(e,1,r,Ve.min(),n,s,0)}static newNoDocument(e,r){return new Mr(e,2,r,Ve.min(),Ve.min(),on.empty(),0)}static newUnknownDocument(e,r){return new Mr(e,3,r,Ve.min(),Ve.min(),on.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ve.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ve.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Mr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Mr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e,r){this.position=e,this.inclusive=r}}function ry(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?n=De.comparator(De.fromName(a.referenceValue),r.key):n=cl(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function ny(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!As(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e,r="asc"){this.field=e,this.dir=r}}function Q3(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{}class Jt extends Ak{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new Z3(e,r,n):r==="array-contains"?new rb(e,n):r==="in"?new nb(e,n):r==="not-in"?new sb(e,n):r==="array-contains-any"?new ib(e,n):new Jt(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new eb(e,n):new tb(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(cl(r,this.value)):r!==null&&Ga(this.value)===Ga(r)&&this.matchesComparison(cl(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Le()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class as extends Ak{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new as(e,r)}matches(e){return Ik(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Ik(t){return t.op==="and"}function Ck(t){return J3(t)&&Ik(t)}function J3(t){for(const e of t.filters)if(e instanceof as)return!1;return!0}function dm(t){if(t instanceof Jt)return t.field.canonicalString()+t.op.toString()+ul(t.value);if(Ck(t))return t.filters.map(e=>dm(e)).join(",");{const e=t.filters.map(r=>dm(r)).join(",");return`${t.op}(${e})`}}function Rk(t,e){return t instanceof Jt?function(n,s){return s instanceof Jt&&n.op===s.op&&n.field.isEqual(s.field)&&As(n.value,s.value)}(t,e):t instanceof as?function(n,s){return s instanceof as&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,a,o)=>i&&Rk(a,s.filters[o]),!0):!1}(t,e):void Le()}function Nk(t){return t instanceof Jt?function(r){return`${r.field.canonicalString()} ${r.op} ${ul(r.value)}`}(t):t instanceof as?function(r){return r.op.toString()+" {"+r.getFilters().map(Nk).join(" ,")+"}"}(t):"Filter"}class Z3 extends Jt{constructor(e,r,n){super(e,r,n),this.key=De.fromName(n.referenceValue)}matches(e){const r=De.comparator(e.key,this.key);return this.matchesComparison(r)}}class eb extends Jt{constructor(e,r){super(e,"in",r),this.keys=Pk("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class tb extends Jt{constructor(e,r){super(e,"not-in",r),this.keys=Pk("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Pk(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>De.fromName(n.referenceValue))}class rb extends Jt{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return sv(r)&&tu(r.arrayValue,this.value)}}class nb extends Jt{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&tu(this.value.arrayValue,r)}}class sb extends Jt{constructor(e,r){super(e,"not-in",r)}matches(e){if(tu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!tu(this.value.arrayValue,r)}}class ib extends Jt{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!sv(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>tu(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{constructor(e,r=null,n=[],s=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=a,this.endAt=o,this.ue=null}}function sy(t,e=null,r=[],n=[],s=null,i=null,a=null){return new ab(t,e,r,n,s,i,a)}function iv(t){const e=Be(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>dm(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),Dd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>ul(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>ul(n)).join(",")),e.ue=r}return e.ue}function av(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!Q3(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Rk(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ny(t.startAt,e.startAt)&&ny(t.endAt,e.endAt)}function pm(t){return De.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e,r=null,n=[],s=[],i=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function ob(t,e,r,n,s,i,a,o){return new fa(t,e,r,n,s,i,a,o)}function ov(t){return new fa(t)}function iy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function lv(t){return t.collectionGroup!==null}function Go(t){const e=Be(t);if(e.ce===null){e.ce=[];const r=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new wr(_r.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.ce.push(new ru(i,n))}),r.has(_r.keyField().canonicalString())||e.ce.push(new ru(_r.keyField(),n))}return e.ce}function Es(t){const e=Be(t);return e.le||(e.le=lb(e,Go(t))),e.le}function lb(t,e){if(t.limitType==="F")return sy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new ru(s.field,i)});const r=t.endAt?new fl(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new fl(t.startAt.position,t.startAt.inclusive):null;return sy(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function mm(t,e){const r=t.filters.concat([e]);return new fa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Bh(t,e,r){return new fa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function bd(t,e){return av(Es(t),Es(e))&&t.limitType===e.limitType}function Dk(t){return`${iv(Es(t))}|lt:${t.limitType}`}function yo(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>Nk(s)).join(", ")}]`),Dd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>ul(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>ul(s)).join(",")),`Target(${n})`}(Es(t))}; limitType=${t.limitType})`}function Od(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):De.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of Go(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(a,o,l){const c=ry(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,Go(n),s)||n.endAt&&!function(a,o,l){const c=ry(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,Go(n),s))}(t,e)}function cb(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Fk(t){return(e,r)=>{let n=!1;for(const s of Go(t)){const i=ub(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function ub(t,e,r){const n=t.field.isKeyField()?De.comparator(e.key,r.key):function(i,a,o){const l=a.data.field(i),c=o.data.field(i);return l!==null&&c!==null?cl(l,c):Le()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Le()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){to(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return Tk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fb=new Mt(De.comparator);function di(){return fb}const bk=new Mt(De.comparator);function tc(...t){let e=bk;for(const r of t)e=e.insert(r.key,r);return e}function Ok(t){let e=bk;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Ca(){return _c()}function Mk(){return _c()}function _c(){return new Tl(t=>t.toString(),(t,e)=>t.isEqual(e))}const hb=new Mt(De.comparator),db=new wr(De.comparator);function Xe(...t){let e=db;for(const r of t)e=e.add(r);return e}const pb=new wr(lt);function mb(){return pb}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vh(e)?"-0":e}}function Lk(t){return{integerValue:""+t}}function gb(t,e){return G3(e)?Lk(e):cv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(){this._=void 0}}function vb(t,e,r){return t instanceof nu?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Fd(i)&&(i=nv(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(r,e):t instanceof su?Vk(t,e):t instanceof iu?Uk(t,e):function(s,i){const a=jk(s,i),o=ay(a)+ay(s.Pe);return hm(a)&&hm(s.Pe)?Lk(o):cv(s.serializer,o)}(t,e)}function xb(t,e,r){return t instanceof su?Vk(t,e):t instanceof iu?Uk(t,e):r}function jk(t,e){return t instanceof zh?function(n){return hm(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class nu extends Md{}class su extends Md{constructor(e){super(),this.elements=e}}function Vk(t,e){const r=Bk(e);for(const n of t.elements)r.some(s=>As(s,n))||r.push(n);return{arrayValue:{values:r}}}class iu extends Md{constructor(e){super(),this.elements=e}}function Uk(t,e){let r=Bk(e);for(const n of t.elements)r=r.filter(s=>!As(s,n));return{arrayValue:{values:r}}}class zh extends Md{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function ay(t){return zt(t.integerValue||t.doubleValue)}function Bk(t){return sv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _b{constructor(e,r){this.field=e,this.transform=r}}function yb(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof su&&s instanceof su||n instanceof iu&&s instanceof iu?ll(n.elements,s.elements,As):n instanceof zh&&s instanceof zh?As(n.Pe,s.Pe):n instanceof nu&&s instanceof nu}(t.transform,e.transform)}class wb{constructor(e,r){this.version=e,this.transformResults=r}}class Mn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Mn}static exists(e){return new Mn(void 0,e)}static updateTime(e){return new Mn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function eh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ld{}function zk(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new uv(t.key,Mn.none()):new Nu(t.key,t.data,Mn.none());{const r=t.data,n=on.empty();let s=new wr(_r.comparator);for(let i of e.fields)if(!s.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),s=s.add(i)}return new ha(t.key,n,new _n(s.toArray()),Mn.none())}}function Eb(t,e,r){t instanceof Nu?function(s,i,a){const o=s.value.clone(),l=ly(s.fieldTransforms,i,a.transformResults);o.setAll(l),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof ha?function(s,i,a){if(!eh(s.precondition,i))return void i.convertToUnknownDocument(a.version);const o=ly(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll($k(s)),l.setAll(o),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function yc(t,e,r,n){return t instanceof Nu?function(i,a,o,l){if(!eh(i.precondition,a))return o;const c=i.value.clone(),u=cy(i.fieldTransforms,l,a);return c.setAll(u),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof ha?function(i,a,o,l){if(!eh(i.precondition,a))return o;const c=cy(i.fieldTransforms,l,a),u=a.data;return u.setAll($k(i)),u.setAll(c),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,r,n):function(i,a,o){return eh(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function Tb(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=jk(n.transform,s||null);i!=null&&(r===null&&(r=on.empty()),r.set(n.field,i))}return r||null}function oy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&ll(n,s,(i,a)=>yb(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Nu extends Ld{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ha extends Ld{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function $k(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function ly(t,e,r){const n=new Map;gt(t.length===r.length);for(let s=0;s<r.length;s++){const i=t[s],a=i.transform,o=e.data.field(i.field);n.set(i.field,xb(a,o,r[s]))}return n}function cy(t,e,r){const n=new Map;for(const s of t){const i=s.transform,a=r.data.field(s.field);n.set(s.field,vb(i,a,e))}return n}class uv extends Ld{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class kb extends Ld{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sb{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&Eb(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=yc(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=yc(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Mk();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=r.has(s.key)?null:o;const l=zk(a,o);l!==null&&n.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(Ve.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Xe())}isEqual(e){return this.batchId===e.batchId&&ll(this.mutations,e.mutations,(r,n)=>oy(r,n))&&ll(this.baseMutations,e.baseMutations,(r,n)=>oy(r,n))}}class fv{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){gt(e.mutations.length===n.length);let s=function(){return hb}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,n[a].version);return new fv(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kt,Ze;function Cb(t){switch(t){default:return Le();case ue.CANCELLED:case ue.UNKNOWN:case ue.DEADLINE_EXCEEDED:case ue.RESOURCE_EXHAUSTED:case ue.INTERNAL:case ue.UNAVAILABLE:case ue.UNAUTHENTICATED:return!1;case ue.INVALID_ARGUMENT:case ue.NOT_FOUND:case ue.ALREADY_EXISTS:case ue.PERMISSION_DENIED:case ue.FAILED_PRECONDITION:case ue.ABORTED:case ue.OUT_OF_RANGE:case ue.UNIMPLEMENTED:case ue.DATA_LOSS:return!0}}function Hk(t){if(t===void 0)return hi("GRPC error has no .code"),ue.UNKNOWN;switch(t){case Kt.OK:return ue.OK;case Kt.CANCELLED:return ue.CANCELLED;case Kt.UNKNOWN:return ue.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return ue.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return ue.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return ue.INTERNAL;case Kt.UNAVAILABLE:return ue.UNAVAILABLE;case Kt.UNAUTHENTICATED:return ue.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return ue.INVALID_ARGUMENT;case Kt.NOT_FOUND:return ue.NOT_FOUND;case Kt.ALREADY_EXISTS:return ue.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return ue.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return ue.FAILED_PRECONDITION;case Kt.ABORTED:return ue.ABORTED;case Kt.OUT_OF_RANGE:return ue.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return ue.UNIMPLEMENTED;case Kt.DATA_LOSS:return ue.DATA_LOSS;default:return Le()}}(Ze=Kt||(Kt={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rb(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nb=new Fa([4294967295,4294967295],0);function uy(t){const e=Rb().encode(t),r=new mk;return r.update(e),new Uint8Array(r.digest())}function fy(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Fa([r,n],0),new Fa([s,i],0)]}class hv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new rc(`Invalid padding: ${r}`);if(n<0)throw new rc(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new rc(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new rc(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Fa.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(Fa.fromNumber(n)));return s.compare(Nb)===1&&(s=new Fa([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=uy(e),[n,s]=fy(r);for(let i=0;i<this.hashCount;i++){const a=this.Ee(n,s,i);if(!this.de(a))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new hv(i,s,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=uy(e),[n,s]=fy(r);for(let i=0;i<this.hashCount;i++){const a=this.Ee(n,s,i);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class rc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Pu.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new jd(Ve.min(),s,new Mt(lt),di(),Xe())}}class Pu{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Pu(n,r,Xe(),Xe(),Xe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class Wk{constructor(e,r){this.targetId=e,this.me=r}}class Gk{constructor(e,r,n=Sr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class hy{constructor(){this.fe=0,this.ge=py(),this.pe=Sr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Xe(),r=Xe(),n=Xe();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Le()}}),new Pu(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=py()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,gt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Pb{constructor(e){this.Le=e,this.Be=new Map,this.ke=di(),this.qe=dy(),this.Qe=new Mt(lt)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:Le()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const i=s.target;if(pm(i))if(n===0){const a=new De(i.path);this.Ue(r,a,Mr.newNoDocument(a,Ve.min()))}else gt(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let a,o;try{a=Wa(n).toUint8Array()}catch(l){if(l instanceof kk)return ol("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new hv(a,s,i)}catch(l){return ol(l instanceof rc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,i,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((i,a)=>{const o=this.Je(a);if(o){if(i.current&&pm(o.target)){const l=new De(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,Mr.newNoDocument(l,e))}i.be&&(r.set(a,i.ve()),i.Ce())}});let n=Xe();this.qe.forEach((i,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new jd(e,r,this.Qe,this.ke,n);return this.ke=di(),this.qe=dy(),this.Qe=new Mt(lt),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new hy,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new wr(lt),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Pe("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new hy),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function dy(){return new Mt(De.comparator)}function py(){return new Mt(De.comparator)}const Db={asc:"ASCENDING",desc:"DESCENDING"},Fb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bb={and:"AND",or:"OR"};class Ob{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function gm(t,e){return t.useProto3Json||Dd(e)?e:{value:e}}function $h(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Kk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Mb(t,e){return $h(t,e.toTimestamp())}function Ts(t){return gt(!!t),Ve.fromTimestamp(function(r){const n=ra(r);return new sr(n.seconds,n.nanos)}(t))}function dv(t,e){return vm(t,e).canonicalString()}function vm(t,e){const r=function(s){return new yt(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function qk(t){const e=yt.fromString(t);return gt(Zk(e)),e}function xm(t,e){return dv(t.databaseId,e.path)}function $0(t,e){const r=qk(e);if(r.get(1)!==t.databaseId.projectId)throw new Ce(ue.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Ce(ue.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new De(Yk(r))}function Xk(t,e){return dv(t.databaseId,e)}function Lb(t){const e=qk(t);return e.length===4?yt.emptyPath():Yk(e)}function _m(t){return new yt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Yk(t){return gt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function my(t,e,r){return{name:xm(t,e),fields:r.value.mapValue.fields}}function jb(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Le()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(gt(u===void 0||typeof u=="string"),Sr.fromBase64String(u||"")):(gt(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Sr.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const u=c.code===void 0?ue.UNKNOWN:Hk(c.code);return new Ce(u,c.message||"")}(a);r=new Gk(n,s,i,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=$0(t,n.document.name),i=Ts(n.document.updateTime),a=n.document.createTime?Ts(n.document.createTime):Ve.min(),o=new on({mapValue:{fields:n.document.fields}}),l=Mr.newFoundDocument(s,i,a,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new th(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=$0(t,n.document),i=n.readTime?Ts(n.readTime):Ve.min(),a=Mr.newNoDocument(s,i),o=n.removedTargetIds||[];r=new th([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=$0(t,n.document),i=n.removedTargetIds||[];r=new th([],i,s,null)}else{if(!("filter"in e))return Le();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,a=new Ib(s,i),o=n.targetId;r=new Wk(o,a)}}return r}function Vb(t,e){let r;if(e instanceof Nu)r={update:my(t,e.key,e.value)};else if(e instanceof uv)r={delete:xm(t,e.key)};else if(e instanceof ha)r={update:my(t,e.key,e.data),updateMask:qb(e.fieldMask)};else{if(!(e instanceof kb))return Le();r={verify:xm(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const o=a.transform;if(o instanceof nu)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof su)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof iu)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof zh)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw Le()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:Mb(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Le()}(t,e.precondition)),r}function Ub(t,e){return t&&t.length>0?(gt(e!==void 0),t.map(r=>function(s,i){let a=s.updateTime?Ts(s.updateTime):Ts(i);return a.isEqual(Ve.min())&&(a=Ts(i)),new wb(a,s.transformResults||[])}(r,e))):[]}function Bb(t,e){return{documents:[Xk(t,e.path)]}}function zb(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Xk(t,s);const i=function(c){if(c.length!==0)return Jk(as.create(c,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const a=function(c){if(c.length!==0)return c.map(u=>function(d){return{field:wo(d.field),direction:Wb(d.dir)}}(u))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=gm(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:s}}function $b(t){let e=Lb(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){gt(n===1);const u=r.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];r.where&&(i=function(h){const d=Qk(h);return d instanceof as&&Ck(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(h){return h.map(d=>function(v){return new ru(Eo(v.field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(h){let d;return d=typeof h=="object"?h.value:h,Dd(d)?null:d}(r.limit));let l=null;r.startAt&&(l=function(h){const d=!!h.before,m=h.values||[];return new fl(m,d)}(r.startAt));let c=null;return r.endAt&&(c=function(h){const d=!h.before,m=h.values||[];return new fl(m,d)}(r.endAt)),ob(e,s,a,i,o,"F",l,c)}function Hb(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Le()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Qk(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Eo(r.unaryFilter.field);return Jt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Eo(r.unaryFilter.field);return Jt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Eo(r.unaryFilter.field);return Jt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Eo(r.unaryFilter.field);return Jt.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Le()}}(t):t.fieldFilter!==void 0?function(r){return Jt.create(Eo(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Le()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return as.create(r.compositeFilter.filters.map(n=>Qk(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Le()}}(r.compositeFilter.op))}(t):Le()}function Wb(t){return Db[t]}function Gb(t){return Fb[t]}function Kb(t){return bb[t]}function wo(t){return{fieldPath:t.canonicalString()}}function Eo(t){return _r.fromServerFormat(t.fieldPath)}function Jk(t){return t instanceof Jt?function(r){if(r.op==="=="){if(ty(r.value))return{unaryFilter:{field:wo(r.field),op:"IS_NAN"}};if(ey(r.value))return{unaryFilter:{field:wo(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(ty(r.value))return{unaryFilter:{field:wo(r.field),op:"IS_NOT_NAN"}};if(ey(r.value))return{unaryFilter:{field:wo(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:wo(r.field),op:Gb(r.op),value:r.value}}}(t):t instanceof as?function(r){const n=r.getFilters().map(s=>Jk(s));return n.length===1?n[0]:{compositeFilter:{op:Kb(r.op),filters:n}}}(t):Le()}function qb(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Zk(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e,r,n,s,i=Ve.min(),a=Ve.min(),o=Sr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Li(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Li(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Li(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Li(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(e){this.ct=e}}function Yb(t){const e=$b({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Bh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(){this.un=new Jb}addToCollectionParentIndex(e,r){return this.un.add(r),me.resolve()}getCollectionParents(e,r){return me.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return me.resolve()}deleteFieldIndex(e,r){return me.resolve()}deleteAllFieldIndexes(e){return me.resolve()}createTargetIndexes(e,r){return me.resolve()}getDocumentsMatchingTarget(e,r){return me.resolve(null)}getIndexType(e,r){return me.resolve(0)}getFieldIndexes(e,r){return me.resolve([])}getNextCollectionGroupToUpdate(e){return me.resolve(null)}getMinOffset(e,r){return me.resolve(ta.min())}getMinOffsetFromCollectionGroup(e,r){return me.resolve(ta.min())}updateCollectionGroup(e,r,n){return me.resolve()}updateIndexEntries(e,r){return me.resolve()}}class Jb{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new wr(yt.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new wr(yt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new hl(0)}static kn(){return new hl(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zb{constructor(){this.changes=new Tl(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Mr.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?me.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eO{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tO{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&yc(n.mutation,s,_n.empty(),sr.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Xe()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Xe()){const s=Ca();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let a=tc();return i.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Ca();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Xe()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,s){let i=di();const a=_c(),o=function(){return _c()}();return r.forEach((l,c)=>{const u=n.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof ha)?i=i.insert(c.key,c):u!==void 0?(a.set(c.key,u.mutation.getFieldMask()),yc(u.mutation,c,u.mutation.getFieldMask(),sr.now())):a.set(c.key,_n.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>a.set(c,u)),r.forEach((c,u)=>{var h;return o.set(c,new eO(u,(h=a.get(c))!==null&&h!==void 0?h:null))}),o))}recalculateAndSaveOverlays(e,r){const n=_c();let s=new Mt((a,o)=>a-o),i=Xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||_n.empty();u=o.applyToLocalView(c,u),n.set(l,u);const h=(s.get(o.batchId)||Xe()).add(l);s=s.insert(o.batchId,h)})}).next(()=>{const a=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,h=Mk();u.forEach(d=>{if(!i.has(d)){const m=zk(r.get(d),n.get(d));m!==null&&h.set(d,m),i=i.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,h))}return me.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(a){return De.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):lv(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):me.resolve(Ca());let o=-1,l=i;return a.next(c=>me.forEach(c,(u,h)=>(o<h.largestBatchId&&(o=h.largestBatchId),i.get(u)?me.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{l=l.insert(u,d)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,Xe())).next(u=>({batchId:o,changes:Ok(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new De(r)).next(n=>{let s=tc();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let a=tc();return this.indexManager.getCollectionParents(e,i).next(o=>me.forEach(o,l=>{const c=function(h,d){return new fa(d,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(r,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,n,s).next(u=>{u.forEach((h,d)=>{a=a.insert(h,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(a=>{i.forEach((l,c)=>{const u=c.getKey();a.get(u)===null&&(a=a.insert(u,Mr.newInvalidDocument(u)))});let o=tc();return a.forEach((l,c)=>{const u=i.get(l);u!==void 0&&yc(u.mutation,c,_n.empty(),sr.now()),Od(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return me.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Ts(s.createTime)}}(r)),me.resolve()}getNamedQuery(e,r){return me.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:Yb(s.bundledQuery),readTime:Ts(s.readTime)}}(r)),me.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(){this.overlays=new Mt(De.comparator),this.Ir=new Map}getOverlay(e,r){return me.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Ca();return me.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.ht(e,r,i)}),me.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(n)),me.resolve()}getOverlaysForCollection(e,r,n){const s=Ca(),i=r.length+1,a=new De(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>n&&s.set(l.getKey(),l)}return me.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new Mt((c,u)=>c-u);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=i.get(c.largestBatchId);u===null&&(u=Ca(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=Ca(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=s)););return me.resolve(o)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new Ab(r,n));let i=this.Ir.get(r);i===void 0&&(i=Xe(),this.Ir.set(r,i)),this.Ir.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(){this.sessionToken=Sr.EMPTY_BYTE_STRING}getSessionToken(e){return me.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,me.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(){this.Tr=new wr(cr.Er),this.dr=new wr(cr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new cr(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new cr(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new De(new yt([])),n=new cr(r,e),s=new cr(r,e+1),i=[];return this.dr.forEachInRange([n,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new De(new yt([])),n=new cr(r,e),s=new cr(r,e+1);let i=Xe();return this.dr.forEachInRange([n,s],a=>{i=i.add(a.key)}),i}containsKey(e){const r=new cr(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class cr{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return De.comparator(e.key,r.key)||lt(e.wr,r.wr)}static Ar(e,r){return lt(e.wr,r.wr)||De.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new wr(cr.Er)}checkEmpty(e){return me.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Sb(i,r,n,s);this.mutationQueue.push(a);for(const o of s)this.br=this.br.add(new cr(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return me.resolve(a)}lookupMutationBatch(e,r){return me.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),i=s<0?0:s;return me.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return me.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return me.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new cr(r,0),s=new cr(r,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,s],a=>{const o=this.Dr(a.wr);i.push(o)}),me.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new wr(lt);return r.forEach(s=>{const i=new cr(s,0),a=new cr(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],o=>{n=n.add(o.wr)})}),me.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;De.isDocumentKey(i)||(i=i.child(""));const a=new cr(new De(i),0);let o=new wr(lt);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.wr)),!0)},a),me.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){gt(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return me.forEach(r.mutations,s=>{const i=new cr(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new cr(r,0),s=this.br.firstAfterOrEqual(n);return me.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,me.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(e){this.Mr=e,this.docs=function(){return new Mt(De.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return me.resolve(n?n.document.mutableCopy():Mr.newInvalidDocument(r))}getEntries(e,r){let n=di();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Mr.newInvalidDocument(s))}),me.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=di();const a=r.path,o=new De(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||z3(B3(u),n)<=0||(s.has(u.key)||Od(r,u))&&(i=i.insert(u.key,u.mutableCopy()))}return me.resolve(i)}getAllFromCollectionGroup(e,r,n,s){Le()}Or(e,r){return me.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new oO(this)}getSize(e){return me.resolve(this.size)}}class oO extends Zb{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),me.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(e){this.persistence=e,this.Nr=new Tl(r=>iv(r),av),this.lastRemoteSnapshotVersion=Ve.min(),this.highestTargetId=0,this.Lr=0,this.Br=new pv,this.targetCount=0,this.kr=hl.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),me.resolve()}getLastRemoteSnapshotVersion(e){return me.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return me.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),me.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),me.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new hl(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,me.resolve()}updateTargetData(e,r){return this.Kn(r),me.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,me.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),me.waitFor(i).next(()=>s)}getTargetCount(e){return me.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return me.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),me.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),me.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),me.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return me.resolve(n)}containsKey(e,r){return me.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(e,r){this.qr={},this.overlays={},this.Qr=new rv(0),this.Kr=!1,this.Kr=!0,this.$r=new sO,this.referenceDelegate=e(this),this.Ur=new lO(this),this.indexManager=new Qb,this.remoteDocumentCache=function(s){return new aO(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new Xb(r),this.Gr=new rO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new nO,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new iO(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Pe("MemoryPersistence","Starting transaction:",e);const s=new uO(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,r){return me.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class uO extends H3{constructor(e){super(),this.currentSequenceNumber=e}}class mv{constructor(e){this.persistence=e,this.Jr=new pv,this.Yr=null}static Zr(e){return new mv(e)}get Xr(){if(this.Yr)return this.Yr;throw Le()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),me.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),me.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),me.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return me.forEach(this.Xr,n=>{const s=De.fromPath(n);return this.ei(e,s).next(i=>{i||r.removeEntry(s,Ve.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return me.or([()=>me.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=Xe(),s=Xe();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new gv(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return vP()?8:W3(Br())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.Yi(e,r).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,r,s,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new fO;return this.Xi(e,r,a).next(o=>{if(i.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>i.result)}es(e,r,n,s){return n.documentReadCount<this.ji?(ql()<=Ye.DEBUG&&Pe("QueryEngine","SDK will not create cache indexes for query:",yo(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),me.resolve()):(ql()<=Ye.DEBUG&&Pe("QueryEngine","Query:",yo(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(ql()<=Ye.DEBUG&&Pe("QueryEngine","The SDK decides to create cache indexes for query:",yo(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Es(r))):me.resolve())}Yi(e,r){if(iy(r))return me.resolve(null);let n=Es(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=Bh(r,null,"F"),n=Es(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=Xe(...i);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,Bh(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,s){return iy(r)||s.isEqual(Ve.min())?me.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const a=this.ts(r,i);return this.ns(r,a,n,s)?me.resolve(null):(ql()<=Ye.DEBUG&&Pe("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),yo(r)),this.rs(e,a,r,U3(s,-1)).next(o=>o))})}ts(e,r){let n=new wr(Fk(e));return r.forEach((s,i)=>{Od(e,i)&&(n=n.add(i))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,r,n){return ql()<=Ye.DEBUG&&Pe("QueryEngine","Using full collection scan to execute query:",yo(r)),this.Ji.getDocumentsMatchingQuery(e,r,ta.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new Mt(lt),this._s=new Tl(i=>iv(i),av),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tO(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function pO(t,e,r,n){return new dO(t,e,r,n)}async function eS(t,e){const r=Be(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],o=[];let l=Xe();for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function mO(t,e){const r=Be(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const h=c.batch,d=h.keys();let m=me.resolve();return d.forEach(v=>{m=m.next(()=>u.getEntry(l,v)).next(g=>{const y=c.docVersions.get(v);gt(y!==null),g.version.compareTo(y)<0&&(h.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),u.addEntry(g)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(l,h))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Xe();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function tS(t){const e=Be(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function gO(t,e){const r=Be(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const o=[];e.targetChanges.forEach((u,h)=>{const d=s.get(h);if(!d)return;o.push(r.Ur.removeMatchingKeys(i,u.removedDocuments,h).next(()=>r.Ur.addMatchingKeys(i,u.addedDocuments,h)));let m=d.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(Sr.EMPTY_BYTE_STRING,Ve.min()).withLastLimboFreeSnapshotVersion(Ve.min()):u.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(u.resumeToken,n)),s=s.insert(h,m),function(g,y,S){return g.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(d,m,u)&&o.push(r.Ur.updateTargetData(i,m))});let l=di(),c=Xe();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(i,u))}),o.push(vO(i,a,e.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!n.isEqual(Ve.min())){const u=r.Ur.getLastRemoteSnapshotVersion(i).next(h=>r.Ur.setTargetsMetadata(i,i.currentSequenceNumber,n));o.push(u)}return me.waitFor(o).next(()=>a.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(r.os=s,i))}function vO(t,e,r){let n=Xe(),s=Xe();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=di();return r.forEach((o,l)=>{const c=i.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Ve.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Pe("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:s}})}function xO(t,e){const r=Be(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function _O(t,e){const r=Be(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(i=>i?(s=i,me.resolve(s)):r.Ur.allocateTargetId(n).next(a=>(s=new Li(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function ym(t,e,r){const n=Be(t),s=n.os.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Ru(a))throw a;Pe("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function gy(t,e,r){const n=Be(t);let s=Ve.min(),i=Xe();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,u){const h=Be(l),d=h._s.get(u);return d!==void 0?me.resolve(h.os.get(d)):h.Ur.getTargetData(c,u)}(n,a,Es(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{i=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?s:Ve.min(),r?i:Xe())).next(o=>(yO(n,cb(e),o),{documents:o,Ts:i})))}function yO(t,e,r){let n=t.us.get(e)||Ve.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.us.set(e,n)}class vy{constructor(){this.activeTargetIds=mb()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class wO{constructor(){this.so=new vy,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new vy,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Pe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Pe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kf=null;function H0(){return kf===null?kf=function(){return 268435456+Math.round(2147483648*Math.random())}():kf++,"0x"+kf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kO{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pr="WebChannelConnection";class SO extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(r,n,s,i,a){const o=H0(),l=this.xo(r,n.toUriEncodedString());Pe("RestConnection",`Sending RPC '${r}' ${o}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,i,a),this.No(r,l,c,s).then(u=>(Pe("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw ol("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",l,"request:",s),u})}Lo(r,n,s,i,a,o){return this.Mo(r,n,s,i,a)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+El}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,a)=>r[a]=i),s&&s.headers.forEach((i,a)=>r[a]=i)}xo(r,n){const s=TO[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const i=H0();return new Promise((a,o)=>{const l=new gk;l.setWithCredentials(!0),l.listenOnce(vk.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Jf.NO_ERROR:const u=l.getResponseJson();Pe(Pr,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(u)),a(u);break;case Jf.TIMEOUT:Pe(Pr,`RPC '${e}' ${i} timed out`),o(new Ce(ue.DEADLINE_EXCEEDED,"Request time out"));break;case Jf.HTTP_ERROR:const h=l.getStatus();if(Pe(Pr,`RPC '${e}' ${i} failed with status:`,h,"response text:",l.getResponseText()),h>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const m=d==null?void 0:d.error;if(m&&m.status&&m.message){const v=function(y){const S=y.toLowerCase().replace(/_/g,"-");return Object.values(ue).indexOf(S)>=0?S:ue.UNKNOWN}(m.status);o(new Ce(v,m.message))}else o(new Ce(ue.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new Ce(ue.UNAVAILABLE,"Connection failed."));break;default:Le()}}finally{Pe(Pr,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);Pe(Pr,`RPC '${e}' ${i} sending request:`,s),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const s=H0(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=yk(),o=_k(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=i.join("");Pe(Pr,`Creating RPC '${e}' stream ${s}: ${u}`,l);const h=a.createWebChannel(u,l);let d=!1,m=!1;const v=new kO({Io:y=>{m?Pe(Pr,`Not sending because RPC '${e}' stream ${s} is closed:`,y):(d||(Pe(Pr,`Opening RPC '${e}' stream ${s} transport.`),h.open(),d=!0),Pe(Pr,`RPC '${e}' stream ${s} sending:`,y),h.send(y))},To:()=>h.close()}),g=(y,S,k)=>{y.listen(S,w=>{try{k(w)}catch(F){setTimeout(()=>{throw F},0)}})};return g(h,ec.EventType.OPEN,()=>{m||(Pe(Pr,`RPC '${e}' stream ${s} transport opened.`),v.yo())}),g(h,ec.EventType.CLOSE,()=>{m||(m=!0,Pe(Pr,`RPC '${e}' stream ${s} transport closed`),v.So())}),g(h,ec.EventType.ERROR,y=>{m||(m=!0,ol(Pr,`RPC '${e}' stream ${s} transport errored:`,y),v.So(new Ce(ue.UNAVAILABLE,"The operation could not be completed")))}),g(h,ec.EventType.MESSAGE,y=>{var S;if(!m){const k=y.data[0];gt(!!k);const w=k,F=w.error||((S=w[0])===null||S===void 0?void 0:S.error);if(F){Pe(Pr,`RPC '${e}' stream ${s} received error:`,F);const B=F.status;let V=function(T){const I=Kt[T];if(I!==void 0)return Hk(I)}(B),x=F.message;V===void 0&&(V=ue.INTERNAL,x="Unknown error status: "+B+" with message "+F.message),m=!0,v.So(new Ce(V,x)),h.close()}else Pe(Pr,`RPC '${e}' stream ${s} received:`,k),v.bo(k)}}),g(o,xk.STAT_EVENT,y=>{y.stat===um.PROXY?Pe(Pr,`RPC '${e}' stream ${s} detected buffering proxy`):y.stat===um.NOPROXY&&Pe(Pr,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{v.wo()},0),v}}function W0(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vd(t){return new Ob(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(e,r,n=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&Pe("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{constructor(e,r,n,s,i,a,o,l){this.ui=e,this.Ho=n,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new rS(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===ue.RESOURCE_EXHAUSTED?(hi(r.toString()),hi("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===ue.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new Ce(ue.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Pe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Pe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class AO extends nS{constructor(e,r,n,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=jb(this.serializer,e),n=function(i){if(!("targetChange"in i))return Ve.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Ve.min():a.readTime?Ts(a.readTime):Ve.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=_m(this.serializer),r.addTarget=function(i,a){let o;const l=a.target;if(o=pm(l)?{documents:Bb(i,l)}:{query:zb(i,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=Kk(i,a.resumeToken);const c=gm(i,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Ve.min())>0){o.readTime=$h(i,a.snapshotVersion.toTimestamp());const c=gm(i,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=Hb(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=_m(this.serializer),r.removeTarget=e,this.a_(r)}}class IO extends nS{constructor(e,r,n,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return gt(!!e.streamToken),this.lastStreamToken=e.streamToken,gt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){gt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=Ub(e.writeResults,e.commitTime),n=Ts(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=_m(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>Vb(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CO extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new Ce(ue.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,vm(r,n),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ce(ue.UNKNOWN,i.toString())})}Lo(e,r,n,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,vm(r,n),s,a,o,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ue.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ce(ue.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class RO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(hi(r),this.D_=!1):Pe("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NO{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{n.enqueueAndForget(async()=>{ro(this)&&(Pe("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Be(l);c.L_.add(4),await Du(c),c.q_.set("Unknown"),c.L_.delete(4),await Ud(c)}(this))})}),this.q_=new RO(n,s)}}async function Ud(t){if(ro(t))for(const e of t.B_)await e(!0)}async function Du(t){for(const e of t.B_)await e(!1)}function sS(t,e){const r=Be(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),yv(r)?_v(r):kl(r).r_()&&xv(r,e))}function vv(t,e){const r=Be(t),n=kl(r);r.N_.delete(e),n.r_()&&iS(r,e),r.N_.size===0&&(n.r_()?n.o_():ro(r)&&r.q_.set("Unknown"))}function xv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ve.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}kl(t).A_(e)}function iS(t,e){t.Q_.xe(e),kl(t).R_(e)}function _v(t){t.Q_=new Pb({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),kl(t).start(),t.q_.v_()}function yv(t){return ro(t)&&!kl(t).n_()&&t.N_.size>0}function ro(t){return Be(t).L_.size===0}function aS(t){t.Q_=void 0}async function PO(t){t.q_.set("Online")}async function DO(t){t.N_.forEach((e,r)=>{xv(t,e)})}async function FO(t,e){aS(t),yv(t)?(t.q_.M_(e),_v(t)):t.q_.set("Unknown")}async function bO(t,e,r){if(t.q_.set("Online"),e instanceof Gk&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const o of i.targetIds)s.N_.has(o)&&(await s.remoteSyncer.rejectListen(o,a),s.N_.delete(o),s.Q_.removeTarget(o))}(t,e)}catch(n){Pe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Hh(t,n)}else if(e instanceof th?t.Q_.Ke(e):e instanceof Wk?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Ve.min()))try{const n=await tS(t.localStore);r.compareTo(n)>=0&&await function(i,a){const o=i.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.N_.get(c);u&&i.N_.set(c,u.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const u=i.N_.get(l);if(!u)return;i.N_.set(l,u.withResumeToken(Sr.EMPTY_BYTE_STRING,u.snapshotVersion)),iS(i,l);const h=new Li(u.target,l,c,u.sequenceNumber);xv(i,h)}),i.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){Pe("RemoteStore","Failed to raise snapshot:",n),await Hh(t,n)}}async function Hh(t,e,r){if(!Ru(e))throw e;t.L_.add(1),await Du(t),t.q_.set("Offline"),r||(r=()=>tS(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Pe("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await Ud(t)})}function oS(t,e){return e().catch(r=>Hh(t,r,e))}async function Bd(t){const e=Be(t),r=na(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;OO(e);)try{const s=await xO(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,MO(e,s)}catch(s){await Hh(e,s)}lS(e)&&cS(e)}function OO(t){return ro(t)&&t.O_.length<10}function MO(t,e){t.O_.push(e);const r=na(t);r.r_()&&r.V_&&r.m_(e.mutations)}function lS(t){return ro(t)&&!na(t).n_()&&t.O_.length>0}function cS(t){na(t).start()}async function LO(t){na(t).p_()}async function jO(t){const e=na(t);for(const r of t.O_)e.m_(r.mutations)}async function VO(t,e,r){const n=t.O_.shift(),s=fv.from(n,e,r);await oS(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Bd(t)}async function UO(t,e){e&&na(t).V_&&await async function(n,s){if(function(a){return Cb(a)&&a!==ue.ABORTED}(s.code)){const i=n.O_.shift();na(n).s_(),await oS(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Bd(n)}}(t,e),lS(t)&&cS(t)}async function _y(t,e){const r=Be(t);r.asyncQueue.verifyOperationInProgress(),Pe("RemoteStore","RemoteStore received new credentials");const n=ro(r);r.L_.add(3),await Du(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await Ud(r)}async function BO(t,e){const r=Be(t);e?(r.L_.delete(2),await Ud(r)):e||(r.L_.add(2),await Du(r),r.q_.set("Unknown"))}function kl(t){return t.K_||(t.K_=function(r,n,s){const i=Be(r);return i.w_(),new AO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:PO.bind(null,t),Ro:DO.bind(null,t),mo:FO.bind(null,t),d_:bO.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),yv(t)?_v(t):t.q_.set("Unknown")):(await t.K_.stop(),aS(t))})),t.K_}function na(t){return t.U_||(t.U_=function(r,n,s){const i=Be(r);return i.w_(),new IO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:LO.bind(null,t),mo:UO.bind(null,t),f_:jO.bind(null,t),g_:VO.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Bd(t)):(await t.U_.stop(),t.O_.length>0&&(Pe("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wv{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new ei,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const a=Date.now()+n,o=new wv(e,r,a,s,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ce(ue.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ev(t,e){if(hi("AsyncQueue",`${e}: ${t}`),Ru(t))return new Ce(ue.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(e){this.comparator=e?(r,n)=>e(r,n)||De.comparator(r.key,n.key):(r,n)=>De.comparator(r.key,n.key),this.keyedMap=tc(),this.sortedSet=new Mt(this.comparator)}static emptySet(e){return new Ko(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Ko)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Ko;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(){this.W_=new Mt(De.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):Le():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class dl{constructor(e,r,n,s,i,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,s,i){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new dl(e,r,Ko.emptySet(r),a,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&bd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class $O{constructor(){this.queries=wy(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=Be(r),i=s.queries;s.queries=wy(),i.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new Ce(ue.ABORTED,"Firestore shutting down"))}}function wy(){return new Tl(t=>Dk(t),bd)}async function uS(t,e){const r=Be(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.H_()&&e.J_()&&(n=2):(i=new zO,n=e.J_()?0:1);try{switch(n){case 0:i.z_=await r.onListen(s,!0);break;case 1:i.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(a){const o=Ev(a,`Initialization of query '${yo(e.query)}' failed`);return void e.onError(o)}r.queries.set(s,i),i.j_.push(e),e.Z_(r.onlineState),i.z_&&e.X_(i.z_)&&Tv(r)}async function fS(t,e){const r=Be(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function HO(t,e){const r=Be(t);let n=!1;for(const s of e){const i=s.query,a=r.queries.get(i);if(a){for(const o of a.j_)o.X_(s)&&(n=!0);a.z_=s}}n&&Tv(r)}function WO(t,e,r){const n=Be(t),s=n.queries.get(e);if(s)for(const i of s.j_)i.onError(r);n.queries.delete(e)}function Tv(t){t.Y_.forEach(e=>{e.next()})}var wm,Ey;(Ey=wm||(wm={})).ea="default",Ey.Cache="cache";class hS{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new dl(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=dl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==wm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e){this.key=e}}class pS{constructor(e){this.key=e}}class GO{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Xe(),this.mutatedKeys=Xe(),this.Aa=Fk(e),this.Ra=new Ko(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new yy,s=r?r.Ra:this.Ra;let i=r?r.mutatedKeys:this.mutatedKeys,a=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,h)=>{const d=s.get(u),m=Od(this.query,h)?h:null,v=!!d&&this.mutatedKeys.has(d.key),g=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let y=!1;d&&m?d.data.isEqual(m.data)?v!==g&&(n.track({type:3,doc:m}),y=!0):this.ga(d,m)||(n.track({type:2,doc:m}),y=!0,(l&&this.Aa(m,l)>0||c&&this.Aa(m,c)<0)&&(o=!0)):!d&&m?(n.track({type:0,doc:m}),y=!0):d&&!m&&(n.track({type:1,doc:d}),y=!0,(l||c)&&(o=!0)),y&&(m?(a=a.add(m),i=g?i.add(u):i.delete(u)):(a=a.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),i=i.delete(u.key),n.track({type:1,doc:u})}return{Ra:a,fa:n,ns:o,mutatedKeys:i}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((u,h)=>function(m,v){const g=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Le()}};return g(m)-g(v)}(u.type,h.type)||this.Aa(u.doc,h.doc)),this.pa(n),s=s!=null&&s;const o=r&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new dl(this.query,e.Ra,i,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new yy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Xe(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new pS(n))}),this.da.forEach(n=>{e.has(n)||r.push(new dS(n))}),r}ba(e){this.Ta=e.Ts,this.da=Xe();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return dl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class KO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class qO{constructor(e){this.key=e,this.va=!1}}class XO{constructor(e,r,n,s,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Tl(o=>Dk(o),bd),this.Ma=new Map,this.xa=new Set,this.Oa=new Mt(De.comparator),this.Na=new Map,this.La=new pv,this.Ba={},this.ka=new Map,this.qa=hl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function YO(t,e,r=!0){const n=yS(t);let s;const i=n.Fa.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await mS(n,e,r,!0),s}async function QO(t,e){const r=yS(t);await mS(r,e,!0,!1)}async function mS(t,e,r,n){const s=await _O(t.localStore,Es(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let o;return n&&(o=await JO(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&r&&sS(t.remoteStore,s),o}async function JO(t,e,r,n,s){t.Ka=(h,d,m)=>async function(g,y,S,k){let w=y.view.ma(S);w.ns&&(w=await gy(g.localStore,y.query,!1).then(({documents:x})=>y.view.ma(x,w)));const F=k&&k.targetChanges.get(y.targetId),B=k&&k.targetMismatches.get(y.targetId)!=null,V=y.view.applyChanges(w,g.isPrimaryClient,F,B);return ky(g,y.targetId,V.wa),V.snapshot}(t,h,d,m);const i=await gy(t.localStore,e,!0),a=new GO(e,i.Ts),o=a.ma(i.documents),l=Pu.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),c=a.applyChanges(o,t.isPrimaryClient,l);ky(t,r,c.wa);const u=new KO(e,r,a);return t.Fa.set(e,u),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function ZO(t,e,r){const n=Be(t),s=n.Fa.get(e),i=n.Ma.get(s.targetId);if(i.length>1)return n.Ma.set(s.targetId,i.filter(a=>!bd(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await ym(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&vv(n.remoteStore,s.targetId),Em(n,s.targetId)}).catch(Cu)):(Em(n,s.targetId),await ym(n.localStore,s.targetId,!0))}async function eM(t,e){const r=Be(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),vv(r.remoteStore,n.targetId))}async function tM(t,e,r){const n=lM(t);try{const s=await function(a,o){const l=Be(a),c=sr.now(),u=o.reduce((m,v)=>m.add(v.key),Xe());let h,d;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let v=di(),g=Xe();return l.cs.getEntries(m,u).next(y=>{v=y,v.forEach((S,k)=>{k.isValidDocument()||(g=g.add(S))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,v)).next(y=>{h=y;const S=[];for(const k of o){const w=Tb(k,h.get(k.key).overlayedDocument);w!=null&&S.push(new ha(k.key,w,Sk(w.value.mapValue),Mn.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,S,o)}).next(y=>{d=y;const S=y.applyToLocalDocumentSet(h,g);return l.documentOverlayCache.saveOverlays(m,y.batchId,S)})}).then(()=>({batchId:d.batchId,changes:Ok(h)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new Mt(lt)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,s.batchId,r),await Fu(n,s.changes),await Bd(n.remoteStore)}catch(s){const i=Ev(s,"Failed to persist write");r.reject(i)}}async function gS(t,e){const r=Be(t);try{const n=await gO(r.localStore,e);e.targetChanges.forEach((s,i)=>{const a=r.Na.get(i);a&&(gt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?gt(a.va):s.removedDocuments.size>0&&(gt(a.va),a.va=!1))}),await Fu(r,n,e)}catch(n){await Cu(n)}}function Ty(t,e,r){const n=Be(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((i,a)=>{const o=a.view.Z_(e);o.snapshot&&s.push(o.snapshot)}),function(a,o){const l=Be(a);l.onlineState=o;let c=!1;l.queries.forEach((u,h)=>{for(const d of h.j_)d.Z_(o)&&(c=!0)}),c&&Tv(l)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function rM(t,e,r){const n=Be(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),i=s&&s.key;if(i){let a=new Mt(De.comparator);a=a.insert(i,Mr.newNoDocument(i,Ve.min()));const o=Xe().add(i),l=new jd(Ve.min(),new Map,new Mt(lt),a,o);await gS(n,l),n.Oa=n.Oa.remove(i),n.Na.delete(e),kv(n)}else await ym(n.localStore,e,!1).then(()=>Em(n,e,r)).catch(Cu)}async function nM(t,e){const r=Be(t),n=e.batch.batchId;try{const s=await mO(r.localStore,e);xS(r,n,null),vS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Fu(r,s)}catch(s){await Cu(s)}}async function sM(t,e,r){const n=Be(t);try{const s=await function(a,o){const l=Be(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(h=>(gt(h!==null),u=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,e);xS(n,e,r),vS(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Fu(n,s)}catch(s){await Cu(s)}}function vS(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function xS(t,e,r){const n=Be(t);let s=n.Ba[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function Em(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||_S(t,n)})}function _S(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(vv(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),kv(t))}function ky(t,e,r){for(const n of r)n instanceof dS?(t.La.addReference(n.key,e),iM(t,n)):n instanceof pS?(Pe("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||_S(t,n.key)):Le()}function iM(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Pe("SyncEngine","New document in limbo: "+r),t.xa.add(n),kv(t))}function kv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new De(yt.fromString(e)),n=t.qa.next();t.Na.set(n,new qO(r)),t.Oa=t.Oa.insert(r,n),sS(t.remoteStore,new Li(Es(ov(r.path)),n,"TargetPurposeLimboResolution",rv.oe))}}async function Fu(t,e,r){const n=Be(t),s=[],i=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var u;if((c||r)&&n.isPrimaryClient){const h=c?!c.fromCache:(u=r==null?void 0:r.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){s.push(c);const h=gv.Wi(l.targetId,c);i.push(h)}}))}),await Promise.all(a),n.Ca.d_(s),await async function(l,c){const u=Be(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>me.forEach(c,d=>me.forEach(d.$i,m=>u.persistence.referenceDelegate.addReference(h,d.targetId,m)).next(()=>me.forEach(d.Ui,m=>u.persistence.referenceDelegate.removeReference(h,d.targetId,m)))))}catch(h){if(!Ru(h))throw h;Pe("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const d=h.targetId;if(!h.fromCache){const m=u.os.get(d),v=m.snapshotVersion,g=m.withLastLimboFreeSnapshotVersion(v);u.os=u.os.insert(d,g)}}}(n.localStore,i))}async function aM(t,e){const r=Be(t);if(!r.currentUser.isEqual(e)){Pe("SyncEngine","User change. New user:",e.toKey());const n=await eS(r.localStore,e);r.currentUser=e,function(i,a){i.ka.forEach(o=>{o.forEach(l=>{l.reject(new Ce(ue.CANCELLED,a))})}),i.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Fu(r,n.hs)}}function oM(t,e){const r=Be(t),n=r.Na.get(e);if(n&&n.va)return Xe().add(n.key);{let s=Xe();const i=r.Ma.get(e);if(!i)return s;for(const a of i){const o=r.Fa.get(a);s=s.unionWith(o.view.Va)}return s}}function yS(t){const e=Be(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=gS.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=oM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=rM.bind(null,e),e.Ca.d_=HO.bind(null,e.eventManager),e.Ca.$a=WO.bind(null,e.eventManager),e}function lM(t){const e=Be(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=nM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=sM.bind(null,e),e}class Wh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Vd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return pO(this.persistence,new hO,e.initialUser,this.serializer)}Ga(e){return new cO(mv.Zr,this.serializer)}Wa(e){return new wO}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Wh.provider={build:()=>new Wh};class Tm{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Ty(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=aM.bind(null,this.syncEngine),await BO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new $O}()}createDatastore(e){const r=Vd(e.databaseInfo.databaseId),n=function(i){return new SO(i)}(e.databaseInfo);return function(i,a,o,l){return new CO(i,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,a,o){return new NO(n,s,i,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>Ty(this.syncEngine,r,0),function(){return xy.D()?new xy:new EO}())}createSyncEngine(e,r){return function(s,i,a,o,l,c,u){const h=new XO(s,i,a,o,l,c);return u&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=Be(s);Pe("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Du(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Tm.provider={build:()=>new Tm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):hi("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Fr.UNAUTHENTICATED,this.clientId=Ek.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{Pe("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(Pe("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ei;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Ev(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function G0(t,e){t.asyncQueue.verifyOperationInProgress(),Pe("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await eS(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Sy(t,e){t.asyncQueue.verifyOperationInProgress();const r=await uM(t);Pe("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>_y(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>_y(e.remoteStore,s)),t._onlineComponents=e}async function uM(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Pe("FirestoreClient","Using user provided OfflineComponentProvider");try{await G0(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===ue.FAILED_PRECONDITION||s.code===ue.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;ol("Error using user provided cache. Falling back to memory cache: "+r),await G0(t,new Wh)}}else Pe("FirestoreClient","Using default OfflineComponentProvider"),await G0(t,new Wh);return t._offlineComponents}async function ES(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Pe("FirestoreClient","Using user provided OnlineComponentProvider"),await Sy(t,t._uninitializedComponentsProvider._online)):(Pe("FirestoreClient","Using default OnlineComponentProvider"),await Sy(t,new Tm))),t._onlineComponents}function fM(t){return ES(t).then(e=>e.syncEngine)}async function TS(t){const e=await ES(t),r=e.eventManager;return r.onListen=YO.bind(null,e.syncEngine),r.onUnlisten=ZO.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=QO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=eM.bind(null,e.syncEngine),r}function hM(t,e,r={}){const n=new ei;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,c){const u=new wS({next:d=>{u.Za(),a.enqueueAndForget(()=>fS(i,h));const m=d.docs.has(o);!m&&d.fromCache?c.reject(new Ce(ue.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&d.fromCache&&l&&l.source==="server"?c.reject(new Ce(ue.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new hS(ov(o.path),u,{includeMetadataChanges:!0,_a:!0});return uS(i,h)}(await TS(t),t.asyncQueue,e,r,n)),n.promise}function dM(t,e,r={}){const n=new ei;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,c){const u=new wS({next:d=>{u.Za(),a.enqueueAndForget(()=>fS(i,h)),d.fromCache&&l.source==="server"?c.reject(new Ce(ue.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),h=new hS(o,u,{includeMetadataChanges:!0,_a:!0});return uS(i,h)}(await TS(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SS(t,e,r){if(!r)throw new Ce(ue.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function pM(t,e,r,n){if(e===!0&&n===!0)throw new Ce(ue.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Iy(t){if(!De.isDocumentKey(t))throw new Ce(ue.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Cy(t){if(De.isDocumentKey(t))throw new Ce(ue.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function zd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Le()}function os(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ce(ue.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=zd(t);throw new Ce(ue.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function mM(t,e){if(e<=0)throw new Ce(ue.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Ce(ue.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ce(ue.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}pM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kS((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ce(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ce(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ce(ue.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class $d{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ry({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ce(ue.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ce(ue.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ry(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new P3;switch(n.type){case"firstParty":return new O3(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ce(ue.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Ay.get(r);n&&(Pe("ComponentProvider","Removing Datastore"),Ay.delete(r),n.terminate())}(this),Promise.resolve()}}function gM(t,e,r,n={}){var s;const i=(t=os(t,$d))._getSettings(),a=`${e}:${r}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&ol("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Fr.MOCK_USER;else{o=R2(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new Ce(ue.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Fr(c)}t._authCredentials=new D3(new wk(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ps(this.firestore,e,this._query)}}class Xr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xr(this.firestore,e,this._key)}}class Yi extends Ps{constructor(e,r,n){super(e,r,ov(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xr(this.firestore,null,new De(e))}withConverter(e){return new Yi(this.firestore,e,this._path)}}function ti(t,e,...r){if(t=Ht(t),SS("collection","path",e),t instanceof $d){const n=yt.fromString(e,...r);return Cy(n),new Yi(t,null,n)}{if(!(t instanceof Xr||t instanceof Yi))throw new Ce(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(yt.fromString(e,...r));return Cy(n),new Yi(t.firestore,null,n)}}function ls(t,e,...r){if(t=Ht(t),arguments.length===1&&(e=Ek.newId()),SS("doc","path",e),t instanceof $d){const n=yt.fromString(e,...r);return Iy(n),new Xr(t,null,new De(n))}{if(!(t instanceof Xr||t instanceof Yi))throw new Ce(ue.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(yt.fromString(e,...r));return Iy(n),new Xr(t.firestore,t instanceof Yi?t.converter:null,new De(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new rS(this,"async_queue_retry"),this.Vu=()=>{const n=W0();n&&Pe("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=W0();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=W0();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new ei;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ru(e))throw e;Pe("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const s=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw hi("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const s=wv.createAndSchedule(this,e,r,n,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&Le()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}class no extends $d{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new Ny,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Ny(e),this._firestoreClient=void 0,await e}}}function vM(t,e){const r=typeof t=="object"?t:Cd(),n=typeof t=="string"?t:"(default)",s=ku(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=Bg("firestore");i&&gM(s,...i)}return s}function Sv(t){if(t._terminated)throw new Ce(ue.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||xM(t),t._firestoreClient}function xM(t){var e,r,n;const s=t._freezeSettings(),i=function(o,l,c,u){return new q3(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,kS(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new cM(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new pl(Sr.fromBase64String(e))}catch(r){throw new Ce(ue.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new pl(Sr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ce(ue.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _r(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ce(ue.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ce(ue.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return lt(this._lat,e._lat)||lt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _M=/^__.*__$/;class yM{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new ha(e,this.data,this.fieldMask,r,this.fieldTransforms):new Nu(e,this.data,r,this.fieldTransforms)}}class AS{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new ha(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function IS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Le()}}class Cv{constructor(e,r,n,s,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Cv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.Ou(e),s}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Gh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(IS(this.Cu)&&_M.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class wM{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Vd(e)}Qu(e,r,n,s=!1){return new Cv({Cu:e,methodName:r,qu:n,path:_r.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function bu(t){const e=t._freezeSettings(),r=Vd(t._databaseId);return new wM(t._databaseId,!!e.ignoreUndefinedProperties,r)}function CS(t,e,r,n,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,r,s);Nv("Data must be an object, but it was:",a,n);const o=NS(n,a);let l,c;if(i.merge)l=new _n(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const d=km(e,h,r);if(!a.contains(d))throw new Ce(ue.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);DS(u,d)||u.push(d)}l=new _n(u),c=a.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=a.fieldTransforms;return new yM(new on(o),l,c)}class Gd extends Wd{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Gd}}class Rv extends Wd{_toFieldTransform(e){return new _b(e.path,new nu)}isEqual(e){return e instanceof Rv}}function EM(t,e,r,n){const s=t.Qu(1,e,r);Nv("Data must be an object, but it was:",s,n);const i=[],a=on.empty();to(n,(l,c)=>{const u=Pv(e,l,r);c=Ht(c);const h=s.Nu(u);if(c instanceof Gd)i.push(u);else{const d=Ou(c,h);d!=null&&(i.push(u),a.set(u,d))}});const o=new _n(i);return new AS(a,o,s.fieldTransforms)}function TM(t,e,r,n,s,i){const a=t.Qu(1,e,r),o=[km(e,n,r)],l=[s];if(i.length%2!=0)throw new Ce(ue.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)o.push(km(e,i[d])),l.push(i[d+1]);const c=[],u=on.empty();for(let d=o.length-1;d>=0;--d)if(!DS(c,o[d])){const m=o[d];let v=l[d];v=Ht(v);const g=a.Nu(m);if(v instanceof Gd)c.push(m);else{const y=Ou(v,g);y!=null&&(c.push(m),u.set(m,y))}}const h=new _n(c);return new AS(u,h,a.fieldTransforms)}function RS(t,e,r,n=!1){return Ou(r,t.Qu(n?4:3,e))}function Ou(t,e){if(PS(t=Ht(t)))return Nv("Unsupported field value:",e,t),NS(t,e);if(t instanceof Wd)return function(n,s){if(!IS(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,s){const i=[];let a=0;for(const o of n){let l=Ou(o,s.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=Ht(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return gb(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=sr.fromDate(n);return{timestampValue:$h(s.serializer,i)}}if(n instanceof sr){const i=new sr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:$h(s.serializer,i)}}if(n instanceof Av)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof pl)return{bytesValue:Kk(s.serializer,n._byteString)};if(n instanceof Xr){const i=s.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:dv(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Iv)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return cv(o.serializer,l)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${zd(n)}`)}(t,e)}function NS(t,e){const r={};return Tk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):to(t,(n,s)=>{const i=Ou(s,e.Mu(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function PS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof sr||t instanceof Av||t instanceof pl||t instanceof Xr||t instanceof Wd||t instanceof Iv)}function Nv(t,e,r){if(!PS(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=zd(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function km(t,e,r){if((e=Ht(e))instanceof Hd)return e._internalPath;if(typeof e=="string")return Pv(t,e);throw Gh("Field path arguments must be of type string or ",t,!1,void 0,r)}const kM=new RegExp("[~\\*/\\[\\]]");function Pv(t,e,r){if(e.search(kM)>=0)throw Gh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Hd(...e.split("."))._internalPath}catch{throw Gh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Gh(t,e,r,n,s){const i=n&&!n.isEmpty(),a=s!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${n}`),a&&(l+=` in document ${s}`),l+=")"),new Ce(ue.INVALID_ARGUMENT,o+t+l)}function DS(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Xr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new SM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Kd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class SM extends Dv{data(){return super.data()}}function Kd(t,e){return typeof e=="string"?Pv(t,e):e instanceof Hd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AM(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Ce(ue.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Fv{}class Mu extends Fv{}function ba(t,e,...r){let n=[];e instanceof Fv&&n.push(e),n=n.concat(r),function(i){const a=i.filter(l=>l instanceof bv).length,o=i.filter(l=>l instanceof qd).length;if(a>1||a>0&&o>0)throw new Ce(ue.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class qd extends Mu{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new qd(e,r,n)}_apply(e){const r=this._parse(e);return bS(e._query,r),new Ps(e.firestore,e.converter,mm(e._query,r))}_parse(e){const r=bu(e.firestore);return function(i,a,o,l,c,u,h){let d;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new Ce(ue.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){Dy(h,u);const m=[];for(const v of h)m.push(Py(l,i,v));d={arrayValue:{values:m}}}else d=Py(l,i,h)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||Dy(h,u),d=RS(o,a,h,u==="in"||u==="not-in");return Jt.create(c,u,d)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function au(t,e,r){const n=e,s=Kd("where",t);return qd._create(s,n,r)}class bv extends Fv{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new bv(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:as.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let a=s;const o=i.getFlattenedFilters();for(const l of o)bS(a,l),a=mm(a,l)}(e._query,r),new Ps(e.firestore,e.converter,mm(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ov extends Mu{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Ov(e,r)}_apply(e){const r=function(s,i,a){if(s.startAt!==null)throw new Ce(ue.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Ce(ue.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ru(i,a)}(e._query,this._field,this._direction);return new Ps(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new fa(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function IM(t,e="asc"){const r=e,n=Kd("orderBy",t);return Ov._create(n,r)}class Mv extends Mu{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new Mv(e,r,n)}_apply(e){return new Ps(e.firestore,e.converter,Bh(e._query,this._limit,this._limitType))}}function K0(t){return mM("limit",t),Mv._create("limit",t,"F")}class Lv extends Mu{constructor(e,r,n){super(),this.type=e,this._docOrFields=r,this._inclusive=n}static _create(e,r,n){return new Lv(e,r,n)}_apply(e){const r=FS(e,this.type,this._docOrFields,this._inclusive);return new Ps(e.firestore,e.converter,function(s,i){return new fa(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,r))}}function CM(...t){return Lv._create("startAt",t,!0)}class jv extends Mu{constructor(e,r,n){super(),this.type=e,this._docOrFields=r,this._inclusive=n}static _create(e,r,n){return new jv(e,r,n)}_apply(e){const r=FS(e,this.type,this._docOrFields,this._inclusive);return new Ps(e.firestore,e.converter,function(s,i){return new fa(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,i)}(e._query,r))}}function RM(...t){return jv._create("endAt",t,!0)}function FS(t,e,r,n){if(r[0]=Ht(r[0]),r[0]instanceof Dv)return function(i,a,o,l,c){if(!l)throw new Ce(ue.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const u=[];for(const h of Go(i))if(h.field.isKeyField())u.push(Uh(a,l.key));else{const d=l.data.field(h.field);if(Fd(d))throw new Ce(ue.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(d===null){const m=h.field.canonicalString();throw new Ce(ue.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${m}' (used as the orderBy) does not exist.`)}u.push(d)}return new fl(u,c)}(t._query,t.firestore._databaseId,e,r[0]._document,n);{const s=bu(t.firestore);return function(a,o,l,c,u,h){const d=a.explicitOrderBy;if(u.length>d.length)throw new Ce(ue.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const m=[];for(let v=0;v<u.length;v++){const g=u[v];if(d[v].field.isKeyField()){if(typeof g!="string")throw new Ce(ue.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof g}`);if(!lv(a)&&g.indexOf("/")!==-1)throw new Ce(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${g}' contains a slash.`);const y=a.path.child(yt.fromString(g));if(!De.isDocumentKey(y))throw new Ce(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${y}' is not because it contains an odd number of segments.`);const S=new De(y);m.push(Uh(o,S))}else{const y=RS(l,c,g);m.push(y)}}return new fl(m,h)}(t._query,t.firestore._databaseId,s,e,r,n)}}function Py(t,e,r){if(typeof(r=Ht(r))=="string"){if(r==="")throw new Ce(ue.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lv(e)&&r.indexOf("/")!==-1)throw new Ce(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(yt.fromString(r));if(!De.isDocumentKey(n))throw new Ce(ue.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Uh(t,new De(n))}if(r instanceof Xr)return Uh(t,r._key);throw new Ce(ue.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zd(r)}.`)}function Dy(t,e){if(!Array.isArray(t)||t.length===0)throw new Ce(ue.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bS(t,e){const r=function(s,i){for(const a of s)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Ce(ue.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ce(ue.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class NM{convertValue(e,r="none"){switch(Ga(e)){case 0:return null;case 1:return e.booleanValue;case 2:return zt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Wa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Le()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return to(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var r,n,s;const i=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(a=>zt(a.doubleValue));return new Iv(i)}convertGeoPoint(e){return new Av(zt(e.latitude),zt(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=nv(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Zc(e));default:return null}}convertTimestamp(e){const r=ra(e);return new sr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=yt.fromString(e);gt(Zk(n));const s=new eu(n.get(1),n.get(3)),i=new De(n.popFirst(5));return s.isEqual(r)||hi(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class MS extends Dv{constructor(e,r,n,s,i,a){super(e,r,n,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new rh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Kd("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class rh extends MS{data(e={}){return super.data(e)}}class PM{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new nc(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new rh(this._firestore,this._userDataWriter,n.key,n,new nc(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Ce(ue.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(o=>{const l=new rh(s._firestore,s._userDataWriter,o.doc.key,o.doc,new nc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const l=new rh(s._firestore,s._userDataWriter,o.doc.key,o.doc,new nc(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:DM(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function DM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Le()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ka(t){t=os(t,Xr);const e=os(t.firestore,no);return hM(Sv(e),t._key).then(r=>bM(e,t,r))}class LS extends NM{constructor(e){super(),this.firestore=e}convertBytes(e){return new pl(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Xr(this.firestore,null,r)}}function ks(t){t=os(t,Ps);const e=os(t.firestore,no),r=Sv(e),n=new LS(e);return AM(t._query),dM(r,t._query).then(s=>new PM(e,n,t,s))}function Kh(t,e,r){t=os(t,Xr);const n=os(t.firestore,no),s=OS(t.converter,e,r);return Xd(n,[CS(bu(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,Mn.none())])}function Vv(t,e,r,...n){t=os(t,Xr);const s=os(t.firestore,no),i=bu(s);let a;return a=typeof(e=Ht(e))=="string"||e instanceof Hd?TM(i,"updateDoc",t._key,e,r,n):EM(i,"updateDoc",t._key,e),Xd(s,[a.toMutation(t._key,Mn.exists(!0))])}function FM(t){return Xd(os(t.firestore,no),[new uv(t._key,Mn.none())])}function Uv(t,e){const r=os(t.firestore,no),n=ls(t),s=OS(t.converter,e);return Xd(r,[CS(bu(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,Mn.exists(!1))]).then(()=>n)}function Xd(t,e){return function(n,s){const i=new ei;return n.asyncQueue.enqueueAndForget(async()=>tM(await fM(n),s,i)),i.promise}(Sv(t),e)}function bM(t,e,r){const n=r.docs.get(e._key),s=new LS(t);return new MS(t,s,e._key,n,new nc(r.hasPendingWrites,r.fromCache),e.converter)}function OM(){return new Rv("serverTimestamp")}(function(e,r=!0){(function(s){El=s})(eo),ea(new ci("firestore",(n,{instanceIdentifier:s,options:i})=>{const a=n.getProvider("app").getImmediate(),o=new no(new F3(n.getProvider("auth-internal")),new L3(n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Ce(ue.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new eu(c.options.projectId,u)}(a,s),a);return i=Object.assign({useFetchStreams:r},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),On(X_,"4.7.3",e),On(X_,"4.7.3","esm2017")})();var MM="firebase",LM="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */On(MM,LM,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jS="firebasestorage.googleapis.com",jM="storageBucket",VM=2*60*1e3,UM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds extends Ns{constructor(e,r,n=0){super(q0(e),`Firebase Storage: ${r} (${q0(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ds.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return q0(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Is;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Is||(Is={}));function q0(t){return"storage/"+t}function BM(){const t="An unknown error occurred, please check the error payload for server response.";return new Ds(Is.UNKNOWN,t)}function zM(){return new Ds(Is.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function $M(){return new Ds(Is.CANCELED,"User canceled the upload/download.")}function HM(t){return new Ds(Is.INVALID_URL,"Invalid URL '"+t+"'.")}function WM(t){return new Ds(Is.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Fy(t){return new Ds(Is.INVALID_ARGUMENT,t)}function VS(){return new Ds(Is.APP_DELETED,"The Firebase app was deleted.")}function GM(t){return new Ds(Is.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Jn.makeFromUrl(e,r)}catch{return new Jn(e,"")}if(n.path==="")return n;throw WM(e)}static makeFromUrl(e,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function i(F){F.path.charAt(F.path.length-1)==="/"&&(F.path_=F.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+s+a,"i"),l={bucket:1,path:3};function c(F){F.path_=decodeURIComponent(F.path)}const u="v[A-Za-z0-9_]+",h=r.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",m=new RegExp(`^https?://${h}/${u}/b/${s}/o${d}`,"i"),v={bucket:1,path:3},g=r===jS?"(?:storage.googleapis.com|storage.cloud.google.com)":r,y="([^?#]*)",S=new RegExp(`^https?://${g}/${s}/${y}`,"i"),w=[{regex:o,indices:l,postModify:i},{regex:m,indices:v,postModify:c},{regex:S,indices:{bucket:1,path:2},postModify:c}];for(let F=0;F<w.length;F++){const B=w[F],V=B.regex.exec(e);if(V){const x=V[B.indices.bucket];let E=V[B.indices.path];E||(E=""),n=new Jn(x,E),B.postModify(n);break}}if(n==null)throw HM(e);return n}}class KM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qM(t,e,r){let n=1,s=null,i=null,a=!1,o=0;function l(){return o===2}let c=!1;function u(...y){c||(c=!0,e.apply(null,y))}function h(y){s=setTimeout(()=>{s=null,t(m,l())},y)}function d(){i&&clearTimeout(i)}function m(y,...S){if(c){d();return}if(y){d(),u.call(null,y,...S);return}if(l()||a){d(),u.call(null,y,...S);return}n<64&&(n*=2);let w;o===1?(o=2,w=0):w=(n+Math.random())*1e3,h(w)}let v=!1;function g(y){v||(v=!0,d(),!c&&(s!==null?(y||(o=2),clearTimeout(s),h(0)):y||(o=1)))}return h(0),i=setTimeout(()=>{a=!0,g(!0)},r),g}function XM(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YM(t){return t!==void 0}function by(t,e,r,n){if(n<e)throw Fy(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw Fy(`Invalid value for '${t}'. Expected ${r} or less.`)}function QM(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const s=e(n)+"="+e(t[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var qh;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(qh||(qh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JM(t,e){const r=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return r||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(e,r,n,s,i,a,o,l,c,u,h,d=!0){this.url_=e,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((m,v)=>{this.resolve_=m,this.reject_=v,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new Sf(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const o=i.getErrorCode()===qh.NO_ERROR,l=i.getStatus();if(!o||JM(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===qh.ABORT;n(!1,new Sf(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new Sf(c,i))})},r=(n,s)=>{const i=this.resolve_,a=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());YM(l)?i(l):i()}catch(l){a(l)}else if(o!==null){const l=BM();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(s.canceled){const l=this.appDelete_?VS():$M();a(l)}else{const l=zM();a(l)}};this.canceled_?r(!1,new Sf(!1,null,!0)):this.backoffId_=qM(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&XM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Sf{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function eL(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function tL(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function rL(t,e){e&&(t["X-Firebase-GMPID"]=e)}function nL(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function sL(t,e,r,n,s,i,a=!0){const o=QM(t.urlParams),l=t.url+o,c=Object.assign({},t.headers);return rL(c,e),eL(c,r),tL(c,i),nL(c,n),new ZM(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iL(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function aL(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e,r){this._service=e,r instanceof Jn?this._location=r:this._location=Jn.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Xh(e,r)}get root(){const e=new Jn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return aL(this._location.path)}get storage(){return this._service}get parent(){const e=iL(this._location.path);if(e===null)return null;const r=new Jn(this._location.bucket,e);return new Xh(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw GM(e)}}function Oy(t,e){const r=e==null?void 0:e[jM];return r==null?null:Jn.makeFromBucketSpec(r,t)}function oL(t,e,r,n={}){t.host=`${e}:${r}`,t._protocol="http";const{mockUserToken:s}=n;s&&(t._overrideAuthToken=typeof s=="string"?s:R2(s,t.app.options.projectId))}class lL{constructor(e,r,n,s,i){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=jS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=VM,this._maxUploadRetryTime=UM,this._requests=new Set,s!=null?this._bucket=Jn.makeFromBucketSpec(s,this._host):this._bucket=Oy(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Jn.makeFromBucketSpec(this._url,e):this._bucket=Oy(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){by("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){by("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xh(this,e)}_makeRequest(e,r,n,s,i=!0){if(this._deleted)return new KM(VS());{const a=sL(e,this._appId,n,s,r,this._firebaseVersion,i);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,s).getPromise()}}const My="@firebase/storage",Ly="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const US="storage";function cL(t=Cd(),e){t=Ht(t);const n=ku(t,US).getImmediate({identifier:e}),s=Bg("storage");return s&&uL(n,...s),n}function uL(t,e,r,n={}){oL(t,e,r,n)}function fL(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new lL(r,n,s,e,eo)}function hL(){ea(new ci(US,fL,"PUBLIC").setMultipleInstances(!0)),On(My,Ly,""),On(My,Ly,"esm2017")}hL();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BS="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e,r,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||n.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const r=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(e){const r=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:r,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sm="us-central1";class pL{constructor(e,r,n,s,i=Sm,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new dL(r,n,s),this.cancelAllRequests=new Promise(o=>{this.deleteService=()=>Promise.resolve(o())});try{const o=new URL(i);this.customDomain=o.origin+(o.pathname==="/"?"":o.pathname),this.region=Sm}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${r}.cloudfunctions.net/${e}`}}function mL(t,e,r){t.emulatorOrigin=`http://${e}:${r}`}const jy="@firebase/functions",Vy="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gL="auth-internal",vL="app-check-internal",xL="messaging-internal";function _L(t,e){const r=(n,{instanceIdentifier:s})=>{const i=n.getProvider("app").getImmediate(),a=n.getProvider(gL),o=n.getProvider(xL),l=n.getProvider(vL);return new pL(i,a,o,l,s,t)};ea(new ci(BS,r,"PUBLIC").setMultipleInstances(!0)),On(jy,Vy,e),On(jy,Vy,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yL(t=Cd(),e=Sm){const n=ku(Ht(t),BS).getImmediate({identifier:e}),s=Bg("functions");return s&&wL(n,...s),n}function wL(t,e,r){mL(Ht(t),e,r)}_L(fetch.bind(self));const EL={apiKey:"AIzaSyAnEPcQISz9FY68mib-0StN6NQtTF3oz1c",authDomain:"xmas-movies.firebaseapp.com",projectId:"xmas-movies",storageBucket:"xmas-movies.firebasestorage.app",messagingSenderId:"721037810395",appId:"1:721037810395:web:1126b377adcc225c944afe"},Yd=D2(EL),wc=R3(Yd),zS=new vs;zS.setCustomParameters({prompt:"select_account"});const TL=zS,ir=vM(Yd);cL(Yd);yL(Yd);const $S=W.createContext(void 0),vi=()=>{const t=W.useContext($S);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},kL=({children:t})=>{const[e,r]=W.useState(null),[n,s]=W.useState(null),[i,a]=W.useState(!0),[o,l]=W.useState(null);W.useEffect(()=>{const d=rk(wc,async m=>{if(r(m),l(null),m)try{const v=ls(ir,"users",m.uid),g=await Ka(v);if(g.exists())await Kh(v,{lastLoginAt:OM()},{merge:!0}),s(g.data());else{const y={email:m.email||"",displayName:m.displayName||"User",photoURL:m.photoURL||void 0,createdAt:new Date,lastLoginAt:new Date};await Kh(v,y),s({id:m.uid,...y})}}catch(v){console.error("Error fetching user profile:",v),l("Failed to load user profile")}else s(null);a(!1)});return()=>d()},[]);const h={currentUser:e,userProfile:n,isLoading:i,error:o,signInWithGoogle:async()=>{try{l(null),a(!0);const d=new vs;await dk(wc,d)}catch(d){console.error("Login error:",d),l(d.message||"Failed to sign in")}finally{a(!1)}},signOut:async()=>{try{await _F(wc)}catch(d){console.error("Sign out error:",d),l(d.message||"Failed to sign out")}}};return p.jsx($S.Provider,{value:h,children:t})},Qd=()=>{const[t,e]=W.useState(!1),[r,n]=W.useState(!0),[s,i]=W.useState(null),[a,o]=W.useState(null);return W.useEffect(()=>{const l=rk(wc,async c=>{if(n(!0),i(null),!c){e(!1),o(null),n(!1);return}o({uid:c.uid,email:c.email});try{if((await B2(c)).claims.admin===!0){e(!0),n(!1);return}const d=ls(ir,"admins",c.uid),m=await Ka(d);e(m.exists())}catch(u){console.error("Error checking admin status:",u),i("Failed to verify admin status"),e(!1)}finally{n(!1)}});return()=>l()},[]),{isAdmin:t,loading:r,error:s,currentUser:a}},SL=({snowflakeCount:t=100,mobileSnowflakeCount:e=50})=>{const[r,n]=W.useState(!1),[s,i]=W.useState(t),a=W.useRef(null),o=W.useRef([]),l=W.useRef(0);return W.useEffect(()=>{const c=()=>{const u=window.matchMedia("(max-width: 768px)").matches;n(u),i(u?e:t)};return c(),window.addEventListener("resize",c),()=>{window.removeEventListener("resize",c)}},[t,e]),W.useEffect(()=>{const c=a.current;if(!c)return;const u=c.getContext("2d");if(!u)return;const h=()=>{c.width=window.innerWidth,c.height=window.innerHeight},d=()=>{o.current=[];for(let y=0;y<s;y++)o.current.push({x:Math.random()*c.width,y:Math.random()*c.height,size:r?Math.random()*3+1:Math.random()*4+1,speed:r?Math.random()*.8+.3:Math.random()*1+.5,opacity:r?Math.random()*.5+.2:Math.random()*.6+.3,wind:r?Math.random()*.3-.15:Math.random()*.5-.25})},m=y=>{u.beginPath(),u.arc(y.x,y.y,y.size,0,Math.PI*2),u.fillStyle=`rgba(255, 255, 255, ${y.opacity})`,u.fill()},v=y=>{y.y+=y.speed,y.x+=y.wind,y.y>c.height&&(y.y=-10,y.x=Math.random()*c.width),y.x>c.width?y.x=0:y.x<0&&(y.x=c.width)},g=()=>{u.clearRect(0,0,c.width,c.height),o.current.forEach(y=>{m(y),v(y)}),l.current=requestAnimationFrame(g)};return window.addEventListener("resize",h),h(),d(),g(),()=>{window.removeEventListener("resize",h),cancelAnimationFrame(l.current)}},[s]),p.jsx("canvas",{ref:a,className:"fixed top-0 left-0 w-full h-full pointer-events-none z-10","aria-hidden":"true"})},AL=()=>{const[t,e]=W.useState(!1),[r,n]=W.useState(null),[s,i]=W.useState(!1);W.useEffect(()=>{const l=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;i(l);const c=u=>{u.preventDefault(),n(u),e(!0)};return window.addEventListener("beforeinstallprompt",c),window.matchMedia("(display-mode: standalone)").matches&&e(!1),()=>{window.removeEventListener("beforeinstallprompt",c)}},[]);const a=async()=>{if(!r)return;r.prompt();const{outcome:l}=await r.userChoice;n(null),e(!1),console.log(`User ${l==="accepted"?"accepted":"dismissed"} the install prompt`)},o=()=>{e(!1),localStorage.setItem("installPromptDismissed","true")};return t?p.jsxs("div",{className:"fixed bottom-0 left-0 right-0 bg-green-800 text-white p-4 shadow-lg z-50 flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"mr-3 text-2xl",children:p.jsx("i",{className:"fas fa-gift"})}),p.jsx("div",{children:s?p.jsxs("p",{children:["Install this app on your device: tap ",p.jsx("i",{className:"fas fa-share"}),' and then "Add to Home Screen"']}):p.jsx("p",{children:"Add Christmas Movies to your home screen!"})})]}),p.jsxs("div",{className:"flex items-center",children:[!s&&p.jsx("button",{onClick:a,className:"bg-red-700 hover:bg-red-800 text-white py-1 px-4 rounded-full mr-2",children:"Install"}),p.jsx("button",{onClick:o,className:"bg-transparent hover:bg-green-700 text-white py-1 px-2 rounded-full",children:p.jsx("i",{className:"fas fa-times"})})]})]}):null};function IL(){const{currentUser:t}=vi(),{isAdmin:e}=Qd(),[r,n]=W.useState(!1),s=ua();W.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[r]),W.useEffect(()=>{r&&n(!1)},[s.pathname]);const i=()=>{n(!r)};return p.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-xmas-bg to-xmas-card bg-opacity-95",children:[p.jsx(SL,{snowflakeCount:150,mobileSnowflakeCount:40}),p.jsx(AL,{}),p.jsxs("div",{className:"navbar bg-gradient-to-r from-xmas-card via-xmas-card to-xmas-bg border-b border-xmas-gold px-2 sm:px-4 shadow-lg relative overflow-hidden",children:[p.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),p.jsx("div",{className:"absolute -bottom-4 left-0 right-0 h-8 snow-accumulation-fast"}),p.jsxs("div",{className:"flex items-center",children:[p.jsx("button",{className:"btn btn-ghost btn-sm md:hidden relative z-10",onClick:i,"aria-label":"Toggle navigation menu",children:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"inline-block w-5 h-5 stroke-current",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),p.jsxs(ct,{to:"/",className:"hidden sm:flex items-center group",children:[p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-xmas-gold to-xmas-line rounded-full opacity-70 group-hover:opacity-100 blur transition duration-200"}),p.jsx("div",{className:"relative flex items-center justify-center w-10 h-10 bg-xmas-card rounded-full border border-xmas-gold overflow-hidden",children:p.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"})})]}),p.jsx("div",{className:"ml-3 font-christmas text-xl sm:text-2xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),p.jsxs(ct,{to:"/",className:"sm:hidden flex items-center",children:[p.jsx("div",{className:"w-8 h-8 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold overflow-hidden",children:p.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),p.jsx("span",{className:"ml-2 font-christmas text-lg text-xmas-gold",children:"Christmas Movies"})]})]}),p.jsx("div",{className:"flex-1"}),p.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[t&&p.jsxs(ct,{to:"/profile",className:"btn btn-primary btn-sm hidden md:flex",children:[p.jsx("i",{className:"fas fa-user-circle mr-1"})," Profile"]}),t?p.jsxs("div",{className:"dropdown dropdown-end",children:[p.jsx("label",{tabIndex:0,className:"btn btn-ghost btn-circle avatar cursor-pointer",children:p.jsx("div",{className:"w-10 rounded-full border border-xmas-gold",children:t.photoURL?p.jsx("img",{src:t.photoURL,alt:"Profile"}):p.jsx("div",{className:"bg-xmas-card flex items-center justify-center h-full",children:p.jsx("i",{className:"fas fa-user text-xmas-gold"})})})}),p.jsxs("ul",{tabIndex:0,className:"dropdown-content menu menu-sm mt-3 z-[1] p-2 shadow bg-xmas-card rounded-box w-52 border border-xmas-gold",children:[p.jsx("li",{children:p.jsxs(ct,{to:"/profile",className:"justify-between",children:["Profile",p.jsx("i",{className:"fas fa-user-circle"})]})}),p.jsx("li",{children:p.jsxs(ct,{to:"/movies",children:["My Movies",p.jsx("i",{className:"fas fa-film"})]})}),p.jsx("li",{children:p.jsxs(ct,{to:"/random",children:["Random Movie",p.jsx("i",{className:"fas fa-random"})]})}),p.jsx("li",{children:p.jsxs(ct,{to:"/import",children:["Import Movies",p.jsx("i",{className:"fas fa-file-import"})]})}),e&&p.jsx("li",{children:p.jsxs(ct,{to:"/admin",className:"text-xmas-gold",children:["Admin Dashboard",p.jsx("i",{className:"fas fa-crown"})]})})]})]}):p.jsxs(ct,{to:"/login",className:"btn btn-primary btn-sm",children:[p.jsx("i",{className:"fas fa-sign-in-alt mr-1"})," Sign In"]})]})]}),p.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-70 z-20 transition-opacity duration-300 md:hidden ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:i}),p.jsxs("div",{className:`fixed top-0 left-0 h-full w-72 bg-gradient-to-b from-xmas-bg to-xmas-card border-r border-xmas-gold z-30 transform transition-transform duration-300 ease-in-out md:hidden shadow-xl ${r?"translate-x-0":"-translate-x-full"}`,children:[p.jsxs("div",{className:"relative overflow-hidden",children:[p.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-60"}),p.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-xmas-gold bg-xmas-card bg-opacity-80",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("div",{className:"w-9 h-9 flex items-center justify-center rounded-full bg-xmas-card border border-xmas-gold shadow-lg overflow-hidden",children:p.jsx("img",{src:"/Santa.png",alt:"Santa",className:"w-full h-full object-cover"})}),p.jsx("div",{className:"ml-3 font-christmas text-xl bg-gradient-to-br from-xmas-gold via-xmas-snow to-xmas-gold bg-clip-text text-transparent font-bold",children:"Christmas Movies"})]}),p.jsx("button",{className:"btn btn-ghost btn-sm text-xmas-text hover:text-xmas-line",onClick:i,"aria-label":"Close navigation menu",children:p.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),p.jsx("div",{className:"overflow-y-auto h-full pb-20",children:p.jsx("div",{className:"p-4 pt-6",children:p.jsxs("div",{className:"mb-6",children:[p.jsx("h3",{className:"font-christmas text-xl text-xmas-gold mb-4 pl-2 border-l-2 border-xmas-line",children:"Navigation"}),p.jsxs("ul",{className:"space-y-3",children:[p.jsx("li",{children:p.jsx(ga,{to:"/",onClick:i,className:({isActive:a})=>a?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:a})=>p.jsxs(p.Fragment,{children:[p.jsx("i",{className:"fas fa-home mr-3 text-xmas-gold"}),p.jsx("span",{children:"Home"}),p.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${a?"visible":"invisible"}`})]})})}),t?p.jsxs(p.Fragment,{children:[p.jsx("li",{children:p.jsx(ga,{to:"/movies",onClick:i,className:({isActive:a})=>a?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:a})=>p.jsxs(p.Fragment,{children:[p.jsx("i",{className:"fas fa-film mr-3 text-xmas-gold"}),p.jsx("span",{children:"My Movies"}),p.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${a?"visible":"invisible"}`})]})})}),p.jsx("li",{children:p.jsx(ga,{to:"/random",onClick:i,className:({isActive:a})=>a?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:a})=>p.jsxs(p.Fragment,{children:[p.jsx("i",{className:"fas fa-random mr-3 text-xmas-gold"}),p.jsx("span",{children:"Random Movie"}),p.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${a?"visible":"invisible"}`})]})})}),p.jsx("li",{children:p.jsx(ga,{to:"/import",onClick:i,className:({isActive:a})=>a?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:a})=>p.jsxs(p.Fragment,{children:[p.jsx("i",{className:"fas fa-file-import mr-3 text-xmas-gold"}),p.jsx("span",{children:"Import Movies"}),p.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${a?"visible":"invisible"}`})]})})}),p.jsx("li",{children:p.jsx(ga,{to:"/profile",onClick:i,className:({isActive:a})=>a?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:a})=>p.jsxs(p.Fragment,{children:[p.jsx("i",{className:"fas fa-user-circle mr-3 text-xmas-gold"}),p.jsx("span",{children:"Profile"}),p.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${a?"visible":"invisible"}`})]})})}),e&&p.jsx("li",{children:p.jsx(ga,{to:"/admin",onClick:i,className:({isActive:a})=>a?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:a})=>p.jsxs(p.Fragment,{children:[p.jsx("i",{className:"fas fa-crown mr-3 text-xmas-gold"}),p.jsx("span",{children:"Admin Dashboard"}),p.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${a?"visible":"invisible"}`})]})})})]}):p.jsx("li",{children:p.jsx(ga,{to:"/login",onClick:i,className:({isActive:a})=>a?"flex items-center p-2 pl-3 rounded-md bg-gradient-to-r from-xmas-card to-transparent border-l-2 border-xmas-gold text-xmas-gold font-medium":"flex items-center p-2 pl-3 rounded-md hover:bg-xmas-card hover:bg-opacity-50 text-xmas-text hover:text-xmas-gold transition-all duration-200",children:({isActive:a})=>p.jsxs(p.Fragment,{children:[p.jsx("i",{className:"fas fa-sign-in-alt mr-3 text-xmas-gold"}),p.jsx("span",{children:"Sign In"}),p.jsx("i",{className:`fas fa-snowflake ml-auto text-xmas-gold opacity-70 ${a?"visible":"invisible"}`})]})})})]})]})})})]}),p.jsx("main",{className:"p-4",children:p.jsx(y2,{})}),p.jsx("div",{className:"fixed bottom-0 left-0 w-full pointer-events-none",children:p.jsx("div",{className:"container mx-auto",children:p.jsxs("div",{className:"relative h-16",children:[p.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-xmas-gold via-transparent to-xmas-gold opacity-40"}),p.jsx("div",{className:"absolute bottom-4 left-4 opacity-30",children:p.jsx("i",{className:"fas fa-tree text-4xl text-xmas-gold"})}),p.jsx("div",{className:"absolute bottom-4 right-4 opacity-30",children:p.jsx("i",{className:"fas fa-star text-4xl text-xmas-gold"})})]})})})]})}const Uy=({children:t})=>{const{currentUser:e,isLoading:r}=vi();return r?p.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):e?t?p.jsx(p.Fragment,{children:t}):p.jsx(y2,{}):p.jsx(FN,{to:"/login"})},CL=()=>{const{currentUser:t}=vi();return p.jsxs("div",{className:"container mx-auto px-4 py-8",children:[p.jsxs("div",{className:"text-center mb-12",children:[p.jsx("h1",{className:"font-christmas text-5xl md:text-7xl text-xmas-line mb-4",children:"My Christmas Movies"}),p.jsx("p",{className:"text-xl md:text-2xl text-xmas-snow mb-8",children:"Track, rate, and discover your favorite Christmas movies!"}),p.jsx("div",{className:"flex flex-col md:flex-row justify-center gap-6 mb-12",children:t?p.jsxs(p.Fragment,{children:[p.jsxs(ct,{to:"/movies",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[p.jsx("i",{className:"fas fa-film mr-2"})," My Movies"]}),p.jsxs(ct,{to:"/random",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[p.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]})]}):p.jsxs(ct,{to:"/login",className:"btn btn-primary btn-lg text-xl px-8 py-3 rounded-md shadow-lg hover:shadow-xl transition-all duration-300 border border-xmas-gold border-opacity-30",children:[p.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In"]})})]}),p.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:p.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),p.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-20 snow-accumulation snow-accumulation-slow relative",children:[p.jsx("h2",{className:"font-christmas text-3xl text-xmas-line mb-6 text-center",children:"Features"}),p.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[p.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[p.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:p.jsx("i",{className:"fas fa-search"})}),p.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Find Movies"}),p.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Search and discover Christmas movies using TMDB integration"})]}),p.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-gold",children:[p.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:p.jsx("i",{className:"fas fa-star"})}),p.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Rate & Review"}),p.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Keep track of movies you've watched and rate them"})]}),p.jsxs("div",{className:"bg-xmas-card bg-opacity-70 p-6 rounded-lg shadow-md border-l-2 border-xmas-line",children:[p.jsx("div",{className:"text-3xl text-xmas-gold mb-4 text-center",children:p.jsx("i",{className:"fas fa-random"})}),p.jsx("h3",{className:"font-christmas text-xl text-center mb-3",children:"Random Picker"}),p.jsx("p",{className:"text-center text-xmas-text text-opacity-80",children:"Can't decide what to watch? Let our random movie picker help!"})]})]})]}),p.jsx("div",{className:"bg-xmas-card rounded-lg shadow-xl p-6 mb-12 border border-xmas-gold border-opacity-30 snow-accumulation snow-accumulation-fast relative",children:p.jsxs("div",{className:"mb-6 text-center",children:[p.jsxs("h2",{className:"font-christmas text-3xl md:text-4xl text-xmas-gold inline-block relative",children:[p.jsx("span",{className:"relative z-10",children:"Import Your Collection"}),p.jsx("span",{className:"absolute -bottom-2 left-0 right-0 h-1 bg-xmas-gold opacity-30 rounded-full"})]}),p.jsx("p",{className:"mt-4 mb-6",children:"Already have a list of Christmas movies? Import them from Excel or search TMDB!"}),t?p.jsxs(ct,{to:"/import",className:"btn btn-primary",children:[p.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]}):p.jsxs(ct,{to:"/login",className:"btn btn-primary",children:[p.jsx("i",{className:"fas fa-sign-in-alt mr-2"})," Sign In to Import"]})]})}),p.jsx("div",{className:"w-full max-w-4xl mx-auto mb-8",children:p.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-xmas-gold to-transparent"})}),p.jsx("footer",{className:"text-center text-xmas-mute mt-12 pb-8",children:p.jsxs("p",{children:[" ",new Date().getFullYear()," Christmas Movie Database"]})})]})},RL=()=>{const t=Za(),{currentUser:e,isLoading:r,error:n,signInWithGoogle:s}=vi();W.useEffect(()=>{e&&!r&&t("/movies")},[e,r,t]);const i=async()=>{try{await s()}catch(a){console.error("Login failed:",a)}};return r?p.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):p.jsx("div",{className:"container mx-auto px-4 py-12",children:p.jsxs("div",{className:"max-w-md mx-auto",children:[p.jsxs("div",{className:"text-center mb-8",children:[p.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Christmas Movie Database"}),p.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage your Christmas movie collection"})]}),p.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[n&&p.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:p.jsx("p",{className:"text-error",children:n})}),p.jsxs("div",{className:"text-center mb-6",children:[p.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access your Christmas movie collection."}),p.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Track, rate, and discover Christmas movies!"}),p.jsxs("button",{onClick:i,className:"btn btn-primary w-full flex items-center justify-center gap-2",children:[p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[p.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
                  s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20
                  s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),p.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039
                  l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),p.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
                  c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),p.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
                  c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})]})]}),p.jsx("div",{className:"text-center mt-6",children:p.jsx("p",{className:"text-sm text-xmas-mute",children:"By signing in, you agree to our Terms of Service and Privacy Policy."})})]})})},NL=5*60*1e3;let Yn=null;const PL=(t,e,r)=>{Yn={userMovies:e,movies:r,timestamp:Date.now(),userId:t}},DL=t=>!Yn||Yn.userId!==t||Date.now()-Yn.timestamp>NL?null:{userMovies:Yn.userMovies,movies:Yn.movies},FL=()=>{Yn=null},bL=(t,e,r)=>{Yn&&Yn.userId===t&&(Yn.userMovies[e]=r,Yn.timestamp=Date.now())},Bv=async(t,e,r)=>{const n=ls(ir,`users/${t}/movies`,e);if((await Ka(n)).exists()){const o={...r,updatedAt:new Date};r.rating===null&&(o.rating=null),r.watchedDate===null&&(o.watchedDate=null),r.review===null&&(o.review=null),await Vv(n,o)}else{const o={userId:t,movieId:e,watched:r.watched||!1,favorite:r.favorite||!1,addedAt:new Date,updatedAt:new Date,...r};await Kh(n,o)}const i=await Ka(n),a={id:i.id,...i.data()};return bL(t,e,a),a},Am=async(t,e)=>{const r=ls(ir,`users/${t}/movies`,e),n=await Ka(r);return n.exists()?{id:n.id,...n.data()}:null},HS=async t=>{const e=ti(ir,`users/${t}/movies`),r=await ks(e),n=[];return r.forEach(s=>{n.push({id:s.id,...s.data()})}),n},OL=async(t,e)=>{const r=ls(ir,`users/${t}/movies`,e);await FM(r),FL()},zv=async t=>{const e=DL(t);if(e)return e;const r=await HS(t),n={},s=[];r.forEach(o=>{n[o.movieId]=o,s.push(o.movieId)});const i=[];if(s.length>0)for(let l=0;l<s.length;l+=10){const u=s.slice(l,l+10).map(d=>Ka(ls(ir,"movies",d)).then(m=>m.exists()?{id:m.id,...m.data()}:null).catch(m=>(console.error(`Error fetching movie ${d}:`,m),null))),h=await Promise.all(u);i.push(...h.filter(Boolean))}const a={userMovies:n,movies:i};return PL(t,n,i),a},ML=()=>{const{currentUser:t}=vi(),[e,r]=W.useState([]),[n,s]=W.useState({}),[i,a]=W.useState(!0),[o,l]=W.useState(!0),[c,u]=W.useState(null),[h,d]=W.useState("all"),[m,v]=W.useState({option:"title",direction:"asc"}),[g,y]=W.useState(""),[S,k]=W.useState("all"),w=ua();Za(),W.useEffect(()=>{const E=new URLSearchParams(w.search),T=E.get("q")||"",I=E.get("field")||"all";T!==g&&y(T),I!==S&&k(I)},[w.search]),W.useEffect(()=>{(async()=>{if(t)try{l(!0);const{userMovies:T,movies:I}=await zv(t.uid);s(T),r(I)}catch(T){console.error("Error fetching movies:",T),u("Failed to load movies")}finally{l(!1),a(!1)}})()},[t]);const F=E=>{v(T=>T.option===E?{option:E,direction:T.direction==="asc"?"desc":"asc"}:{option:E,direction:"asc"})},B=W.useCallback(E=>{if(!g.trim())return!0;const T=g.toLowerCase().trim(),I=T.split(",").map(R=>R.trim()).filter(Boolean),P=R=>E.cast&&E.cast.some(se=>se.toLowerCase().includes(R)),N=n[E.id];switch(S){case"title":return E.title.toLowerCase().includes(T)||E.sortTitle&&E.sortTitle.toLowerCase().includes(T)||E.originalTitle&&E.originalTitle.toLowerCase().includes(T);case"year":return E.releaseDate&&E.releaseDate.substring(0,4).includes(T);case"cast":return I.length?I.some(R=>P(R)):P(T);case"all":default:return E.title.toLowerCase().includes(T)||E.sortTitle&&E.sortTitle.toLowerCase().includes(T)||E.originalTitle&&E.originalTitle.toLowerCase().includes(T)||E.releaseDate&&E.releaseDate.substring(0,4).includes(T)||E.overview&&E.overview.toLowerCase().includes(T)||E.genres&&E.genres.some(R=>R.toLowerCase().includes(T))||E.directors&&E.directors.some(R=>R.toLowerCase().includes(T))||E.cast&&E.cast.some(R=>R.toLowerCase().includes(T))||N&&N.review&&N.review.toLowerCase().includes(T)}},[g,S,n]),V=W.useMemo(()=>{if(o)return[];a(!0);const E=e.filter(T=>{const I=n[T.id];let P=!0;switch(h){case"watched":P=I&&I.watched;break;case"unwatched":P=!I||!I.watched;break;case"favorites":P=I&&I.favorite;break}return P&&B(T)}).sort((T,I)=>{const P=n[T.id],N=n[I.id],R=m.direction==="asc"?1:-1;switch(m.option){case"title":const se=T.sortTitle||T.title,ae=I.sortTitle||I.title;return se.localeCompare(ae)*R;case"year":const fe=T.releaseDate?parseInt(T.releaseDate.substring(0,4)):0,ge=I.releaseDate?parseInt(I.releaseDate.substring(0,4)):0;return(fe-ge)*R;case"rating":const oe=(P==null?void 0:P.rating)||0,K=(N==null?void 0:N.rating)||0;return(oe-K)*R;case"watched":const he=P!=null&&P.watched?1:0,we=N!=null&&N.watched?1:0;return(he-we)*R;case"added":const U=P!=null&&P.addedAt?P.addedAt.getTime():0,q=N!=null&&N.addedAt?N.addedAt.getTime():0;return(U-q)*R;default:return 0}});return a(!1),E},[e,n,h,m,g,S,o]),x=V;return o?p.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):p.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[p.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 sm:mb-8 gap-3",children:[p.jsx("h1",{className:"font-christmas text-2xl sm:text-3xl md:text-4xl text-xmas-line",children:"My Christmas Movies"}),p.jsxs("div",{className:"flex gap-2 w-full sm:w-auto justify-center",children:[p.jsxs(ct,{to:"/random",className:"btn btn-primary btn-sm sm:btn-md",children:[p.jsx("i",{className:"fas fa-random mr-1 sm:mr-2"})," ",p.jsx("span",{className:"hidden xs:inline",children:"Random Movie"}),p.jsx("span",{className:"xs:hidden",children:"Random"})]}),p.jsxs(ct,{to:"/import",className:"btn btn-primary btn-sm sm:btn-md",children:[p.jsx("i",{className:"fas fa-file-import mr-1 sm:mr-2"})," ",p.jsx("span",{className:"hidden xs:inline",children:"Import Movies"}),p.jsx("span",{className:"xs:hidden",children:"Import"})]})]})]}),c&&p.jsxs("div",{className:"alert alert-error mb-6",children:[p.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),p.jsx("span",{children:c})]}),p.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-3",children:[p.jsxs("div",{className:"relative flex-grow",children:[p.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:p.jsx("i",{className:"fas fa-search text-gray-400"})}),p.jsx("input",{type:"text",className:"input input-bordered input-sm sm:input-md w-full pl-8 pr-8",placeholder:"   Search movies...",value:g,onChange:E=>y(E.target.value)}),g&&p.jsx("button",{className:"absolute inset-y-0 right-0 pr-2 flex items-center",onClick:()=>y(""),children:p.jsx("i",{className:"fas fa-times text-gray-400 hover:text-gray-600"})})]}),p.jsxs("select",{className:"select select-bordered select-sm sm:select-md w-full sm:w-36",value:S,onChange:E=>k(E.target.value),children:[p.jsx("option",{value:"all",children:"All Fields"}),p.jsx("option",{value:"title",children:"Title Only"}),p.jsx("option",{value:"year",children:"Year Only"}),p.jsx("option",{value:"cast",children:"Cast Only"})]})]}),p.jsxs("div",{className:"tabs tabs-boxed mb-3 text-xs sm:text-sm overflow-x-auto",children:[p.jsx("button",{className:`tab ${h==="all"?"tab-active":""}`,onClick:()=>d("all"),children:"All Movies"}),p.jsx("button",{className:`tab ${h==="watched"?"tab-active":""}`,onClick:()=>d("watched"),children:"Watched"}),p.jsx("button",{className:`tab ${h==="unwatched"?"tab-active":""}`,onClick:()=>d("unwatched"),children:"Unwatched"}),p.jsxs("button",{className:`tab ${h==="favorites"?"tab-active":""}`,onClick:()=>d("favorites"),children:[p.jsx("span",{className:"hidden sm:inline",children:"Favorites"}),p.jsx("span",{className:"sm:hidden",children:"Favs"})]})]}),p.jsxs("div",{className:"flex flex-wrap items-center gap-1 mb-3 bg-xmas-card bg-opacity-50 p-2 rounded-lg overflow-x-auto",children:[p.jsx("span",{className:"text-xs sm:text-sm font-medium mr-1",children:"Sort:"}),p.jsxs("div",{className:"flex flex-nowrap gap-1 overflow-x-auto",children:[p.jsxs("button",{className:`btn btn-xs ${m.option==="title"?"btn-primary":"btn-ghost"}`,onClick:()=>F("title"),children:["Title ",m.option==="title"&&p.jsx("i",{className:`fas fa-sort-${m.direction==="asc"?"up":"down"} ml-1`})]}),p.jsxs("button",{className:`btn btn-xs ${m.option==="year"?"btn-primary":"btn-ghost"}`,onClick:()=>F("year"),children:["Year ",m.option==="year"&&p.jsx("i",{className:`fas fa-sort-${m.direction==="asc"?"up":"down"} ml-1`})]}),p.jsxs("button",{className:`btn btn-xs ${m.option==="rating"?"btn-primary":"btn-ghost"}`,onClick:()=>F("rating"),children:["Rating ",m.option==="rating"&&p.jsx("i",{className:`fas fa-sort-${m.direction==="asc"?"up":"down"} ml-1`})]}),p.jsxs("button",{className:`btn btn-xs ${m.option==="watched"?"btn-primary":"btn-ghost"}`,onClick:()=>F("watched"),children:[p.jsx("span",{className:"hidden sm:inline",children:"Watched Status"}),p.jsx("span",{className:"sm:hidden",children:"Watched"}),m.option==="watched"&&p.jsx("i",{className:`fas fa-sort-${m.direction==="asc"?"up":"down"} ml-1`})]}),p.jsxs("button",{className:`btn btn-xs ${m.option==="added"?"btn-primary":"btn-ghost"}`,onClick:()=>F("added"),children:[p.jsx("span",{className:"hidden sm:inline",children:"Date Added"}),p.jsx("span",{className:"sm:hidden",children:"Added"}),m.option==="added"&&p.jsx("i",{className:`fas fa-sort-${m.direction==="asc"?"up":"down"} ml-1`})]})]})]}),p.jsxs("div",{className:"flex flex-col xs:flex-row justify-between items-start xs:items-center mb-3 text-xs sm:text-sm",children:[p.jsxs("div",{children:[p.jsx("span",{className:"font-medium",children:V.length})," ",V.length===1?"movie":"movies"," found",g&&p.jsxs("span",{className:"ml-1 text-xmas-mute",children:["for: ",p.jsxs("span",{className:"font-medium",children:['"',g,'"']})]})]}),m.option&&p.jsxs("div",{className:"text-xmas-mute",children:["Sorted by ",p.jsx("span",{className:"font-medium",children:m.option})," (",m.direction==="asc"?"asc":"desc",")"]})]}),i&&!o&&p.jsx("div",{className:"flex justify-center items-center py-4",children:p.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-xmas-gold"})}),V.length===0?p.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[p.jsx("h3",{className:"text-xl mb-4",children:"No movies found"}),p.jsx("p",{className:"mb-4",children:h==="all"?"You haven't added any Christmas movies yet.":`You don't have any ${h} Christmas movies.`}),p.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[p.jsxs(ct,{to:"/import",className:"btn btn-primary",children:[p.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]}),e.length>0&&p.jsxs(ct,{to:"/random",className:"btn btn-primary",children:[p.jsx("i",{className:"fas fa-random mr-2"})," Random Movie"]})]})]}):p.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2 sm:gap-3",children:x.map(E=>{var I;const T=n[E.id];return p.jsx(ct,{to:`/movies/${E.id}`,className:"block transition-transform hover:scale-[1.02] hover:shadow-xl",children:p.jsxs("div",{className:"relative rounded-lg overflow-hidden bg-xmas-card shadow-md h-full flex flex-col",children:[p.jsxs("div",{className:"relative",children:[E.posterUrl?p.jsx("img",{src:E.posterUrl,alt:E.title,className:"w-full h-auto object-cover",style:{aspectRatio:"2/3"},loading:"lazy"}):p.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:p.jsx("i",{className:"fas fa-film text-2xl text-gray-500"})}),T&&T.watched&&p.jsx("div",{className:"absolute top-1 right-1 bg-primary rounded-full p-1 shadow-md",children:p.jsx("i",{className:"fas fa-check text-xs text-white"})}),T&&T.favorite&&p.jsx("div",{className:"absolute top-1 left-1 text-yellow-400 drop-shadow-md",children:p.jsx("i",{className:"fas fa-star text-sm"})})]}),p.jsxs("div",{className:"p-1 sm:p-2 flex-grow flex flex-col",children:[p.jsx("h3",{className:"text-xs sm:text-sm font-medium line-clamp-2",children:E.title}),p.jsxs("div",{className:"flex justify-between items-center mt-1",children:[p.jsx("p",{className:"text-xs text-gray-400",children:(I=E.releaseDate)==null?void 0:I.substring(0,4)}),T&&T.rating&&p.jsxs("div",{className:"flex items-center",children:[p.jsx("span",{className:"text-yellow-400 mr-0.5",children:p.jsx("i",{className:"fas fa-star text-xs"})}),p.jsx("span",{className:"text-xs",children:T.rating})]})]})]})]})},E.id)})})]})},LL=()=>{const{movieId:t}=_N(),e=Za(),{currentUser:r}=vi(),[n,s]=W.useState(null),[i,a]=W.useState(null),[o,l]=W.useState(!0),[c,u]=W.useState(null),[h,d]=W.useState(!1),[m,v]=W.useState(!1),[g,y]=W.useState(""),[S,k]=W.useState(null),[w,F]=W.useState(""),[B,V]=W.useState(!1);W.useEffect(()=>{(async()=>{if(!(!r||!t))try{l(!0);const I=await Ka(ls(ir,"movies",t));if(!I.exists()){u("Movie not found"),l(!1);return}const P={id:I.id,...I.data()};s(P);const N=await Am(r.uid,t);if(N){a(N),v(N.watched);let R="";if(N.watchedDate)try{if(N.watchedDate instanceof Date)R=N.watchedDate.toISOString().split("T")[0];else{const se=N.watchedDate;if(typeof se=="object"&&se!==null&&"seconds"in se){const ae=se;R=new Date(ae.seconds*1e3).toISOString().split("T")[0]}else{const ae=new Date(N.watchedDate);isNaN(ae.getTime())||(R=ae.toISOString().split("T")[0])}}}catch(se){console.error("Error parsing watchedDate:",se)}y(R),k(N.rating||null),F(N.review||""),V(N.favorite)}}catch(I){console.error("Error fetching movie data:",I),u("Failed to load movie data")}finally{l(!1)}})()},[r,t]);const x=async()=>{if(!(!r||!t||!n))try{d(!0);const T={userId:r.uid,movieId:t,watched:m,favorite:B,updatedAt:new Date};if(m&&g)try{T.watchedDate=new Date(g),isNaN(T.watchedDate.getTime())&&delete T.watchedDate}catch(P){console.error("Error parsing watchedDate for save:",P),delete T.watchedDate}else m||(T.watchedDate=null);T.rating=S,T.review=w||null;const I=await Bv(r.uid,t,T);a(I)}catch(T){console.error("Error saving movie data:",T),u("Failed to save movie data")}finally{d(!1)}},E=async()=>{if(!(!r||!t||!window.confirm("Are you sure you want to remove this movie from your collection?")))try{d(!0),await OL(r.uid,t),e("/movies")}catch(T){console.error("Error deleting movie:",T),u("Failed to delete movie"),d(!1)}};return o?p.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):n?p.jsxs("div",{className:"container mx-auto px-4 py-8",children:[p.jsx("div",{className:"mb-4",children:p.jsxs(ct,{to:"/movies",className:"btn btn-ghost",children:[p.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),c&&p.jsxs("div",{className:"alert alert-error mb-6",children:[p.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),p.jsx("span",{children:c})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[p.jsxs("div",{className:"md:col-span-1",children:[p.jsx("div",{className:"rounded-lg overflow-hidden shadow-xl",children:n.posterUrl?p.jsx("img",{src:n.posterUrl,alt:n.title,className:"w-full object-contain",style:{aspectRatio:"2/3"}}):p.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3"},children:p.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})})}),p.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[p.jsxs("button",{className:`btn ${B?"btn-warning":"btn-outline"} w-full`,onClick:()=>V(!B),children:[p.jsx("i",{className:`fas fa-star mr-2 ${B?"text-white":""}`}),B?"Favorited":"Add to Favorites"]}),p.jsxs("button",{className:`btn ${m?"btn-success":"btn-outline"} w-full`,onClick:()=>v(!m),children:[p.jsx("i",{className:`fas fa-check mr-2 ${m?"text-white":""}`}),m?"Watched":"Mark as Watched"]}),p.jsxs("button",{className:"btn btn-error btn-outline w-full",onClick:E,disabled:h,children:[p.jsx("i",{className:"fas fa-trash mr-2"}),"Remove from Collection"]})]})]}),p.jsxs("div",{className:"md:col-span-2",children:[p.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-2",children:n.title}),n.releaseDate&&p.jsx("p",{className:"text-lg text-gray-400 mb-4",children:new Date(n.releaseDate).getFullYear()}),n.genres&&n.genres.length>0&&p.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:n.genres.map((T,I)=>p.jsx("span",{className:"badge badge-outline",children:T},I))}),n.runtime&&p.jsxs("p",{className:"mb-4",children:[p.jsx("i",{className:"fas fa-clock mr-2 text-xmas-gold"}),Math.floor(n.runtime/60),"h ",n.runtime%60,"m"]}),n.overview&&p.jsxs("div",{className:"mb-6",children:[p.jsx("h2",{className:"text-xl font-bold mb-2",children:"Overview"}),p.jsx("p",{className:"text-gray-300",children:n.overview})]}),n.directors&&n.directors.length>0&&p.jsxs("div",{className:"mb-4",children:[p.jsxs("h2",{className:"text-xl font-bold mb-2",children:["Director",n.directors.length>1?"s":""]}),p.jsx("p",{children:n.directors.join(", ")})]}),n.cast&&n.cast.length>0&&p.jsxs("div",{className:"mb-6",children:[p.jsx("h2",{className:"text-xl font-bold mb-2",children:"Cast"}),p.jsx("p",{className:"flex flex-wrap gap-1",children:n.cast.slice(0,10).map((T,I)=>p.jsxs(Hm.Fragment,{children:[p.jsx(ct,{to:`/movies?q=${encodeURIComponent(T)}&field=cast`,className:"link link-primary",children:T}),I<Math.min(n.cast.length,10)-1&&p.jsx("span",{children:","})]},T))})]}),p.jsx("div",{className:"divider"}),p.jsx("h2",{className:"text-2xl font-christmas text-xmas-gold mb-4",children:"Your Rating & Review"}),m&&p.jsxs("div",{className:"form-control mb-4",children:[p.jsx("label",{className:"label",children:p.jsx("span",{className:"label-text",children:"Date Watched"})}),p.jsx("input",{type:"date",className:"input input-bordered",value:g,onChange:T=>y(T.target.value)})]}),p.jsxs("div",{className:"form-control mb-4",children:[p.jsx("label",{className:"label",children:p.jsx("span",{className:"label-text",children:"Your Rating"})}),p.jsx("div",{className:"rating rating-lg",children:[1,2,3,4,5,6,7,8,9,10].map(T=>p.jsx("input",{type:"radio",name:"rating",className:`mask mask-star-2 ${T<=5?"bg-orange-400":"bg-yellow-400"}`,checked:S===T,onChange:()=>k(T)},T))}),S&&p.jsx("div",{className:"mt-2",children:p.jsx("button",{className:"btn btn-xs btn-ghost",onClick:()=>k(null),children:"Clear Rating"})})]}),p.jsxs("div",{className:"form-control mb-6",children:[p.jsx("label",{className:"label",children:p.jsx("span",{className:"label-text",children:"Your Review"})}),p.jsx("textarea",{className:"textarea textarea-bordered h-32",placeholder:"Write your thoughts about this movie...",value:w,onChange:T=>F(T.target.value)})]}),p.jsx("div",{className:"flex justify-end",children:p.jsx("button",{className:"btn btn-primary",onClick:x,disabled:h,children:h?p.jsxs(p.Fragment,{children:[p.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Saving..."]}):p.jsxs(p.Fragment,{children:[p.jsx("i",{className:"fas fa-save mr-2"}),"Save Changes"]})})})]})]})]}):p.jsxs("div",{className:"container mx-auto px-4 py-8",children:[p.jsxs("div",{className:"alert alert-error",children:[p.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),p.jsx("span",{children:"Movie not found"})]}),p.jsx("div",{className:"mt-4",children:p.jsx(ct,{to:"/movies",className:"btn btn-primary",children:"Back to Movies"})})]})},WS=t=>{const e=t.trim();return/^The\s+/i.test(e)?e.replace(/^The\s+/i,"").trim():/^A\s+/i.test(e)?e.replace(/^A\s+/i,"").trim():/^An\s+/i.test(e)?e.replace(/^An\s+/i,"").trim():e},GS="https://api.themoviedb.org/3",jL="https://image.tmdb.org/t/p/w500",VL="https://image.tmdb.org/t/p/original",$v=t=>(t||"").toLowerCase().replace(/^(the|a|an)\s+/,"").replace(/[^a-z0-9]+/g," ").trim(),UL=t=>{var n;const e=new Set,r=s=>{const i=$v(s||"");i&&(e.add(i),i.split(" ").forEach(a=>a&&e.add(a)))};return r(t.title),r(t.original_title),t.release_date&&e.add(t.release_date.slice(0,4)),(t.genres||[]).forEach(s=>r(s==null?void 0:s.name)),(((n=t.credits)==null?void 0:n.cast)||[]).slice(0,5).forEach(s=>r(s==null?void 0:s.name)),Array.from(e).slice(0,200)},Im=async(t,e)=>{const r=await fetch(`${GS}/search/movie?api_key=${e}&query=${encodeURIComponent(t)}&include_adult=false`);if(!r.ok)throw new Error(`TMDB API error: ${r.status}`);return await r.json()},Yh=async(t,e)=>{const r=await fetch(`${GS}/movie/${t}?api_key=${e}&append_to_response=credits`);if(!r.ok)throw new Error(`TMDB API error: ${r.status}`);return await r.json()},Hv=t=>{var n,s,i,a,o,l;const e=WS(t.title),r=$v(e);return{tmdbId:t.id,title:t.title,sortTitle:e,sortTitleLower:r,originalTitle:t.original_title,releaseDate:t.release_date,posterUrl:t.poster_path?`${jL}${t.poster_path}`:void 0,backdropUrl:t.backdrop_path?`${VL}${t.backdrop_path}`:void 0,overview:t.overview,runtime:t.runtime,genres:((n=t.genres)==null?void 0:n.map(c=>c.name))||[],directors:((a=(i=(s=t.credits)==null?void 0:s.crew)==null?void 0:i.filter(c=>c.job==="Director"))==null?void 0:a.map(c=>c.name))||[],cast:((l=(o=t.credits)==null?void 0:o.cast)==null?void 0:l.slice(0,10).map(c=>c.name))||[],isChristmas:!0,keywords:UL(t),updatedAt:new Date}};async function BL(t,e=24){const r=t.toLowerCase().trim(),n=$v(t),s=ti(ir,"movies"),i=new Map;n&&(await ks(ba(s,IM("sortTitleLower"),CM(n),RM(n+""),K0(e)))).docs.forEach(l=>{const c={id:l.id,...l.data()};i.set(l.id,c)});const a=r.split(" ").filter(Boolean).slice(0,10);return a.length&&(await ks(ba(s,au("keywords","array-contains-any",a),K0(e)))).docs.forEach(l=>{i.has(l.id)||i.set(l.id,{id:l.id,...l.data()})}),i.size<Math.min(10,e)&&r.length>=2&&(await ks(ba(s,K0(100)))).docs.forEach(l=>{if(!i.has(l.id)){const c=l.data(),u=(c.title||"").toLowerCase(),h=(c.originalTitle||"").toLowerCase();(u.includes(r)||h.includes(r))&&i.set(l.id,{id:l.id,...c})}}),Array.from(i.values())}function By(t,e){let r=0;const n=(t.title||"").toLowerCase(),s=(e.title||"").toLowerCase();if(n&&s)if(n===s)r+=60;else if(s.includes(n)||n.includes(s))r+=40;else{const i=n.split(" "),a=s.split(" "),o=i.filter(l=>a.includes(l));r+=o.length/Math.max(i.length,a.length)*40}if(t.releaseDate&&e.release_date){const i=t.releaseDate.slice(0,4),a=e.release_date.slice(0,4);i===a?r+=40:Math.abs(parseInt(i)-parseInt(a))<=1&&(r+=20)}return Math.min(Math.round(r),100)}const xs=t=>t!=null&&t.poster_path?`https://image.tmdb.org/t/p/w500${t.poster_path}`:(t==null?void 0:t.posterUrl)||"",zL=({onSelect:t})=>{const[e,r]=W.useState(""),[n,s]=W.useState(!1),[i,a]=W.useState([]),[o,l]=W.useState(null),c=async()=>{const u=e.trim();if(!u){l("Please enter a search term");return}if(u.length<2){l("Search term must be at least 2 characters");return}try{s(!0),l(null),a([]);const h=await BL(u);console.log("Search results:",h);const d=h.filter(m=>m.tmdbId).map(m=>{var v;return{id:m.tmdbId,title:m.title,release_date:m.releaseDate,poster_path:(v=m.posterUrl)!=null&&v.startsWith("https://image.tmdb.org/t/p/")?m.posterUrl.replace("https://image.tmdb.org/t/p/w500",""):null}});a(d),d.length===0&&l(`No movies found matching "${u}". Try a different search term.`)}catch(h){console.error("Search error:",h),l((h==null?void 0:h.message)??"Local search failed")}finally{s(!1)}};return p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"flex gap-2",children:[p.jsx("input",{className:"input input-bordered flex-1",value:e,onChange:u=>r(u.target.value),placeholder:"Search local catalogue...",onKeyDown:u=>u.key==="Enter"&&c(),disabled:n}),p.jsx("button",{className:"btn btn-primary",onClick:c,disabled:n||!e.trim()||e.trim().length<2,children:n?p.jsx("span",{className:"loading loading-spinner loading-sm"}):"Search"})]}),o&&p.jsx("div",{className:"alert alert-error",children:o}),n&&p.jsx("div",{className:"flex justify-center p-4",children:p.jsx("span",{className:"loading loading-spinner loading-lg"})}),!n&&i.length>0&&p.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:i.map(u=>{var h;return p.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>t(u),children:[p.jsx("figure",{children:xs(u)?p.jsx("img",{src:xs(u),alt:u.title,className:"w-full h-64 object-contain"}):p.jsx("div",{className:"h-64 w-full flex items-center justify-center bg-base-200",children:p.jsx("i",{className:"fas fa-film text-3xl opacity-50"})})}),p.jsxs("div",{className:"card-body p-3",children:[p.jsx("div",{className:"font-semibold",children:u.title}),p.jsx("div",{className:"text-xs opacity-70",children:(h=u.release_date)==null?void 0:h.slice(0,4)})]})]},u.id)})})]})},$L=({tmdbApiKey:t,onSelect:e})=>{const[r,n]=W.useState(""),[s,i]=W.useState(!1),[a,o]=W.useState([]),[l,c]=W.useState(null),u=async()=>{if(r.trim())try{i(!0),c(null);const h=await Im(r,t);o(h.results)}catch(h){c((h==null?void 0:h.message)??"TMDB search failed")}finally{i(!1)}};return p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"flex gap-2",children:[p.jsx("input",{className:"input input-bordered flex-1",value:r,onChange:h=>n(h.target.value),placeholder:"Search TMDB...",onKeyDown:h=>h.key==="Enter"&&u()}),p.jsx("button",{className:"btn btn-primary",onClick:u,disabled:s||!t,children:s?p.jsx("span",{className:"loading loading-spinner loading-sm"}):"Search"})]}),l&&p.jsx("div",{className:"alert alert-error",children:l}),a.length>0&&p.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:a.map(h=>{var d;return p.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>e(h),children:[p.jsx("figure",{children:xs(h)?p.jsx("img",{src:xs(h),alt:h.title,className:"w-full h-64 object-contain"}):p.jsx("div",{className:"h-64 w-full flex items-center justify-center bg-base-200",children:p.jsx("i",{className:"fas fa-film text-3xl opacity-50"})})}),p.jsxs("div",{className:"card-body p-3",children:[p.jsx("div",{className:"font-semibold",children:h.title}),p.jsx("div",{className:"text-xs opacity-70",children:(d=h.release_date)==null?void 0:d.slice(0,4)})]})]},h.id)})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var KS=1252,HL=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Wv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Gv=function(t){HL.indexOf(t)!=-1&&(KS=Wv[0]=t)};function WL(){Gv(1252)}var Zn=function(t){Gv(t)};function qS(){Zn(1200),WL()}function zy(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function GL(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function XS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var sc=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?GL(t.slice(2)):e==254&&r==255?XS(t.slice(2)):e==65279?t.slice(1):t},Af=function(e){return String.fromCharCode(e)},$y=function(e){return String.fromCharCode(e)},ou,ji="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Hy(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),i=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,s=t.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=ji.charAt(i)+ji.charAt(a)+ji.charAt(o)+ji.charAt(l);return e}function En(t){var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)i=ji.indexOf(t.charAt(c++)),a=ji.indexOf(t.charAt(c++)),r=i<<2|a>>4,e+=String.fromCharCode(r),o=ji.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=ji.indexOf(t.charAt(c++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var Qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),so=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function sa(t){return Qe?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Wy(t){return Qe?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Qn=function(e){return Qe?so(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function io(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Kv(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Kv(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Fi=Qe?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:so(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function KL(t){for(var e=[],r=0,n=t.length+250,s=sa(t.length+255),i=0;i<t.length;++i){var a=t.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(e.push(s.slice(0,r)),r=0,s=sa(65535),n=65530)}return e.push(s.slice(0,r)),Fi(e)}var Yr=/\u0000/g,ic=/[\u0001-\u0006]/g;function qo(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function es(t,e){var r=""+t;return r.length>=e?r:Vt("0",e-r.length)+r}function qv(t,e){var r=""+t;return r.length>=e?r:Vt(" ",e-r.length)+r}function Qh(t,e){var r=""+t;return r.length>=e?r:r+Vt(" ",e-r.length)}function qL(t,e){var r=""+Math.round(t);return r.length>=e?r:Vt("0",e-r.length)+r}function XL(t,e){var r=""+t;return r.length>=e?r:Vt("0",e-r.length)+r}var Gy=Math.pow(2,32);function _o(t,e){if(t>Gy||t<-Gy)return qL(t,e);var r=Math.round(t);return XL(r,e)}function Jh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Ky=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],X0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function YL(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},qy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},QL={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Zh(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,a=1,o=0,l=1,c=0,u=0,h=Math.floor(s);c<e&&(h=Math.floor(s),o=h*a+i,u=h*c+l,!(s-h<5e-8));)s=1/(s-h),i=a,a=o,l=c,c=u;if(u>e&&(c>e?(u=l,o=i):(u=c,o=a)),!r)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function Ra(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,a=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=n6(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var YS=new Date(1899,11,31,0,0,0),JL=YS.getTime(),ZL=new Date(1900,2,1,0,0,0);function QS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=ZL&&(r+=24*60*60*1e3),(r-(JL+(t.getTimezoneOffset()-YS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Xv(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function e6(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function t6(t){var e=t<0?12:11,r=Xv(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function r6(t){var e=Xv(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function lu(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=t6(t):e===10?r=t.toFixed(10).substr(0,12):r=r6(t),Xv(e6(r.toUpperCase()))}function qa(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):lu(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Vn(14,QS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function n6(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function s6(t,e,r,n){var s="",i=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return X0[r.m-1][1];case 5:return X0[r.m-1][0];default:return X0[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return Ky[r.q][0];default:return Ky[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?es(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),e==="s"?i===0?"0":""+i/a:(s=es(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?es(l,c):"";return u}function Vi(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var JS=/%/g;function i6(t,e,r){var n=e.replace(JS,""),s=e.length-n.length;return ri(t,n,r*Math.pow(10,2*s))+Vt("%",s)}function a6(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ri(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function ZS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+ZS(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var eA=/# (\?+)( ?)\/( ?)(\d+)/;function o6(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?Vt(" ",t[1].length+1+t[4].length):qv(a,t[1].length)+t[2]+"/"+t[3]+es(o,t[4].length))}function l6(t,e,r){return r+(e===0?"":""+e)+Vt(" ",t[1].length+2+t[4].length)}var tA=/^#*0*\.([0#]+)/,rA=/\).*[0#]/,nA=/\(###\) ###\\?-####/;function Wr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Xy(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Yy(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function c6(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function u6(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Rn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(rA)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Rn("n",n,r):"("+Rn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return a6(t,e,r);if(e.indexOf("%")!==-1)return i6(t,e,r);if(e.indexOf("E")!==-1)return ZS(e,r);if(e.charCodeAt(0)===36)return"$"+Rn(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+_o(l,e.length);if(e.match(/^[#?]+$/))return s=_o(r,0),s==="0"&&(s=""),s.length>e.length?s:Wr(e.substr(0,e.length-s.length))+s;if(i=e.match(eA))return o6(i,l,c);if(e.match(/^#+0+$/))return c+_o(l,e.length-e.indexOf("0"));if(i=e.match(tA))return s=Xy(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Wr(i[1])).replace(/\.$/,"."+Wr(i[1])).replace(/\.(\d*)$/,function(v,g){return"."+g+Vt("0",Wr(i[1]).length-g.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+Xy(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Vi(_o(l,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Rn(t,e,-r):Vi(""+(Math.floor(r)+c6(r,i[1].length)))+"."+es(Yy(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Rn(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=qo(Rn(t,e.replace(/[\\-]/g,""),r)),a=0,qo(qo(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<s.length?s.charAt(a++):v==="0"?"0":""}));if(e.match(nA))return s=Rn(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=Zh(l,Math.pow(10,a)-1,!1),s=""+c,u=ri("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=Qh(o[2],a),u.length<i[4].length&&(u=Wr(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=Zh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?qv(o[1],a)+i[2]+"/"+i[3]+Qh(o[2],a):Vt(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=_o(r,0),e.length<=s.length?s:Wr(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=e.indexOf(".")-a,d=e.length-s.length-h;return Wr(e.substr(0,h)+s+e.substr(e.length-d))}if(i=e.match(/^00,000\.([#0]*0)$/))return a=Yy(r,i[1].length),r<0?"-"+Rn(t,e,-r):Vi(u6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?es(0,3-v.length):"")+v})+"."+es(a,i[1].length);switch(e){case"###,##0.00":return Rn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Vi(_o(l,0));return m!=="0"?c+m:"";case"###,###.00":return Rn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Rn(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function f6(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ri(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function h6(t,e,r){var n=e.replace(JS,""),s=e.length-n.length;return ri(t,n,r*Math.pow(10,2*s))+Vt("%",s)}function sA(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+sA(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ps(t,e,r){if(t.charCodeAt(0)===40&&!e.match(rA)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ps("n",n,r):"("+ps("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return f6(t,e,r);if(e.indexOf("%")!==-1)return h6(t,e,r);if(e.indexOf("E")!==-1)return sA(e,r);if(e.charCodeAt(0)===36)return"$"+ps(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+es(l,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Wr(e.substr(0,e.length-s.length))+s;if(i=e.match(eA))return l6(i,l,c);if(e.match(/^#+0+$/))return c+es(l,e.length-e.indexOf("0"));if(i=e.match(tA))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Wr(i[1])).replace(/\.$/,"."+Wr(i[1])),s=s.replace(/\.(\d*)$/,function(v,g){return"."+g+Vt("0",Wr(i[1]).length-g.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Vi(""+l);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ps(t,e,-r):Vi(""+r)+"."+Vt("0",i[1].length);if(i=e.match(/^#,#*,#0/))return ps(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=qo(ps(t,e.replace(/[\\-]/g,""),r)),a=0,qo(qo(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<s.length?s.charAt(a++):v==="0"?"0":""}));if(e.match(nA))return s=ps(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=Zh(l,Math.pow(10,a)-1,!1),s=""+c,u=ri("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=Qh(o[2],a),u.length<i[4].length&&(u=Wr(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=Zh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?qv(o[1],a)+i[2]+"/"+i[3]+Qh(o[2],a):Vt(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Wr(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=e.indexOf(".")-a,d=e.length-s.length-h;return Wr(e.substr(0,h)+s+e.substr(e.length-d))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ps(t,e,-r):Vi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?es(0,3-v.length):"")+v})+"."+es(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=Vi(""+l);return m!=="0"?c+m:"";default:if(e.match(/\.[0#?]*$/))return ps(t,e.slice(0,e.lastIndexOf(".")),r)+Wr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ri(t,e,r){return(r|0)===r?ps(t,e,r):Rn(t,e,r)}function d6(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var iA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Sl(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Jh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(iA))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function p6(t,e,r,n){for(var s=[],i="",a=0,o="",l="t",c,u,h,d="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Jh(t,a))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(h=t.charCodeAt(++a))!==34&&a<t.length;)i+=String.fromCharCode(h);s[s.length]={t:"t",v:i},++a;break;case"\\":var m=t.charAt(++a),v=m==="("||m===")"?m:"t";s[s.length]={t:v,v:m},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=Ra(e,r,t.charAt(a+1)==="2"),c==null))return"";s[s.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Ra(e,r),c==null))return"";for(i=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),s[s.length]={t:o,v:i},l=o;break;case"A":case"a":case"":var g={t:o,v:o};if(c==null&&(c=Ra(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",d="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",a+=5,d="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(g.v=c.H>=12?"":""),g.t="T",a+=5,d="h"):(g.t="t",++a),c==null&&g.t==="T")return"";s[s.length]=g,l=o;break;case"[":for(i=o;t.charAt(a++)!=="]"&&a<t.length;)i+=t.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(iA)){if(c==null&&(c=Ra(e,r),c==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Sl(t)||(s[s.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++a<t.length&&(o=t.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;t.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)i+=t.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++a;break}var y=0,S=0,k;for(a=s.length-1,l="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=d,l="h",y<1&&(y=1);break;case"s":(k=s[a].v.match(/\.0+$/))&&(S=Math.max(S,k[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=s[a].t;break;case"m":l==="s"&&(s[a].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&s[a].v.match(/[Hh]/)&&(y=1),y<2&&s[a].v.match(/[Mm]/)&&(y=2),y<3&&s[a].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",F;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=s6(s[a].t.charCodeAt(0),s[a].v,c,S),s[a].t="t";break;case"n":case"?":for(F=a+1;s[F]!=null&&((o=s[F].t)==="?"||o==="D"||(o===" "||o==="t")&&s[F+1]!=null&&(s[F+1].t==="?"||s[F+1].t==="t"&&s[F+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[F].v==="/"||s[F].v===" "&&s[F+1]!=null&&s[F+1].t=="?"));)s[a].v+=s[F].v,s[F]={v:"",t:";"},++F;w+=s[a].v,a=F-1;break;case"G":s[a].t="t",s[a].v=qa(e,r);break}var B="",V,x;if(w.length>0){w.charCodeAt(0)==40?(V=e<0&&w.charCodeAt(0)===45?-e:e,x=ri("n",w,V)):(V=e<0&&n>1?-e:e,x=ri("n",w,V),V<0&&s[0]&&s[0].t=="t"&&(x=x.substr(1),s[0].v="-"+s[0].v)),F=x.length-1;var E=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){E=a;break}var T=s.length;if(E===s.length&&x.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(F>=s[a].v.length-1?(F-=s[a].v.length,s[a].v=x.substr(F+1,s[a].v.length)):F<0?s[a].v="":(s[a].v=x.substr(0,F+1),F=-1),s[a].t="t",T=a);F>=0&&T<s.length&&(s[T].v=x.substr(0,F+1)+s[T].v)}else if(E!==s.length&&x.indexOf("E")===-1){for(F=x.indexOf(".")-1,a=E;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(u=s[a].v.indexOf(".")>-1&&a===E?s[a].v.indexOf(".")-1:s[a].v.length-1,B=s[a].v.substr(u+1);u>=0;--u)F>=0&&(s[a].v.charAt(u)==="0"||s[a].v.charAt(u)==="#")&&(B=x.charAt(F--)+B);s[a].v=B,s[a].t="t",T=a}for(F>=0&&T<s.length&&(s[T].v=x.substr(0,F+1)+s[T].v),F=x.indexOf(".")+1,a=E;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==E)){for(u=s[a].v.indexOf(".")>-1&&a===E?s[a].v.indexOf(".")+1:0,B=s[a].v.substr(0,u);u<s[a].v.length;++u)F<x.length&&(B+=x.charAt(F++));s[a].v=B,s[a].t="t",T=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(V=n>1&&e<0&&a>0&&s[a-1].v==="-"?-e:e,s[a].v=ri(s[a].t,s[a].v,V),s[a].t="t");var I="";for(a=0;a!==s.length;++a)s[a]!=null&&(I+=s[a].v);return I}var Qy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Jy(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function m6(t,e){var r=d6(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Qy),o=r[1].match(Qy);return Jy(e,a)?[n,r[0]]:Jy(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function Vn(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ze)[t],n==null&&(n=r.table&&r.table[qy[t]]||ze[qy[t]]),n==null&&(n=QL[t]||"General");break}if(Jh(n,0))return qa(e,r);e instanceof Date&&(e=QS(e,r.date1904));var s=m6(n,e);if(Jh(s[1]))return qa(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return p6(s[1],e,r,s[0])}function Oa(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ze[r]==null){e<0&&(e=r);continue}if(ze[r]==t){e=r;break}}e<0&&(e=391)}return ze[e]=t,e}function aA(){ze=YL()}var g6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},oA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function v6(t){var e=typeof t=="number"?ze[t]:t;return e=e.replace(oA,"(\\d+)"),new RegExp("^"+e+"$")}function x6(t,e,r){var n=-1,s=-1,i=-1,a=-1,o=-1,l=-1;(e.match(oA)||[]).forEach(function(h,d){var m=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":i=m;break;case"h":a=m;break;case"s":l=m;break;case"m":a>=0?o=m:s=m;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&i==-1?u:c+"T"+u}var _6=function(){var t={};t.version="1.2.0";function e(){for(var x=0,E=new Array(256),T=0;T!=256;++T)x=T,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,E[T]=x;return typeof Int32Array<"u"?new Int32Array(E):E}var r=e();function n(x){var E=0,T=0,I=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)P[I]=x[I];for(I=0;I!=256;++I)for(T=x[I],E=256+I;E<4096;E+=256)T=P[E]=T>>>8^x[T&255];var N=[];for(I=1;I!=16;++I)N[I-1]=typeof Int32Array<"u"?P.subarray(I*256,I*256+256):P.slice(I*256,I*256+256);return N}var s=n(r),i=s[0],a=s[1],o=s[2],l=s[3],c=s[4],u=s[5],h=s[6],d=s[7],m=s[8],v=s[9],g=s[10],y=s[11],S=s[12],k=s[13],w=s[14];function F(x,E){for(var T=E^-1,I=0,P=x.length;I<P;)T=T>>>8^r[(T^x.charCodeAt(I++))&255];return~T}function B(x,E){for(var T=E^-1,I=x.length-15,P=0;P<I;)T=w[x[P++]^T&255]^k[x[P++]^T>>8&255]^S[x[P++]^T>>16&255]^y[x[P++]^T>>>24]^g[x[P++]]^v[x[P++]]^m[x[P++]]^d[x[P++]]^h[x[P++]]^u[x[P++]]^c[x[P++]]^l[x[P++]]^o[x[P++]]^a[x[P++]]^i[x[P++]]^r[x[P++]];for(I+=15;P<I;)T=T>>>8^r[(T^x[P++])&255];return~T}function V(x,E){for(var T=E^-1,I=0,P=x.length,N=0,R=0;I<P;)N=x.charCodeAt(I++),N<128?T=T>>>8^r[(T^N)&255]:N<2048?(T=T>>>8^r[(T^(192|N>>6&31))&255],T=T>>>8^r[(T^(128|N&63))&255]):N>=55296&&N<57344?(N=(N&1023)+64,R=x.charCodeAt(I++)&1023,T=T>>>8^r[(T^(240|N>>8&7))&255],T=T>>>8^r[(T^(128|N>>2&63))&255],T=T>>>8^r[(T^(128|R>>6&15|(N&3)<<4))&255],T=T>>>8^r[(T^(128|R&63))&255]):(T=T>>>8^r[(T^(224|N>>12&15))&255],T=T>>>8^r[(T^(128|N>>6&63))&255],T=T>>>8^r[(T^(128|N&63))&255]);return~T}return t.table=r,t.bstr=F,t.buf=B,t.str=V,t}(),et=function(){var e={};e.version="1.2.1";function r(C,L){for(var D=C.split("/"),b=L.split("/"),O=0,M=0,X=Math.min(D.length,b.length);O<X;++O){if(M=D[O].length-b[O].length)return M;if(D[O]!=b[O])return D[O]<b[O]?-1:1}return D.length-b.length}function n(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:n(C.slice(0,-1));var L=C.lastIndexOf("/");return L===-1?C:C.slice(0,L+1)}function s(C){if(C.charAt(C.length-1)=="/")return s(C.slice(0,-1));var L=C.lastIndexOf("/");return L===-1?C:C.slice(L+1)}function i(C,L){typeof L=="string"&&(L=new Date(L));var D=L.getHours();D=D<<6|L.getMinutes(),D=D<<5|L.getSeconds()>>>1,C.write_shift(2,D);var b=L.getFullYear()-1980;b=b<<4|L.getMonth()+1,b=b<<5|L.getDate(),C.write_shift(2,b)}function a(C){var L=C.read_shift(2)&65535,D=C.read_shift(2)&65535,b=new Date,O=D&31;D>>>=5;var M=D&15;D>>>=4,b.setMilliseconds(0),b.setFullYear(D+1980),b.setMonth(M-1),b.setDate(O);var X=L&31;L>>>=5;var te=L&63;return L>>>=6,b.setHours(L),b.setMinutes(te),b.setSeconds(X<<1),b}function o(C){xr(C,0);for(var L={},D=0;C.l<=C.length-4;){var b=C.read_shift(2),O=C.read_shift(2),M=C.l+O,X={};switch(b){case 21589:D=C.read_shift(1),D&1&&(X.mtime=C.read_shift(4)),O>5&&(D&2&&(X.atime=C.read_shift(4)),D&4&&(X.ctime=C.read_shift(4))),X.mtime&&(X.mt=new Date(X.mtime*1e3));break}C.l=M,L[b]=X}return L}var l;function c(){return l||(l={})}function u(C,L){if(C[0]==80&&C[1]==75)return _i(C,L);if((C[0]|32)==109&&(C[1]|32)==105)return ho(C,L);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var D=3,b=512,O=0,M=0,X=0,te=0,ee=0,Z=[],Q=C.slice(0,512);xr(Q,0);var ce=h(Q);switch(D=ce[0],D){case 3:b=512;break;case 4:b=4096;break;case 0:if(ce[1]==0)return _i(C,L);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}b!==512&&(Q=C.slice(0,b),xr(Q,28));var ye=C.slice(0,b);d(Q,D);var Ie=Q.read_shift(4,"i");if(D===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);Q.l+=4,X=Q.read_shift(4,"i"),Q.l+=4,Q.chk("00100000","Mini Stream Cutoff Size: "),te=Q.read_shift(4,"i"),O=Q.read_shift(4,"i"),ee=Q.read_shift(4,"i"),M=Q.read_shift(4,"i");for(var pe=-1,Ee=0;Ee<109&&(pe=Q.read_shift(4,"i"),!(pe<0));++Ee)Z[Ee]=pe;var Fe=m(C,b);y(ee,M,Fe,b,Z);var nt=k(Fe,X,Z,b);nt[X].name="!Directory",O>0&&te!==R&&(nt[te].name="!MiniFAT"),nt[Z[0]].name="!FAT",nt.fat_addrs=Z,nt.ssz=b;var Ke={},dt=[],rn=[],He=[];w(X,nt,Fe,dt,O,Ke,rn,te),v(rn,He,dt),dt.shift();var ft={FileIndex:rn,FullPaths:He};return L&&L.raw&&(ft.raw={header:ye,sectors:Fe}),ft}function h(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(se,"Header Signature: "),C.l+=16;var L=C.read_shift(2,"u");return[C.read_shift(2,"u"),L]}function d(C,L){var D=9;switch(C.l+=2,D=C.read_shift(2)){case 9:if(L!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(L!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function m(C,L){for(var D=Math.ceil(C.length/L)-1,b=[],O=1;O<D;++O)b[O-1]=C.slice(O*L,(O+1)*L);return b[D-1]=C.slice(D*L),b}function v(C,L,D){for(var b=0,O=0,M=0,X=0,te=0,ee=D.length,Z=[],Q=[];b<ee;++b)Z[b]=Q[b]=b,L[b]=D[b];for(;te<Q.length;++te)b=Q[te],O=C[b].L,M=C[b].R,X=C[b].C,Z[b]===b&&(O!==-1&&Z[O]!==O&&(Z[b]=Z[O]),M!==-1&&Z[M]!==M&&(Z[b]=Z[M])),X!==-1&&(Z[X]=b),O!==-1&&b!=Z[b]&&(Z[O]=Z[b],Q.lastIndexOf(O)<te&&Q.push(O)),M!==-1&&b!=Z[b]&&(Z[M]=Z[b],Q.lastIndexOf(M)<te&&Q.push(M));for(b=1;b<ee;++b)Z[b]===b&&(M!==-1&&Z[M]!==M?Z[b]=Z[M]:O!==-1&&Z[O]!==O&&(Z[b]=Z[O]));for(b=1;b<ee;++b)if(C[b].type!==0){if(te=b,te!=Z[te])do te=Z[te],L[b]=L[te]+"/"+L[b];while(te!==0&&Z[te]!==-1&&te!=Z[te]);Z[b]=-1}for(L[0]+="/",b=1;b<ee;++b)C[b].type!==2&&(L[b]+="/")}function g(C,L,D){for(var b=C.start,O=C.size,M=[],X=b;D&&O>0&&X>=0;)M.push(L.slice(X*N,X*N+N)),O-=N,X=Ea(D,X*4);return M.length===0?er(0):Fi(M).slice(0,C.size)}function y(C,L,D,b,O){var M=R;if(C===R){if(L!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var X=D[C],te=(b>>>2)-1;if(!X)return;for(var ee=0;ee<te&&(M=Ea(X,ee*4))!==R;++ee)O.push(M);y(Ea(X,b-4),L-1,D,b,O)}}function S(C,L,D,b,O){var M=[],X=[];O||(O=[]);var te=b-1,ee=0,Z=0;for(ee=L;ee>=0;){O[ee]=!0,M[M.length]=ee,X.push(C[ee]);var Q=D[Math.floor(ee*4/b)];if(Z=ee*4&te,b<4+Z)throw new Error("FAT boundary crossed: "+ee+" 4 "+b);if(!C[Q])break;ee=Ea(C[Q],Z)}return{nodes:M,data:lw([X])}}function k(C,L,D,b){var O=C.length,M=[],X=[],te=[],ee=[],Z=b-1,Q=0,ce=0,ye=0,Ie=0;for(Q=0;Q<O;++Q)if(te=[],ye=Q+L,ye>=O&&(ye-=O),!X[ye]){ee=[];var pe=[];for(ce=ye;ce>=0;){pe[ce]=!0,X[ce]=!0,te[te.length]=ce,ee.push(C[ce]);var Ee=D[Math.floor(ce*4/b)];if(Ie=ce*4&Z,b<4+Ie)throw new Error("FAT boundary crossed: "+ce+" 4 "+b);if(!C[Ee]||(ce=Ea(C[Ee],Ie),pe[ce]))break}M[ye]={nodes:te,data:lw([ee])}}return M}function w(C,L,D,b,O,M,X,te){for(var ee=0,Z=b.length?2:0,Q=L[C].data,ce=0,ye=0,Ie;ce<Q.length;ce+=128){var pe=Q.slice(ce,ce+128);xr(pe,64),ye=pe.read_shift(2),Ie=ex(pe,0,ye-Z),b.push(Ie);var Ee={name:Ie,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},Fe=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);Fe!==0&&(Ee.ct=F(pe,pe.l-8));var nt=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);nt!==0&&(Ee.mt=F(pe,pe.l-8)),Ee.start=pe.read_shift(4,"i"),Ee.size=pe.read_shift(4,"i"),Ee.size<0&&Ee.start<0&&(Ee.size=Ee.type=0,Ee.start=R,Ee.name=""),Ee.type===5?(ee=Ee.start,O>0&&ee!==R&&(L[ee].name="!StreamData")):Ee.size>=4096?(Ee.storage="fat",L[Ee.start]===void 0&&(L[Ee.start]=S(D,Ee.start,L.fat_addrs,L.ssz)),L[Ee.start].name=Ee.name,Ee.content=L[Ee.start].data.slice(0,Ee.size)):(Ee.storage="minifat",Ee.size<0?Ee.size=0:ee!==R&&Ee.start!==R&&L[ee]&&(Ee.content=g(Ee,L[ee].data,(L[te]||{}).data))),Ee.content&&xr(Ee.content,0),M[Ie]=Ee,X.push(Ee)}}function F(C,L){return new Date((gn(C,L+4)/1e7*Math.pow(2,32)+gn(C,L)/1e7-11644473600)*1e3)}function B(C,L){return c(),u(l.readFileSync(C),L)}function V(C,L){var D=L&&L.type;switch(D||Qe&&Buffer.isBuffer(C)&&(D="buffer"),D||"base64"){case"file":return B(C,L);case"base64":return u(Qn(En(C)),L);case"binary":return u(Qn(C),L)}return u(C,L)}function x(C,L){var D=L||{},b=D.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=b+"/",C.FileIndex[0]={name:b,type:5}),D.CLSID&&(C.FileIndex[0].clsid=D.CLSID),E(C)}function E(C){var L="Sh33tJ5";if(!et.find(C,"/"+L)){var D=er(4);D[0]=55,D[1]=D[3]=50,D[2]=54,C.FileIndex.push({name:L,type:2,content:D,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+L),T(C)}}function T(C,L){x(C);for(var D=!1,b=!1,O=C.FullPaths.length-1;O>=0;--O){var M=C.FileIndex[O];switch(M.type){case 0:b?D=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:b=!0,isNaN(M.R*M.L*M.C)&&(D=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!L)){var X=new Date(1987,1,19),te=0,ee=Object.create?Object.create(null):{},Z=[];for(O=0;O<C.FullPaths.length;++O)ee[C.FullPaths[O]]=!0,C.FileIndex[O].type!==0&&Z.push([C.FullPaths[O],C.FileIndex[O]]);for(O=0;O<Z.length;++O){var Q=n(Z[O][0]);b=ee[Q],b||(Z.push([Q,{name:s(Q).replace("/",""),type:1,clsid:fe,ct:X,mt:X,content:null}]),ee[Q]=!0)}for(Z.sort(function(Ie,pe){return r(Ie[0],pe[0])}),C.FullPaths=[],C.FileIndex=[],O=0;O<Z.length;++O)C.FullPaths[O]=Z[O][0],C.FileIndex[O]=Z[O][1];for(O=0;O<Z.length;++O){var ce=C.FileIndex[O],ye=C.FullPaths[O];if(ce.name=s(ye).replace("/",""),ce.L=ce.R=ce.C=-(ce.color=1),ce.size=ce.content?ce.content.length:0,ce.start=0,ce.clsid=ce.clsid||fe,O===0)ce.C=Z.length>1?1:-1,ce.size=0,ce.type=5;else if(ye.slice(-1)=="/"){for(te=O+1;te<Z.length&&n(C.FullPaths[te])!=ye;++te);for(ce.C=te>=Z.length?-1:te,te=O+1;te<Z.length&&n(C.FullPaths[te])!=n(ye);++te);ce.R=te>=Z.length?-1:te,ce.type=1}else n(C.FullPaths[O+1]||"")==n(ye)&&(ce.R=O+1),ce.type=2}}}function I(C,L){var D=L||{};if(D.fileType=="mad")return Zt(C,D);switch(T(C),D.fileType){case"zip":return js(C,D)}var b=function(Ie){for(var pe=0,Ee=0,Fe=0;Fe<Ie.FileIndex.length;++Fe){var nt=Ie.FileIndex[Fe];if(nt.content){var Ke=nt.content.length;Ke>0&&(Ke<4096?pe+=Ke+63>>6:Ee+=Ke+511>>9)}}for(var dt=Ie.FullPaths.length+3>>2,rn=pe+7>>3,He=pe+127>>7,ft=rn+Ee+dt+He,pr=ft+127>>7,In=pr<=109?0:Math.ceil((pr-109)/127);ft+pr+In+127>>7>pr;)In=++pr<=109?0:Math.ceil((pr-109)/127);var Je=[1,In,pr,He,dt,Ee,pe,0];return Ie.FileIndex[0].size=pe<<6,Je[7]=(Ie.FileIndex[0].start=Je[0]+Je[1]+Je[2]+Je[3]+Je[4]+Je[5])+(Je[6]+7>>3),Je}(C),O=er(b[7]<<9),M=0,X=0;{for(M=0;M<8;++M)O.write_shift(1,ae[M]);for(M=0;M<8;++M)O.write_shift(2,0);for(O.write_shift(2,62),O.write_shift(2,3),O.write_shift(2,65534),O.write_shift(2,9),O.write_shift(2,6),M=0;M<3;++M)O.write_shift(2,0);for(O.write_shift(4,0),O.write_shift(4,b[2]),O.write_shift(4,b[0]+b[1]+b[2]+b[3]-1),O.write_shift(4,0),O.write_shift(4,4096),O.write_shift(4,b[3]?b[0]+b[1]+b[2]-1:R),O.write_shift(4,b[3]),O.write_shift(-4,b[1]?b[0]-1:R),O.write_shift(4,b[1]),M=0;M<109;++M)O.write_shift(-4,M<b[2]?b[1]+M:-1)}if(b[1])for(X=0;X<b[1];++X){for(;M<236+X*127;++M)O.write_shift(-4,M<b[2]?b[1]+M:-1);O.write_shift(-4,X===b[1]-1?R:X+1)}var te=function(Ie){for(X+=Ie;M<X-1;++M)O.write_shift(-4,M+1);Ie&&(++M,O.write_shift(-4,R))};for(X=M=0,X+=b[1];M<X;++M)O.write_shift(-4,ge.DIFSECT);for(X+=b[2];M<X;++M)O.write_shift(-4,ge.FATSECT);te(b[3]),te(b[4]);for(var ee=0,Z=0,Q=C.FileIndex[0];ee<C.FileIndex.length;++ee)Q=C.FileIndex[ee],Q.content&&(Z=Q.content.length,!(Z<4096)&&(Q.start=X,te(Z+511>>9)));for(te(b[6]+7>>3);O.l&511;)O.write_shift(-4,ge.ENDOFCHAIN);for(X=M=0,ee=0;ee<C.FileIndex.length;++ee)Q=C.FileIndex[ee],Q.content&&(Z=Q.content.length,!(!Z||Z>=4096)&&(Q.start=X,te(Z+63>>6)));for(;O.l&511;)O.write_shift(-4,ge.ENDOFCHAIN);for(M=0;M<b[4]<<2;++M){var ce=C.FullPaths[M];if(!ce||ce.length===0){for(ee=0;ee<17;++ee)O.write_shift(4,0);for(ee=0;ee<3;++ee)O.write_shift(4,-1);for(ee=0;ee<12;++ee)O.write_shift(4,0);continue}Q=C.FileIndex[M],M===0&&(Q.start=Q.size?Q.start-1:R);var ye=M===0&&D.root||Q.name;if(Z=2*(ye.length+1),O.write_shift(64,ye,"utf16le"),O.write_shift(2,Z),O.write_shift(1,Q.type),O.write_shift(1,Q.color),O.write_shift(-4,Q.L),O.write_shift(-4,Q.R),O.write_shift(-4,Q.C),Q.clsid)O.write_shift(16,Q.clsid,"hex");else for(ee=0;ee<4;++ee)O.write_shift(4,0);O.write_shift(4,Q.state||0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,Q.start),O.write_shift(4,Q.size),O.write_shift(4,0)}for(M=1;M<C.FileIndex.length;++M)if(Q=C.FileIndex[M],Q.size>=4096)if(O.l=Q.start+1<<9,Qe&&Buffer.isBuffer(Q.content))Q.content.copy(O,O.l,0,Q.size),O.l+=Q.size+511&-512;else{for(ee=0;ee<Q.size;++ee)O.write_shift(1,Q.content[ee]);for(;ee&511;++ee)O.write_shift(1,0)}for(M=1;M<C.FileIndex.length;++M)if(Q=C.FileIndex[M],Q.size>0&&Q.size<4096)if(Qe&&Buffer.isBuffer(Q.content))Q.content.copy(O,O.l,0,Q.size),O.l+=Q.size+63&-64;else{for(ee=0;ee<Q.size;++ee)O.write_shift(1,Q.content[ee]);for(;ee&63;++ee)O.write_shift(1,0)}if(Qe)O.l=O.length;else for(;O.l<O.length;)O.write_shift(1,0);return O}function P(C,L){var D=C.FullPaths.map(function(ee){return ee.toUpperCase()}),b=D.map(function(ee){var Z=ee.split("/");return Z[Z.length-(ee.slice(-1)=="/"?2:1)]}),O=!1;L.charCodeAt(0)===47?(O=!0,L=D[0].slice(0,-1)+L):O=L.indexOf("/")!==-1;var M=L.toUpperCase(),X=O===!0?D.indexOf(M):b.indexOf(M);if(X!==-1)return C.FileIndex[X];var te=!M.match(ic);for(M=M.replace(Yr,""),te&&(M=M.replace(ic,"!")),X=0;X<D.length;++X)if((te?D[X].replace(ic,"!"):D[X]).replace(Yr,"")==M||(te?b[X].replace(ic,"!"):b[X]).replace(Yr,"")==M)return C.FileIndex[X];return null}var N=64,R=-2,se="d0cf11e0a1b11ae1",ae=[208,207,17,224,161,177,26,225],fe="00000000000000000000000000000000",ge={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:se,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(C,L,D){c();var b=I(C,D);l.writeFileSync(L,b)}function K(C){for(var L=new Array(C.length),D=0;D<C.length;++D)L[D]=String.fromCharCode(C[D]);return L.join("")}function he(C,L){var D=I(C,L);switch(L&&L.type||"buffer"){case"file":return c(),l.writeFileSync(L.filename,D),D;case"binary":return typeof D=="string"?D:K(D);case"base64":return Hy(typeof D=="string"?D:K(D));case"buffer":if(Qe)return Buffer.isBuffer(D)?D:so(D);case"array":return typeof D=="string"?Qn(D):D}return D}var we;function U(C){try{var L=C.InflateRaw,D=new L;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)we=C;else throw new Error("zlib does not expose bytesRead")}catch(b){console.error("cannot use native zlib: "+(b.message||b))}}function q(C,L){if(!we)return Ls(C,L);var D=we.InflateRaw,b=new D,O=b._processChunk(C.slice(C.l),b._finishFlushFlag);return C.l+=b.bytesRead,O}function Y(C){return we?we.deflateRawSync(C):je(C)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Re(C){var L=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(L>>16|L>>8|L)&255}for(var Te=typeof Uint8Array<"u",ve=Te?new Uint8Array(256):[],$e=0;$e<256;++$e)ve[$e]=Re($e);function z(C,L){var D=ve[C&255];return L<=8?D>>>8-L:(D=D<<8|ve[C>>8&255],L<=16?D>>>16-L:(D=D<<8|ve[C>>16&255],D>>>24-L))}function at(C,L){var D=L&7,b=L>>>3;return(C[b]|(D<=6?0:C[b+1]<<8))>>>D&3}function We(C,L){var D=L&7,b=L>>>3;return(C[b]|(D<=5?0:C[b+1]<<8))>>>D&7}function rt(C,L){var D=L&7,b=L>>>3;return(C[b]|(D<=4?0:C[b+1]<<8))>>>D&15}function be(C,L){var D=L&7,b=L>>>3;return(C[b]|(D<=3?0:C[b+1]<<8))>>>D&31}function Ae(C,L){var D=L&7,b=L>>>3;return(C[b]|(D<=1?0:C[b+1]<<8))>>>D&127}function Tt(C,L,D){var b=L&7,O=L>>>3,M=(1<<D)-1,X=C[O]>>>b;return D<8-b||(X|=C[O+1]<<8-b,D<16-b)||(X|=C[O+2]<<16-b,D<24-b)||(X|=C[O+3]<<24-b),X&M}function or(C,L,D){var b=L&7,O=L>>>3;return b<=5?C[O]|=(D&7)<<b:(C[O]|=D<<b&255,C[O+1]=(D&7)>>8-b),L+3}function Ar(C,L,D){var b=L&7,O=L>>>3;return D=(D&1)<<b,C[O]|=D,L+1}function en(C,L,D){var b=L&7,O=L>>>3;return D<<=b,C[O]|=D&255,D>>>=8,C[O+1]=D,L+8}function Os(C,L,D){var b=L&7,O=L>>>3;return D<<=b,C[O]|=D&255,D>>>=8,C[O+1]=D&255,C[O+2]=D>>>8,L+16}function tn(C,L){var D=C.length,b=2*D>L?2*D:L+5,O=0;if(D>=L)return C;if(Qe){var M=Wy(b);if(C.copy)C.copy(M);else for(;O<C.length;++O)M[O]=C[O];return M}else if(Te){var X=new Uint8Array(b);if(X.set)X.set(C);else for(;O<D;++O)X[O]=C[O];return X}return C.length=b,C}function kt(C){for(var L=new Array(C),D=0;D<C;++D)L[D]=0;return L}function lr(C,L,D){var b=1,O=0,M=0,X=0,te=0,ee=C.length,Z=Te?new Uint16Array(32):kt(32);for(M=0;M<32;++M)Z[M]=0;for(M=ee;M<D;++M)C[M]=0;ee=C.length;var Q=Te?new Uint16Array(ee):kt(ee);for(M=0;M<ee;++M)Z[O=C[M]]++,b<O&&(b=O),Q[M]=0;for(Z[0]=0,M=1;M<=b;++M)Z[M+16]=te=te+Z[M-1]<<1;for(M=0;M<ee;++M)te=C[M],te!=0&&(Q[M]=Z[te+16]++);var ce=0;for(M=0;M<ee;++M)if(ce=C[M],ce!=0)for(te=z(Q[M],b)>>b-ce,X=(1<<b+4-ce)-1;X>=0;--X)L[te|X<<ce]=ce&15|M<<4;return b}var vt=Te?new Uint16Array(512):kt(512),St=Te?new Uint16Array(32):kt(32);if(!Te){for(var ht=0;ht<512;++ht)vt[ht]=0;for(ht=0;ht<32;++ht)St[ht]=0}(function(){for(var C=[],L=0;L<32;L++)C.push(5);lr(C,St,32);var D=[];for(L=0;L<=143;L++)D.push(8);for(;L<=255;L++)D.push(9);for(;L<=279;L++)D.push(7);for(;L<=287;L++)D.push(8);lr(D,vt,288)})();var Dt=function(){for(var L=Te?new Uint8Array(32768):[],D=0,b=0;D<xe.length-1;++D)for(;b<xe[D+1];++b)L[b]=D;for(;b<32768;++b)L[b]=29;var O=Te?new Uint8Array(259):[];for(D=0,b=0;D<le.length-1;++D)for(;b<le[D+1];++b)O[b]=D;function M(te,ee){for(var Z=0;Z<te.length;){var Q=Math.min(65535,te.length-Z),ce=Z+Q==te.length;for(ee.write_shift(1,+ce),ee.write_shift(2,Q),ee.write_shift(2,~Q&65535);Q-- >0;)ee[ee.l++]=te[Z++]}return ee.l}function X(te,ee){for(var Z=0,Q=0,ce=Te?new Uint16Array(32768):[];Q<te.length;){var ye=Math.min(65535,te.length-Q);if(ye<10){for(Z=or(ee,Z,+(Q+ye==te.length)),Z&7&&(Z+=8-(Z&7)),ee.l=Z/8|0,ee.write_shift(2,ye),ee.write_shift(2,~ye&65535);ye-- >0;)ee[ee.l++]=te[Q++];Z=ee.l*8;continue}Z=or(ee,Z,+(Q+ye==te.length)+2);for(var Ie=0;ye-- >0;){var pe=te[Q];Ie=(Ie<<5^pe)&32767;var Ee=-1,Fe=0;if((Ee=ce[Ie])&&(Ee|=Q&-32768,Ee>Q&&(Ee-=32768),Ee<Q))for(;te[Ee+Fe]==te[Q+Fe]&&Fe<250;)++Fe;if(Fe>2){pe=O[Fe],pe<=22?Z=en(ee,Z,ve[pe+1]>>1)-1:(en(ee,Z,3),Z+=5,en(ee,Z,ve[pe-23]>>5),Z+=3);var nt=pe<8?0:pe-4>>2;nt>0&&(Os(ee,Z,Fe-le[pe]),Z+=nt),pe=L[Q-Ee],Z=en(ee,Z,ve[pe]>>3),Z-=3;var Ke=pe<4?0:pe-2>>1;Ke>0&&(Os(ee,Z,Q-Ee-xe[pe]),Z+=Ke);for(var dt=0;dt<Fe;++dt)ce[Ie]=Q&32767,Ie=(Ie<<5^te[Q])&32767,++Q;ye-=Fe-1}else pe<=143?pe=pe+48:Z=Ar(ee,Z,1),Z=en(ee,Z,ve[pe]),ce[Ie]=Q&32767,++Q}Z=en(ee,Z,0)-1}return ee.l=(Z+7)/8|0,ee.l}return function(ee,Z){return ee.length<8?M(ee,Z):X(ee,Z)}}();function je(C){var L=er(50+Math.floor(C.length*1.1)),D=Dt(C,L);return L.slice(0,D)}var xt=Te?new Uint16Array(32768):kt(32768),Wt=Te?new Uint16Array(32768):kt(32768),ut=Te?new Uint16Array(128):kt(128),hn=1,Ms=1;function uo(C,L){var D=be(C,L)+257;L+=5;var b=be(C,L)+1;L+=5;var O=rt(C,L)+4;L+=4;for(var M=0,X=Te?new Uint8Array(19):kt(19),te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,Z=Te?new Uint8Array(8):kt(8),Q=Te?new Uint8Array(8):kt(8),ce=X.length,ye=0;ye<O;++ye)X[G[ye]]=M=We(C,L),ee<M&&(ee=M),Z[M]++,L+=3;var Ie=0;for(Z[0]=0,ye=1;ye<=ee;++ye)Q[ye]=Ie=Ie+Z[ye-1]<<1;for(ye=0;ye<ce;++ye)(Ie=X[ye])!=0&&(te[ye]=Q[Ie]++);var pe=0;for(ye=0;ye<ce;++ye)if(pe=X[ye],pe!=0){Ie=ve[te[ye]]>>8-pe;for(var Ee=(1<<7-pe)-1;Ee>=0;--Ee)ut[Ie|Ee<<pe]=pe&7|ye<<3}var Fe=[];for(ee=1;Fe.length<D+b;)switch(Ie=ut[Ae(C,L)],L+=Ie&7,Ie>>>=3){case 16:for(M=3+at(C,L),L+=2,Ie=Fe[Fe.length-1];M-- >0;)Fe.push(Ie);break;case 17:for(M=3+We(C,L),L+=3;M-- >0;)Fe.push(0);break;case 18:for(M=11+Ae(C,L),L+=7;M-- >0;)Fe.push(0);break;default:Fe.push(Ie),ee<Ie&&(ee=Ie);break}var nt=Fe.slice(0,D),Ke=Fe.slice(D);for(ye=D;ye<286;++ye)nt[ye]=0;for(ye=b;ye<30;++ye)Ke[ye]=0;return hn=lr(nt,xt,286),Ms=lr(Ke,Wt,30),L}function Cl(C,L){if(C[0]==3&&!(C[1]&3))return[sa(L),2];for(var D=0,b=0,O=Wy(L||1<<18),M=0,X=O.length>>>0,te=0,ee=0;!(b&1);){if(b=We(C,D),D+=3,b>>>1)b>>1==1?(te=9,ee=5):(D=uo(C,D),te=hn,ee=Ms);else{D&7&&(D+=8-(D&7));var Z=C[D>>>3]|C[(D>>>3)+1]<<8;if(D+=32,Z>0)for(!L&&X<M+Z&&(O=tn(O,M+Z),X=O.length);Z-- >0;)O[M++]=C[D>>>3],D+=8;continue}for(;;){!L&&X<M+32767&&(O=tn(O,M+32767),X=O.length);var Q=Tt(C,D,te),ce=b>>>1==1?vt[Q]:xt[Q];if(D+=ce&15,ce>>>=4,!(ce>>>8&255))O[M++]=ce;else{if(ce==256)break;ce-=257;var ye=ce<8?0:ce-4>>2;ye>5&&(ye=0);var Ie=M+le[ce];ye>0&&(Ie+=Tt(C,D,ye),D+=ye),Q=Tt(C,D,ee),ce=b>>>1==1?St[Q]:Wt[Q],D+=ce&15,ce>>>=4;var pe=ce<4?0:ce-2>>1,Ee=xe[ce];for(pe>0&&(Ee+=Tt(C,D,pe),D+=pe),!L&&X<Ie&&(O=tn(O,Ie+100),X=O.length);M<Ie;)O[M]=O[M-Ee],++M}}}return L?[O,D+7>>>3]:[O.slice(0,M),D+7>>>3]}function Ls(C,L){var D=C.slice(C.l||0),b=Cl(D,L);return C.l+=b[1],b[0]}function cs(C,L){if(C)typeof console<"u"&&console.error(L);else throw new Error(L)}function _i(C,L){var D=C;xr(D,0);var b=[],O=[],M={FileIndex:b,FullPaths:O};x(M,{root:L.root});for(var X=D.length-4;(D[X]!=80||D[X+1]!=75||D[X+2]!=5||D[X+3]!=6)&&X>=0;)--X;D.l=X+4,D.l+=4;var te=D.read_shift(2);D.l+=6;var ee=D.read_shift(4);for(D.l=ee,X=0;X<te;++X){D.l+=20;var Z=D.read_shift(4),Q=D.read_shift(4),ce=D.read_shift(2),ye=D.read_shift(2),Ie=D.read_shift(2);D.l+=8;var pe=D.read_shift(4),Ee=o(D.slice(D.l+ce,D.l+ce+ye));D.l+=ce+ye+Ie;var Fe=D.l;D.l=pe+4,Bn(D,Z,Q,M,Ee),D.l=Fe}return M}function Bn(C,L,D,b,O){C.l+=2;var M=C.read_shift(2),X=C.read_shift(2),te=a(C);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var ee=C.read_shift(4),Z=C.read_shift(4),Q=C.read_shift(4),ce=C.read_shift(2),ye=C.read_shift(2),Ie="",pe=0;pe<ce;++pe)Ie+=String.fromCharCode(C[C.l++]);if(ye){var Ee=o(C.slice(C.l,C.l+ye));(Ee[21589]||{}).mt&&(te=Ee[21589].mt),((O||{})[21589]||{}).mt&&(te=O[21589].mt)}C.l+=ye;var Fe=C.slice(C.l,C.l+Z);switch(X){case 8:Fe=q(C,Q);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+X)}var nt=!1;M&8&&(ee=C.read_shift(4),ee==134695760&&(ee=C.read_shift(4),nt=!0),Z=C.read_shift(4),Q=C.read_shift(4)),Z!=L&&cs(nt,"Bad compressed size: "+L+" != "+Z),Q!=D&&cs(nt,"Bad uncompressed size: "+D+" != "+Q),J(b,Ie,Fe,{unsafe:!0,mt:te})}function js(C,L){var D=L||{},b=[],O=[],M=er(1),X=D.compression?8:0,te=0,ee=0,Z=0,Q=0,ce=0,ye=C.FullPaths[0],Ie=ye,pe=C.FileIndex[0],Ee=[],Fe=0;for(ee=1;ee<C.FullPaths.length;++ee)if(Ie=C.FullPaths[ee].slice(ye.length),pe=C.FileIndex[ee],!(!pe.size||!pe.content||Ie=="Sh33tJ5")){var nt=Q,Ke=er(Ie.length);for(Z=0;Z<Ie.length;++Z)Ke.write_shift(1,Ie.charCodeAt(Z)&127);Ke=Ke.slice(0,Ke.l),Ee[ce]=_6.buf(pe.content,0);var dt=pe.content;X==8&&(dt=Y(dt)),M=er(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,te),M.write_shift(2,X),pe.mt?i(M,pe.mt):M.write_shift(4,0),M.write_shift(-4,Ee[ce]),M.write_shift(4,dt.length),M.write_shift(4,pe.content.length),M.write_shift(2,Ke.length),M.write_shift(2,0),Q+=M.length,b.push(M),Q+=Ke.length,b.push(Ke),Q+=dt.length,b.push(dt),M=er(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,te),M.write_shift(2,X),M.write_shift(4,0),M.write_shift(-4,Ee[ce]),M.write_shift(4,dt.length),M.write_shift(4,pe.content.length),M.write_shift(2,Ke.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,nt),Fe+=M.l,O.push(M),Fe+=Ke.length,O.push(Ke),++ce}return M=er(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,ce),M.write_shift(2,ce),M.write_shift(4,Fe),M.write_shift(4,Q),M.write_shift(2,0),Fi([Fi(b),Fi(O),M])}var us={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Sn(C,L){if(C.ctype)return C.ctype;var D=C.name||"",b=D.match(/\.([^\.]+)$/);return b&&us[b[1]]||L&&(b=(D=L).match(/[\.\\]([^\.\\])+$/),b&&us[b[1]])?us[b[1]]:"application/octet-stream"}function fo(C){for(var L=Hy(C),D=[],b=0;b<L.length;b+=76)D.push(L.slice(b,b+76));return D.join(`\r
`)+`\r
`}function Vs(C){var L=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Z){var Q=Z.charCodeAt(0).toString(16).toUpperCase();return"="+(Q.length==1?"0"+Q:Q)});L=L.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),L.charAt(0)==`
`&&(L="=0D"+L.slice(1)),L=L.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],b=L.split(`\r
`),O=0;O<b.length;++O){var M=b[O];if(M.length==0){D.push("");continue}for(var X=0;X<M.length;){var te=76,ee=M.slice(X,X+te);ee.charAt(te-1)=="="?te--:ee.charAt(te-2)=="="?te-=2:ee.charAt(te-3)=="="&&(te-=3),ee=M.slice(X,X+te),X+=te,X<M.length&&(ee+="="),D.push(ee)}}return D.join(`\r
`)}function Us(C){for(var L=[],D=0;D<C.length;++D){for(var b=C[D];D<=C.length&&b.charAt(b.length-1)=="=";)b=b.slice(0,b.length-1)+C[++D];L.push(b)}for(var O=0;O<L.length;++O)L[O]=L[O].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return Qn(L.join(`\r
`))}function An(C,L,D){for(var b="",O="",M="",X,te=0;te<10;++te){var ee=L[te];if(!ee||ee.match(/^\s*$/))break;var Z=ee.match(/^(.*?):\s*([^\s].*)$/);if(Z)switch(Z[1].toLowerCase()){case"content-location":b=Z[2].trim();break;case"content-type":M=Z[2].trim();break;case"content-transfer-encoding":O=Z[2].trim();break}}switch(++te,O.toLowerCase()){case"base64":X=Qn(En(L.slice(te).join("")));break;case"quoted-printable":X=Us(L.slice(te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+O)}var Q=J(C,b.slice(D.length),X,{unsafe:!0});M&&(Q.ctype=M)}function ho(C,L){if(K(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=L&&L.root||"",b=(Qe&&Buffer.isBuffer(C)?C.toString("binary"):K(C)).split(`\r
`),O=0,M="";for(O=0;O<b.length;++O)if(M=b[O],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),D||(D=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),M.slice(0,D.length)!=D););var X=(b[1]||"").match(/boundary="(.*?)"/);if(!X)throw new Error("MAD cannot find boundary");var te="--"+(X[1]||""),ee=[],Z=[],Q={FileIndex:ee,FullPaths:Z};x(Q);var ce,ye=0;for(O=0;O<b.length;++O){var Ie=b[O];Ie!==te&&Ie!==te+"--"||(ye++&&An(Q,b.slice(ce,O),D),ce=O)}return Q}function Zt(C,L){var D=L||{},b=D.boundary||"SheetJS";b="------="+b;for(var O=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+b.slice(2)+'"',"","",""],M=C.FullPaths[0],X=M,te=C.FileIndex[0],ee=1;ee<C.FullPaths.length;++ee)if(X=C.FullPaths[ee].slice(M.length),te=C.FileIndex[ee],!(!te.size||!te.content||X=="Sh33tJ5")){X=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Fe){return"_x"+Fe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Fe){return"_u"+Fe.charCodeAt(0).toString(16)+"_"});for(var Z=te.content,Q=Qe&&Buffer.isBuffer(Z)?Z.toString("binary"):K(Z),ce=0,ye=Math.min(1024,Q.length),Ie=0,pe=0;pe<=ye;++pe)(Ie=Q.charCodeAt(pe))>=32&&Ie<128&&++ce;var Ee=ce>=ye*4/5;O.push(b),O.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+X),O.push("Content-Transfer-Encoding: "+(Ee?"quoted-printable":"base64")),O.push("Content-Type: "+Sn(te,X)),O.push(""),O.push(Ee?Vs(Q):fo(Q))}return O.push(b+`--\r
`),O.join(`\r
`)}function H(C){var L={};return x(L,C),L}function J(C,L,D,b){var O=b&&b.unsafe;O||x(C);var M=!O&&et.find(C,L);if(!M){var X=C.FullPaths[0];L.slice(0,X.length)==X?X=L:(X.slice(-1)!="/"&&(X+="/"),X=(X+L).replace("//","/")),M={name:s(L),type:2},C.FileIndex.push(M),C.FullPaths.push(X),O||et.utils.cfb_gc(C)}return M.content=D,M.size=D?D.length:0,b&&(b.CLSID&&(M.clsid=b.CLSID),b.mt&&(M.mt=b.mt),b.ct&&(M.ct=b.ct)),M}function ne(C,L){x(C);var D=et.find(C,L);if(D){for(var b=0;b<C.FileIndex.length;++b)if(C.FileIndex[b]==D)return C.FileIndex.splice(b,1),C.FullPaths.splice(b,1),!0}return!1}function de(C,L,D){x(C);var b=et.find(C,L);if(b){for(var O=0;O<C.FileIndex.length;++O)if(C.FileIndex[O]==b)return C.FileIndex[O].name=s(D),C.FullPaths[O]=D,!0}return!1}function Se(C){T(C,!0)}return e.find=P,e.read=V,e.parse=u,e.write=he,e.writeFile=oe,e.utils={cfb_new:H,cfb_add:J,cfb_del:ne,cfb_mov:de,cfb_gc:Se,ReadShift:Ec,CheckField:RA,prep_blob:xr,bconcat:Fi,use_zlib:U,_deflateRaw:je,_inflateRaw:Ls,consts:ge},e}();function y6(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Cs(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Yv(t){for(var e=[],r=Cs(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var ed=new Date(1899,11,30,0,0,0);function Qr(t,e){var r=t.getTime(),n=ed.getTime()+(t.getTimezoneOffset()-ed.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var lA=new Date,w6=ed.getTime()+(lA.getTimezoneOffset()-ed.getTimezoneOffset())*6e4,Zy=lA.getTimezoneOffset();function Jd(t){var e=new Date;return e.setTime(t*24*60*60*1e3+w6),e.getTimezoneOffset()!==Zy&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Zy)*6e4),e}function E6(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[i],10)}return e}var ew=new Date("2017-02-19T19:06:09.000Z"),cA=isNaN(ew.getFullYear())?new Date("2/19/17"):ew,T6=cA.getFullYear()==2017;function dr(t,e){var r=new Date(t);if(T6)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(cA.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Xa(t,e){if(Qe&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return oc(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return oc(XS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return oc(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return oc(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function Er(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Er(t[r]));return e}function Vt(t,e){for(var r="";r.length<e;)r+=t;return r}function ss(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var k6=["january","february","march","april","may","june","july","august","september","october","november","december"];function ml(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&k6.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var S6=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),a=[i[0]],o=1;o<i.length;++o)a.push(s),a.push(i[o]);return a}}();function uA(t){return t?t.content&&t.type?Xa(t.content,!0):t.data?sc(t.data):t.asNodeBuffer&&Qe?sc(t.asNodeBuffer().toString("binary")):t.asBinary?sc(t.asBinary()):t._data&&t._data.getContent?sc(Xa(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function fA(t){if(!t)return null;if(t.data)return zy(t.data);if(t.asNodeBuffer&&Qe)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?zy(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function A6(t){return t&&t.name.slice(-4)===".bin"?fA(t):uA(t)}function Nn(t,e){for(var r=t.FullPaths||Cs(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var a=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||s==a)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function Qv(t,e){var r=Nn(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function qt(t,e,r){if(!r)return A6(Qv(t,e));if(!e)return null;try{return qt(t,e)}catch{return null}}function vn(t,e,r){if(!r)return uA(Qv(t,e));if(!e)return null;try{return vn(t,e)}catch{return null}}function I6(t,e,r){return fA(Qv(t,e))}function tw(t){for(var e=t.FullPaths||Cs(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function C6(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Qe?n=so(r):n=KL(r),et.utils.cfb_add(t,e,n)}et.utils.cfb_add(t,e,r)}else t.file(e,r)}function hA(t,e){switch(e.type){case"base64":return et.read(t,{type:"base64"});case"binary":return et.read(t,{type:"binary"});case"buffer":case"array":return et.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function ac(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var dA=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,R6=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,rw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,N6=/<[^>]*>/g,$r=dA.match(rw)?rw:N6,P6=/<\w*:/,D6=/<(\/?)\w+:/;function Oe(t,e,r){for(var n={},s=0,i=0;s!==t.length&&!((i=t.charCodeAt(s))===32||i===10||i===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var a=t.match(R6),o=0,l="",c=0,u="",h="",d=1;if(a)for(c=0;c!=a.length;++c){for(h=a[c],i=0;i!=h.length&&h.charCodeAt(i)!==61;++i);for(u=h.slice(0,i).trim();h.charCodeAt(i+1)==32;)++i;for(d=(s=h.charCodeAt(i+1))==34||s==39?1:0,l=h.slice(i+1+d,h.length-d),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var m=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[m]&&u.slice(o-3,o)=="ext")continue;n[m]=l,n[m.toLowerCase()]=l}}return n}function Fs(t){return t.replace(D6,"<$1")}var pA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},F6=Yv(pA),it=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(t,function(o,l){return pA[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,a)+r(s.slice(a+3))}}(),b6=/[&<>'"]/g,O6=/[\u0000-\u001f]/g;function Jv(t){var e=t+"";return e.replace(b6,function(r){return F6[r]}).replace(/\n/g,"<br/>").replace(O6,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var nw=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Nt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Y0(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,e+=String.fromCharCode(a);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function sw(t){var e=sa(2*t.length),r,n,s=1,i=0,a=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[i++]=a&255,e[i++]=a>>>8,a=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function iw(t){return so(t,"binary").toString("utf8")}var If="foo bar baz",Et=Qe&&(iw(If)==Y0(If)&&iw||sw(If)==Y0(If)&&sw)||Y0,oc=Qe?function(t){return so(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},cu=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),mA=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),M6=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),L6=/<\/?(?:vt:)?variant>/g,j6=/<(?:vt:)([^>]*)>([\s\S]*)</;function aw(t,e){var r=Oe(t),n=t.match(M6(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var a=i.replace(L6,"").match(j6);a&&s.push({v:Et(a[2]),t:a[1]})}),s}var V6=/(^\s|\s$|\n)/;function U6(t){return Cs(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function B6(t,e,r){return"<"+t+(r!=null?U6(r):"")+(e!=null?(e.match(V6)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Zv(t){if(Qe&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Et(io(Kv(t)));throw new Error("Bad input format: expected Buffer or string")}var uu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,z6={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},$6=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function H6(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function W6(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,a=n?-e:e;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var o=0;o<=5;++o,i/=256)t[r+o]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var ow=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},lw=Qe?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:so(e)})):ow(t)}:ow,cw=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(Qs(t,s)));return n.join("").replace(Yr,"")},ex=Qe?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Yr,""):cw(t,e,r)}:cw,uw=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},gA=Qe?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):uw(t,e,r)}:uw,fw=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(To(t,s)));return n.join("")},Lu=Qe?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):fw(e,r,n)}:fw,vA=function(t,e){var r=gn(t,e);return r>0?Lu(t,e+4,e+4+r-1):""},xA=vA,_A=function(t,e){var r=gn(t,e);return r>0?Lu(t,e+4,e+4+r-1):""},yA=_A,wA=function(t,e){var r=2*gn(t,e);return r>0?Lu(t,e+4,e+4+r-1):""},EA=wA,TA=function(e,r){var n=gn(e,r);return n>0?ex(e,r+4,r+4+n):""},kA=TA,SA=function(t,e){var r=gn(t,e);return r>0?Lu(t,e+4,e+4+r):""},AA=SA,IA=function(t,e){return H6(t,e)},td=IA,CA=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Qe&&(xA=function(e,r){if(!Buffer.isBuffer(e))return vA(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},yA=function(e,r){if(!Buffer.isBuffer(e))return _A(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},EA=function(e,r){if(!Buffer.isBuffer(e))return wA(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},kA=function(e,r){if(!Buffer.isBuffer(e))return TA(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},AA=function(e,r){if(!Buffer.isBuffer(e))return SA(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},td=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):IA(e,r)},CA=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var To=function(t,e){return t[e]},Qs=function(t,e){return t[e+1]*256+t[e]},G6=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},gn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Ea=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},K6=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Ec(t,e){var r="",n,s,i=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Qe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(Qs(this,c)),c+=2;t*=2;break;case"utf8":r=Lu(this,this.l,this.l+t);break;case"utf16le":t*=2,r=ex(this,this.l,this.l+t);break;case"wstr":return Ec.call(this,t,"dbcs");case"lpstr-ansi":r=xA(this,this.l),t=4+gn(this,this.l);break;case"lpstr-cp":r=yA(this,this.l),t=4+gn(this,this.l);break;case"lpwstr":r=EA(this,this.l),t=4+2*gn(this,this.l);break;case"lpp4":t=4+gn(this,this.l),r=kA(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+gn(this,this.l),r=AA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=To(this,this.l+t++))!==0;)i.push(Af(a));r=i.join("");break;case"_wstr":for(t=0,r="";(a=Qs(this,this.l+t))!==0;)i.push(Af(a)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=To(this,c),this.l=c+1,o=Ec.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Af(Qs(this,c))),c+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=To(this,c),this.l=c+1,o=Ec.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Af(To(this,c))),c+=1}r=i.join("");break;default:switch(t){case 1:return n=To(this,this.l),this.l++,n;case 2:return n=(e==="i"?G6:Qs)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Ea:K6)(this,this.l),this.l+=4,n):(s=gn(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=td(this,this.l):s=td([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=gA(this,this.l,t);break}}return this.l+=t,r}var q6=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},X6=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},Y6=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function Q6(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)Y6(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var a=e.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,q6(this,e,this.l);break;case 8:if(n=8,r==="f"){W6(this,e,this.l);break}case 16:break;case-4:n=4,X6(this,e,this.l);break}return this.l+=n,this}function RA(t,e){var r=gA(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function xr(t,e){t.l=e,t.read_shift=Ec,t.chk=RA,t.write_shift=Q6}function zr(t,e){t.l+=e}function er(t){var e=sa(t);return xr(e,0),e}function xi(t,e,r){if(t){var n,s,i;xr(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=od[o]||od[65535];for(n=t.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=t.read_shift(1))&127)<<7*s;l=t.l+i;var u=c.f&&c.f(t,i,r);if(t.l=l,e(u,c,o))return}}}function Cm(){var t=[],e=Qe?256:2048,r=function(c){var u=er(c);return xr(u,0),u},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,e)))},a=function(){return s(),Fi(t)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:o,end:a,_bufs:t}}function Tc(t,e,r){var n=Er(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function hw(t,e,r){var n=Er(t);return n.s=Tc(n.s,e.s,r),n.e=Tc(n.e,e.s,r),n}function kc(t,e){if(t.cRel&&t.c<0)for(t=Er(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Er(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Ue(t);return!t.cRel&&t.cRel!=null&&(r=e8(r)),!t.rRel&&t.rRel!=null&&(r=J6(r)),r}function Q0(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+nr(t.s.c)+":"+(t.e.cRel?"":"$")+nr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Tr(t.s.r)+":"+(t.e.rRel?"":"$")+Tr(t.e.r):kc(t.s,e.biff)+":"+kc(t.e,e.biff)}function tx(t){return parseInt(Z6(t),10)-1}function Tr(t){return""+(t+1)}function J6(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Z6(t){return t.replace(/\$(\d+)$/,"$1")}function rx(t){for(var e=t8(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function nr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function e8(t){return t.replace(/^([A-Z])/,"$$$1")}function t8(t){return t.replace(/^\$([A-Z])/,"$1")}function r8(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Kr(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Ue(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Al(t){var e=t.indexOf(":");return e==-1?{s:Kr(t),e:Kr(t)}:{s:Kr(t.slice(0,e)),e:Kr(t.slice(e+1))}}function tt(t,e){return typeof e>"u"||typeof e=="number"?tt(t.s,t.e):(typeof t!="string"&&(t=Ue(t)),typeof e!="string"&&(e=Ue(e)),t==e?t:t+":"+e)}function Ut(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function dw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Vn(t.z,r?Qr(e):e)}catch{}try{return t.w=Vn((t.XF||{}).numFmtId||(r?14:0),r?Qr(e):e)}catch{return""+e}}function pi(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?lo[t.v]||t.v:e==null?dw(t,t.v):dw(t,e))}function da(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function NA(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Kr(n.origin):n.origin;a=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Ut(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var m={v:e[h][d]},v=a+h,g=o+d;if(c.s.r>v&&(c.s.r=v),c.s.c>g&&(c.s.c=g),c.e.r<v&&(c.e.r=v),c.e.c<g&&(c.e.c=g),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))m=e[h][d];else if(Array.isArray(m.v)&&(m.f=e[h][d][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||ze[14],n.cellDates?(m.t="d",m.w=Vn(m.z,Qr(m.v))):(m.t="n",m.v=Qr(m.v),m.w=Vn(m.z,m.v))):m.t="s";if(s)i[v]||(i[v]=[]),i[v][g]&&i[v][g].z&&(m.z=i[v][g].z),i[v][g]=m;else{var y=Ue({c:g,r:v});i[y]&&i[y].z&&(m.z=i[y].z),i[y]=m}}}return c.s.c<1e7&&(i["!ref"]=tt(c)),i}function Il(t,e){return NA(null,t,e)}function n8(t){return t.read_shift(4,"i")}function Vr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function s8(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function nx(t,e){var r=t.l,n=t.read_shift(1),s=Vr(t),i=[],a={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)i.push(s8(t));a.r=i}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}var i8=nx;function Un(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function ao(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var a8=Vr;function sx(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var o8=Vr,Rm=sx;function ix(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?td([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Ea(e,0)>>2;return r?s/100:s}function PA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var oo=PA;function Lr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function l8(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var c=Ma[s];c&&(e.rgb=hu(c));break;case 2:e.rgb=hu([a,o,l]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function c8(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function DA(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function u8(t){return DA(t,1)}function f8(t){return DA(t,2)}var ax=2,sn=3,Cf=11,pw=12,rd=19,Rf=64,h8=65,d8=71,p8=4108,m8=4126,ur=80,FA=81,g8=[ur,FA],v8={1:{n:"CodePage",t:ax},2:{n:"Category",t:ur},3:{n:"PresentationFormat",t:ur},4:{n:"ByteCount",t:sn},5:{n:"LineCount",t:sn},6:{n:"ParagraphCount",t:sn},7:{n:"SlideCount",t:sn},8:{n:"NoteCount",t:sn},9:{n:"HiddenCount",t:sn},10:{n:"MultimediaClipCount",t:sn},11:{n:"ScaleCrop",t:Cf},12:{n:"HeadingPairs",t:p8},13:{n:"TitlesOfParts",t:m8},14:{n:"Manager",t:ur},15:{n:"Company",t:ur},16:{n:"LinksUpToDate",t:Cf},17:{n:"CharacterCount",t:sn},19:{n:"SharedDoc",t:Cf},22:{n:"HyperlinksChanged",t:Cf},23:{n:"AppVersion",t:sn,p:"version"},24:{n:"DigSig",t:h8},26:{n:"ContentType",t:ur},27:{n:"ContentStatus",t:ur},28:{n:"Language",t:ur},29:{n:"Version",t:ur},255:{},2147483648:{n:"Locale",t:rd},2147483651:{n:"Behavior",t:rd},1919054434:{}},x8={1:{n:"CodePage",t:ax},2:{n:"Title",t:ur},3:{n:"Subject",t:ur},4:{n:"Author",t:ur},5:{n:"Keywords",t:ur},6:{n:"Comments",t:ur},7:{n:"Template",t:ur},8:{n:"LastAuthor",t:ur},9:{n:"RevNumber",t:ur},10:{n:"EditTime",t:Rf},11:{n:"LastPrinted",t:Rf},12:{n:"CreatedDate",t:Rf},13:{n:"ModifiedDate",t:Rf},14:{n:"PageCount",t:sn},15:{n:"WordCount",t:sn},16:{n:"CharCount",t:sn},17:{n:"Thumbnail",t:d8},18:{n:"Application",t:ur},19:{n:"DocSecurity",t:sn},255:{},2147483648:{n:"Locale",t:rd},2147483651:{n:"Behavior",t:rd},1919054434:{}},mw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},_8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function y8(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var w8=y8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ma=Er(w8),lo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},bA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},gw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function E8(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function T8(t){var e=E8();if(!t||!t.match)return e;var r={};if((t.match($r)||[]).forEach(function(n){var s=Oe(n);switch(s[0].replace(P6,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[gw[s.ContentType]]!==void 0&&e[gw[s.ContentType]].push(s.PartName);break}}),e.xmlns!==z6.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var Mo={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Nm(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Sc(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match($r)||[]).forEach(function(s){var i=Oe(s);if(i[0]==="<Relationship"){var a={};a.Type=i.Type,a.Target=i.Target,a.Id=i.Id,i.TargetMode&&(a.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:ac(i.Target,e);r[o]=a,n[i.Id]=a}}),r["!id"]=n,r}var k8="application/vnd.oasis.opendocument.spreadsheet";function S8(t,e){for(var r=Zv(t),n,s;n=uu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Oe(n[0],!1),s.path=="/"&&s.type!==k8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var Ac=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],A8=function(){for(var t=new Array(Ac.length),e=0;e<Ac.length;++e){var r=Ac[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function OA(t){var e={};t=Et(t);for(var r=0;r<Ac.length;++r){var n=Ac[r],s=t.match(A8[r]);s!=null&&s.length>0&&(e[n[1]]=it(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=dr(e[n[1]]))}return e}var I8=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function MA(t,e,r,n){var s=[];if(typeof t=="string")s=aw(t,n);else for(var i=0;i<t.length;++i)s=s.concat(t[i].map(function(u){return{v:u}}));var a=typeof e=="string"?aw(e,n).map(function(u){return u.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function C8(t,e,r){var n={};return e||(e={}),t=Et(t),I8.forEach(function(s){var i=(t.match(cu(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=it(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var a=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));a&&a.length>0&&(n[s[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&MA(n.HeadingPairs,n.TitlesOfParts,e,r),e}var R8=/<[^>]+>[^<]*/g;function N8(t,e){var r={},n="",s=t.match(R8);if(s)for(var i=0;i!=s.length;++i){var a=s[i],o=Oe(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=it(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=it(u);break;case"bool":r[n]=Nt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=dr(u);break;case"cy":case"error":r[n]=it(u);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}var P8={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},J0;function D8(t,e,r){J0||(J0=Yv(P8)),e=J0[e]||e,t[e]=r}function ox(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function LA(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function jA(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function VA(t,e,r){return e===31?jA(t):LA(t,e,r)}function Pm(t,e,r){return VA(t,e,r===!1?0:4)}function F8(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return VA(t,e,0)}function b8(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Yr,""),t.l-s&2&&(t.l+=2)}return r}function O8(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Yr,"");return r}function M8(t){var e=t.l,r=nd(t,FA);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=nd(t,sn);return[r,n]}function L8(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(M8(t));return r}function vw(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var i=t.read_shift(4),a=t.read_shift(4);n[i]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Yr,"").replace(ic,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function UA(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function j8(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function nd(t,e,r){var n=t.read_shift(2),s,i=r||{};if(t.l+=2,e!==pw&&n!==e&&g8.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===pw?n:e){case 2:return s=t.read_shift(2,"i"),i.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return LA(t,n,4).replace(Yr,"");case 31:return jA(t);case 64:return ox(t);case 65:return UA(t);case 71:return j8(t);case 80:return Pm(t,n,!i.raw).replace(Yr,"");case 81:return F8(t,n).replace(Yr,"");case 4108:return L8(t);case 4126:case 4127:return n==4127?b8(t):O8(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function xw(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0,o=0,l=-1,c={};for(a=0;a!=s;++a){var u=t.read_shift(4),h=t.read_shift(4);i[a]=[u,h+r]}i.sort(function(k,w){return k[1]-w[1]});var d={};for(a=0;a!=s;++a){if(t.l!==i[a][1]){var m=!0;if(a>0&&e)switch(e[i[a-1][0]].t){case 2:t.l+2===i[a][1]&&(t.l+=2,m=!1);break;case 80:t.l<=i[a][1]&&(t.l=i[a][1],m=!1);break;case 4108:t.l<=i[a][1]&&(t.l=i[a][1],m=!1);break}if((!e||a==0)&&t.l<=i[a][1]&&(m=!1,t.l=i[a][1]),m)throw new Error("Read Error: Expected address "+i[a][1]+" at "+t.l+" :"+a)}if(e){var v=e[i[a][0]];if(d[v.n]=nd(t,v.t,{raw:!0}),v.p==="version"&&(d[v.n]=String(d[v.n]>>16)+"."+("0000"+String(d[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(d[v.n]){case 0:d[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Zn(o=d[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[v.n])}}else if(i[a][0]===1){if(o=d.CodePage=nd(t,ax),Zn(o),l!==-1){var g=t.l;t.l=i[l][1],c=vw(t,o),t.l=g}}else if(i[a][0]===0){if(o===0){l=a,t.l=i[a+1][1];continue}c=vw(t,o)}else{var y=c[i[a][0]],S;switch(t[t.l]){case 65:t.l+=4,S=UA(t);break;case 30:t.l+=4,S=Pm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,S=Pm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,S=t.read_shift(4,"i");break;case 19:t.l+=4,S=t.read_shift(4);break;case 5:t.l+=4,S=t.read_shift(8,"f");break;case 11:t.l+=4,S=Bt(t,4);break;case 64:t.l+=4,S=dr(ox(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[y]=S}}return t.l=r+n,d}function _w(t,e,r){var n=t.content;if(!n)return{};xr(n,0);var s,i,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==et.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(a=n.read_shift(16),l=n.read_shift(4));var h=xw(n,e),d={SystemIdentifier:c};for(var m in h)d[m]=h[m];if(d.FMTID=i,s===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=xw(n,null)}catch{}for(m in v)d[m]=v[m];return d.FMTID=[i,a],d}function ki(t,e){return t.read_shift(e),null}function V8(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function Bt(t,e){return t.read_shift(e)===1}function Xt(t){return t.read_shift(2,"u")}function BA(t,e){return V8(t,e,Xt)}function U8(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function ju(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?t.read_shift(n,s):"";return a}function B8(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,i=1+(r&1),a=0,o,l={};s&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=i==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,c);return s&&(t.l+=4*a),n&&(t.l+=o),l.t=u,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Ya(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Vu(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Ya(t,n,r)}function co(t,e,r){if(r.biff>5)return Vu(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function z8(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function $8(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Yr,"");return n&&(t.l+=24),s}function H8(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(i>>1,"utf16le").replace(Yr,"");return r+a}function W8(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return $8(t);case"0303000000000000c000000000000046":return H8(t);default:throw new Error("Unsupported Moniker "+r)}}function Nf(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Yr,""):"";return r}function G8(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var i,a,o,l,c="",u,h;s&16&&(i=Nf(t,r-t.l)),s&128&&(a=Nf(t,r-t.l)),(s&257)===257&&(o=Nf(t,r-t.l)),(s&257)===1&&(l=W8(t,r-t.l)),s&8&&(c=Nf(t,r-t.l)),s&32&&(u=t.read_shift(16)),s&64&&(h=ox(t)),t.l=r;var d=a||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),s&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var m={Target:d};return u&&(m.guid=u),h&&(m.time=h),i&&(m.Tooltip=i),m}function zA(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function $A(t,e){var r=zA(t);return r[3]=0,r}function bs(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function K8(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function q8(t,e,r){return e===0?"":co(t,e,r)}function X8(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[s,i,a]}function HA(t){var e=t.read_shift(2),r=ix(t);return[e,r]}function Y8(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=ju(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,s}function Zd(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function WA(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var Q8=WA;function GA(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function J8(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function Z8(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Dr(t){t.l+=2,t.l+=t.read_shift(2)}var e5={0:Dr,4:Dr,5:Dr,6:Dr,7:Z8,8:Dr,9:Dr,10:Dr,11:Dr,12:Dr,13:J8,14:Dr,15:Dr,16:Dr,17:Dr,18:Dr,19:Dr,20:Dr,21:GA};function t5(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(e5[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Pf(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function r5(t,e){return e===0||t.read_shift(2),1200}function n5(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=co(t,0,r);return t.read_shift(e+n-t.l),s}function s5(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function i5(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var a=ju(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:s,dt:i,name:a}}function a5(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0;a!=s&&t.l<r;++a)i.push(B8(t));return i.Count=n,i.Unique=s,i}function o5(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function l5(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function c5(t){var e=K8(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function u5(t){return t.read_shift(2),t.read_shift(4)}function yw(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function f5(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:i,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function h5(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function d5(){}function p5(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=ju(t,0,r),n}function m5(t){var e=bs(t);return e.isst=t.read_shift(4),e}function g5(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=bs(t);r.biff==2&&t.l++;var i=Vu(t,n-t.l,r);return s.val=i,s}function v5(t,e,r){var n=t.read_shift(2),s=co(t,0,r);return[n,s]}var x5=co;function ww(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,i=t.read_shift(s),a=t.read_shift(s),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:i,c:o},e:{r:a,c:l}}}function _5(t){var e=t.read_shift(2),r=t.read_shift(2),n=HA(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function y5(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(HA(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:a,rkrec:i}}function w5(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:a,ixfe:i}}function E5(t,e,r,n){var s={},i=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return s.patternType=_8[o>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=a&15,s.dgRight=a>>4&15,s.dgTop=a>>8&15,s.dgBottom=a>>12&15,s.icvLeft=a>>16&127,s.icvRight=a>>23&127,s.grbitDiag=a>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function T5(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=E5(t,e,n.fStyle,r),n}function k5(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function Ew(t,e,r){var n=bs(t);(r.biff==2||e==9)&&++t.l;var s=U8(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function S5(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=bs(t),s=Lr(t);return n.val=s,n}var Tw=q8;function A5(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var a=Ya(t,i),o=[];n>t.l;)o.push(Vu(t));return[i,s,a,o]}function kw(t,e,r){var n=t.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=Y8(t,e-2,r)),i.body=s||t.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var I5=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Sw(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=Ya(t,a,r);s&32&&(c=I5[c.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var h=n==t.l||o===0||!(u>0)?[]:lU(t,u,r,o);return{chKey:i,Name:c,itab:l,rgce:h}}function KA(t,e,r){if(r.biff<8)return C5(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(X8(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function C5(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=ju(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function R5(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),i=Ya(t,n,r),a=Ya(t,s,r);return[i,a]}function N5(t,e,r){var n=WA(t);t.l++;var s=t.read_shift(1);return e-=8,[cU(t,e,r),s,n]}function Aw(t,e,r){var n=Q8(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,aU(t,e,r)]}function P5(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function D5(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=co(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,a,i]}}function F5(t,e,r){return D5(t,e,r)}function b5(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Zd(t));return r}function O5(t,e,r){if(r&&r.biff<8)return L5(t,e,r);var n=GA(t),s=t5(t,e-22,n[1]);return{cmo:n,ft:s}}var M5={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function L5(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((M5[n]||zr)(t,e,r)),{cmo:[s,n,i],ft:a}}function j5(t,e,r){var n=t.l,s="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:a=z8(t,6,r);var o=t.read_shift(2);t.read_shift(2),Xt(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],h=Ya(t,t.lens[c+1]-t.lens[c]-1);if(s+=h,s.length>=(u?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function V5(t,e){var r=Zd(t);t.l+=16;var n=G8(t,e-24);return[r,n]}function U5(t,e){t.read_shift(2);var r=Zd(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Yr,""),[r,n]}function B5(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=mw[r]||r,r=t.read_shift(2),e[1]=mw[r]||r,e}function z5(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push($A(t));return r}function $5(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push($A(t));return r}function H5(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function qA(t,e,r){if(!r.cellStyles)return zr(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s,e:i,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function W5(t,e){var r={};return e<32||(t.l+=16,r.header=Lr(t),r.footer=Lr(t),t.l+=2),r}function G5(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}var K5=bs,q5=BA,X5=Vu;function Y5(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function Q5(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=bs(t);++t.l;var s=co(t,e-7,r);return n.t="str",n.val=s,n}function J5(t){var e=bs(t);++t.l;var r=Lr(t);return e.t="n",e.val=r,e}function Z5(t){var e=bs(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function e9(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function t9(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function r9(t,e,r){var n=t.l+e,s=bs(t),i=t.read_shift(2),a=Ya(t,i,r);return t.l=n,s.t="str",s.val=a,s}var n9=[2,3,48,49,131,139,140,245],Iw=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Yv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=sa(1);switch(l.type){case"base64":u=Qn(En(o));break;case"binary":u=Qn(o);break;case"buffer":case"array":u=o;break}xr(u,0);var h=u.read_shift(1),d=!!(h&136),m=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,d=!0;break;case 49:m=!0,d=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,y=521;h==2&&(g=u.read_shift(2)),u.l+=3,h!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(y=u.read_shift(2));var S=u.read_shift(2),k=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(k=t[u[u.l]]),u.l+=1,u.l+=2),v&&(u.l+=36);for(var w=[],F={},B=Math.min(u.length,h==2?521:y-10-(m?264:0)),V=v?32:11;u.l<B&&u[u.l]!=13;)switch(F={},F.name=ou.utils.decode(k,u.slice(u.l,u.l+V)).replace(/[\u0000\r\n].*$/g,""),u.l+=V,F.type=String.fromCharCode(u.read_shift(1)),h!=2&&!v&&(F.offset=u.read_shift(4)),F.len=u.read_shift(1),h==2&&(F.offset=u.read_shift(2)),F.dec=u.read_shift(1),F.name.length&&w.push(F),h!=2&&(u.l+=v?13:14),F.type){case"B":(!m||F.len!=8)&&l.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(u[u.l]!==13&&(u.l=y-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=y;var x=0,E=0;for(c[0]=[],E=0;E!=w.length;++E)c[0][E]=w[E].name;for(;g-- >0;){if(u[u.l]===42){u.l+=S;continue}for(++u.l,c[++x]=[],E=0,E=0;E!=w.length;++E){var T=u.slice(u.l,u.l+w[E].len);u.l+=w[E].len,xr(T,0);var I=ou.utils.decode(k,T);switch(w[E].type){case"C":I.trim().length&&(c[x][E]=I.replace(/\s+$/,""));break;case"D":I.length===8?c[x][E]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):c[x][E]=I;break;case"F":c[x][E]=parseFloat(I.trim());break;case"+":case"I":c[x][E]=v?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":c[x][E]=!0;break;case"N":case"F":c[x][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[x][E]="##MEMO##"+(v?parseInt(I.trim(),10):T.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(c[x][E]=+I||0);break;case"@":c[x][E]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":c[x][E]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":c[x][E]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[x][E]=-T.read_shift(-8,"f");break;case"B":if(m&&w[E].len==8){c[x][E]=T.read_shift(8,"f");break}case"G":case"P":T.l+=w[E].len;break;case"0":if(w[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[E].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=w,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Il(r(o,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function s(o,l){try{return da(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&Zn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Cm(),h=jm(o,{header:1,raw:!0,cellDates:!0}),d=h[0],m=h.slice(1),v=o["!cols"]||[],g=0,y=0,S=0,k=1;for(g=0;g<d.length;++g){if(((v[g]||{}).DBF||{}).name){d[g]=v[g].DBF.name,++S;continue}if(d[g]!=null){if(++S,typeof d[g]=="number"&&(d[g]=d[g].toString(10)),typeof d[g]!="string")throw new Error("DBF Invalid column name "+d[g]+" |"+typeof d[g]+"|");if(d.indexOf(d[g])!==g){for(y=0;y<1024;++y)if(d.indexOf(d[g]+"_"+y)==-1){d[g]+="_"+y;break}}}}var w=Ut(o["!ref"]),F=[],B=[],V=[];for(g=0;g<=w.e.c-w.s.c;++g){var x="",E="",T=0,I=[];for(y=0;y<m.length;++y)m[y][g]!=null&&I.push(m[y][g]);if(I.length==0||d[g]==null){F[g]="?";continue}for(y=0;y<I.length;++y){switch(typeof I[y]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=I[y]instanceof Date?"D":"C";break;default:E="C"}T=Math.max(T,String(I[y]).length),x=x&&x!=E?"C":E}T>250&&(T=250),E=((v[g]||{}).DBF||{}).type,E=="C"&&v[g].DBF.len>T&&(T=v[g].DBF.len),x=="B"&&E=="N"&&(x="N",V[g]=v[g].DBF.dec,T=v[g].DBF.len),B[g]=x=="C"||E=="N"?T:i[x]||0,k+=B[g],F[g]=x}var P=u.next(32);for(P.write_shift(4,318902576),P.write_shift(4,m.length),P.write_shift(2,296+32*S),P.write_shift(2,k),g=0;g<4;++g)P.write_shift(4,0);for(P.write_shift(4,0|(+e[KS]||3)<<8),g=0,y=0;g<d.length;++g)if(d[g]!=null){var N=u.next(32),R=(d[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);N.write_shift(1,R,"sbcs"),N.write_shift(1,F[g]=="?"?"C":F[g],"sbcs"),N.write_shift(4,y),N.write_shift(1,B[g]||i[F[g]]||0),N.write_shift(1,V[g]||0),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(1,0),N.write_shift(4,0),N.write_shift(4,0),y+=B[g]||i[F[g]]||0}var se=u.next(264);for(se.write_shift(4,13),g=0;g<65;++g)se.write_shift(4,0);for(g=0;g<m.length;++g){var ae=u.next(k);for(ae.write_shift(1,0),y=0;y<d.length;++y)if(d[y]!=null)switch(F[y]){case"L":ae.write_shift(1,m[g][y]==null?63:m[g][y]?84:70);break;case"B":ae.write_shift(8,m[g][y]||0,"f");break;case"N":var fe="0";for(typeof m[g][y]=="number"&&(fe=m[g][y].toFixed(V[y]||0)),S=0;S<B[y]-fe.length;++S)ae.write_shift(1,32);ae.write_shift(1,fe,"sbcs");break;case"D":m[g][y]?(ae.write_shift(4,("0000"+m[g][y].getFullYear()).slice(-4),"sbcs"),ae.write_shift(2,("00"+(m[g][y].getMonth()+1)).slice(-2),"sbcs"),ae.write_shift(2,("00"+m[g][y].getDate()).slice(-2),"sbcs")):ae.write_shift(8,"00000000","sbcs");break;case"C":var ge=String(m[g][y]!=null?m[g][y]:"").slice(0,B[y]);for(ae.write_shift(1,ge,"sbcs"),S=0;S<B[y]-ge.length;++S)ae.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),s9=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Cs(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,m){var v=t[m];return typeof v=="number"?$y(v):v},n=function(d,m,v){var g=m.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return g==59?d:$y(g)};t["|"]=254;function s(d,m){switch(m.type){case"base64":return i(En(d),m);case"binary":return i(d,m);case"buffer":return i(Qe&&Buffer.isBuffer(d)?d.toString("binary"):io(d),m);case"array":return i(Xa(d),m)}throw new Error("Unrecognized type "+m.type)}function i(d,m){var v=d.split(/[\n\r]+/),g=-1,y=-1,S=0,k=0,w=[],F=[],B=null,V={},x=[],E=[],T=[],I=0,P;for(+m.codepage>=0&&Zn(+m.codepage);S!==v.length;++S){I=0;var N=v[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),R=N.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),se=R[0],ae;if(N.length>0)switch(se){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&F.push(N.slice(3).replace(/;;/g,";"));break;case"C":var fe=!1,ge=!1,oe=!1,K=!1,he=-1,we=-1;for(k=1;k<R.length;++k)switch(R[k].charAt(0)){case"A":break;case"X":y=parseInt(R[k].slice(1))-1,ge=!0;break;case"Y":for(g=parseInt(R[k].slice(1))-1,ge||(y=0),P=w.length;P<=g;++P)w[P]=[];break;case"K":ae=R[k].slice(1),ae.charAt(0)==='"'?ae=ae.slice(1,ae.length-1):ae==="TRUE"?ae=!0:ae==="FALSE"?ae=!1:isNaN(ss(ae))?isNaN(ml(ae).getDate())||(ae=dr(ae)):(ae=ss(ae),B!==null&&Sl(B)&&(ae=Jd(ae))),fe=!0;break;case"E":K=!0;var U=Xo(R[k].slice(1),{r:g,c:y});w[g][y]=[w[g][y],U];break;case"S":oe=!0,w[g][y]=[w[g][y],"S5S"];break;case"G":break;case"R":he=parseInt(R[k].slice(1))-1;break;case"C":we=parseInt(R[k].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+N)}if(fe&&(w[g][y]&&w[g][y].length==2?w[g][y][0]=ae:w[g][y]=ae,B=null),oe){if(K)throw new Error("SYLK shared formula cannot have own formula");var q=he>-1&&w[he][we];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");w[g][y][1]=sI(q[1],{r:g-he,c:y-we})}break;case"F":var Y=0;for(k=1;k<R.length;++k)switch(R[k].charAt(0)){case"X":y=parseInt(R[k].slice(1))-1,++Y;break;case"Y":for(g=parseInt(R[k].slice(1))-1,P=w.length;P<=g;++P)w[P]=[];break;case"M":I=parseInt(R[k].slice(1))/20;break;case"F":break;case"G":break;case"P":B=F[parseInt(R[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=R[k].slice(1).split(" "),P=parseInt(T[0],10);P<=parseInt(T[1],10);++P)I=parseInt(T[2],10),E[P-1]=I===0?{hidden:!0}:{wch:I},gl(E[P-1]);break;case"C":y=parseInt(R[k].slice(1))-1,E[y]||(E[y]={});break;case"R":g=parseInt(R[k].slice(1))-1,x[g]||(x[g]={}),I>0?(x[g].hpt=I,x[g].hpx=du(I)):I===0&&(x[g].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+N)}Y<1&&(B=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+N)}}return x.length>0&&(V["!rows"]=x),E.length>0&&(V["!cols"]=E),m&&m.sheetRows&&(w=w.slice(0,m.sheetRows)),[w,V]}function a(d,m){var v=s(d,m),g=v[0],y=v[1],S=Il(g,m);return Cs(y).forEach(function(k){S[k]=y[k]}),S}function o(d,m){return da(a(d,m),m)}function l(d,m,v,g){var y="C;Y"+(v+1)+";X"+(g+1)+";K";switch(d.t){case"n":y+=d.v||0,d.f&&!d.F&&(y+=";E"+Hj(d.f,{r:v,c:g}));break;case"b":y+=d.v?"TRUE":"FALSE";break;case"e":y+=d.w||d.v;break;case"d":y+='"'+(d.w||d.v)+'"';break;case"s":y+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function c(d,m){m.forEach(function(v,g){var y="F;W"+(g+1)+" "+(g+1)+" ";v.hidden?y+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=id(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=ad(v.wpx)),typeof v.wch=="number"&&(y+=Math.round(v.wch))),y.charAt(y.length-1)!=" "&&d.push(y)})}function u(d,m){m.forEach(function(v,g){var y="F;";v.hidden?y+="M0;":v.hpt?y+="M"+20*v.hpt+";":v.hpx&&(y+="M"+20*tI(v.hpx)+";"),y.length>2&&d.push(y+"R"+(g+1))})}function h(d,m){var v=["ID;PWXL;N;E"],g=[],y=Ut(d["!ref"]),S,k=Array.isArray(d),w=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),d["!cols"]&&c(v,d["!cols"]),d["!rows"]&&u(v,d["!rows"]),v.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var F=y.s.r;F<=y.e.r;++F)for(var B=y.s.c;B<=y.e.c;++B){var V=Ue({r:F,c:B});S=k?(d[F]||[])[B]:d[V],!(!S||S.v==null&&(!S.f||S.F))&&g.push(l(S,d,F,B))}return v.join(w)+w+g.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),i9=function(){function t(i,a){switch(a.type){case"base64":return e(En(i),a);case"binary":return e(i,a);case"buffer":return e(Qe&&Buffer.isBuffer(i)?i.toString("binary"):io(i),a);case"array":return e(Xa(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){for(var o=i.split(`
`),l=-1,c=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=o[u].trim().split(","),m=d[0],v=d[1];++u;for(var g=o[u]||"";(g.match(/["]/g)||[]).length&1&&u<o.length-1;)g+=`
`+o[++u];switch(g=g.trim(),+m){case-1:if(g==="BOT"){h[++l]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[l][c]=!0:g==="FALSE"?h[l][c]=!1:isNaN(ss(v))?isNaN(ml(v).getDate())?h[l][c]=v:h[l][c]=dr(v):h[l][c]=ss(v),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[l][c++]=g!==""?g:null;break}if(g==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(i,a){return Il(t(i,a),a)}function n(i,a){return da(r(i,a),a)}var s=function(){var i=function(l,c,u,h,d){l.push(c),l.push(u+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},a=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=Ut(l["!ref"]),h,d=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){a(c,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var g=Ue({r:m,c:v});if(h=d?(l[m]||[])[v]:l[g],!h){a(c,1,0,"");continue}switch(h.t){case"n":var y=h.w;!y&&h.v!=null&&(y=h.v),y==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,y,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Vn(h.z||ze[14],Qr(dr(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var S=`\r
`,k=c.join(S);return k}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),a9=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var m=h.split(`
`),v=-1,g=-1,y=0,S=[];y!==m.length;++y){var k=m[y].trim().split(":");if(k[0]==="cell"){var w=Kr(k[1]);if(S.length<=w.r)for(v=S.length;v<=w.r;++v)S[v]||(S[v]=[]);switch(v=w.r,g=w.c,k[2]){case"t":S[v][g]=t(k[3]);break;case"v":S[v][g]=+k[3];break;case"vtf":var F=k[k.length-1];case"vtc":switch(k[3]){case"nl":S[v][g]=!!+k[4];break;default:S[v][g]=+k[4];break}k[2]=="vtf"&&(S[v][g]=[S[v][g],F])}}}return d&&d.sheetRows&&(S=S.slice(0,d.sheetRows)),S}function n(h,d){return Il(r(h,d),d)}function s(h,d){return da(n(h,d),d)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],m=[],v,g="",y=Al(h["!ref"]),S=Array.isArray(h),k=y.s.r;k<=y.e.r;++k)for(var w=y.s.c;w<=y.e.c;++w)if(g=Ue({r:k,c:w}),v=S?(h[k]||[])[w]:h[g],!(!v||v.v==null||v.t==="z")){switch(m=["cell",g,"t"],v.t){case"s":case"str":m.push(e(v.v));break;case"n":v.f?(m[2]="vtf",m[3]="n",m[4]=v.v,m[5]=e(v.f)):(m[2]="v",m[3]=v.v);break;case"b":m[2]="vt"+(v.f?"f":"c"),m[3]="nl",m[4]=v.v?"1":"0",m[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var F=Qr(dr(v.v));m[2]="vtc",m[3]="nd",m[4]=""+F,m[5]=v.w||Vn(v.z||ze[14],F);break;case"e":continue}d.push(m.join(":"))}return d.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(h){return[i,a,o,a,c(h),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),fu=function(){function t(u,h,d,m,v){v.raw?h[d][m]=u:u===""||(u==="TRUE"?h[d][m]=!0:u==="FALSE"?h[d][m]=!1:isNaN(ss(u))?isNaN(ml(u).getDate())?h[d][m]=u:h[d][m]=dr(u):h[d][m]=ss(u))}function e(u,h){var d=h||{},m=[];if(!u||u.length===0)return m;for(var v=u.split(/[\r\n]/),g=v.length-1;g>=0&&v[g].length===0;)--g;for(var y=10,S=0,k=0;k<=g;++k)S=v[k].indexOf(" "),S==-1?S=v[k].length:S++,y=Math.max(y,S);for(k=0;k<=g;++k){m[k]=[];var w=0;for(t(v[k].slice(0,y).trim(),m,k,w,d),w=1;w<=(v[k].length-y)/10+1;++w)t(v[k].slice(y+(w-1)*10,y+w*10).trim(),m,k,w,d)}return d.sheetRows&&(m=m.slice(0,d.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var h={},d=!1,m=0,v=0;m<u.length;++m)(v=u.charCodeAt(m))==34?d=!d:!d&&v in r&&(h[v]=(h[v]||0)+1);v=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&v.push([h[m],m]);if(!v.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&v.push([h[m],m])}return v.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[v.pop()[1]]||44}function i(u,h){var d=h||{},m="",v=d.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=s(u.slice(0,1024)):d&&d.FS?m=d.FS:m=s(u.slice(0,1024));var y=0,S=0,k=0,w=0,F=0,B=m.charCodeAt(0),V=!1,x=0,E=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var T=d.dateNF!=null?v6(d.dateNF):null;function I(){var P=u.slice(w,F),N={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)N.t="z";else if(d.raw)N.t="s",N.v=P;else if(P.trim().length===0)N.t="s",N.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(N.t="s",N.v=P.slice(2,-1).replace(/""/g,'"')):Gj(P)?(N.t="n",N.f=P.slice(1)):(N.t="s",N.v=P);else if(P=="TRUE")N.t="b",N.v=!0;else if(P=="FALSE")N.t="b",N.v=!1;else if(!isNaN(k=ss(P)))N.t="n",d.cellText!==!1&&(N.w=P),N.v=k;else if(!isNaN(ml(P).getDate())||T&&P.match(T)){N.z=d.dateNF||ze[14];var R=0;T&&P.match(T)&&(P=x6(P,d.dateNF,P.match(T)||[]),R=1),d.cellDates?(N.t="d",N.v=dr(P,R)):(N.t="n",N.v=Qr(dr(P,R))),d.cellText!==!1&&(N.w=Vn(N.z,N.v instanceof Date?Qr(N.v):N.v)),d.cellNF||delete N.z}else N.t="s",N.v=P;if(N.t=="z"||(d.dense?(v[y]||(v[y]=[]),v[y][S]=N):v[Ue({c:S,r:y})]=N),w=F+1,E=u.charCodeAt(w),g.e.c<S&&(g.e.c=S),g.e.r<y&&(g.e.r=y),x==B)++S;else if(S=0,++y,d.sheetRows&&d.sheetRows<=y)return!0}e:for(;F<u.length;++F)switch(x=u.charCodeAt(F)){case 34:E===34&&(V=!V);break;case B:case 10:case 13:if(!V&&I())break e;break}return F-w>0&&I(),v["!ref"]=tt(g),v}function a(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,h):Il(e(u,h),h)}function o(u,h){var d="",m=h.type=="string"?[0,0,0,0]:mx(u,h);switch(h.type){case"base64":d=En(u);break;case"binary":d=u;break;case"buffer":h.codepage==65001?d=u.toString("utf8"):h.codepage&&typeof ou<"u"||(d=Qe&&Buffer.isBuffer(u)?u.toString("binary"):io(u));break;case"array":d=Xa(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?d=Et(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=Et(d):h.type=="binary"&&typeof ou<"u",d.slice(0,19)=="socialcalc:version:"?a9.to_sheet(h.type=="string"?d:Et(d),h):a(d,h)}function l(u,h){return da(o(u,h),h)}function c(u){for(var h=[],d=Ut(u["!ref"]),m,v=Array.isArray(u),g=d.s.r;g<=d.e.r;++g){for(var y=[],S=d.s.c;S<=d.e.c;++S){var k=Ue({r:g,c:S});if(m=v?(u[g]||[])[S]:u[k],!m||m.v==null){y.push("          ");continue}for(var w=(m.w||(pi(m),m.w)||"").slice(0,10);w.length<10;)w+=" ";y.push(w+(S===0?" ":""))}h.push(y.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function o9(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=s9.to_workbook(t,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return fu.to_workbook(t,e)}}var Ic=function(){function t(U,q,Y){if(U){xr(U,U.l||0);for(var G=Y.Enum||he;U.l<U.length;){var le=U.read_shift(2),xe=G[le]||G[65535],Re=U.read_shift(2),Te=U.l+Re,ve=xe.f&&xe.f(U,Re,Y);if(U.l=Te,q(ve,xe,le))return}}}function e(U,q){switch(q.type){case"base64":return r(Qn(En(U)),q);case"binary":return r(Qn(U),q);case"buffer":case"array":return r(U,q)}throw"Unsupported type "+q.type}function r(U,q){if(!U)return U;var Y=q||{},G=Y.dense?[]:{},le="Sheet1",xe="",Re=0,Te={},ve=[],$e=[],z={s:{r:0,c:0},e:{r:0,c:0}},at=Y.sheetRows||0;if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)Y.Enum=he,t(U,function(Ae,Tt,or){switch(or){case 0:Y.vers=Ae,Ae>=4096&&(Y.qpro=!0);break;case 6:z=Ae;break;case 204:Ae&&(xe=Ae);break;case 222:xe=Ae;break;case 15:case 51:Y.qpro||(Ae[1].v=Ae[1].v.slice(1));case 13:case 14:case 16:or==14&&(Ae[2]&112)==112&&(Ae[2]&15)>1&&(Ae[2]&15)<15&&(Ae[1].z=Y.dateNF||ze[14],Y.cellDates&&(Ae[1].t="d",Ae[1].v=Jd(Ae[1].v))),Y.qpro&&Ae[3]>Re&&(G["!ref"]=tt(z),Te[le]=G,ve.push(le),G=Y.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},Re=Ae[3],le=xe||"Sheet"+(Re+1),xe="");var Ar=Y.dense?(G[Ae[0].r]||[])[Ae[0].c]:G[Ue(Ae[0])];if(Ar){Ar.t=Ae[1].t,Ar.v=Ae[1].v,Ae[1].z!=null&&(Ar.z=Ae[1].z),Ae[1].f!=null&&(Ar.f=Ae[1].f);break}Y.dense?(G[Ae[0].r]||(G[Ae[0].r]=[]),G[Ae[0].r][Ae[0].c]=Ae[1]):G[Ue(Ae[0])]=Ae[1];break}},Y);else if(U[2]==26||U[2]==14)Y.Enum=we,U[2]==14&&(Y.qpro=!0,U.l=0),t(U,function(Ae,Tt,or){switch(or){case 204:le=Ae;break;case 22:Ae[1].v=Ae[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ae[3]>Re&&(G["!ref"]=tt(z),Te[le]=G,ve.push(le),G=Y.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},Re=Ae[3],le="Sheet"+(Re+1)),at>0&&Ae[0].r>=at)break;Y.dense?(G[Ae[0].r]||(G[Ae[0].r]=[]),G[Ae[0].r][Ae[0].c]=Ae[1]):G[Ue(Ae[0])]=Ae[1],z.e.c<Ae[0].c&&(z.e.c=Ae[0].c),z.e.r<Ae[0].r&&(z.e.r=Ae[0].r);break;case 27:Ae[14e3]&&($e[Ae[14e3][0]]=Ae[14e3][1]);break;case 1537:$e[Ae[0]]=Ae[1],Ae[0]==Re&&(le=Ae[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(G["!ref"]=tt(z),Te[xe||le]=G,ve.push(xe||le),!$e.length)return{SheetNames:ve,Sheets:Te};for(var We={},rt=[],be=0;be<$e.length;++be)Te[ve[be]]?(rt.push($e[be]||ve[be]),We[$e[be]]=Te[$e[be]]||Te[ve[be]]):(rt.push($e[be]),We[$e[be]]={"!ref":"A1"});return{SheetNames:rt,Sheets:We}}function n(U,q){var Y=q||{};if(+Y.codepage>=0&&Zn(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var G=Cm(),le=Ut(U["!ref"]),xe=Array.isArray(U),Re=[];Wn(G,0,i(1030)),Wn(G,6,l(le));for(var Te=Math.min(le.e.r,8191),ve=le.s.r;ve<=Te;++ve)for(var $e=Tr(ve),z=le.s.c;z<=le.e.c;++z){ve===le.s.r&&(Re[z]=nr(z));var at=Re[z]+$e,We=xe?(U[ve]||[])[z]:U[at];if(!(!We||We.t=="z"))if(We.t=="n")(We.v|0)==We.v&&We.v>=-32768&&We.v<=32767?Wn(G,13,m(ve,z,We.v)):Wn(G,14,g(ve,z,We.v));else{var rt=pi(We);Wn(G,15,h(ve,z,rt.slice(0,239)))}}return Wn(G,1),G.end()}function s(U,q){var Y=q||{};if(+Y.codepage>=0&&Zn(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var G=Cm();Wn(G,0,a(U));for(var le=0,xe=0;le<U.SheetNames.length;++le)(U.Sheets[U.SheetNames[le]]||{})["!ref"]&&Wn(G,27,K(U.SheetNames[le],xe++));var Re=0;for(le=0;le<U.SheetNames.length;++le){var Te=U.Sheets[U.SheetNames[le]];if(!(!Te||!Te["!ref"])){for(var ve=Ut(Te["!ref"]),$e=Array.isArray(Te),z=[],at=Math.min(ve.e.r,8191),We=ve.s.r;We<=at;++We)for(var rt=Tr(We),be=ve.s.c;be<=ve.e.c;++be){We===ve.s.r&&(z[be]=nr(be));var Ae=z[be]+rt,Tt=$e?(Te[We]||[])[be]:Te[Ae];if(!(!Tt||Tt.t=="z"))if(Tt.t=="n")Wn(G,23,I(We,be,Re,Tt.v));else{var or=pi(Tt);Wn(G,22,x(We,be,Re,or.slice(0,239)))}}++Re}}return Wn(G,1),G.end()}function i(U){var q=er(2);return q.write_shift(2,U),q}function a(U){var q=er(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var Y=0,G=0,le=0,xe=0;xe<U.SheetNames.length;++xe){var Re=U.SheetNames[xe],Te=U.Sheets[Re];if(!(!Te||!Te["!ref"])){++le;var ve=Al(Te["!ref"]);Y<ve.e.r&&(Y=ve.e.r),G<ve.e.c&&(G=ve.e.c)}}return Y>8191&&(Y=8191),q.write_shift(2,Y),q.write_shift(1,le),q.write_shift(1,G),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function o(U,q,Y){var G={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&Y.qpro?(G.s.c=U.read_shift(1),U.l++,G.s.r=U.read_shift(2),G.e.c=U.read_shift(1),U.l++,G.e.r=U.read_shift(2),G):(G.s.c=U.read_shift(2),G.s.r=U.read_shift(2),q==12&&Y.qpro&&(U.l+=2),G.e.c=U.read_shift(2),G.e.r=U.read_shift(2),q==12&&Y.qpro&&(U.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function l(U){var q=er(8);return q.write_shift(2,U.s.c),q.write_shift(2,U.s.r),q.write_shift(2,U.e.c),q.write_shift(2,U.e.r),q}function c(U,q,Y){var G=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(G[0].c=U.read_shift(1),G[3]=U.read_shift(1),G[0].r=U.read_shift(2),U.l+=2):(G[2]=U.read_shift(1),G[0].c=U.read_shift(2),G[0].r=U.read_shift(2)),G}function u(U,q,Y){var G=U.l+q,le=c(U,q,Y);if(le[1].t="s",Y.vers==20768){U.l++;var xe=U.read_shift(1);return le[1].v=U.read_shift(xe,"utf8"),le}return Y.qpro&&U.l++,le[1].v=U.read_shift(G-U.l,"cstr"),le}function h(U,q,Y){var G=er(7+Y.length);G.write_shift(1,255),G.write_shift(2,q),G.write_shift(2,U),G.write_shift(1,39);for(var le=0;le<G.length;++le){var xe=Y.charCodeAt(le);G.write_shift(1,xe>=128?95:xe)}return G.write_shift(1,0),G}function d(U,q,Y){var G=c(U,q,Y);return G[1].v=U.read_shift(2,"i"),G}function m(U,q,Y){var G=er(7);return G.write_shift(1,255),G.write_shift(2,q),G.write_shift(2,U),G.write_shift(2,Y,"i"),G}function v(U,q,Y){var G=c(U,q,Y);return G[1].v=U.read_shift(8,"f"),G}function g(U,q,Y){var G=er(13);return G.write_shift(1,255),G.write_shift(2,q),G.write_shift(2,U),G.write_shift(8,Y,"f"),G}function y(U,q,Y){var G=U.l+q,le=c(U,q,Y);if(le[1].v=U.read_shift(8,"f"),Y.qpro)U.l=G;else{var xe=U.read_shift(2);F(U.slice(U.l,U.l+xe),le),U.l+=xe}return le}function S(U,q,Y){var G=q&32768;return q&=-32769,q=(G?U:0)+(q>=8192?q-16384:q),(G?"":"$")+(Y?nr(q):Tr(q))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(U,q){xr(U,0);for(var Y=[],G=0,le="",xe="",Re="",Te="";U.l<U.length;){var ve=U[U.l++];switch(ve){case 0:Y.push(U.read_shift(8,"f"));break;case 1:xe=S(q[0].c,U.read_shift(2),!0),le=S(q[0].r,U.read_shift(2),!1),Y.push(xe+le);break;case 2:{var $e=S(q[0].c,U.read_shift(2),!0),z=S(q[0].r,U.read_shift(2),!1);xe=S(q[0].c,U.read_shift(2),!0),le=S(q[0].r,U.read_shift(2),!1),Y.push($e+z+":"+xe+le)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(U.read_shift(2));break;case 6:{for(var at="";ve=U[U.l++];)at+=String.fromCharCode(ve);Y.push('"'+at.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:Te=Y.pop(),Re=Y.pop(),Y.push(["AND","OR"][ve-20]+"("+Re+","+Te+")");break;default:if(ve<32&&w[ve])Te=Y.pop(),Re=Y.pop(),Y.push(Re+w[ve]+Te);else if(k[ve]){if(G=k[ve][1],G==69&&(G=U[U.l++]),G>Y.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+Y.join("|")+"|");return}var We=Y.slice(-G);Y.length-=G,Y.push(k[ve][0]+"("+We.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}Y.length==1?q[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function B(U){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=U.read_shift(2),q[3]=U[U.l++],q[0].c=U[U.l++],q}function V(U,q){var Y=B(U);return Y[1].t="s",Y[1].v=U.read_shift(q-4,"cstr"),Y}function x(U,q,Y,G){var le=er(6+G.length);le.write_shift(2,U),le.write_shift(1,Y),le.write_shift(1,q),le.write_shift(1,39);for(var xe=0;xe<G.length;++xe){var Re=G.charCodeAt(xe);le.write_shift(1,Re>=128?95:Re)}return le.write_shift(1,0),le}function E(U,q){var Y=B(U);Y[1].v=U.read_shift(2);var G=Y[1].v>>1;if(Y[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return Y[1].v=G,Y}function T(U,q){var Y=B(U),G=U.read_shift(4),le=U.read_shift(4),xe=U.read_shift(2);if(xe==65535)return G===0&&le===3221225472?(Y[1].t="e",Y[1].v=15):G===0&&le===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var Re=xe&32768;return xe=(xe&32767)-16446,Y[1].v=(1-Re*2)*(le*Math.pow(2,xe+32)+G*Math.pow(2,xe)),Y}function I(U,q,Y,G){var le=er(14);if(le.write_shift(2,U),le.write_shift(1,Y),le.write_shift(1,q),G==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var xe=0,Re=0,Te=0,ve=0;return G<0&&(xe=1,G=-G),Re=Math.log2(G)|0,G/=Math.pow(2,Re-31),ve=G>>>0,ve&2147483648||(G/=2,++Re,ve=G>>>0),G-=ve,ve|=2147483648,ve>>>=0,G*=Math.pow(2,32),Te=G>>>0,le.write_shift(4,Te),le.write_shift(4,ve),Re+=16383+(xe?32768:0),le.write_shift(2,Re),le}function P(U,q){var Y=T(U);return U.l+=q-14,Y}function N(U,q){var Y=B(U),G=U.read_shift(4);return Y[1].v=G>>6,Y}function R(U,q){var Y=B(U),G=U.read_shift(8,"f");return Y[1].v=G,Y}function se(U,q){var Y=R(U);return U.l+=q-10,Y}function ae(U,q){return U[U.l+q-1]==0?U.read_shift(q,"cstr"):""}function fe(U,q){var Y=U[U.l++];Y>q-1&&(Y=q-1);for(var G="";G.length<Y;)G+=String.fromCharCode(U[U.l++]);return G}function ge(U,q,Y){if(!(!Y.qpro||q<21)){var G=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var le=U.read_shift(q-21,"cstr");return[G,le]}}function oe(U,q){for(var Y={},G=U.l+q;U.l<G;){var le=U.read_shift(2);if(le==14e3){for(Y[le]=[0,""],Y[le][0]=U.read_shift(2);U[U.l];)Y[le][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return Y}function K(U,q){var Y=er(5+U.length);Y.write_shift(2,14e3),Y.write_shift(2,q);for(var G=0;G<U.length;++G){var le=U.charCodeAt(G);Y[Y.l++]=le>127?95:le}return Y[Y.l++]=0,Y}var he={0:{n:"BOF",f:Xt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ae},222:{n:"SHEETNAMELP",f:fe},65535:{n:""}},we={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:V},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:N},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:se},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ge},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function l9(t){var e={},r=t.match($r),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=Oe(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=Wv[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var c9=function(){var t=cu("t"),e=cu("rPr");function r(i){var a=i.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:it(a[1])},l=i.match(e);return l&&(o.s=l9(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),u9=function(){var e=/(\r\n|\n)/g;function r(s,i,a){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),s.b&&(i.push("<b>"),a.push("</b>")),s.i&&(i.push("<i>"),a.push("</i>")),s.strike&&(i.push("<s>"),a.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),f9=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,h9=/<(?:\w+:)?r>/,d9=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function lx(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=it(Et(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Et(t),r&&(n.h=Jv(n.t))):t.match(h9)&&(n.r=Et(t),n.t=it(Et((t.replace(d9,"").match(f9)||[]).join("").replace($r,""))),r&&(n.h=u9(c9(n.r)))),n):{t:""}}var p9=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,m9=/<(?:\w+:)?(?:si|sstItem)>/g,g9=/<\/(?:\w+:)?(?:si|sstItem)>/;function v9(t,e){var r=[],n="";if(!t)return r;var s=t.match(p9);if(s){n=s[2].replace(m9,"").split(g9);for(var i=0;i!=n.length;++i){var a=lx(n[i].trim(),e);a!=null&&(r[r.length]=a)}s=Oe(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function x9(t){return[t.read_shift(4),t.read_shift(4)]}function _9(t,e){var r=[],n=!1;return xi(t,function(i,a,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function XA(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function ni(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function y9(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=ni(t,4),e.U=ni(t,4),e.W=ni(t,4),e}function w9(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),i=[];s-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function E9(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(w9(t));return e}function T9(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function k9(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=ni(t,4),e.U=ni(t,4),e.W=ni(t,4),e}function S9(t){var e=k9(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function YA(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function QA(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function A9(t){var e=ni(t);switch(e.Minor){case 2:return[e.Minor,I9(t)];case 3:return[e.Minor,C9()];case 4:return[e.Minor,R9(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function I9(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=YA(t,r),s=QA(t,t.length-t.l);return{t:"Std",h:n,v:s}}function C9(){throw new Error("File is password-protected: ECMA-376 Extensible")}function R9(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace($r,function(i){var a=Oe(i);switch(Fs(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function N9(t,e){var r={},n=r.EncryptionVersionInfo=ni(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=YA(t,s),e-=s,r.EncryptionVerifier=QA(t,e),r}function P9(t){var e={},r=e.EncryptionVersionInfo=ni(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function D9(t){var e=0,r,n=XA(t),s=n.length+1,i,a,o,l,c;for(r=sa(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var JA=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},s=function(a,o){return n(a^o)},i=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var u=a[c],h=0;h!=7;++h)u&64&&(o^=r[l]),u*=2,--l;return o};return function(a){for(var o=XA(a),l=i(o),c=o.length,u=sa(16),h=0;h!=16;++h)u[h]=0;var d,m,v;for((c&1)===1&&(d=l>>8,u[c]=s(t[0],d),--c,d=l&255,m=o[o.length-1],u[c]=s(m,d));c>0;)--c,d=l>>8,u[c]=s(o[c],d),--c,d=l&255,u[c]=s(o[c],d);for(c=15,v=15-o.length;v>0;)d=l>>8,u[c]=s(t[v],d),--c,--v,d=l&255,u[c]=s(o[c],d),--c,--v;return u}}(),F9=function(t,e,r,n,s){s||(s=e),n||(n=JA(t));var i,a;for(i=0;i!=e.length;++i)a=e[i],a^=n[r],a=(a>>5|a<<3)&255,s[i]=a,++r;return[s,r,n]},b9=function(t){var e=0,r=JA(t);return function(n){var s=F9("",n,e,r);return e=s[1],s[0]}};function O9(t,e,r,n){var s={key:Xt(t),verificationBytes:Xt(t)};return r.password&&(s.verifier=D9(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=b9(r.password)),s}function M9(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=P9(t):n.Data=N9(t,e),n}function L9(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?M9(t,e-2,n):O9(t,r.biff>=8?e:e-2,r,n),n}var j9=function(){function t(s,i){switch(i.type){case"base64":return e(En(s),i);case"binary":return e(s,i);case"buffer":return e(Qe&&Buffer.isBuffer(s)?s.toString("binary"):io(s),i);case"array":return e(Xa(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var a=i||{},o=a.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,m=0,v,g=-1;v=d.exec(u);){switch(v[0]){case"\\cell":var y=u.slice(m,d.lastIndex-v[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var S={v:y,t:"s"};Array.isArray(o)?o[h][g]=S:o[Ue({r:h,c:g})]=S}break}m=d.lastIndex}g>c.e.c&&(c.e.c=g)}),o["!ref"]=tt(c),o}function r(s,i){return da(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=Ut(s["!ref"]),o,l=Array.isArray(s),c=a.s.r;c<=a.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var h=Ue({r:c,c:u});o=l?(s[c]||[])[u]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(pi(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function V9(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function hu(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function U9(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),i=Math.min(e,r,n),a=s-i;if(a===0)return[0,0,e];var o=0,l=0,c=s+i;switch(l=a/(c>1?2-c:c),s){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function B9(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),i=n-s/2,a=[i,i,i],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,a[0]+=s,a[1]+=l;break;case 1:l=s*(2-o),a[0]+=l,a[1]+=s;break;case 2:l=s*(o-2),a[1]+=s,a[2]+=l;break;case 3:l=s*(4-o),a[1]+=l,a[2]+=s;break;case 4:l=s*(o-4),a[2]+=s,a[0]+=l;break;case 5:l=s*(6-o),a[2]+=l,a[0]+=s;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function sd(t,e){if(e===0)return t;var r=U9(V9(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),hu(B9(r))}var ZA=6,z9=15,$9=1,Gr=ZA;function id(t){return Math.floor((t+Math.round(128/Gr)/256)*Gr)}function ad(t){return Math.floor((t-5)/Gr*100+.5)/100}function Dm(t){return Math.round((t*Gr+5)/Gr*256)/256}function Z0(t){return Dm(ad(id(t)))}function cx(t){var e=Math.abs(t-Z0(t)),r=Gr;if(e>.005)for(Gr=$9;Gr<z9;++Gr)Math.abs(t-Z0(t))<=e&&(e=Math.abs(t-Z0(t)),r=Gr);Gr=r}function gl(t){t.width?(t.wpx=id(t.width),t.wch=ad(t.wpx),t.MDW=Gr):t.wpx?(t.wch=ad(t.wpx),t.width=Dm(t.wch),t.MDW=Gr):typeof t.wch=="number"&&(t.width=Dm(t.wch),t.wpx=id(t.width),t.MDW=Gr),t.customWidth&&delete t.customWidth}var H9=96,eI=H9;function tI(t){return t*96/eI}function du(t){return t*eI/96}var W9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function G9(t,e,r,n){e.Borders=[];var s={},i=!1;(t[0].match($r)||[]).forEach(function(a){var o=Oe(a);switch(Fs(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Nt(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Nt(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function K9(t,e,r,n){e.Fills=[];var s={},i=!1;(t[0].match($r)||[]).forEach(function(a){var o=Oe(a);switch(Fs(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function q9(t,e,r,n){e.Fonts=[];var s={},i=!1;(t[0].match($r)||[]).forEach(function(a){var o=Oe(a);switch(Fs(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Et(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Nt(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Nt(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Nt(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Nt(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Nt(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Nt(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Nt(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Wv[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Nt(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Ma[s.color.index];s.color.index==81&&(l=Ma[1]),l||(l=Ma[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=sd(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function X9(t,e,r){e.NumberFmt=[];for(var n=Cs(ze),s=0;s<n.length;++s)e.NumberFmt[n[s]]=ze[n[s]];var i=t[0].match($r);if(i)for(s=0;s<i.length;++s){var a=Oe(i[s]);switch(Fs(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=it(Et(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Oa(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var Df=["numFmtId","fillId","fontId","borderId","xfId"],Ff=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Y9(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match($r)||[]).forEach(function(i){var a=Oe(i),o=0;switch(Fs(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Df.length;++o)n[Df[o]]&&(n[Df[o]]=parseInt(n[Df[o]],10));for(o=0;o<Ff.length;++o)n[Ff[o]]&&(n[Ff[o]]=Nt(n[Ff[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Nt(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var Q9=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(e))&&X9(h,u,c),(h=o.match(s))&&q9(h,u,l,c),(h=o.match(n))&&K9(h,u,l,c),(h=o.match(i))&&G9(h,u,l,c),(h=o.match(r))&&Y9(h,u,c),u}}();function J9(t,e){var r=t.read_shift(2),n=Vr(t);return[r,n]}function Z9(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=c8(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=l8(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Vr(t),n}var ej=zr;function tj(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}var rj=zr;function nj(t,e,r){var n={};n.NumberFmt=[];for(var s in ze)n.NumberFmt[s]=ze[s];n.CellXf=[],n.Fonts=[];var i=[],a=!1;return xi(t,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Oa(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=sd(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:i.push(u),a=!0;break;case 38:i.pop(),a=!1;break;default:if(c.T>0)i.push(u);else if(c.T<0)i.pop();else if(!a||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var sj=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function ij(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match($r)||[]).forEach(function(s){var i=Oe(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[sj.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function aj(){}function oj(){}var lj=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,cj=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,uj=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function fj(t,e,r){e.themeElements={};var n;[["clrScheme",lj,ij],["fontScheme",cj,aj],["fmtScheme",uj,oj]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var hj=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function rI(t,e){(!t||t.length===0)&&(t=dj());var r,n={};if(!(r=t.match(hj)))throw new Error("themeElements not found in theme");return fj(r[0],n,e),n.raw=t,n}function dj(t,e){var r=[dA];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function pj(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var a;try{a=hA(i,{type:"array"})}catch{return}var o=vn(a,"theme/theme/theme1.xml",!0);if(o)return rI(o,r)}}function mj(t){return t.read_shift(4)}function gj(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=vj(t,4);break;case 2:e.xclrValue=zA(t);break;case 3:e.xclrValue=mj(t);break;case 4:t.l+=4;break}return t.l+=8,e}function vj(t,e){return zr(t,e)}function xj(t,e){return zr(t,e)}function _j(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=gj(t);break;case 6:n[1]=xj(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function yj(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),i=[];s-- >0;)i.push(_j(t,r-t.l));return{ixfe:n,ext:i}}function wj(t,e){e.forEach(function(r){switch(r[0]){}})}function Ej(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Vr(t)}}function Tj(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function kj(t){return t.l+=4,t.read_shift(4)!=0}function Sj(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],a=!1,o=2;return xi(t,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:i.push(u),a=!0;break;case 36:i.pop(),a=!1;break;default:if(!c.T){if(!a||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function Aj(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,i=2,a;return t.replace($r,function(o){var l=Oe(o);switch(Fs(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function Ij(t){var e=[];if(!t)return e;var r=1;return(t.match($r)||[]).forEach(function(n){var s=Oe(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function Cj(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Ue(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function Rj(t,e,r){var n=[];return xi(t,function(i,a,o){switch(o){case 63:n.push(i);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function Nj(t,e,r,n){if(!t)return t;var s=n||{},i=!1;xi(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function Pj(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function Cw(t,e,r,n){var s=Array.isArray(t),i;e.forEach(function(a){var o=Kr(a.ref);if(s?(t[o.r]||(t[o.r]=[]),i=t[o.r][o.c]):i=t[a.ref],!i){i={t:"z"},s?t[o.r][o.c]=i:t[a.ref]=i;var l=Ut(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=tt(l);c!==t["!ref"]&&(t["!ref"]=c)}i.c||(i.c=[]);var u={a:a.author,t:a.t,r:a.r,T:r};a.h&&(u.h=a.h);for(var h=i.c.length-1;h>=0;--h){if(!r&&i.c[h].T)return;r&&!i.c[h].T&&i.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}i.c.push(u)})}function Dj(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Oe(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Kr(l.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&lx(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function Fj(t,e){var r=[],n=!1,s={},i=0;return t.replace($r,function(o,l){var c=Oe(o);switch(Fs(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=l+o.length;break;case"</text>":s.t=t.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function bj(t,e){var r=[],n=!1;return t.replace($r,function(i){var a=Oe(i);switch(Fs(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return i}),r}function Oj(t){var e={};e.iauthor=t.read_shift(4);var r=oo(t);return e.rfx=r.s,e.ref=Ue(r.s),t.l+=16,e}var Mj=Vr;function Lj(t,e){var r=[],n=[],s={},i=!1;return xi(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var jj="application/vnd.ms-office.vbaProject";function Vj(t){var e=et.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");et.utils.cfb_add(e,s,t.FileIndex[n].content)}}),et.write(e)}function Uj(){return{"!type":"dialog"}}function Bj(){return{"!type":"dialog"}}function zj(){return{"!type":"macro"}}function $j(){return{"!type":"macro"}}var Xo=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,a){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=e.c:--u,l?c+=e.r:--c,s+(o?"":"$")+nr(u)+(l?"":"$")+Tr(c)}return function(s,i){return e=i,s.replace(t,r)}}(),nI=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Hj=function(){return function(e,r){return e.replace(nI,function(n,s,i,a,o,l){var c=rx(a)-(i?0:r.c),u=tx(l)-(o?0:r.r),h=u==0?"":o?u+1:"["+u+"]",d=c==0?"":i?c+1:"["+c+"]";return s+"R"+h+"C"+d})}}();function sI(t,e){return t.replace(nI,function(r,n,s,i,a,o){return n+(s=="$"?s+i:nr(rx(i)+e.c))+(a=="$"?a+o:Tr(tx(o)+e.r))})}function Wj(t,e,r){var n=Al(e),s=n.s,i=Kr(r),a={r:i.r-s.r,c:i.c-s.c};return sI(t,a)}function Gj(t){return t.length!=1}function Rw(t){return t.replace(/_xlfn\./g,"")}function Gt(t){t.l+=1}function ia(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function iI(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return aI(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),a=ia(t),o=ia(t);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function aI(t){var e=ia(t),r=ia(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function Kj(t,e,r){if(r.biff<8)return aI(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=ia(t),a=ia(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function oI(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return qj(t);var n=t.read_shift(r&&r.biff==12?4:2),s=ia(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function qj(t){var e=ia(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function Xj(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Yj(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Qj(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function Qj(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function Jj(t,e,r){var n=(t[t.l++]&96)>>5,s=iI(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function Zj(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var a=iI(t,i,r);return[n,s,a]}function eV(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function tV(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function rV(t,e,r){var n=(t[t.l++]&96)>>5,s=Kj(t,e-1,r);return[n,s]}function nV(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Nw(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function sV(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function iV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function aV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function oV(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function lV(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function lI(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function cV(t){return t.read_shift(2),lI(t)}function uV(t){return t.read_shift(2),lI(t)}function fV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=oI(t,0,r);return[n,s]}function hV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=Yj(t,0,r);return[n,s]}function dV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=oI(t,0,r);return[n,s,i]}function pV(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[mU[s],fI[s],n]}function mV(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:gV(t);return[s,(i[0]===0?fI:pU)[i[1]]]}function gV(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function vV(t,e,r){t.l+=r&&r.biff==2?3:4}function xV(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function _V(t){return t.l++,lo[t.read_shift(1)]}function yV(t){return t.l++,t.read_shift(2)}function wV(t){return t.l++,t.read_shift(1)!==0}function EV(t){return t.l++,Lr(t)}function TV(t,e,r){return t.l++,ju(t,e-1,r)}function kV(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Bt(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=lo[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Lr(t);break;case 2:r[1]=co(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function SV(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?oo:Zd)(t));return s}function AV(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=kV(t,r.biff);return a}function IV(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function CV(t,e,r){if(r.biff==5)return RV(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function RV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function NV(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function PV(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function DV(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function FV(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var bV=zr,OV=zr,MV=zr;function Uu(t,e,r){return t.l+=2,[Xj(t)]}function ux(t){return t.l+=6,[]}var LV=Uu,jV=ux,VV=ux,UV=Uu;function cI(t){return t.l+=2,[Xt(t),t.read_shift(2)&1]}var BV=Uu,zV=cI,$V=ux,HV=Uu,WV=Uu,GV=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function KV(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),a=GV[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:s,C:i}}function qV(t){return t.l+=2,[t.read_shift(4)]}function XV(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function YV(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function QV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function JV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function ZV(t){return t.l+=4,[0,0]}var Pw={1:{n:"PtgExp",f:xV},2:{n:"PtgTbl",f:MV},3:{n:"PtgAdd",f:Gt},4:{n:"PtgSub",f:Gt},5:{n:"PtgMul",f:Gt},6:{n:"PtgDiv",f:Gt},7:{n:"PtgPower",f:Gt},8:{n:"PtgConcat",f:Gt},9:{n:"PtgLt",f:Gt},10:{n:"PtgLe",f:Gt},11:{n:"PtgEq",f:Gt},12:{n:"PtgGe",f:Gt},13:{n:"PtgGt",f:Gt},14:{n:"PtgNe",f:Gt},15:{n:"PtgIsect",f:Gt},16:{n:"PtgUnion",f:Gt},17:{n:"PtgRange",f:Gt},18:{n:"PtgUplus",f:Gt},19:{n:"PtgUminus",f:Gt},20:{n:"PtgPercent",f:Gt},21:{n:"PtgParen",f:Gt},22:{n:"PtgMissArg",f:Gt},23:{n:"PtgStr",f:TV},26:{n:"PtgSheet",f:XV},27:{n:"PtgEndSheet",f:YV},28:{n:"PtgErr",f:_V},29:{n:"PtgBool",f:wV},30:{n:"PtgInt",f:yV},31:{n:"PtgNum",f:EV},32:{n:"PtgArray",f:nV},33:{n:"PtgFunc",f:pV},34:{n:"PtgFuncVar",f:mV},35:{n:"PtgName",f:IV},36:{n:"PtgRef",f:fV},37:{n:"PtgArea",f:Jj},38:{n:"PtgMemArea",f:NV},39:{n:"PtgMemErr",f:bV},40:{n:"PtgMemNoMem",f:OV},41:{n:"PtgMemFunc",f:PV},42:{n:"PtgRefErr",f:DV},43:{n:"PtgAreaErr",f:eV},44:{n:"PtgRefN",f:hV},45:{n:"PtgAreaN",f:rV},46:{n:"PtgMemAreaN",f:QV},47:{n:"PtgMemNoMemN",f:JV},57:{n:"PtgNameX",f:CV},58:{n:"PtgRef3d",f:dV},59:{n:"PtgArea3d",f:Zj},60:{n:"PtgRefErr3d",f:FV},61:{n:"PtgAreaErr3d",f:tV},255:{}},eU={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},tU={1:{n:"PtgElfLel",f:cI},2:{n:"PtgElfRw",f:HV},3:{n:"PtgElfCol",f:LV},6:{n:"PtgElfRwV",f:WV},7:{n:"PtgElfColV",f:UV},10:{n:"PtgElfRadical",f:BV},11:{n:"PtgElfRadicalS",f:$V},13:{n:"PtgElfColS",f:jV},15:{n:"PtgElfColSV",f:VV},16:{n:"PtgElfRadicalLel",f:zV},25:{n:"PtgList",f:KV},29:{n:"PtgSxName",f:qV},255:{}},rU={0:{n:"PtgAttrNoop",f:ZV},1:{n:"PtgAttrSemi",f:lV},2:{n:"PtgAttrIf",f:aV},4:{n:"PtgAttrChoose",f:sV},8:{n:"PtgAttrGoto",f:iV},16:{n:"PtgAttrSum",f:vV},32:{n:"PtgAttrBaxcel",f:Nw},33:{n:"PtgAttrBaxcel",f:Nw},64:{n:"PtgAttrSpace",f:cV},65:{n:"PtgAttrSpaceSemi",f:uV},128:{n:"PtgAttrIfError",f:oV},255:{}};function Bu(t,e,r,n){if(n.biff<8)return zr(t,e);for(var s=t.l+e,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=AV(t,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=SV(t,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=s-t.l,e!==0&&i.push(zr(t,e)),i}function zu(t,e,r){for(var n=t.l+e,s,i,a=[];n!=t.l;)e=n-t.l,i=t[t.l],s=Pw[i]||Pw[eU[i]],(i===24||i===25)&&(s=(i===24?tU:rU)[t[t.l+1]]),!s||!s.f?zr(t,e):a.push([s.n,s.f(t,e,r)]);return a}function nU(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var sU={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function iU(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function uI(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Dw(t,e,r){var n=uI(t,e,r);return n=="#REF"?n:iU(n,r)}function br(t,e,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0}},o=[],l,c,u,h=0,d=0,m,v="";if(!t[0]||!t[0][0])return"";for(var g=-1,y="",S=0,k=t[0].length;S<k;++S){var w=t[0][S];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),g>=0){switch(t[0][g][1][0]){case 0:y=Vt(" ",t[0][g][1][1]);break;case 1:y=Vt("\r",t[0][g][1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}c=c+y,g=-1}o.push(c+sU[w[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Tc(w[1][1],a,s),o.push(kc(u,i));break;case"PtgRefN":u=r?Tc(w[1][1],r,s):w[1][1],o.push(kc(u,i));break;case"PtgRef3d":h=w[1][1],u=Tc(w[1][2],a,s),v=Dw(n,h,s),o.push(v+"!"+kc(u,i));break;case"PtgFunc":case"PtgFuncVar":var F=w[1][0],B=w[1][1];F||(F=0),F&=127;var V=F==0?[]:o.slice(-F);o.length-=F,B==="User"&&(B=V.shift()),o.push(B+"("+V.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":m=hw(w[1][1],r?{s:r}:a,s),o.push(Q0(m,s));break;case"PtgArea":m=hw(w[1][1],a,s),o.push(Q0(m,s));break;case"PtgArea3d":h=w[1][1],m=w[1][2],v=Dw(n,h,s),o.push(v+"!"+Q0(m,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=w[1][2];var x=(n.names||[])[d-1]||(n[0]||[])[d],E=x?x.Name:"SH33TJSNAME"+String(d);E&&E.slice(0,6)=="_xlfn."&&!s.xlfn&&(E=E.slice(6)),o.push(E);break;case"PtgNameX":var T=w[1][1];d=w[1][2];var I;if(s.biff<=5)T<0&&(T=-T),n[T]&&(I=n[T][d]);else{var P="";if(((n[T]||[])[0]||[])[0]==14849||(((n[T]||[])[0]||[])[0]==1025?n[T][d]&&n[T][d].itab>0&&(P=n.SheetNames[n[T][d].itab-1]+"!"):P=n.SheetNames[d-1]+"!"),n[T]&&n[T][d])P+=n[T][d].Name;else if(n[0]&&n[0][d])P+=n[0][d].Name;else{var N=(uI(n,T,s)||"").split(";;");N[d-1]?P=N[d-1]:P+="SH33TJSERRX"}o.push(P);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var R="(",se=")";if(g>=0){switch(y="",t[0][g][1][0]){case 2:R=Vt(" ",t[0][g][1][1])+R;break;case 3:R=Vt("\r",t[0][g][1][1])+R;break;case 4:se=Vt(" ",t[0][g][1][1])+se;break;case 5:se=Vt("\r",t[0][g][1][1])+se;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}g=-1}o.push(R+o.pop()+se);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:w[1][1],r:w[1][0]};var ae={c:r.c,r:r.r};if(n.sharedf[Ue(u)]){var fe=n.sharedf[Ue(u)];o.push(br(fe,a,ae,n,s))}else{var ge=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(br(c[1],a,ae,n,s)),ge=!0;break}ge||o.push(w[1])}break;case"PtgArray":o.push("{"+nU(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&oe.indexOf(t[0][S][0])==-1){w=t[0][g];var K=!0;switch(w[1][0]){case 4:K=!1;case 0:y=Vt(" ",w[1][1]);break;case 5:K=!1;case 1:y=Vt("\r",w[1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((K?y:"")+o.pop()+(K?"":y)),g=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function aU(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],zr(t,e-2)];var o=zu(t,a,r);return e!==a+s&&(i=Bu(t,e-a-s,o,r)),t.l=n,[o,i]}function oU(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],zr(t,e-2)];var o=zu(t,a,r);return e!==a+s&&(i=Bu(t,e-a-s,o,r)),t.l=n,[o,i]}function lU(t,e,r,n){var s=t.l+e,i=zu(t,n,r),a;return s!==t.l&&(a=Bu(t,s-t.l,i,r)),[i,a]}function cU(t,e,r){var n=t.l+e,s,i=t.read_shift(2),a=zu(t,i,r);return i==65535?[[],zr(t,e-2)]:(e!==i+2&&(s=Bu(t,n-i-2,a,r)),[a,s])}function uU(t){var e;if(Qs(t,t.l+6)!==65535)return[Lr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function ep(t,e,r){var n=t.l+e,s=bs(t);r.biff==2&&++t.l;var i=uU(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=oU(t,n-t.l,r);return{cell:s,val:i[0],formula:o,shared:a>>3&1,tt:i[1]}}function e0(t,e,r){var n=t.read_shift(4),s=zu(t,n,r),i=t.read_shift(4),a=i>0?Bu(t,i,s,r):null;return[s,a]}var fU=e0,t0=e0,hU=e0,dU=e0,pU={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},fI={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},mU={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Fw(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function tp(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Cc={},Yo={};function Rc(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function hI(t,e,r,n,s,i){try{n.cellNF&&(t.z=ze[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=dr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ze[e]==null&&Oa(g6[e]||"General",e),t.t==="e")t.w=t.w||lo[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=lu(t.v);else if(t.t==="d"){var a=Qr(t.v);(a|0)===a?t.w=a.toString(10):t.w=lu(a)}else{if(t.v===void 0)return"";t.w=qa(t.v,Yo)}else t.t==="d"?t.w=Vn(e,Qr(t.v),Yo):t.w=Vn(e,t.v,Yo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=sd(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=sd(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function gU(t,e){var r=Ut(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=tt(r))}var vU=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,xU=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,_U=/<(?:\w:)?hyperlink [^>]*>/mg,yU=/"(\w*:\w*)"/,wU=/<(?:\w:)?col\b[^>]*[\/]?>/g,EU=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,TU=/<(?:\w:)?pageMargins[^>]*\/>/g,dI=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,kU=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,SU=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function AU(t,e,r,n,s,i,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=t.match(xU);h?(c=t.slice(0,h.index),u=t.slice(h.index+h[0].length)):c=u=t;var d=c.match(dI);d?fx(d[0],o,s,r):(d=c.match(kU))&&IU(d[0],d[1]||"",o,s,r);var m=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var v=c.slice(m,m+50).match(yU);v&&gU(o,v[1])}var g=c.match(SU);g&&g[1]&&FU(g[1],s);var y=[];if(e.cellStyles){var S=c.match(wU);S&&NU(y,S)}h&&bU(h[1],o,e,l,i,a);var k=u.match(EU);k&&(o["!autofilter"]=PU(k[0]));var w=[],F=u.match(vU);if(F)for(m=0;m!=F.length;++m)w[m]=Ut(F[m].slice(F[m].indexOf('"')+1));var B=u.match(_U);B&&CU(o,B,n);var V=u.match(TU);if(V&&(o["!margins"]=RU(Oe(V[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=tt(l)),e.sheetRows>0&&o["!ref"]){var x=Ut(o["!ref"]);e.sheetRows<=+x.e.r&&(x.e.r=e.sheetRows-1,x.e.r>l.e.r&&(x.e.r=l.e.r),x.e.r<x.s.r&&(x.s.r=x.e.r),x.e.c>l.e.c&&(x.e.c=l.e.c),x.e.c<x.s.c&&(x.s.c=x.e.c),o["!fullref"]=o["!ref"],o["!ref"]=tt(x))}return y.length>0&&(o["!cols"]=y),w.length>0&&(o["!merges"]=w),o}function fx(t,e,r,n){var s=Oe(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=it(Et(s.codeName)))}function IU(t,e,r,n,s){fx(t.slice(0,t.indexOf(">")),r,n,s)}function CU(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var i=Oe(Et(e[s]),!0);if(!i.ref)return;var a=((r||{})["!id"]||[])[i.id];a?(i.Target=a.Target,i.location&&(i.Target+="#"+it(i.location))):(i.Target="#"+it(i.location),a={Target:i.Target,TargetMode:"Internal"}),i.Rel=a,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Ut(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Ue({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=i):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=i)}}}function RU(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function NU(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=Oe(e[n],!0);s.hidden&&(s.hidden=Nt(s.hidden));var i=parseInt(s.min,10)-1,a=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,cx(s.width)),gl(s);i<=a;)t[i++]=Er(s)}}function PU(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var DU=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function FU(t,e){e.Views||(e.Views=[{}]),(t.match(DU)||[]).forEach(function(r,n){var s=Oe(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Nt(s.rightToLeft)&&(e.Views[n].RTL=!0)})}var bU=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=cu("v"),a=cu("f");return function(l,c,u,h,d,m){for(var v=0,g="",y=[],S=[],k=0,w=0,F=0,B="",V,x,E=0,T=0,I,P,N=0,R=0,se=Array.isArray(m.CellXf),ae,fe=[],ge=[],oe=Array.isArray(c),K=[],he={},we=!1,U=!!u.sheetStubs,q=l.split(e),Y=0,G=q.length;Y!=G;++Y){g=q[Y].trim();var le=g.length;if(le!==0){var xe=0;e:for(v=0;v<le;++v)switch(g[v]){case">":if(g[v-1]!="/"){++v;break e}if(u&&u.cellStyles){if(x=Oe(g.slice(xe,v),!0),E=x.r!=null?parseInt(x.r,10):E+1,T=-1,u.sheetRows&&u.sheetRows<E)continue;he={},we=!1,x.ht&&(we=!0,he.hpt=parseFloat(x.ht),he.hpx=du(he.hpt)),x.hidden=="1"&&(we=!0,he.hidden=!0),x.outlineLevel!=null&&(we=!0,he.level=+x.outlineLevel),we&&(K[E-1]=he)}break;case"<":xe=v;break}if(xe>=v)break;if(x=Oe(g.slice(xe,v),!0),E=x.r!=null?parseInt(x.r,10):E+1,T=-1,!(u.sheetRows&&u.sheetRows<E)){h.s.r>E-1&&(h.s.r=E-1),h.e.r<E-1&&(h.e.r=E-1),u&&u.cellStyles&&(he={},we=!1,x.ht&&(we=!0,he.hpt=parseFloat(x.ht),he.hpx=du(he.hpt)),x.hidden=="1"&&(we=!0,he.hidden=!0),x.outlineLevel!=null&&(we=!0,he.level=+x.outlineLevel),we&&(K[E-1]=he)),y=g.slice(v).split(t);for(var Re=0;Re!=y.length&&y[Re].trim().charAt(0)=="<";++Re);for(y=y.slice(Re),v=0;v!=y.length;++v)if(g=y[v].trim(),g.length!==0){if(S=g.match(r),k=v,w=0,F=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,S!=null&&S.length===2){for(k=0,B=S[1],w=0;w!=B.length&&!((F=B.charCodeAt(w)-64)<1||F>26);++w)k=26*k+F;--k,T=k}else++T;for(w=0;w!=g.length&&g.charCodeAt(w)!==62;++w);if(++w,x=Oe(g.slice(0,w),!0),x.r||(x.r=Ue({r:E-1,c:T})),B=g.slice(w),V={t:""},(S=B.match(i))!=null&&S[1]!==""&&(V.v=it(S[1])),u.cellFormula){if((S=B.match(a))!=null&&S[1]!==""){if(V.f=it(Et(S[1])).replace(/\r\n/g,`
`),u.xlfn||(V.f=Rw(V.f)),S[0].indexOf('t="array"')>-1)V.F=(B.match(s)||[])[1],V.F.indexOf(":")>-1&&fe.push([Ut(V.F),V.F]);else if(S[0].indexOf('t="shared"')>-1){P=Oe(S[0]);var Te=it(Et(S[1]));u.xlfn||(Te=Rw(Te)),ge[parseInt(P.si,10)]=[P,Te,x.r]}}else(S=B.match(/<f[^>]*\/>/))&&(P=Oe(S[0]),ge[P.si]&&(V.f=Wj(ge[P.si][1],ge[P.si][2],x.r)));var ve=Kr(x.r);for(w=0;w<fe.length;++w)ve.r>=fe[w][0].s.r&&ve.r<=fe[w][0].e.r&&ve.c>=fe[w][0].s.c&&ve.c<=fe[w][0].e.c&&(V.F=fe[w][1])}if(x.t==null&&V.v===void 0)if(V.f||V.F)V.v=0,V.t="n";else if(U)V.t="z";else continue;else V.t=x.t||"n";switch(h.s.c>T&&(h.s.c=T),h.e.c<T&&(h.e.c=T),V.t){case"n":if(V.v==""||V.v==null){if(!U)continue;V.t="z"}else V.v=parseFloat(V.v);break;case"s":if(typeof V.v>"u"){if(!U)continue;V.t="z"}else I=Cc[parseInt(V.v,10)],V.v=I.t,V.r=I.r,u.cellHTML&&(V.h=I.h);break;case"str":V.t="s",V.v=V.v!=null?Et(V.v):"",u.cellHTML&&(V.h=Jv(V.v));break;case"inlineStr":S=B.match(n),V.t="s",S!=null&&(I=lx(S[1]))?(V.v=I.t,u.cellHTML&&(V.h=I.h)):V.v="";break;case"b":V.v=Nt(V.v);break;case"d":u.cellDates?V.v=dr(V.v,1):(V.v=Qr(dr(V.v,1)),V.t="n");break;case"e":(!u||u.cellText!==!1)&&(V.w=V.v),V.v=bA[V.v];break}if(N=R=0,ae=null,se&&x.s!==void 0&&(ae=m.CellXf[x.s],ae!=null&&(ae.numFmtId!=null&&(N=ae.numFmtId),u.cellStyles&&ae.fillId!=null&&(R=ae.fillId))),hI(V,N,R,u,d,m),u.cellDates&&se&&V.t=="n"&&Sl(ze[N])&&(V.t="d",V.v=Jd(V.v)),x.cm&&u.xlmeta){var $e=(u.xlmeta.Cell||[])[+x.cm-1];$e&&$e.type=="XLDAPR"&&(V.D=!0)}if(oe){var z=Kr(x.r);c[z.r]||(c[z.r]=[]),c[z.r][z.c]=V}else c[x.r]=V}}}}K.length>0&&(c["!rows"]=K)}}();function OU(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}var MU=oo;function LU(){}function jU(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=a8(t),r}function VU(t){var e=Un(t);return[e]}function UU(t){var e=ao(t);return[e]}function BU(t){var e=Un(t),r=t.read_shift(1);return[e,r,"b"]}function zU(t){var e=ao(t),r=t.read_shift(1);return[e,r,"b"]}function $U(t){var e=Un(t),r=t.read_shift(1);return[e,r,"e"]}function HU(t){var e=ao(t),r=t.read_shift(1);return[e,r,"e"]}function WU(t){var e=Un(t),r=t.read_shift(4);return[e,r,"s"]}function GU(t){var e=ao(t),r=t.read_shift(4);return[e,r,"s"]}function KU(t){var e=Un(t),r=Lr(t);return[e,r,"n"]}function pI(t){var e=ao(t),r=Lr(t);return[e,r,"n"]}function qU(t){var e=Un(t),r=ix(t);return[e,r,"n"]}function XU(t){var e=ao(t),r=ix(t);return[e,r,"n"]}function YU(t){var e=Un(t),r=nx(t);return[e,r,"is"]}function QU(t){var e=Un(t),r=Vr(t);return[e,r,"str"]}function JU(t){var e=ao(t),r=Vr(t);return[e,r,"str"]}function ZU(t,e,r){var n=t.l+e,s=Un(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"b"];if(r.cellFormula){t.l+=2;var o=t0(t,n-t.l,r);a[3]=br(o,null,s,r.supbooks,r)}else t.l=n;return a}function eB(t,e,r){var n=t.l+e,s=Un(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"e"];if(r.cellFormula){t.l+=2;var o=t0(t,n-t.l,r);a[3]=br(o,null,s,r.supbooks,r)}else t.l=n;return a}function tB(t,e,r){var n=t.l+e,s=Un(t);s.r=r["!row"];var i=Lr(t),a=[s,i,"n"];if(r.cellFormula){t.l+=2;var o=t0(t,n-t.l,r);a[3]=br(o,null,s,r.supbooks,r)}else t.l=n;return a}function rB(t,e,r){var n=t.l+e,s=Un(t);s.r=r["!row"];var i=Vr(t),a=[s,i,"str"];if(r.cellFormula){t.l+=2;var o=t0(t,n-t.l,r);a[3]=br(o,null,s,r.supbooks,r)}else t.l=n;return a}var nB=oo;function sB(t,e){var r=t.l+e,n=oo(t),s=sx(t),i=Vr(t),a=Vr(t),o=Vr(t);t.l=r;var l={rfx:n,relId:s,loc:i,display:o};return a&&(l.Tooltip=a),l}function iB(){}function aB(t,e,r){var n=t.l+e,s=PA(t),i=t.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=fU(t,n-t.l,r);a[1]=o}else t.l=n;return a}function oB(t,e,r){var n=t.l+e,s=oo(t),i=[s];if(r.cellFormula){var a=dU(t,n-t.l,r);i[1]=a,t.l=n}else t.l=n;return i}var lB=["left","right","top","bottom","header","footer"];function cB(t){var e={};return lB.forEach(function(r){e[r]=Lr(t)}),e}function uB(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function fB(){}function hB(){}function dB(t,e,r,n,s,i,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,m,v,g,y,S,k,w,F,B,V=[];o.biff=12,o["!row"]=0;var x=0,E=!1,T=[],I={},P=o.supbooks||s.supbooks||[[]];if(P.sharedf=I,P.arrayf=T,P.SheetNames=s.SheetNames||s.Sheets.map(function(oe){return oe.name}),!o.supbooks&&(o.supbooks=P,s.Names))for(var N=0;N<s.Names.length;++N)P[0][N+1]=s.Names[N];var R=[],se=[],ae=!1;od[16]={n:"BrtShortReal",f:pI};var fe;if(xi(t,function(K,he,we){if(!d)switch(we){case 148:c=K;break;case 0:m=K,o.sheetRows&&o.sheetRows<=m.r&&(d=!0),F=Tr(y=m.r),o["!row"]=m.r,(K.hidden||K.hpt||K.level!=null)&&(K.hpt&&(K.hpx=du(K.hpt)),se[K.r]=K);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:K[2]},K[2]){case"n":v.v=K[1];break;case"s":w=Cc[K[1]],v.v=w.t,v.r=w.r;break;case"b":v.v=!!K[1];break;case"e":v.v=K[1],o.cellText!==!1&&(v.w=lo[v.v]);break;case"str":v.t="s",v.v=K[1];break;case"is":v.t="s",v.v=K[1].t;break}if((g=a.CellXf[K[0].iStyleRef])&&hI(v,g.numFmtId,null,o,i,a),S=K[0].c==-1?S+1:K[0].c,o.dense?(l[y]||(l[y]=[]),l[y][S]=v):l[nr(S)+F]=v,o.cellFormula){for(E=!1,x=0;x<T.length;++x){var U=T[x];m.r>=U[0].s.r&&m.r<=U[0].e.r&&S>=U[0].s.c&&S<=U[0].e.c&&(v.F=tt(U[0]),E=!0)}!E&&K.length>3&&(v.f=K[3])}if(u.s.r>m.r&&(u.s.r=m.r),u.s.c>S&&(u.s.c=S),u.e.r<m.r&&(u.e.r=m.r),u.e.c<S&&(u.e.c=S),o.cellDates&&g&&v.t=="n"&&Sl(ze[g.numFmtId])){var q=Ra(v.v);q&&(v.t="d",v.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}fe&&(fe.type=="XLDAPR"&&(v.D=!0),fe=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;v={t:"z",v:void 0},S=K[0].c==-1?S+1:K[0].c,o.dense?(l[y]||(l[y]=[]),l[y][S]=v):l[nr(S)+F]=v,u.s.r>m.r&&(u.s.r=m.r),u.s.c>S&&(u.s.c=S),u.e.r<m.r&&(u.e.r=m.r),u.e.c<S&&(u.e.c=S),fe&&(fe.type=="XLDAPR"&&(v.D=!0),fe=void 0);break;case 176:V.push(K);break;case 49:fe=((o.xlmeta||{}).Cell||[])[K-1];break;case 494:var Y=n["!id"][K.relId];for(Y?(K.Target=Y.Target,K.loc&&(K.Target+="#"+K.loc),K.Rel=Y):K.relId==""&&(K.Target="#"+K.loc),y=K.rfx.s.r;y<=K.rfx.e.r;++y)for(S=K.rfx.s.c;S<=K.rfx.e.c;++S)o.dense?(l[y]||(l[y]=[]),l[y][S]||(l[y][S]={t:"z",v:void 0}),l[y][S].l=K):(k=Ue({c:S,r:y}),l[k]||(l[k]={t:"z",v:void 0}),l[k].l=K);break;case 426:if(!o.cellFormula)break;T.push(K),B=o.dense?l[y][S]:l[nr(S)+F],B.f=br(K[1],u,{r:m.r,c:S},P,o),B.F=tt(K[0]);break;case 427:if(!o.cellFormula)break;I[Ue(K[0].s)]=K[1],B=o.dense?l[y][S]:l[nr(S)+F],B.f=br(K[1],u,{r:m.r,c:S},P,o);break;case 60:if(!o.cellStyles)break;for(;K.e>=K.s;)R[K.e--]={width:K.w/256,hidden:!!(K.flags&1),level:K.level},ae||(ae=!0,cx(K.w/256)),gl(R[K.e+1]);break;case 161:l["!autofilter"]={ref:tt(K)};break;case 476:l["!margins"]=K;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),K.name&&(s.Sheets[r].CodeName=K.name),(K.above||K.left)&&(l["!outline"]={above:K.above,left:K.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),K.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!he.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+we.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=tt(c||u)),o.sheetRows&&l["!ref"]){var ge=Ut(l["!ref"]);o.sheetRows<=+ge.e.r&&(ge.e.r=o.sheetRows-1,ge.e.r>u.e.r&&(ge.e.r=u.e.r),ge.e.r<ge.s.r&&(ge.s.r=ge.e.r),ge.e.c>u.e.c&&(ge.e.c=u.e.c),ge.e.c<ge.s.c&&(ge.s.c=ge.e.c),l["!fullref"]=l["!ref"],l["!ref"]=tt(ge))}return V.length>0&&(l["!merges"]=V),R.length>0&&(l["!cols"]=R),se.length>0&&(l["!rows"]=se),l}function pB(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var a=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var s=it((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,s,n]}function mB(t,e,r,n,s,i){var a=i||{"!type":"chart"};if(!t)return i;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=pB(h);u.s.r=u.s.c=0,u.e.c=o,c=nr(o),d[0].forEach(function(m,v){a[c+Tr(v)]={t:"n",v:m,z:d[1]},l=v}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(a["!ref"]=tt(u)),a}function gB(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(dI);return o&&fx(o[0],i,s,r),(a=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=a[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function vB(t,e){t.l+=10;var r=Vr(t);return{name:r}}function xB(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a=!1;return xi(t,function(l,c,u){switch(u){case 550:i["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var mI=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],_B=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],yB=[],wB=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function bw(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var i=e[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Nt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function Ow(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Nt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function gI(t){Ow(t.WBProps,mI),Ow(t.CalcPr,wB),bw(t.WBView,_B),bw(t.Sheets,yB),Yo.date1904=Nt(t.WBProps.date1904)}var EB="][*?/\\".split("");function TB(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return EB.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var kB=/<\w+:workbook/;function SB(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},a=0;if(t.replace($r,function(l,c){var u=Oe(l);switch(Fs(u[0])){case"<?xml":break;case"<workbook":l.match(kB)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":mI.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Nt(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=Et(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=it(Et(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Et(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),Nt(u.hidden||"0")&&(i.Hidden=!0),a=c+l.length;break;case"</definedName>":i.Ref=it(Et(t.slice(a,c))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),$6.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return gI(r),r}function AB(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Rm(t),r.name=Vr(t),r}function IB(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?Vr(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function CB(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function RB(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=o8(t),a=hU(t,0,r),o=sx(t);t.l=n;var l={Name:i,Ptg:a};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function NB(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var i=[],a=[[]];return a.SheetNames=[],a.XTI=[],od[16]={n:"BrtFRTArchID$",f:CB},xi(t,function(l,c,u){switch(u){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=br(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,l]):a[0]=[u,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),gI(r),r.Names=i,r.supbooks=a,r}function PB(t,e,r){return e.slice(-4)===".bin"?NB(t,r):SB(t,r)}function DB(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?dB(t,n,r,s,i,a,o):AU(t,n,r,s,i,a,o)}function FB(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?xB(t,n,r,s,i):gB(t,n,r,s,i)}function bB(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?zj():$j()}function OB(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?Uj():Bj()}function MB(t,e,r,n){return e.slice(-4)===".bin"?nj(t,r,n):Q9(t,r,n)}function LB(t,e,r){return rI(t,r)}function jB(t,e,r){return e.slice(-4)===".bin"?_9(t,r):v9(t,r)}function VB(t,e,r){return e.slice(-4)===".bin"?Lj(t,r):Dj(t,r)}function UB(t,e,r){return e.slice(-4)===".bin"?Rj(t):Ij(t)}function BB(t,e,r,n){return r.slice(-4)===".bin"?Nj(t,e,r,n):void 0}function zB(t,e,r){return e.slice(-4)===".bin"?Sj(t,e,r):Aj(t,e,r)}var vI=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,xI=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Hn(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(vI),i,a,o,l;if(s)for(l=0;l!=s.length;++l)i=s[l].match(xI),(a=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),n[o]=i[2].slice(1,i[2].length-1));return n}function $B(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(vI),s,i,a,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(xI),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(i+1),r[a]=s[2].slice(1,s[2].length-1));return r}var Nc;function HB(t,e){var r=Nc[t]||it(t);return r==="General"?qa(e):Vn(r,e)}function WB(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Nt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=dr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[it(e)]=s}function GB(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||lo[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=lu(t.v):t.w=qa(t.v):t.w=HB(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=Nc[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Sl(n)){var s=Ra(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function KB(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=W9[n.Pattern]||n.Pattern)}t[e.ID]=e}function qB(t,e,r,n,s,i,a,o,l,c){var u="General",h=n.StyleID,d={};c=c||{};var m=[],v=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);i[h]!==void 0&&(i[h].nf&&(u=i[h].nf),i[h].Interior&&m.push(i[h].Interior),!!i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Nt(t);break;case"String":n.t="s",n.r=nw(it(t)),n.v=t.indexOf("<")>-1?it(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(dr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=it(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=bA[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=nw(e||t));break}if(GB(n,u,c),c.cellFormula!==!1)if(n.Formula){var g=it(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=Xo(g,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Xo("RC:RC",s):n.ArrayRange&&(n.F=Xo(n.ArrayRange,s),l.push([Ut(n.F),n.F]))}else for(v=0;v<l.length;++v)s.r>=l[v][0].s.r&&s.r<=l[v][0].e.r&&s.c>=l[v][0].s.c&&s.c<=l[v][0].e.c&&(n.F=l[v][1]);c.cellStyles&&(m.forEach(function(y){!d.patternType&&y.patternType&&(d.patternType=y.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function XB(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function rp(t,e){var r=e||{};aA();var n=sc(Zv(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Et(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var a=Er(r);return a.type="string",fu.to_workbook(n,a)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Tt){s.indexOf("<"+Tt)>=0&&(i=!0)}),i)return s7(n,r);Nc={"General Number":"General","General Date":ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ze[15],"Short Date":ze[14],"Long Time":ze[19],"Medium Time":ze[18],"Short Time":ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ze[2],Standard:ze[4],Percent:ze[10],Scientific:ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},h=[],d=r.dense?[]:{},m="",v={},g={},y=Hn('<Data ss:Type="String">'),S=0,k=0,w=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},B={},V={},x="",E=0,T=[],I={},P={},N=0,R=[],se=[],ae={},fe=[],ge,oe=!1,K=[],he=[],we={},U=0,q=0,Y={Sheets:[],WBProps:{date1904:!1}},G={};uu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var le="";o=uu.exec(n);)switch(o[3]=(le=o[3]).toLowerCase()){case"data":if(le=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?qB(n.slice(S,o.index),x,y,l[l.length-1][0]=="comment"?ae:v,{c:k,r:w},B,fe[k],g,K,r):(x="",y=Hn(o[0]),S=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(se.length>0&&(v.c=se),(!r.sheetRows||r.sheetRows>w)&&v.v!==void 0&&(r.dense?(d[w]||(d[w]=[]),d[w][k]=v):d[nr(k)+Tr(w)]=v),v.HRef&&(v.l={Target:it(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(U=k+(parseInt(v.MergeAcross,10)|0),q=w+(parseInt(v.MergeDown,10)|0),T.push({s:{c:k,r:w},e:{c:U,r:q}})),!r.sheetStubs)v.MergeAcross?k=U+1:++k;else if(v.MergeAcross||v.MergeDown){for(var xe=k;xe<=U;++xe)for(var Re=w;Re<=q;++Re)(xe>k||Re>w)&&(r.dense?(d[Re]||(d[Re]=[]),d[Re][xe]={t:"z"}):d[nr(xe)+Tr(Re)]={t:"z"});k=U+1}else++k;else v=$B(o[0]),v.Index&&(k=+v.Index-1),k<F.s.c&&(F.s.c=k),k>F.e.c&&(F.e.c=k),o[0].slice(-2)==="/>"&&++k,se=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<F.s.r&&(F.s.r=w),w>F.e.r&&(F.e.r=w),o[0].slice(-2)==="/>"&&(g=Hn(o[0]),g.Index&&(w=+g.Index-1)),k=0,++w):(g=Hn(o[0]),g.Index&&(w=+g.Index-1),we={},(g.AutoFitHeight=="0"||g.Height)&&(we.hpx=parseInt(g.Height,10),we.hpt=tI(we.hpx),he[w]=we),g.Hidden=="1"&&(we.hidden=!0,he[w]=we));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));h.push(m),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(d["!ref"]=tt(F),r.sheetRows&&r.sheetRows<=F.e.r&&(d["!fullref"]=d["!ref"],F.e.r=r.sheetRows-1,d["!ref"]=tt(F))),T.length&&(d["!merges"]=T),fe.length>0&&(d["!cols"]=fe),he.length>0&&(d["!rows"]=he),u[m]=d}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=k=0,l.push([o[3],!1]),c=Hn(o[0]),m=it(c.Name),d=r.dense?[]:{},T=[],K=[],he=[],G={name:m,Hidden:0},Y.Sheets.push(G);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),fe=[],oe=!1}break;case"style":o[1]==="/"?KB(B,V,r):V=Hn(o[0]);break;case"numberformat":V.nf=it(Hn(o[0]).Format||"General"),Nc[V.nf]&&(V.nf=Nc[V.nf]);for(var Te=0;Te!=392&&ze[Te]!=V.nf;++Te);if(Te==392){for(Te=57;Te!=392;++Te)if(ze[Te]==null){Oa(V.nf,Te);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ge=Hn(o[0]),ge.Hidden&&(ge.hidden=!0,delete ge.Hidden),ge.Width&&(ge.wpx=parseInt(ge.Width,10)),!oe&&ge.wpx>10){oe=!0,Gr=ZA;for(var ve=0;ve<fe.length;++ve)fe[ve]&&gl(fe[ve])}oe&&gl(ge),fe[ge.Index-1||fe.length]=ge;for(var $e=0;$e<+ge.Span;++$e)fe[fe.length]=Er(ge);break;case"namedrange":if(o[1]==="/")break;Y.Names||(Y.Names=[]);var z=Oe(o[0]),at={Name:z.Name,Ref:Xo(z.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(at.Sheet=Y.Sheets.length-1),Y.Names.push(at);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?x+=n.slice(E,o.index):E=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;V.Interior=Hn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?D8(I,le,n.slice(N,o.index)):N=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));XB(ae),se.push(ae)}else l.push([o[3],!1]),c=Hn(o[0]),ae={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var We=Hn(o[0]);d["!autofilter"]={ref:Xo(We.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Bw(n,r);var rt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:rt=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:rt=!1}break;case"excelworkbook":switch(o[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:rt=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:rt=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(N,o.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else N=o.index+o[0].length;break;case"header":d["!margins"]||Rc(d["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(d["!margins"].header=+Oe(o[0]).Margin);break;case"footer":d["!margins"]||Rc(d["!margins"]={},"xlml"),isNaN(+Oe(o[0]).Margin)||(d["!margins"].footer=+Oe(o[0]).Margin);break;case"pagemargins":var be=Oe(o[0]);d["!margins"]||Rc(d["!margins"]={},"xlml"),isNaN(+be.Top)||(d["!margins"].top=+be.Top),isNaN(+be.Left)||(d["!margins"].left=+be.Left),isNaN(+be.Right)||(d["!margins"].right=+be.Right),isNaN(+be.Bottom)||(d["!margins"].bottom=+be.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:rt=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:rt=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:rt=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:rt=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:rt=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:rt=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:rt=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:rt=!1}break;case"smarttags":break;default:rt=!1;break}if(rt||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?WB(P,le,R,n.slice(N,o.index)):(R=o,N=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Ae={};return!r.bookSheets&&!r.bookProps&&(Ae.Sheets=u),Ae.SheetNames=h,Ae.Workbook=Y,Ae.SSF=Er(ze),Ae.Props=I,Ae.Custprops=P,Ae}function Fm(t,e){switch(px(e=e||{}),e.type||"base64"){case"base64":return rp(En(t),e);case"binary":case"buffer":case"file":return rp(t,e);case"array":return rp(io(t),e)}}function YB(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=u8(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=f8(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var QB=[60,1084,2066,2165,2175];function JB(t,e,r,n,s){var i=n,a=[],o=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}a.push(o),r.l+=i;for(var l=Qs(r,r.l),c=bm[l],u=0;c!=null&&QB.indexOf(l)>-1;)i=Qs(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+i),a.push(o),r.l+=4+i,c=bm[l=Qs(r,r.l)];var h=Fi(a);xr(h,0);var d=0;h.lens=[];for(var m=0;m<a.length;++m)h.lens.push(d),d+=a[m].length;if(h.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+n;return e.f(h,h.length,s)}function ds(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ze[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||lo[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=lu(t.v):t.w=qa(t.v):t.w=Vn(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&Sl(ze[n]||String(n))){var s=Ra(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function bf(t,e,r){return{v:t,ixfe:e,t:r}}function ZB(t,e){var r={opts:{}},n={},s=e.dense?[]:{},i={},a={},o=null,l=[],c="",u={},h,d="",m,v,g,y,S={},k=[],w,F,B=[],V=[],x={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},T=function(je){return je<8?Ma[je]:je<64&&V[je-8]||Ma[je]},I=function(je,xt,Wt){var ut=xt.XF.data;if(!(!ut||!ut.patternType||!Wt||!Wt.cellStyles)){xt.s={},xt.s.patternType=ut.patternType;var hn;(hn=hu(T(ut.icvFore)))&&(xt.s.fgColor={rgb:hn}),(hn=hu(T(ut.icvBack)))&&(xt.s.bgColor={rgb:hn})}},P=function(je,xt,Wt){if(!(we>1)&&!(Wt.sheetRows&&je.r>=Wt.sheetRows)){if(Wt.cellStyles&&xt.XF&&xt.XF.data&&I(je,xt,Wt),delete xt.ixfe,delete xt.XF,h=je,d=Ue(je),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),je.r<a.s.r&&(a.s.r=je.r),je.c<a.s.c&&(a.s.c=je.c),je.r+1>a.e.r&&(a.e.r=je.r+1),je.c+1>a.e.c&&(a.e.c=je.c+1),Wt.cellFormula&&xt.f){for(var ut=0;ut<k.length;++ut)if(!(k[ut][0].s.c>je.c||k[ut][0].s.r>je.r)&&!(k[ut][0].e.c<je.c||k[ut][0].e.r<je.r)){xt.F=tt(k[ut][0]),(k[ut][0].s.c!=je.c||k[ut][0].s.r!=je.r)&&delete xt.f,xt.f&&(xt.f=""+br(k[ut][1],a,je,K,N));break}}Wt.dense?(s[je.r]||(s[je.r]=[]),s[je.r][je.c]=xt):s[d]=xt}},N={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(N.password=e.password);var R,se=[],ae=[],fe=[],ge=[],oe=!1,K=[];K.SheetNames=N.snames,K.sharedf=N.sharedf,K.arrayf=N.arrayf,K.names=[],K.XTI=[];var he=0,we=0,U=0,q=[],Y=[],G;N.codepage=1200,Zn(1200);for(var le=!1;t.l<t.length-1;){var xe=t.l,Re=t.read_shift(2);if(Re===0&&he===10)break;var Te=t.l===t.length?0:t.read_shift(2),ve=bm[Re];if(ve&&ve.f){if(e.bookSheets&&he===133&&Re!==133)break;if(he=Re,ve.r===2||ve.r==12){var $e=t.read_shift(2);if(Te-=2,!N.enc&&$e!==Re&&(($e&255)<<8|$e>>8)!==Re)throw new Error("rt mismatch: "+$e+"!="+Re);ve.r==12&&(t.l+=10,Te-=10)}var z={};if(Re===10?z=ve.f(t,Te,N):z=JB(Re,ve,t,Te,N),we==0&&[9,521,1033,2057].indexOf(he)===-1)continue;switch(Re){case 34:r.opts.Date1904=x.WBProps.date1904=z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(N.enc||(t.l=0),N.enc=z,!e.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:N.lastuser=z;break;case 66:var at=Number(z);switch(at){case 21010:at=1200;break;case 32768:at=1e4;break;case 32769:at=1252;break}Zn(N.codepage=at),le=!0;break;case 317:N.rrtabid=z;break;case 25:N.winlocked=z;break;case 439:r.opts.RefreshAll=z;break;case 12:r.opts.CalcCount=z;break;case 16:r.opts.CalcDelta=z;break;case 17:r.opts.CalcIter=z;break;case 13:r.opts.CalcMode=z;break;case 14:r.opts.CalcPrecision=z;break;case 95:r.opts.CalcSaveRecalc=z;break;case 15:N.CalcRefMode=z;break;case 2211:r.opts.FullCalc=z;break;case 129:z.fDialog&&(s["!type"]="dialog"),z.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),z.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:B.push(z);break;case 430:K.push([z]),K[K.length-1].XTI=[];break;case 35:case 547:K[K.length-1].push(z);break;case 24:case 536:G={Name:z.Name,Ref:br(z.rgce,a,null,K,N)},z.itab>0&&(G.Sheet=z.itab-1),K.names.push(G),K[0]||(K[0]=[],K[0].XTI=[]),K[K.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(Y[z.itab-1]={ref:tt(z.rgce[0][0][1][2])});break;case 22:N.ExternCount=z;break;case 23:K.length==0&&(K[0]=[],K[0].XTI=[]),K[K.length-1].XTI=K[K.length-1].XTI.concat(z),K.XTI=K.XTI.concat(z);break;case 2196:if(N.biff<8)break;G!=null&&(G.Comment=z[1]);break;case 18:s["!protect"]=z;break;case 19:z!==0&&N.WTF&&console.error("Password verifier: "+z);break;case 133:i[z.pos]=z,N.snames.push(z.name);break;case 10:{if(--we)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,s["!ref"]=tt(a),e.sheetRows&&e.sheetRows<=a.e.r){var We=a.e.r;a.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=tt(a),a.e.r=We}a.e.r++,a.e.c++}se.length>0&&(s["!merges"]=se),ae.length>0&&(s["!objects"]=ae),fe.length>0&&(s["!cols"]=fe),ge.length>0&&(s["!rows"]=ge),x.Sheets.push(E)}c===""?u=s:n[c]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(N.biff===8&&(N.biff={9:2,521:3,1033:4}[Re]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),N.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(N.biff=5,le=!0,Zn(N.codepage=28591)),N.biff==8&&z.BIFFVer==0&&z.dt==16&&(N.biff=2),we++)break;if(s=e.dense?[]:{},N.biff<8&&!le&&(le=!0,Zn(N.codepage=e.codepage||1252)),N.biff<5||z.BIFFVer==0&&z.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var rt={pos:t.l-Te,name:c};i[rt.pos]=rt,N.snames.push(c)}else c=(i[xe]||{name:""}).name;z.dt==32&&(s["!type"]="chart"),z.dt==64&&(s["!type"]="macro"),se=[],ae=[],N.arrayf=k=[],fe=[],ge=[],oe=!1,E={Hidden:(i[xe]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[z.r]||[])[z.c]:s[Ue({c:z.c,r:z.r})])&&++z.c,w={ixfe:z.ixfe,XF:B[z.ixfe]||{},v:z.val,t:"n"},U>0&&(w.z=q[w.ixfe>>8&63]),ds(w,e,r.opts.Date1904),P({c:z.c,r:z.r},w,e);break;case 5:case 517:w={ixfe:z.ixfe,XF:B[z.ixfe],v:z.val,t:z.t},U>0&&(w.z=q[w.ixfe>>8&63]),ds(w,e,r.opts.Date1904),P({c:z.c,r:z.r},w,e);break;case 638:w={ixfe:z.ixfe,XF:B[z.ixfe],v:z.rknum,t:"n"},U>0&&(w.z=q[w.ixfe>>8&63]),ds(w,e,r.opts.Date1904),P({c:z.c,r:z.r},w,e);break;case 189:for(var be=z.c;be<=z.C;++be){var Ae=z.rkrec[be-z.c][0];w={ixfe:Ae,XF:B[Ae],v:z.rkrec[be-z.c][1],t:"n"},U>0&&(w.z=q[w.ixfe>>8&63]),ds(w,e,r.opts.Date1904),P({c:be,r:z.r},w,e)}break;case 6:case 518:case 1030:{if(z.val=="String"){o=z;break}if(w=bf(z.val,z.cell.ixfe,z.tt),w.XF=B[w.ixfe],e.cellFormula){var Tt=z.formula;if(Tt&&Tt[0]&&Tt[0][0]&&Tt[0][0][0]=="PtgExp"){var or=Tt[0][0][1][0],Ar=Tt[0][0][1][1],en=Ue({r:or,c:Ar});S[en]?w.f=""+br(z.formula,a,z.cell,K,N):w.F=((e.dense?(s[or]||[])[Ar]:s[en])||{}).F}else w.f=""+br(z.formula,a,z.cell,K,N)}U>0&&(w.z=q[w.ixfe>>8&63]),ds(w,e,r.opts.Date1904),P(z.cell,w,e),o=z}break;case 7:case 519:if(o)o.val=z,w=bf(z,o.cell.ixfe,"s"),w.XF=B[w.ixfe],e.cellFormula&&(w.f=""+br(o.formula,a,o.cell,K,N)),U>0&&(w.z=q[w.ixfe>>8&63]),ds(w,e,r.opts.Date1904),P(o.cell,w,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(z);var Os=Ue(z[0].s);if(m=e.dense?(s[z[0].s.r]||[])[z[0].s.c]:s[Os],e.cellFormula&&m){if(!o||!Os||!m)break;m.f=""+br(z[1],a,z[0],K,N),m.F=tt(z[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;S[Ue(o.cell)]=z[0],m=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Ue(o.cell)],(m||{}).f=""+br(z[0],a,h,K,N)}}break;case 253:w=bf(l[z.isst].t,z.ixfe,"s"),l[z.isst].h&&(w.h=l[z.isst].h),w.XF=B[w.ixfe],U>0&&(w.z=q[w.ixfe>>8&63]),ds(w,e,r.opts.Date1904),P({c:z.c,r:z.r},w,e);break;case 513:e.sheetStubs&&(w={ixfe:z.ixfe,XF:B[z.ixfe],t:"z"},U>0&&(w.z=q[w.ixfe>>8&63]),ds(w,e,r.opts.Date1904),P({c:z.c,r:z.r},w,e));break;case 190:if(e.sheetStubs)for(var tn=z.c;tn<=z.C;++tn){var kt=z.ixfe[tn-z.c];w={ixfe:kt,XF:B[kt],t:"z"},U>0&&(w.z=q[w.ixfe>>8&63]),ds(w,e,r.opts.Date1904),P({c:tn,r:z.r},w,e)}break;case 214:case 516:case 4:w=bf(z.val,z.ixfe,"s"),w.XF=B[w.ixfe],U>0&&(w.z=q[w.ixfe>>8&63]),ds(w,e,r.opts.Date1904),P({c:z.c,r:z.r},w,e);break;case 0:case 512:we===1&&(a=z);break;case 252:l=z;break;case 1054:if(N.biff==4){q[U++]=z[1];for(var lr=0;lr<U+163&&ze[lr]!=z[1];++lr);lr>=163&&Oa(z[1],U+163)}else Oa(z[1],z[0]);break;case 30:{q[U++]=z;for(var vt=0;vt<U+163&&ze[vt]!=z;++vt);vt>=163&&Oa(z,U+163)}break;case 229:se=se.concat(z);break;case 93:ae[z.cmo[0]]=N.lastobj=z;break;case 438:N.lastobj.TxO=z;break;case 127:N.lastobj.ImData=z;break;case 440:for(y=z[0].s.r;y<=z[0].e.r;++y)for(g=z[0].s.c;g<=z[0].e.c;++g)m=e.dense?(s[y]||[])[g]:s[Ue({c:g,r:y})],m&&(m.l=z[1]);break;case 2048:for(y=z[0].s.r;y<=z[0].e.r;++y)for(g=z[0].s.c;g<=z[0].e.c;++g)m=e.dense?(s[y]||[])[g]:s[Ue({c:g,r:y})],m&&m.l&&(m.l.Tooltip=z[1]);break;case 28:{if(N.biff<=5&&N.biff>=2)break;m=e.dense?(s[z[0].r]||[])[z[0].c]:s[Ue(z[0])];var St=ae[z[2]];m||(e.dense?(s[z[0].r]||(s[z[0].r]=[]),m=s[z[0].r][z[0].c]={t:"z"}):m=s[Ue(z[0])]={t:"z"},a.e.r=Math.max(a.e.r,z[0].r),a.s.r=Math.min(a.s.r,z[0].r),a.e.c=Math.max(a.e.c,z[0].c),a.s.c=Math.min(a.s.c,z[0].c)),m.c||(m.c=[]),v={a:z[1],t:St.TxO.t},m.c.push(v)}break;case 2173:wj(B[z.ixfe],z.ext);break;case 125:{if(!N.cellStyles)break;for(;z.e>=z.s;)fe[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},oe||(oe=!0,cx(z.w/256)),gl(fe[z.e+1])}break;case 520:{var ht={};z.level!=null&&(ge[z.r]=ht,ht.level=z.level),z.hidden&&(ge[z.r]=ht,ht.hidden=!0),z.hpt&&(ge[z.r]=ht,ht.hpt=z.hpt,ht.hpx=du(z.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Rc(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Re]]=z;break;case 161:s["!margins"]||Rc(s["!margins"]={}),s["!margins"].header=z.header,s["!margins"].footer=z.footer;break;case 574:z.RTL&&(x.Views[0].RTL=!0);break;case 146:V=z;break;case 2198:R=z;break;case 140:F=z;break;case 442:c?E.CodeName=z||E.name:x.WBProps.CodeName=z||"ThisWorkbook";break}}else ve||console.error("Missing Info for XLS Record 0x"+Re.toString(16)),t.l+=Te}return r.SheetNames=Cs(i).sort(function(Dt,je){return Number(Dt)-Number(je)}).map(function(Dt){return i[Dt].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&Y.forEach(function(Dt,je){r.Sheets[r.SheetNames[je]]["!autofilter"]=Dt}),r.Strings=l,r.SSF=Er(ze),N.enc&&(r.Encryption=N.enc),R&&(r.Themes=R),r.Metadata={},F!==void 0&&(r.Metadata.Country=F),K.names.length>0&&(x.Names=K.names),r.Workbook=x,r}var Mw={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function e7(t,e,r){var n=et.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=_w(n,v8,Mw.DSI);for(var i in s)e[i]=s[i]}catch(c){if(r.WTF)throw c}var a=et.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=_w(a,x8,Mw.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(MA(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function _I(t,e){e||(e={}),px(e),qS(),e.codepage&&Gv(e.codepage);var r,n;if(t.FullPaths){if(et.find(t,"/encryption"))throw new Error("File is password-protected");r=et.find(t,"!CompObj"),n=et.find(t,"/Workbook")||et.find(t,"/Book")}else{switch(e.type){case"base64":t=Qn(En(t));break;case"binary":t=Qn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}xr(t,0),n={content:t}}var s,i;if(r&&YB(r),e.bookProps&&!e.bookSheets)s={};else{var a=Qe?"buffer":"array";if(n&&n.content)s=ZB(n.content,e);else if((i=et.find(t,"PerfectOffice_MAIN"))&&i.content)s=Ic.to_workbook(i.content,(e.type=a,e));else if((i=et.find(t,"NativeContent_MAIN"))&&i.content)s=Ic.to_workbook(i.content,(e.type=a,e));else throw(i=et.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&et.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Vj(t))}var o={};return t.FullPaths&&e7(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}var od={0:{f:OU},1:{f:VU},2:{f:qU},3:{f:$U},4:{f:BU},5:{f:KU},6:{f:QU},7:{f:WU},8:{f:rB},9:{f:tB},10:{f:ZU},11:{f:eB},12:{f:UU},13:{f:XU},14:{f:HU},15:{f:zU},16:{f:pI},17:{f:JU},18:{f:GU},19:{f:nx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:RB},40:{},42:{},43:{f:Z9},44:{f:J9},45:{f:ej},46:{f:rj},47:{f:tj},48:{},49:{f:n8},50:{},51:{f:Tj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:qA},62:{f:YU},63:{f:Cj},64:{f:fB},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:zr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:uB},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:jU},148:{f:MU,p:16},151:{f:iB},152:{},153:{f:IB},154:{},155:{},156:{f:AB},157:{},158:{},159:{T:1,f:x9},160:{T:-1},161:{T:1,f:oo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:nB},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Ej},336:{T:-1},337:{f:kj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Rm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:KA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:aB},427:{f:oB},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:cB},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:LU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:sB},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Rm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Mj},633:{T:1},634:{T:-1},635:{T:1,f:Oj},636:{T:-1},637:{f:i8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:vB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:hB},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},bm={6:{f:ep},10:{f:ki},12:{f:Xt},13:{f:Xt},14:{f:Bt},15:{f:Bt},16:{f:Lr},17:{f:Bt},18:{f:Bt},19:{f:Xt},20:{f:Tw},21:{f:Tw},23:{f:KA},24:{f:Sw},25:{f:Bt},26:{},27:{},28:{f:F5},29:{},34:{f:Bt},35:{f:kw},38:{f:Lr},39:{f:Lr},40:{f:Lr},41:{f:Lr},42:{f:Bt},43:{f:Bt},47:{f:L9},49:{f:p5},51:{f:Xt},60:{},61:{f:f5},64:{f:Bt},65:{f:d5},66:{f:Xt},77:{},80:{},81:{},82:{},85:{f:Xt},89:{},90:{},91:{},92:{f:n5},93:{f:O5},94:{},95:{f:Bt},96:{},97:{},99:{f:Bt},125:{f:qA},128:{f:k5},129:{f:s5},130:{f:Xt},131:{f:Bt},132:{f:Bt},133:{f:i5},134:{},140:{f:B5},141:{f:Xt},144:{},146:{f:$5},151:{},152:{},153:{},154:{},155:{},156:{f:Xt},157:{},158:{},160:{f:q5},161:{f:W5},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:y5},190:{f:w5},193:{f:ki},197:{},198:{},199:{},200:{},201:{},202:{f:Bt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Xt},220:{},221:{f:Bt},222:{},224:{f:T5},225:{f:r5},226:{f:ki},227:{},229:{f:b5},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:a5},253:{f:m5},255:{f:o5},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:BA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Bt},353:{f:ki},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:A5},431:{f:Bt},432:{},433:{},434:{},437:{},438:{f:j5},439:{f:Bt},440:{f:V5},441:{},442:{f:Vu},443:{},444:{f:Xt},445:{},446:{},448:{f:ki},449:{f:u5,r:2},450:{f:ki},512:{f:ww},513:{f:K5},515:{f:S5},516:{f:g5},517:{f:Ew},519:{f:X5},520:{f:l5},523:{},545:{f:Aw},549:{f:yw},566:{},574:{f:h5},638:{f:_5},659:{},1048:{},1054:{f:v5},1084:{},1212:{f:N5},2048:{f:U5},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Pf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ki},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:H5,r:12},2173:{f:yj,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Bt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:R5,r:12},2197:{},2198:{f:pj,r:12},2199:{},2200:{},2201:{},2202:{f:P5,r:12},2203:{f:ki},2204:{},2205:{},2206:{},2207:{},2211:{f:c5},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Xt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:G5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:z5},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ww},1:{},2:{f:Z5},3:{f:J5},4:{f:Q5},5:{f:Ew},7:{f:e9},8:{},9:{f:Pf},11:{},22:{f:Xt},30:{f:x5},31:{},32:{},33:{f:Aw},36:{},37:{f:yw},50:{f:t9},62:{},52:{},67:{},68:{f:Xt},69:{},86:{},126:{},127:{f:Y5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:r9},223:{},234:{},354:{},421:{},518:{f:ep},521:{f:Pf},536:{f:Sw},547:{f:kw},561:{},579:{},1030:{f:ep},1033:{f:Pf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Wn(t,e,r,n){var s=e;if(!isNaN(s)){var i=(r||[]).length||0,a=t.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&CA(r)&&t.push(r)}}function Lw(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),a=s.index,o=i&&i.index||t.length,l=S6(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,d=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(a=0;a<l.length;++a){var g=l[a].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(y!="<td"&&y!="<th")){var S=g.split(/<\/t[dh]>/i);for(o=0;o<S.length;++o){var k=S[o].trim();if(k.match(/<t[dh]/i)){for(var w=k,F=0;w.charAt(0)=="<"&&(F=w.indexOf(">"))>-1;)w=w.slice(F+1);for(var B=0;B<v.length;++B){var V=v[B];V.s.c==u&&V.s.r<c&&c<=V.e.r&&(u=V.e.c+1,B=-1)}var x=Oe(k.slice(0,k.indexOf(">")));d=x.colspan?+x.colspan:1,((h=+x.rowspan)>1||d>1)&&v.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+d-1}});var E=x.t||x["data-t"]||"";if(!w.length){u+=d;continue}if(w=mA(w),m.s.r>c&&(m.s.r=c),m.e.r<c&&(m.e.r=c),m.s.c>u&&(m.s.c=u),m.e.c<u&&(m.e.c=u),!w.length){u+=d;continue}var T={t:"s",v:w};r.raw||!w.trim().length||E=="s"||(w==="TRUE"?T={t:"b",v:!0}:w==="FALSE"?T={t:"b",v:!1}:isNaN(ss(w))?isNaN(ml(w).getDate())||(T={t:"d",v:dr(w)},r.cellDates||(T={t:"n",v:Qr(T.v)}),T.z=r.dateNF||ze[14]):T={t:"n",v:ss(w)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=T):n[Ue({r:c,c:u})]=T,u+=d}}}}return n["!ref"]=tt(m),v.length&&(n["!merges"]=v),n}function t7(t,e,r,n){for(var s=t["!merges"]||[],i=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>a)&&!(s[c].e.r<r||s[c].e.c<a)){if(s[c].s.r<r||s[c].s.c<a){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var u=Ue({r,c:a}),h=n.dense?(t[r]||[])[a]:t[u],d=h&&h.v!=null&&(h.h||Jv(h.w||(pi(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),m.id=(n.id||"sjs")+"-"+u,i.push(B6("td",d,m))}}var v="<tr>";return v+i.join("")+"</tr>"}var r7='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',n7="</body></html>";function s7(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return da(Lw(r[0],e),e);var n=gx();return r.forEach(function(s,i){vx(n,Lw(s,e),"Sheet"+(i+1))}),n}function i7(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function a7(t,e){var r=e||{},n=r.header!=null?r.header:r7,s=r.footer!=null?r.footer:n7,i=[n],a=Al(t["!ref"]);r.dense=Array.isArray(t),i.push(i7(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(t7(t,a,o,r));return i.push("</table>"+s),i.join("")}function yI(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?Kr(n.origin):n.origin;s=a.r,i=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var u=Al(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var h=[],d=0,m=t["!rows"]||(t["!rows"]=[]),v=0,g=0,y=0,S=0,k=0,w=0;for(t["!cols"]||(t["!cols"]=[]);v<o.length&&g<l;++v){var F=o[v];if(jw(F)){if(n.display)continue;m[g]={hidden:!0}}var B=F.children;for(y=S=0;y<B.length;++y){var V=B[y];if(!(n.display&&jw(V))){var x=V.hasAttribute("data-v")?V.getAttribute("data-v"):V.hasAttribute("v")?V.getAttribute("v"):mA(V.innerHTML),E=V.getAttribute("data-z")||V.getAttribute("z");for(d=0;d<h.length;++d){var T=h[d];T.s.c==S+i&&T.s.r<g+s&&g+s<=T.e.r&&(S=T.e.c+1-i,d=-1)}w=+V.getAttribute("colspan")||1,((k=+V.getAttribute("rowspan")||1)>1||w>1)&&h.push({s:{r:g+s,c:S+i},e:{r:g+s+(k||1)-1,c:S+i+(w||1)-1}});var I={t:"s",v:x},P=V.getAttribute("data-t")||V.getAttribute("t")||"";x!=null&&(x.length==0?I.t=P||"z":n.raw||x.trim().length==0||P=="s"||(x==="TRUE"?I={t:"b",v:!0}:x==="FALSE"?I={t:"b",v:!1}:isNaN(ss(x))?isNaN(ml(x).getDate())||(I={t:"d",v:dr(x)},n.cellDates||(I={t:"n",v:Qr(I.v)}),I.z=n.dateNF||ze[14]):I={t:"n",v:ss(x)})),I.z===void 0&&E!=null&&(I.z=E);var N="",R=V.getElementsByTagName("A");if(R&&R.length)for(var se=0;se<R.length&&!(R[se].hasAttribute("href")&&(N=R[se].getAttribute("href"),N.charAt(0)!="#"));++se);N&&N.charAt(0)!="#"&&(I.l={Target:N}),n.dense?(t[g+s]||(t[g+s]=[]),t[g+s][S+i]=I):t[Ue({c:S+i,r:g+s})]=I,c.e.c<S+i&&(c.e.c=S+i),S+=w}}++g}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,g-1+s),t["!ref"]=tt(c),g>=l&&(t["!fullref"]=tt((c.e.r=o.length-v+g-1+s,c))),t}function wI(t,e){var r=e||{},n=r.dense?[]:{};return yI(n,t,e)}function o7(t,e){return da(wI(t,e),e)}function jw(t){var e="",r=l7(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function l7(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function c7(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=it(e.replace(/<[^>]*>/g,""));return[r]}var Vw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function EI(t,e){var r=e||{},n=Zv(t),s=[],i,a,o={name:""},l="",c=0,u,h,d={},m=[],v=r.dense?[]:{},g,y,S={value:""},k="",w=0,F=[],B=-1,V=-1,x={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,T={},I=[],P={},N=0,R=0,se=[],ae=1,fe=1,ge=[],oe={Names:[]},K={},he=["",""],we=[],U={},q="",Y=0,G=!1,le=!1,xe=0;for(uu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=uu.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(x.e.c>=x.s.c&&x.e.r>=x.s.r?v["!ref"]=tt(x):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=x.e.r&&(v["!fullref"]=v["!ref"],x.e.r=r.sheetRows-1,v["!ref"]=tt(x)),I.length&&(v["!merges"]=I),se.length&&(v["!rows"]=se),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),m.push(u.name),d[u.name]=v,le=!1):g[0].charAt(g[0].length-2)!=="/"&&(u=Oe(g[0],!1),B=V=-1,x.s.r=x.s.c=1e7,x.e.r=x.e.c=0,v=r.dense?[]:{},I=[],se=[],le=!0);break;case"table-row-group":g[1]==="/"?--E:++E;break;case"table-row":case"":if(g[1]==="/"){B+=ae,ae=1;break}if(h=Oe(g[0],!1),h.?B=h.-1:B==-1&&(B=0),ae=+h["number-rows-repeated"]||1,ae<10)for(xe=0;xe<ae;++xe)E>0&&(se[B+xe]={level:E});V=-1;break;case"covered-table-cell":g[1]!=="/"&&++V,r.sheetStubs&&(r.dense?(v[B]||(v[B]=[]),v[B][V]={t:"z"}):v[Ue({r:B,c:V})]={t:"z"}),k="",F=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++V,S=Oe(g[0],!1),fe=parseInt(S["number-columns-repeated"]||"1",10),y={t:"z",v:null},S.formula&&r.cellFormula!=!1&&(y.f=Fw(it(S.formula))),(S.||S["value-type"])=="string"&&(y.t="s",y.v=it(S["string-value"]||""),r.dense?(v[B]||(v[B]=[]),v[B][V]=y):v[Ue({r:B,c:V})]=y),V+=fe-1;else if(g[1]!=="/"){++V,k="",w=0,F=[],fe=1;var Re=ae?B+ae-1:B;if(V>x.e.c&&(x.e.c=V),V<x.s.c&&(x.s.c=V),B<x.s.r&&(x.s.r=B),Re>x.e.r&&(x.e.r=Re),S=Oe(g[0],!1),we=[],U={},y={t:S.||S["value-type"],v:null},r.cellFormula)if(S.formula&&(S.formula=it(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(N=parseInt(S["number-matrix-rows-spanned"],10)||0,R=parseInt(S["number-matrix-columns-spanned"],10)||0,P={s:{r:B,c:V},e:{r:B+N-1,c:V+R-1}},y.F=tt(P),ge.push([P,y.F])),S.formula)y.f=Fw(S.formula);else for(xe=0;xe<ge.length;++xe)B>=ge[xe][0].s.r&&B<=ge[xe][0].e.r&&V>=ge[xe][0].s.c&&V<=ge[xe][0].e.c&&(y.F=ge[xe][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(N=parseInt(S["number-rows-spanned"],10)||0,R=parseInt(S["number-columns-spanned"],10)||0,P={s:{r:B,c:V},e:{r:B+N-1,c:V+R-1}},I.push(P)),S["number-columns-repeated"]&&(fe=parseInt(S["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Nt(S["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(S.value);break;case"percentage":y.t="n",y.v=parseFloat(S.value);break;case"currency":y.t="n",y.v=parseFloat(S.value);break;case"date":y.t="d",y.v=dr(S["date-value"]),r.cellDates||(y.t="n",y.v=Qr(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=E6(S["time-value"])/86400,r.cellDates&&(y.t="d",y.v=Jd(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(S.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",S["string-value"]!=null&&(k=it(S["string-value"]),F=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(G=!1,y.t==="s"&&(y.v=k||"",F.length&&(y.R=F),G=w==0),K.Target&&(y.l=K),we.length>0&&(y.c=we,we=[]),k&&r.cellText!==!1&&(y.w=k),G&&(y.t="z",delete y.v),(!G||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=B))for(var Te=0;Te<ae;++Te){if(fe=parseInt(S["number-columns-repeated"]||"1",10),r.dense)for(v[B+Te]||(v[B+Te]=[]),v[B+Te][V]=Te==0?y:Er(y);--fe>0;)v[B+Te][V+fe]=Er(y);else for(v[Ue({r:B+Te,c:V})]=y;--fe>0;)v[Ue({r:B+Te,c:V+fe})]=Er(y);x.e.c<=V&&(x.e.c=V)}fe=parseInt(S["number-columns-repeated"]||"1",10),V+=fe-1,fe=0,y={},k="",F=[]}K={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i;U.t=k,F.length&&(U.R=F),U.a=q,we.push(U)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);q="",Y=0,k="",w=0,F=[];break;case"creator":g[1]==="/"?q=n.slice(Y,g.index):Y=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);k="",w=0,F=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(T[o.name]=l,(i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&(l="",o=Oe(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":a=Oe(g[0],!1),l+=Vw[g[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":a=Oe(g[0],!1),l+=Vw[g[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,g.index);break}else c=g.index+g[0].length;break;case"named-range":a=Oe(g[0],!1),he=tp(a["cell-range-address"]);var ve={Name:a.name,Ref:he[0]+"!"+he[1]};le&&(ve.Sheet=m.length),oe.Names.push(ve);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!S||!S["string-value"])){var $e=c7(n.slice(w,g.index));k=(k.length>0?k+`
`:"")+$e[0]}else Oe(g[0],!1),w=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{he=tp(Oe(g[0])["target-range-address"]),d[he[0]]["!autofilter"]={ref:he[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(K=Oe(g[0],!1),!K.href)break;K.Target=it(K.href),delete K.href,K.Target.charAt(0)=="#"&&K.Target.indexOf(".")>-1?(he=tp(K.Target.slice(1)),K.Target="#"+he[0]+"!"+he[1]):K.Target.match(/^\.\.[\\\/]/)&&(K.Target=K.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var z={Sheets:d,SheetNames:m,Workbook:oe};return r.bookSheets&&delete z.Sheets,z}function Uw(t,e){e=e||{},Nn(t,"META-INF/manifest.xml")&&S8(qt(t,"META-INF/manifest.xml"),e);var r=vn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=EI(Et(r),e);return Nn(t,"meta.xml")&&(n.Props=OA(qt(t,"meta.xml"))),n}function Bw(t,e){return EI(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function hx(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Om(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Et(io(t))}function Mm(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function zw(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function u7(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function pu(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function ar(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function jr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=pu(t,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=pu(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:i};e[s]==null?e[s]=[c]:e[s].push(c)}return e}function dx(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function f7(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=pu(t,n),i=jr(t.slice(n[0],n[0]+s));n[0]+=s;var a={id:ar(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=jr(o.data),c=ar(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=i[3])!=null&&e[0]&&(a.merge=ar(i[3][0].data)>>>0>0),r.push(a)}return r}function h7(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=pu(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(i==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,i==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Mm(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var u=Mm(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function d7(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(h7(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Mm(e)}function p7(t,e,r,n){var s=hx(t),i=s.getUint32(4,!0),a=(n>1?12:8)+zw(i&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);i&512&&(o=s.getUint32(a,!0),a+=4),a+=zw(i&(n>1?12288:4096))*4,i&16&&(l=s.getUint32(a,!0),a+=4),i&32&&(c=s.getFloat64(a,!0),a+=8),i&64&&(u.setTime(u.getTime()+s.getFloat64(a,!0)*1e3),a+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:e[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:e[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function m7(t,e,r){var n=hx(t),s=n.getUint32(8,!0),i=12,a=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);s&1&&(l=u7(t,i),i+=16),s&2&&(c=n.getFloat64(i,!0),i+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(o=n.getUint32(i,!0),i+=4),s&16&&(a=n.getUint32(i,!0),i+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:e[o]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return h}function g7(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return p7(t,e,r,t[0]);case 5:return m7(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Qi(t){var e=jr(t);return pu(e[1][0].data)}function $w(t,e){var r=jr(e.data),n=ar(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(a){var o=jr(a.data),l=ar(o[1][0].data)>>>0;switch(n){case 1:i[l]=Om(o[3][0].data);break;case 8:{var c=t[Qi(o[9][0].data)][0],u=jr(c.data),h=t[Qi(u[1][0].data)][0],d=ar(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var m=jr(h.data);i[l]=m[3].map(function(v){return Om(v.data)}).join("")}break}}),i}function v7(t,e){var r,n,s,i,a,o,l,c,u,h,d,m,v,g,y=jr(t),S=ar(y[1][0].data)>>>0,k=ar(y[2][0].data)>>>0,w=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&ar(y[8][0].data)>0||!1,F,B;if((i=(s=y[7])==null?void 0:s[0])!=null&&i.data&&e!=0)F=(o=(a=y[7])==null?void 0:a[0])==null?void 0:o.data,B=(c=(l=y[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(u=y[4])==null?void 0:u[0])!=null&&h.data&&e!=1)F=(m=(d=y[4])==null?void 0:d[0])==null?void 0:m.data,B=(g=(v=y[3])==null?void 0:v[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var V=w?4:1,x=hx(F),E=[],T=0;T<F.length/2;++T){var I=x.getUint16(T*2,!0);I<65535&&E.push([T,I])}if(E.length!=k)throw"Expected ".concat(k," cells, found ").concat(E.length);var P=[];for(T=0;T<E.length-1;++T)P[E[T][0]]=B.subarray(E[T][1]*V,E[T+1][1]*V);return E.length>=1&&(P[E[E.length-1][0]]=B.subarray(E[E.length-1][1]*V)),{R:S,cells:P}}function x7(t,e){var r,n=jr(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?ar(n[7][0].data)>>>0>0?1:0:-1,i=dx(n[5],function(a){return v7(a,s)});return{nrows:ar(n[4][0].data)>>>0,data:i.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function _7(t,e,r){var n,s=jr(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(ar(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(ar(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=tt(i);var a=jr(s[4][0].data),o=$w(t,t[Qi(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?$w(t,t[Qi(a[17][0].data)][0]):[],c=jr(a[3][0].data),u=0;c[1].forEach(function(h){var d=jr(h.data),m=t[Qi(d[2][0].data)][0],v=ar(m.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var g=x7(t,m);g.data.forEach(function(y,S){y.forEach(function(k,w){var F=Ue({r:u+S,c:w}),B=g7(k,o,l);B&&(r[F]=B)})}),u+=g.nrows})}function y7(t,e){var r=jr(e.data),n={"!ref":"A1"},s=t[Qi(r[2][0].data)],i=ar(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return _7(t,s[0],n),n}function w7(t,e){var r,n=jr(e.data),s={name:(r=n[1])!=null&&r[0]?Om(n[1][0].data):"",sheets:[]},i=dx(n[2],Qi);return i.forEach(function(a){t[a].forEach(function(o){var l=ar(o.meta[1][0].data);l==6e3&&s.sheets.push(y7(t,o))})}),s}function E7(t,e){var r=gx(),n=jr(e.data),s=dx(n[1],Qi);if(s.forEach(function(i){t[i].forEach(function(a){var o=ar(a.meta[1][0].data);if(o==2){var l=w7(t,a);l.sheets.forEach(function(c,u){vx(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function np(t){var e,r,n,s,i={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=d7(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=f7(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){i[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&ar(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||a.forEach(function(l){i[l].forEach(function(c){var u=ar(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return E7(i,o)}function T7(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function px(t){T7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function k7(t){return Mo.WS.indexOf(t)>-1?"sheet":t==Mo.CS?"chart":t==Mo.DS?"dialog":t==Mo.MS?"macro":t&&t.length?t:"sheet"}function S7(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,k7(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function A7(t,e,r,n,s,i,a,o,l,c,u,h){try{i[n]=Sc(vn(t,r,!0),e);var d=qt(t,e),m;switch(o){case"sheet":m=DB(d,e,s,l,i[n],c,u,h);break;case"chart":if(m=FB(d,e,s,l,i[n],c,u,h),!m||!m["!drawel"])break;var v=ac(m["!drawel"].Target,e),g=Nm(v),y=Pj(vn(t,v,!0),Sc(vn(t,g,!0),v)),S=ac(y,v),k=Nm(S);m=mB(vn(t,S,!0),S,l,Sc(vn(t,k,!0),S),c,m);break;case"macro":m=bB(d,e,s,l,i[n],c,u,h);break;case"dialog":m=OB(d,e,s,l,i[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var w=[];i&&i[n]&&Cs(i[n]).forEach(function(F){var B="";if(i[n][F].Type==Mo.CMNT){B=ac(i[n][F].Target,e);var V=VB(qt(t,B,!0),B,l);if(!V||!V.length)return;Cw(m,V,!1)}i[n][F].Type==Mo.TCMNT&&(B=ac(i[n][F].Target,e),w=w.concat(Fj(qt(t,B,!0),l)))}),w&&w.length&&Cw(m,w,!0,l.people||[])}catch(F){if(l.WTF)throw F}}function Cn(t){return t.charAt(0)=="/"?t.slice(1):t}function I7(t,e){if(aA(),e=e||{},px(e),Nn(t,"META-INF/manifest.xml")||Nn(t,"objectdata.xml"))return Uw(t,e);if(Nn(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof np<"u"){if(t.FileIndex)return np(t);var r=et.utils.cfb_new();return tw(t).forEach(function(se){C6(r,se,I6(t,se))}),np(r)}throw new Error("Unsupported NUMBERS file")}if(!Nn(t,"[Content_Types].xml"))throw Nn(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Nn(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=tw(t),s=T8(vn(t,"[Content_Types].xml")),i=!1,a,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",qt(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!qt(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(Cc=[],s.sst)try{Cc=jB(qt(t,Cn(s.sst)),s.sst,e)}catch(se){if(e.WTF)throw se}e.cellStyles&&s.themes.length&&(l=LB(vn(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(c=MB(qt(t,Cn(s.style)),s.style,l,e))}s.links.map(function(se){try{var ae=Sc(vn(t,Nm(Cn(se))),se);return BB(qt(t,Cn(se)),ae,se,e)}catch{}});var u=PB(qt(t,Cn(s.workbooks[0])),s.workbooks[0],e),h={},d="";s.coreprops.length&&(d=qt(t,Cn(s.coreprops[0]),!0),d&&(h=OA(d)),s.extprops.length!==0&&(d=qt(t,Cn(s.extprops[0]),!0),d&&C8(d,h,e)));var m={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(d=vn(t,Cn(s.custprops[0]),!0),d&&(m=N8(d,e)));var v={};if((e.bookSheets||e.bookProps)&&(u.Sheets?a=u.Sheets.map(function(ae){return ae.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),e.bookProps&&(v.Props=h,v.Custprops=m),e.bookSheets&&typeof a<"u"&&(v.SheetNames=a),e.bookSheets?v.SheetNames:e.bookProps))return v;a={};var g={};e.bookDeps&&s.calcchain&&(g=UB(qt(t,Cn(s.calcchain)),s.calcchain));var y=0,S={},k,w;{var F=u.Sheets;h.Worksheets=F.length,h.SheetNames=[];for(var B=0;B!=F.length;++B)h.SheetNames[B]=F[B].name}var V=i?"bin":"xml",x=s.workbooks[0].lastIndexOf("/"),E=(s.workbooks[0].slice(0,x+1)+"_rels/"+s.workbooks[0].slice(x+1)+".rels").replace(/^\//,"");Nn(t,E)||(E="xl/_rels/workbook."+V+".rels");var T=Sc(vn(t,E,!0),E.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=zB(qt(t,Cn(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=bj(qt(t,Cn(s.people[0])),e)),T&&(T=S7(T,u.Sheets));var I=qt(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=h.Worksheets;++y){var P="sheet";if(T&&T[y]?(k="xl/"+T[y][1].replace(/[\/]?xl\//,""),Nn(t,k)||(k=T[y][1]),Nn(t,k)||(k=E.replace(/_rels\/.*$/,"")+T[y][1]),P=T[y][2]):(k="xl/worksheets/sheet"+(y+1-I)+"."+V,k=k.replace(/sheet0\./,"sheet.")),w=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(y!=e.sheets)continue e;break;case"string":if(h.SheetNames[y].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var N=!1,R=0;R!=e.sheets.length;++R)typeof e.sheets[R]=="number"&&e.sheets[R]==y&&(N=1),typeof e.sheets[R]=="string"&&e.sheets[R].toLowerCase()==h.SheetNames[y].toLowerCase()&&(N=1);if(!N)continue e}}A7(t,k,w,h.SheetNames[y],y,S,a,P,e,u,l,c)}return v={Directory:s,Workbook:u,Props:h,Custprops:m,Deps:g,Sheets:a,SheetNames:h.SheetNames,Strings:Cc,Styles:c,Themes:l,SSF:Er(ze)},e&&e.bookFiles&&(t.files?(v.keys=n,v.files=t.files):(v.keys=[],v.files={},t.FullPaths.forEach(function(se,ae){se=se.replace(/^Root Entry[\/]/,""),v.keys.push(se),v.files[se]=t.FileIndex[ae]}))),e&&e.bookVBA&&(s.vba.length>0?v.vbaraw=qt(t,Cn(s.vba[0]),!0):s.defaults&&s.defaults.bin===jj&&(v.vbaraw=qt(t,"xl/vbaProject.bin",!0))),v}function C7(t,e){var r=e||{},n="Workbook",s=et.find(t,n);try{if(n="/!DataSpaces/Version",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(y9(s.content),n="/!DataSpaces/DataSpaceMap",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=E9(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=T9(s.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);S9(s.content)}catch{}if(n="/EncryptionInfo",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=A9(s.content);if(n="/EncryptedPackage",s=et.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function mx(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=En(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function R7(t,e){return et.find(t,"EncryptedPackage")?C7(t,e):_I(t,e)}function N7(t,e){var r,n=t,s=e||{};return s.type||(s.type=Qe&&Buffer.isBuffer(t)?"buffer":"base64"),r=hA(n,s),I7(r,s)}function TI(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Fm(t.slice(r),e);default:break e}return fu.to_workbook(t,e)}function P7(t,e){var r="",n=mx(t,e);switch(e.type){case"base64":r=En(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Xa(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Et(r)),e.type="binary",TI(r,e)}function D7(t,e){var r=t;return e.type=="base64"&&(r=En(r)),r=ou.utils.decode(1200,r.slice(2),"str"),e.type="binary",TI(r,e)}function F7(t){return t.match(/[^\x00-\x7F]/)?oc(t):t}function sp(t,e,r,n){return n?(r.type="string",fu.to_workbook(t,r)):fu.to_workbook(e,r)}function Lm(t,e){qS();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Lm(new Uint8Array(t),(r=Er(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Yo={},r.dateNF&&(Yo.dateNF=r.dateNF),r.type||(r.type=Qe&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Qe?"buffer":"binary",n=y6(t),typeof Uint8Array<"u"&&!Qe&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=F7(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=Er(r),r.type="array",Lm(Kv(n),r)}switch((s=mx(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return R7(et.read(n,r),r);break;case 9:if(s[1]<=8)return _I(n,r);break;case 60:return Fm(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return o9(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return i9.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?N7(n,r):sp(t,n,r,i);case 239:return s[3]===60?Fm(n,r):sp(t,n,r,i);case 255:if(s[1]===254)return D7(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Ic.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Ic.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Iw.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return j9.to_workbook(n,r);break;case 10:case 13:case 32:return P7(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return n9.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Iw.to_workbook(n,r):sp(t,n,r,i)}function b7(t,e,r,n,s,i,a,o){var l=Tr(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var v=a?t[r][m]:t[n[m]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;i[m]!=null&&(d[i[m]]=c);continue}var g=v.v;switch(v.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(i[m]!=null){if(g==null)if(v.t=="e"&&g===null)d[i[m]]=null;else if(c!==void 0)d[i[m]]=c;else if(u&&g===null)d[i[m]]=null;else continue;else d[i[m]]=u&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?g:pi(v,g,o);g!=null&&(h=!1)}}return{row:d,isempty:h}}function jm(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Ut(u);break;case"number":l=Ut(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(s=0);var h=Tr(l.s.r),d=[],m=[],v=0,g=0,y=Array.isArray(t),S=l.s.r,k=0,w={};y&&!t[S]&&(t[S]=[]);var F=c.skipHidden&&t["!cols"]||[],B=c.skipHidden&&t["!rows"]||[];for(k=l.s.c;k<=l.e.c;++k)if(!(F[k]||{}).hidden)switch(d[k]=nr(k),r=y?t[S][k]:t[d[k]+h],n){case 1:i[k]=k-l.s.c;break;case 2:i[k]=d[k];break;case 3:i[k]=c.header[k-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=pi(r,null,c),g=w[a]||0,!g)w[a]=1;else{do o=a+"_"+g++;while(w[o]);w[a]=g,w[o]=1}i[k]=o}for(S=l.s.r+s;S<=l.e.r;++S)if(!(B[S]||{}).hidden){var V=b7(t,l,S,d,n,i,y,c);(V.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(m[v++]=V.row)}return m.length=v,m}var Hw=/"/g;function O7(t,e,r,n,s,i,a,o){for(var l=!0,c=[],u="",h=Tr(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var m=o.dense?(t[r]||[])[d]:t[n[d]+h];if(m==null)u="";else if(m.v!=null){l=!1,u=""+(o.rawNumbers&&m.t=="n"?m.v:pi(m,null,o));for(var v=0,g=0;v!==u.length;++v)if((g=u.charCodeAt(v))===s||g===i||g===34||o.forceQuotes){u='"'+u.replace(Hw,'""')+'"';break}u=="ID"&&(u='"ID"')}else m.f!=null&&!m.F?(l=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(Hw,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function kI(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=Ut(t["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],v=s.s.c;v<=s.e.c;++v)(d[v]||{}).hidden||(h[v]=nr(v));for(var g=0,y=s.s.r;y<=s.e.r;++y)(m[y]||{}).hidden||(u=O7(t,s,y,h,a,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((g++?o:"")+u)));return delete n.dense,r.join("")}function M7(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=kI(t,e);return r}function L7(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=Ut(t["!ref"]),i="",a=[],o,l=[],c=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)a[o]=nr(o);for(var u=s.s.r;u<=s.e.r;++u)for(i=Tr(u),o=s.s.c;o<=s.e.c;++o)if(e=a[o]+i,r=c?(t[u]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function SI(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Kr(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+e.length-1+s}};if(i["!ref"]){var h=Ut(i["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),a==-1&&(a=h.e.r+1,u.e.r=a+e.length-1+s)}else a==-1&&(a=0,u.e.r=e.length-1+s);var d=n.header||[],m=0;e.forEach(function(g,y){Cs(g).forEach(function(S){(m=d.indexOf(S))==-1&&(d[m=d.length]=S);var k=g[S],w="z",F="",B=Ue({c:o+m,r:a+y+s});c=mu(i,B),k&&typeof k=="object"&&!(k instanceof Date)?i[B]=k:(typeof k=="number"?w="n":typeof k=="boolean"?w="b":typeof k=="string"?w="s":k instanceof Date?(w="d",n.cellDates||(w="n",k=Qr(k)),F=n.dateNF||ze[14]):k===null&&n.nullError&&(w="e",k=0),c?(c.t=w,c.v=k,delete c.w,delete c.R,F&&(c.z=F)):i[B]=c={t:w,v:k},F&&(c.z=F))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var v=Tr(a);if(s)for(m=0;m<d.length;++m)i[nr(m+o)+v]={t:"s",v:d[m]};return i["!ref"]=tt(u),i}function j7(t,e){return SI(null,t,e)}function mu(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Kr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?mu(t,Ue(e)):mu(t,Ue({r:e,c:r||0}))}function V7(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function gx(){return{SheetNames:[],Sheets:{}}}function vx(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=a+s)!=-1;++s);}if(TB(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function U7(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=V7(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function B7(t,e){return t.z=e,t}function AI(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function z7(t,e,r){return AI(t,"#"+e,r)}function $7(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function H7(t,e,r,n){for(var s=typeof e!="string"?e:Ut(e),i=typeof e=="string"?e:tt(e),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var l=mu(t,a,o);l.t="n",l.F=i,delete l.v,a==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return t}var W7={encode_col:nr,encode_row:Tr,encode_cell:Ue,encode_range:tt,decode_col:rx,decode_row:tx,split_cell:r8,decode_cell:Kr,decode_range:Al,format_cell:pi,sheet_add_aoa:NA,sheet_add_json:SI,sheet_add_dom:yI,aoa_to_sheet:Il,json_to_sheet:j7,table_to_sheet:wI,table_to_book:o7,sheet_to_csv:kI,sheet_to_txt:M7,sheet_to_json:jm,sheet_to_html:a7,sheet_to_formulae:L7,sheet_to_row_object_array:jm,sheet_get_cell:mu,book_new:gx,book_append_sheet:vx,book_set_sheet_visibility:U7,cell_set_number_format:B7,cell_set_hyperlink:AI,cell_set_internal_link:z7,cell_add_comment:$7,sheet_set_array_formula:H7,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const G7=({tmdbApiKey:t,userId:e,onDone:r})=>{const[n,s]=W.useState(null),[i,a]=W.useState([]),[o,l]=W.useState([]),[c,u]=W.useState("upload"),[h,d]=W.useState(0),[m,v]=W.useState(0),[g,y]=W.useState(!1),[S,k]=W.useState(null),[w,F]=W.useState([]),[B,V]=W.useState(null),x=o.filter(R=>R.selected&&R.tmdbMatch).length,E=R=>{var fe;const se=(fe=R.target.files)==null?void 0:fe[0];if(!se)return;s(se);const ae=new FileReader;ae.onload=ge=>{var U;const oe=Lm((U=ge.target)==null?void 0:U.result,{type:"binary"}),K=oe.Sheets[oe.SheetNames[0]],we=W7.sheet_to_json(K).map(q=>({title:q.title||q.Title||q.name||q.Name||"",releaseDate:q.releaseDate||q.ReleaseDate||q.release_date||q.year||q.Year||"",watched:q.watched||q.Watched||!1,rating:q.rating||q.Rating||null,review:q.review||q.Review||q.notes||q.Notes||""})).filter(q=>q.title);a(we)},ae.readAsBinaryString(se)},T=async()=>{if(!i.length||!t){V("Missing data or TMDB key");return}try{y(!0),V(null),l([]),d(0);const R=[],se=ti(ir,"movies");for(let ae=0;ae<i.length;ae++){const fe=i[ae];try{const ge=`${fe.title} ${fe.releaseDate||""}`.trim(),oe=await Im(ge,t);if(!oe.results.length)R.push({excelData:fe,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1});else{const K=await Yh(oe.results[0].id,t),he=By(fe,K),we=await ks(ba(se,au("tmdbId","==",K.id)));let U,q=!1;we.empty||(U=we.docs[0].id,q=!!await Am(e,U)),R.push({excelData:fe,tmdbMatch:K,confidence:he,status:q?"duplicate":he>=70?"matched":"manual",userMovieExists:q,movieId:U,selected:!q})}}catch{R.push({excelData:fe,tmdbMatch:null,confidence:0,status:"unmatched",userMovieExists:!1,selected:!1})}d(Math.round((ae+1)/i.length*100))}l(R),u("review")}finally{y(!1)}},I=async(R,se)=>{try{y(!0);const ae=o[R],fe=se||ae.excelData.title,ge=await Im(fe,t);k(R),F(ge.results)}finally{y(!1)}},P=async R=>{if(S!=null){y(!0);try{const se=await Yh(R.id,t),ae=By(o[S].excelData,se),fe=ti(ir,"movies"),ge=await ks(ba(fe,au("tmdbId","==",se.id)));let oe,K=!1;ge.empty||(oe=ge.docs[0].id,K=!!await Am(e,oe)),l(he=>{const we=[...he],U=we[S];return we[S]={...U,tmdbMatch:se,confidence:ae,status:K?"duplicate":"matched",userMovieExists:K,movieId:oe,selected:!K},we}),k(null),F([])}finally{y(!1)}}},N=async()=>{const R=o.filter(ae=>ae.selected&&ae.tmdbMatch);if(!R.length)return;u("import"),v(0);const se=ti(ir,"movies");for(let ae=0;ae<R.length;ae++){const fe=R[ae];try{let ge=fe.movieId;ge||(ge=(await Uv(se,{...Hv(fe.tmdbMatch),addedAt:new Date,updatedAt:new Date})).id),await Bv(e,ge,{userId:e,movieId:ge,watched:fe.excelData.watched||!1,rating:fe.excelData.rating||null,review:fe.excelData.review||"",favorite:!1})}catch{}v(Math.round((ae+1)/R.length*100))}r==null||r()};return p.jsxs("div",{className:"space-y-6",children:[c==="upload"&&p.jsxs("div",{className:"space-y-4",children:[p.jsx("input",{type:"file",accept:".xlsx,.xls",className:"file-input file-input-bordered w-full",onChange:E}),!!i.length&&p.jsxs("div",{className:"text-sm opacity-80",children:[i.length," rows detected"]}),p.jsx("button",{className:"btn btn-primary",onClick:T,disabled:!t||!i.length||g,children:g?p.jsx("span",{className:"loading loading-spinner loading-sm"}):"Scan & Match"})]}),c==="review"&&p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("div",{className:"font-bold",children:"Review Matches"}),p.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>u("upload"),children:"Back"})]}),p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"table table-zebra w-full",children:[p.jsx("thead",{children:p.jsxs("tr",{children:[p.jsx("th",{}),p.jsx("th",{children:"Excel"}),p.jsx("th",{children:"Match"}),p.jsx("th",{children:"Confidence"}),p.jsx("th",{children:"Status"}),p.jsx("th",{children:"Action"})]})}),p.jsx("tbody",{children:o.map((R,se)=>{var ae;return p.jsxs("tr",{className:R.userMovieExists?"bg-warning bg-opacity-20":"",children:[p.jsx("td",{children:p.jsx("input",{type:"checkbox",className:"checkbox",checked:R.selected,disabled:!R.tmdbMatch,onChange:()=>{const fe=[...o];fe[se].selected=!fe[se].selected,l(fe)}})}),p.jsxs("td",{children:[p.jsx("div",{className:"font-semibold",children:R.excelData.title}),p.jsx("div",{className:"text-xs opacity-70",children:R.excelData.releaseDate||"-"})]}),p.jsx("td",{children:R.tmdbMatch?p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:"w-12 h-18",children:xs(R.tmdbMatch)?p.jsx("img",{src:xs(R.tmdbMatch),className:"object-cover"}):p.jsx("div",{className:"w-full h-full bg-base-200"})}),p.jsxs("div",{children:[p.jsx("div",{className:"font-semibold",children:R.tmdbMatch.title}),p.jsx("div",{className:"text-xs opacity-70",children:(ae=R.tmdbMatch.release_date)==null?void 0:ae.slice(0,4)})]})]}):p.jsx("span",{className:"text-error",children:"No match"})}),p.jsx("td",{children:R.tmdbMatch?p.jsxs("div",{className:"flex items-center",children:[p.jsx("progress",{className:`progress ${R.confidence>=70?"progress-success":R.confidence>=40?"progress-warning":"progress-error"}`,value:R.confidence,max:100}),p.jsxs("span",{className:"ml-2",children:[R.confidence,"%"]})]}):"-"}),p.jsxs("td",{children:[R.status==="matched"&&p.jsx("div",{className:"badge badge-success",children:"Matched"}),R.status==="unmatched"&&p.jsx("div",{className:"badge badge-error",children:"Unmatched"}),R.status==="duplicate"&&p.jsx("div",{className:"badge badge-warning",children:"Duplicate"}),R.status==="manual"&&p.jsx("div",{className:"badge badge-info",children:"Manual"})]}),p.jsx("td",{children:p.jsx("button",{className:"btn btn-sm btn-outline",onClick:()=>I(se),children:p.jsx("i",{className:"fas fa-search"})})})]},se)})})]})}),p.jsx("div",{className:"flex justify-end",children:p.jsxs("button",{className:"btn btn-primary",onClick:N,disabled:!x||g,children:["Import ",x," Movies"]})}),!!h&&h<100&&p.jsx("div",{children:p.jsx("progress",{className:"progress w-full",value:h,max:100})})]}),c==="import"&&p.jsxs("div",{className:"space-y-3",children:[p.jsx("div",{className:"font-bold",children:"Importing"}),p.jsx("progress",{className:"progress w-full",value:m,max:100})]}),S!==null&&p.jsx("div",{className:"modal modal-open",children:p.jsxs("div",{className:"modal-box max-w-4xl",children:[p.jsxs("h3",{className:"font-bold text-lg mb-4",children:["Manual match: ",o[S].excelData.title]}),p.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mb-6",children:[p.jsx("input",{type:"text",className:"input input-bordered flex-1",placeholder:"Search for a movie...",defaultValue:o[S].excelData.title,onKeyDown:R=>R.key==="Enter"&&I(S,R.target.value)}),p.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:()=>{var R;return I(S,(R=document.querySelector(".modal input"))==null?void 0:R.value)},disabled:g,children:g?p.jsx("span",{className:"loading loading-spinner loading-sm"}):p.jsx("i",{className:"fas fa-search"})})]}),p.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-96 overflow-y-auto",children:w.map(R=>{var se;return p.jsxs("div",{className:"card bg-base-100 shadow cursor-pointer",onClick:()=>P(R),children:[p.jsx("figure",{children:xs(R)?p.jsx("img",{src:xs(R)}):p.jsx("div",{className:"h-48 w-full bg-base-200"})}),p.jsxs("div",{className:"card-body p-3",children:[p.jsx("div",{className:"text-sm font-semibold",children:R.title}),p.jsx("div",{className:"text-xs opacity-70",children:(se=R.release_date)==null?void 0:se.slice(0,4)})]})]},R.id)})}),p.jsx("div",{className:"modal-action",children:p.jsx("button",{className:"btn",onClick:()=>{k(null),F([])},children:"Close"})})]})}),B&&p.jsx("div",{className:"alert alert-error",children:B})]})},K7=()=>{var v;const{currentUser:t,userProfile:e}=vi(),[r,n]=W.useState(""),[s,i]=W.useState("local"),[a,o]=W.useState(null),[l,c]=W.useState(!1),[u,h]=W.useState(null);W.useEffect(()=>{e!=null&&e.tmdbApiKey&&n(e.tmdbApiKey)},[e]);const d=async g=>{if(!r){h({type:"error",text:"TMDB key required to fetch details."});return}try{c(!0),h(null);const y=await Yh(g.id,r);o(y)}catch(y){h({type:"error",text:(y==null?void 0:y.message)??"Failed to fetch details"})}finally{c(!1)}},m=async()=>{if(!(!t||!a))try{c(!0),h(null);const g=ti(ir,"movies"),y=await ks(ba(g,au("tmdbId","==",a.id)));let S;y.empty?S=(await Uv(g,{...Hv(a),addedAt:new Date,updatedAt:new Date})).id:S=y.docs[0].id,await Bv(t.uid,S,{userId:t.uid,movieId:S,watched:!1,favorite:!1}),h({type:"success",text:"Added to your collection!"}),o(null)}catch(g){h({type:"error",text:(g==null?void 0:g.message)??"Failed to add movie"})}finally{c(!1)}};return p.jsxs("div",{className:"container mx-auto px-4 py-8",children:[p.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-3 mb-6",children:[p.jsxs(ct,{to:"/movies",className:"btn btn-ghost w-full sm:w-auto",children:[p.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Movies"]}),p.jsxs(ct,{to:"/profile",className:"btn btn-outline btn-primary w-full sm:w-auto",children:[p.jsx("i",{className:"fas fa-user-cog mr-2"}),"Profile Settings"]})]}),p.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Import Movies"}),u&&p.jsxs("div",{className:`alert ${u.type==="error"?"alert-error":"alert-success"} mb-4`,children:[p.jsx("i",{className:`fas ${u.type==="error"?"fa-exclamation-circle":"fa-check-circle"} mr-2`}),p.jsx("span",{children:u.text})]}),p.jsxs("div",{className:"tabs tabs-boxed mb-6",children:[p.jsxs("button",{className:`tab ${s==="local"?"tab-active":""}`,onClick:()=>i("local"),children:[p.jsx("i",{className:"fas fa-database mr-2"}),"Local"]}),p.jsxs("button",{className:`tab ${s==="tmdb"?"tab-active":""}`,onClick:()=>i("tmdb"),children:[p.jsx("i",{className:"fas fa-search mr-2"}),"TMDB"]}),p.jsxs("button",{className:`tab ${s==="excel"?"tab-active":""}`,onClick:()=>i("excel"),children:[p.jsx("i",{className:"fas fa-file-excel mr-2"}),"Excel"]})]}),s==="local"&&p.jsx("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:p.jsx(zL,{onSelect:d})}),s==="tmdb"&&p.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[!r&&p.jsxs("div",{className:"alert alert-warning mb-4",children:[p.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),p.jsx("span",{children:"Set your TMDB API key in Profile to search TMDB."})]}),p.jsx($L,{tmdbApiKey:r,onSelect:d})]}),s==="excel"&&p.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[!r&&p.jsxs("div",{className:"alert alert-warning mb-4",children:[p.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),p.jsx("span",{children:"TMDB key required for matching."})]}),t?p.jsx(G7,{tmdbApiKey:r,userId:t.uid,onDone:()=>i("local")}):p.jsx("div",{className:"alert alert-info",children:"Log in to import from Excel."})]}),a&&p.jsx("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg mt-6",children:p.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[p.jsx("div",{className:"md:w-1/3",children:xs(a)?p.jsx("img",{src:xs(a),className:"w-full h-auto max-h-[500px] object-contain rounded-lg shadow"}):p.jsx("div",{className:"w-full h-96 bg-base-200 flex items-center justify-center",children:p.jsx("i",{className:"fas fa-film text-5xl opacity-50"})})}),p.jsxs("div",{className:"md:w-2/3",children:[p.jsx("h3",{className:"text-2xl font-bold mb-2",children:a.title}),p.jsx("p",{className:"text-gray-400 mb-4",children:(v=a.release_date)==null?void 0:v.slice(0,4)}),a.genres&&p.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:a.genres.map(g=>p.jsx("span",{className:"badge badge-outline",children:g.name},g.id))}),p.jsx("p",{className:"mb-6",children:a.overview}),p.jsx("button",{className:"btn btn-primary",onClick:m,disabled:l,children:l?p.jsxs(p.Fragment,{children:[p.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Adding"]}):p.jsxs(p.Fragment,{children:[p.jsx("i",{className:"fas fa-plus mr-2"}),"Add to Collection"]})}),p.jsx("button",{className:"btn btn-ghost ml-2",onClick:()=>o(null),disabled:l,children:"Cancel"})]})]})})]})},q7=()=>{var y,S,k;const{currentUser:t}=vi(),[e,r]=W.useState([]),[n,s]=W.useState({}),[i,a]=W.useState(!0),[o,l]=W.useState(null),[c,u]=W.useState(null),[h,d]=W.useState(!1),[m,v]=W.useState(!1);W.useEffect(()=>{(async()=>{if(t)try{a(!0);const{userMovies:F,movies:B}=await zv(t.uid);s(F),r(B)}catch(F){console.error("Error fetching movies:",F),l("Failed to load movies")}finally{a(!1)}})()},[t]);const g=()=>{if(e.length===0)return;v(!0),u(null);const w=e.filter(x=>{const E=n[x.id];return h||!E||!E.watched});if(w.length===0){l("No eligible movies found. Try including watched movies."),v(!1);return}let F=0;const B=25,V=setInterval(()=>{const x=Math.floor(Math.random()*w.length);u(w[x]),F++,F>=B&&(clearInterval(V),v(!1))},100)};return i?p.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):p.jsxs("div",{className:"container mx-auto px-4 py-8",children:[p.jsx("div",{className:"mb-4",children:p.jsxs(ct,{to:"/movies",className:"btn btn-ghost",children:[p.jsx("i",{className:"fas fa-arrow-left mr-2"})," Back to Movies"]})}),p.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Christmas Movie Picker"}),o&&p.jsxs("div",{className:"alert alert-error mb-6",children:[p.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),p.jsx("span",{children:o})]}),e.length===0?p.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg text-center",children:[p.jsx("h3",{className:"text-xl mb-4",children:"No movies in your collection"}),p.jsx("p",{className:"mb-4",children:"Add some Christmas movies to use the random movie picker!"}),p.jsxs(ct,{to:"/import",className:"btn btn-primary",children:[p.jsx("i",{className:"fas fa-file-import mr-2"})," Import Movies"]})]}):p.jsxs("div",{className:"bg-xmas-card p-8 rounded-lg shadow-lg",children:[p.jsxs("div",{className:"text-center mb-6",children:[p.jsx("p",{className:"mb-4",children:"Can't decide what Christmas movie to watch? Let us pick one for you!"}),p.jsx("div",{className:"form-control mb-6",children:p.jsxs("label",{className:"label cursor-pointer justify-center",children:[p.jsx("span",{className:"label-text mr-2",children:"Include watched movies"}),p.jsx("input",{type:"checkbox",className:"toggle toggle-primary",checked:h,onChange:()=>d(!h)})]})}),p.jsx("button",{className:"btn btn-primary btn-lg",onClick:g,disabled:m,children:m?p.jsxs(p.Fragment,{children:[p.jsx("span",{className:"loading loading-spinner loading-md mr-2"}),"Picking a movie..."]}):p.jsxs(p.Fragment,{children:[p.jsx("i",{className:"fas fa-random mr-2"}),"Pick a Random Movie"]})})]}),c&&p.jsx("div",{className:"mt-8 flex flex-col items-center",children:p.jsx("div",{className:"w-full max-w-md",children:p.jsxs("div",{className:"card bg-base-100 shadow-xl overflow-hidden",children:[p.jsxs("figure",{className:"relative",children:[c.posterUrl?p.jsx("img",{src:c.posterUrl,alt:c.title,className:"w-full object-contain",style:{aspectRatio:"2/3",maxHeight:"500px"},loading:"lazy"}):p.jsx("div",{className:"w-full flex items-center justify-center bg-gray-800",style:{aspectRatio:"2/3",maxHeight:"500px"},children:p.jsx("i",{className:"fas fa-film text-6xl text-gray-500"})}),((y=n[c.id])==null?void 0:y.watched)&&p.jsx("div",{className:"absolute top-4 left-4 badge badge-lg badge-success",children:"Already Watched"}),((S=n[c.id])==null?void 0:S.rating)&&p.jsxs("div",{className:"absolute top-4 right-4 badge badge-lg badge-warning",children:[p.jsx("i",{className:"fas fa-star mr-1"}),n[c.id].rating,"/10"]})]}),p.jsxs("div",{className:"card-body",children:[p.jsx("h2",{className:"card-title text-2xl font-christmas",children:c.title}),p.jsx("p",{className:"text-gray-400",children:(k=c.releaseDate)==null?void 0:k.substring(0,4)}),p.jsxs("div",{className:"card-actions justify-end mt-4",children:[p.jsx(ct,{to:`/movies/${c.id}`,className:"btn btn-primary",children:"View Details"}),p.jsx("button",{className:"btn btn-outline",onClick:g,disabled:m,children:"Pick Another"})]})]})]})})})]})]})},X7=(t,e)=>{const r=["Title","TMDB ID","Release Year","Watched","Watched Date","Rating","Review","Favorite","Date Added"].join(","),n=t.map(s=>{const i=e[s.id];if(!i)return null;const a=s.releaseDate?s.releaseDate.substring(0,4):"",o=i.watchedDate?Vm(i.watchedDate):"",l=i.addedAt?Vm(i.addedAt):"",c=Ww(s.title),u=i.review?Ww(i.review):"";return[c,s.tmdbId||"",a,i.watched?"Yes":"No",o,i.rating!==null&&i.rating!==void 0?i.rating:"",u,i.favorite?"Yes":"No",l].join(",")}).filter(Boolean);return[r,...n].join(`
`)},Vm=t=>{if(!(t instanceof Date))try{t&&typeof t.toDate=="function"?t=t.toDate():t=new Date(t)}catch{return""}return t.toISOString().split("T")[0]},Ww=t=>t?t.includes(",")||t.includes('"')||t.includes(`
`)?`"${t.replace(/"/g,'""')}"`:t:"",Y7=(t,e,r)=>{const n=document.createElement("a"),s=new Blob([t],{type:r});n.href=URL.createObjectURL(s),n.download=e,n.click(),URL.revokeObjectURL(n.href)},Q7=async(t,e,r)=>{const n=X7(t,e),s=`${r.replace(/\s+/g,"_")}_christmas_movies_${Vm(new Date)}.csv`;Y7(n,s,"text/csv;charset=utf-8;")},II=async()=>{const t=ti(ir,"movies"),e=await ks(t);let r=0;const n=e.size;for(const s of e.docs){const i=s.data();if(i.sortTitle)continue;const a=WS(i.title);a!==i.title&&(await Vv(ls(ir,"movies",s.id),{sortTitle:a,updatedAt:new Date}),r++)}return{updated:r,total:n}},J7=()=>{const{currentUser:t,userProfile:e,signOut:r}=vi(),{isAdmin:n}=Qd(),[s,i]=W.useState(""),[a,o]=W.useState(!1),[l,c]=W.useState(!1),[u,h]=W.useState(!1),[d,m]=W.useState(null),[v,g]=W.useState(null),[y,S]=W.useState({totalMovies:0,watchedMovies:0,unwatchedMovies:0,averageRating:0,favoriteMovies:0});W.useEffect(()=>{e!=null&&e.tmdbApiKey&&i(e.tmdbApiKey),(async()=>{if(t)try{const x=await HS(t.uid),E=x.length,T=x.filter(se=>se.watched).length,I=E-T,P=x.filter(se=>se.favorite).length,N=x.filter(se=>se.rating!==void 0&&se.rating!==null),R=N.length>0?N.reduce((se,ae)=>se+(ae.rating||0),0)/N.length:0;S({totalMovies:E,watchedMovies:T,unwatchedMovies:I,averageRating:R,favoriteMovies:P})}catch(x){console.error("Error fetching user stats:",x)}})()},[t,e]);const k=async()=>{if(t)try{o(!0),m(null);const V=ls(ir,"users",t.uid);await Vv(V,{tmdbApiKey:s}),g("TMDB API key saved successfully!"),setTimeout(()=>{g(null)},3e3)}catch(V){console.error("Error saving API key:",V),m(V.message||"Failed to save API key")}finally{o(!1)}},w=async()=>{try{await r()}catch(V){console.error("Error signing out:",V)}},F=async()=>{if(t)try{c(!0),m(null);const{userMovies:V,movies:x}=await zv(t.uid);await Q7(x,V,e.displayName||"User"),g("Movies exported successfully!"),setTimeout(()=>{g(null)},3e3)}catch(V){console.error("Error exporting movies:",V),m(V.message||"Failed to export movies")}finally{c(!1)}},B=async()=>{try{h(!0),m(null);const V=await II();g(`Sort titles updated for ${V.updated} out of ${V.total} movies.`),setTimeout(()=>{g(null)},5e3)}catch(V){console.error("Error updating sort titles:",V),m(V.message||"Failed to update sort titles")}finally{h(!1)}};return!t||!e?p.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):p.jsxs("div",{className:"container mx-auto px-4 py-8",children:[p.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line mb-6",children:"Your Profile"}),d&&p.jsxs("div",{className:"alert alert-error mb-6",children:[p.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),p.jsx("span",{children:d})]}),v&&p.jsxs("div",{className:"alert alert-success mb-6",children:[p.jsx("i",{className:"fas fa-check-circle mr-2"}),p.jsx("span",{children:v})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[p.jsx("div",{className:"md:col-span-1",children:p.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[p.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.photoURL?p.jsx("img",{src:e.photoURL,alt:e.displayName,className:"w-24 h-24 rounded-full mb-4"}):p.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-700 flex items-center justify-center mb-4",children:p.jsx("i",{className:"fas fa-user text-4xl text-gray-400"})}),p.jsx("h2",{className:"text-xl font-bold",children:e.displayName}),p.jsx("p",{className:"text-gray-400",children:e.email})]}),p.jsx("div",{className:"divider"}),p.jsxs("div",{className:"mb-6",children:[p.jsx("h3",{className:"text-lg font-bold mb-2",children:"Your Stats"}),p.jsxs("ul",{className:"space-y-2",children:[p.jsxs("li",{className:"flex justify-between",children:[p.jsx("span",{children:"Total Movies:"}),p.jsx("span",{className:"font-bold",children:y.totalMovies})]}),p.jsxs("li",{className:"flex justify-between",children:[p.jsx("span",{children:"Watched:"}),p.jsx("span",{className:"font-bold",children:y.watchedMovies})]}),p.jsxs("li",{className:"flex justify-between",children:[p.jsx("span",{children:"Unwatched:"}),p.jsx("span",{className:"font-bold",children:y.unwatchedMovies})]}),p.jsxs("li",{className:"flex justify-between",children:[p.jsx("span",{children:"Favorites:"}),p.jsx("span",{className:"font-bold",children:y.favoriteMovies})]}),p.jsxs("li",{className:"flex justify-between",children:[p.jsx("span",{children:"Average Rating:"}),p.jsxs("span",{className:"font-bold",children:[y.averageRating.toFixed(1),"/10"]})]})]})]}),p.jsx("div",{className:"divider"}),p.jsxs("div",{className:"mt-6 space-y-3",children:[p.jsxs("button",{className:"btn btn-outline btn-primary w-full",onClick:F,disabled:l||y.totalMovies===0,children:[l?p.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):p.jsx("i",{className:"fas fa-file-export mr-2"}),"Export Movie Data"]}),p.jsxs("button",{className:"btn btn-outline btn-error w-full",onClick:w,children:[p.jsx("i",{className:"fas fa-sign-out-alt mr-2"}),"Sign Out"]})]})]})}),p.jsx("div",{className:"md:col-span-2",children:p.jsxs("div",{className:"bg-xmas-card p-6 rounded-lg shadow-lg",children:[p.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Settings"}),p.jsxs("div",{className:"mb-6",children:[p.jsx("h3",{className:"text-lg font-bold mb-2",children:"TMDB API Key"}),p.jsxs("p",{className:"mb-4",children:["Your TMDB API key is used to search for movies and fetch movie details. If you don't have one, you can get it for free from ",p.jsx("a",{href:"https://www.themoviedb.org/settings/api",target:"_blank",rel:"noopener noreferrer",className:"link link-primary",children:"The Movie Database"}),"."]}),p.jsxs("div",{className:"form-control",children:[p.jsx("label",{className:"label",children:p.jsx("span",{className:"label-text",children:"API Key"})}),p.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[p.jsx("input",{type:"text",className:"input input-bordered flex-1 h-12 text-lg",value:s,onChange:V=>i(V.target.value),placeholder:"Enter your TMDB API key"}),p.jsx("button",{className:"btn btn-primary w-full sm:w-auto",onClick:k,disabled:a,children:a?p.jsx("span",{className:"loading loading-spinner loading-sm"}):p.jsx("i",{className:"fas fa-save"})})]})]})]}),p.jsx("div",{className:"divider"}),p.jsxs("div",{className:"mb-6",children:[p.jsx("h3",{className:"text-lg font-bold mb-2",children:"Quick Links"}),p.jsxs("div",{className:"flex flex-wrap gap-2",children:[p.jsxs(ct,{to:"/movies",className:"btn btn-outline btn-sm",children:[p.jsx("i",{className:"fas fa-film mr-2"}),"My Movies"]}),p.jsxs(ct,{to:"/import",className:"btn btn-outline btn-sm",children:[p.jsx("i",{className:"fas fa-file-import mr-2"}),"Import Movies"]}),p.jsxs(ct,{to:"/random",className:"btn btn-outline btn-sm",children:[p.jsx("i",{className:"fas fa-random mr-2"}),"Random Movie Picker"]})]})]}),n&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"divider"}),p.jsxs("div",{className:"mb-6",children:[p.jsx("h3",{className:"text-lg font-bold mb-2",children:"Admin Tools"}),p.jsx("div",{className:"space-y-4",children:p.jsxs("div",{children:[p.jsx("h4",{className:"font-medium mb-1",children:"Sort Title Migration"}),p.jsx("p",{className:"text-sm mb-2",children:'Update all movies to include sort titles (e.g., "The Grinch"  "Grinch") for better alphabetical sorting.'}),p.jsxs("button",{className:"btn btn-outline btn-warning btn-sm",onClick:B,disabled:u,children:[u?p.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):p.jsx("i",{className:"fas fa-sort-alpha-down mr-2"}),"Update Sort Titles"]})]})})]})]})]})})]})]})},Z7=()=>{const t=Za(),{isAdmin:e,loading:r,currentUser:n}=Qd(),[s,i]=W.useState(!1),[a,o]=W.useState(null),l=!1;W.useEffect(()=>{e&&!r&&t("/admin")},[e,r,t]);const c=async()=>{o(null),i(!0);try{await dk(wc,TL)}catch(u){console.error("Login error:",u),u.code==="auth/popup-closed-by-user"?o("Sign-in popup was closed. Please try again."):u.code==="auth/cancelled-popup-request"?o("Another popup is already open. Please try again."):u.code==="auth/unauthorized-domain"?(console.error("Unauthorized domain error:",window.location.hostname),o("This domain is not authorized for OAuth operations. Please add "+window.location.hostname+" to your Firebase authorized domains list in the Firebase console under Authentication > Sign-in method > Authorized domains.")):o("Failed to sign in. Please try again."),i(!1)}};return r?p.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):p.jsx("div",{className:"container mx-auto px-4 py-12",children:p.jsxs("div",{className:"max-w-md mx-auto",children:[p.jsxs("div",{className:"text-center mb-8",children:[p.jsx("h1",{className:"font-christmas text-4xl text-xmas-line mb-2",children:"Admin Login"}),p.jsx("p",{className:"text-xmas-mute",children:"Sign in to manage the Christmas Quiz"})]}),p.jsxs("div",{className:"bg-xmas-card rounded-lg shadow-lg p-6",children:[l,n&&p.jsxs("div",{className:"bg-info bg-opacity-10 border-l-4 border-info p-4 mb-6 rounded",children:[p.jsx("p",{className:"text-info font-bold mb-2",children:"User Authenticated"}),p.jsxs("p",{className:"text-info text-sm mb-1",children:["Email: ",n.email]}),p.jsxs("p",{className:"text-info text-sm mb-2",children:["UID: ",n.uid]}),p.jsxs("p",{className:"text-info text-sm",children:["To grant admin access, create a document in the ",p.jsx("code",{className:"bg-base-300 px-1 py-0.5 rounded",children:"admins"})," collection with this UID as the document ID."]}),l]}),a&&p.jsx("div",{className:"bg-error bg-opacity-10 border-l-4 border-error p-4 mb-6 rounded",children:p.jsx("p",{className:"text-error",children:a})}),p.jsxs("div",{className:"text-center mb-6",children:[p.jsx("p",{className:"mb-4",children:"Sign in with your Google account to access the admin panel."}),p.jsx("p",{className:"text-sm text-xmas-mute mb-6",children:"Only authorized administrators will be granted access."}),p.jsx("button",{onClick:c,className:"btn btn-primary w-full flex items-center justify-center gap-2",disabled:s,children:s?p.jsxs(p.Fragment,{children:[p.jsx("span",{className:"loading loading-spinner loading-sm"}),"Signing in..."]}):p.jsxs(p.Fragment,{children:[p.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 48 48",children:[p.jsx("path",{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12
                      s5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24s8.955,20,20,20
                      s20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`}),p.jsx("path",{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039
                      l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`}),p.jsx("path",{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36
                      c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`}),p.jsx("path",{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571
                      c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`})]}),"Sign in with Google"]})})]})]}),p.jsx("div",{className:"text-center mt-6",children:p.jsx("button",{onClick:()=>t("/"),className:"btn btn-link text-xmas-mute",children:"Back to Home"})})]})})};async function ez(t,e){const r=await Yh(t,e),n=ti(ir,"movies"),s=ba(n,au("tmdbId","==",r.id)),i=await ks(s),a={...Hv(r),updatedAt:new Date};if(i.empty){const o={...a,addedAt:new Date};return{movieId:(await Uv(n,o)).id,action:"created"}}else{const o=i.docs[0].id;return await Kh(ls(ir,"movies",o),a,{merge:!0}),{movieId:o,action:"updated"}}}const tz=t=>new Promise(e=>setTimeout(e,t));async function rz(t,e,r,n=200){let s=0,i=0,a=0,o=0;const l=[];for(let c=0;c<t.length;c++){const u=t[c];try{if(!u||Number.isNaN(u)){a++,r==null||r(c+1,t.length,"skipped");continue}const{movieId:h,action:d}=await ez(u,e);l.push(h),d==="created"?s++:i++,r==null||r(c+1,t.length,d),n>0&&await tz(n)}catch(h){console.error("Catalogue upsert error for TMDB",u,h),o++,r==null||r(c+1,t.length,"error")}}return{totalRequested:t.length,created:s,updated:i,skipped:a,errors:o,movieIds:l}}const nz=()=>{const t=Za(),{isAdmin:e,loading:r}=Qd(),[n,s]=W.useState(!0),[i,a]=W.useState(null),[o,l]=W.useState(null),[c,u]=W.useState(!1),[h,d]=W.useState({totalMovies:0,moviesWithSortTitle:0}),[m,v]=W.useState(""),[g,y]=W.useState(""),[S,k]=W.useState(!0),[w,F]=W.useState(!1),[B,V]=W.useState(0),[x,E]=W.useState("");W.useEffect(()=>{!r&&!e&&t("/admin/login")},[e,r,t]),W.useEffect(()=>{e&&(async()=>{if(e){s(!0);try{const R=await ks(ti(ir,"movies")),se=R.size;let ae=0;R.forEach(fe=>{fe.data().sortTitle&&ae++}),d({totalMovies:se,moviesWithSortTitle:ae})}catch(R){console.error("Error fetching movie data:",R),a("Failed to load movie data")}finally{s(!1)}}})()},[e]);const T=async()=>{try{u(!0),a(null);const N=await II();l(`Sort titles updated for ${N.updated} out of ${N.total} movies.`),d(R=>({...R,moviesWithSortTitle:R.moviesWithSortTitle+N.updated})),setTimeout(()=>l(null),5e3)}catch(N){console.error("Error updating sort titles:",N),a(N.message||"Failed to update sort titles")}finally{u(!1)}},I=W.useMemo(()=>{const R=g.split(/[\s,]+/).map(se=>se.trim()).filter(Boolean).map(se=>Number(se)).filter(se=>Number.isInteger(se)&&se>0);return Array.from(new Set(R))},[g]),P=async()=>{if(a(null),l(null),!m){a("TMDB API key required");return}if(I.length===0){a("Please paste at least one valid TMDB ID");return}try{F(!0),V(0),E(`Starting (0 / ${I.length})`);const N=await rz(I,m,(R,se,ae)=>{const fe=Math.round(R/se*100);V(fe),E(`Processed ${R} / ${se} (${ae})`)},S?300:0);l(`Catalogue updated. Created: ${N.created}, Updated: ${N.updated}, Skipped: ${N.skipped}, Errors: ${N.errors}.`)}catch(N){console.error(N),a((N==null?void 0:N.message)??"Catalogue import failed.")}finally{F(!1)}};return r||n?p.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-xmas-gold"})}):p.jsxs("div",{className:"container mx-auto px-4 py-8",children:[p.jsxs("div",{className:"flex justify-between items-center mb-8",children:[p.jsx("h1",{className:"font-christmas text-3xl md:text-4xl text-xmas-line",children:"Admin Dashboard"}),p.jsx("div",{className:"flex gap-2",children:p.jsxs(ct,{to:"/movies",className:"btn btn-outline",children:[p.jsx("i",{className:"fas fa-film mr-2"})," Movies"]})})]}),i&&p.jsxs("div",{className:"alert alert-error mb-6",children:[p.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),p.jsx("span",{children:i})]}),o&&p.jsxs("div",{className:"alert alert-success mb-6",children:[p.jsx("i",{className:"fas fa-check-circle mr-2"}),p.jsx("span",{children:o})]}),p.jsxs("div",{className:"mb-8",children:[p.jsx("h2",{className:"text-2xl font-christmas mb-4 text-xmas-gold",children:"Movie Administration"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[p.jsx("div",{className:"card bg-xmas-card shadow-xl",children:p.jsxs("div",{className:"card-body",children:[p.jsxs("h2",{className:"card-title font-christmas",children:[p.jsx("i",{className:"fas fa-sort-alpha-down text-primary mr-2"})," Sort Title Migration"]}),p.jsx("p",{className:"mb-4",children:'Update all movies to include sort titles (e.g., "The Grinch"  "Grinch") for better alphabetical sorting.'}),p.jsxs("div",{className:"flex flex-col gap-2",children:[p.jsxs("div",{className:"stats bg-base-200 text-base-content",children:[p.jsxs("div",{className:"stat",children:[p.jsx("div",{className:"stat-title",children:"Total Movies"}),p.jsx("div",{className:"stat-value",children:h.totalMovies})]}),p.jsxs("div",{className:"stat",children:[p.jsx("div",{className:"stat-title",children:"With Sort Titles"}),p.jsx("div",{className:"stat-value",children:h.moviesWithSortTitle}),p.jsx("div",{className:"stat-desc",children:h.totalMovies>0?`${Math.round(h.moviesWithSortTitle/h.totalMovies*100)}%`:"0%"})]})]}),p.jsxs("button",{className:"btn btn-primary w-full",onClick:T,disabled:c||h.moviesWithSortTitle===h.totalMovies,children:[c?p.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}):p.jsx("i",{className:"fas fa-sync-alt mr-2"}),h.moviesWithSortTitle===h.totalMovies?"All Movies Updated":"Update Sort Titles"]})]})]})}),p.jsx("div",{className:"card bg-xmas-card shadow-xl",children:p.jsxs("div",{className:"card-body",children:[p.jsxs("h2",{className:"card-title font-christmas",children:[p.jsx("i",{className:"fas fa-database text-primary mr-2"})," Catalogue Builder (TMDB IDs)"]}),p.jsxs("p",{className:"mb-4",children:["Bulk-import TMDB titles into your ",p.jsx("code",{children:"movies"})," catalogue only  no user collections will be updated."]}),p.jsx("label",{className:"label mt-2",children:p.jsx("span",{className:"label-text",children:"TMDB API Key"})}),p.jsx("input",{type:"password",className:"input input-bordered w-full",value:m,onChange:N=>v(N.target.value),placeholder:"TMDB_API_KEY"}),p.jsx("label",{className:"label mt-4",children:p.jsx("span",{className:"label-text",children:"TMDB IDs (comma / space / newline separated)"})}),p.jsx("textarea",{className:"textarea textarea-bordered w-full h-40",value:g,onChange:N=>y(N.target.value),placeholder:`e.g. 603, 497, 155, 27205
603
497 155
27205`}),p.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[p.jsx("div",{className:"form-control",children:p.jsxs("label",{className:"label cursor-pointer gap-2",children:[p.jsx("span",{className:"label-text",children:"Slow mode (API friendly)"}),p.jsx("input",{type:"checkbox",className:"toggle",checked:S,onChange:N=>k(N.target.checked)})]})}),p.jsx("button",{className:"btn btn-primary ml-auto",onClick:P,disabled:w||I.length===0||!m,title:m?void 0:"Enter TMDB API Key",children:w?p.jsxs(p.Fragment,{children:[p.jsx("span",{className:"loading loading-spinner loading-sm mr-2"}),"Importing ",I.length,""]}):p.jsxs(p.Fragment,{children:[p.jsx("i",{className:"fas fa-file-import mr-2"}),"Import ",I.length||0," to Catalogue"]})})]}),(w||B>0)&&p.jsxs("div",{className:"mt-4",children:[p.jsx("progress",{className:"progress w-full",value:B,max:100}),p.jsx("div",{className:"text-sm mt-1 opacity-80",children:x})]})]})})]})]})]})},sz=BN([{element:p.jsx(IL,{}),children:[{path:"/",element:p.jsx(CL,{})},{path:"/login",element:p.jsx(RL,{})},{element:p.jsx(Uy,{}),children:[{path:"/movies",element:p.jsx(ML,{})},{path:"/movies/:movieId",element:p.jsx(LL,{})},{path:"/import",element:p.jsx(K7,{})},{path:"/random",element:p.jsx(q7,{})},{path:"/profile",element:p.jsx(J7,{})}]},{path:"/admin/login",element:p.jsx(Z7,{})},{path:"/admin",element:p.jsx(Uy,{children:p.jsx(nz,{})})}]}]);ip.createRoot(document.getElementById("root")).render(p.jsx(Hm.StrictMode,{children:p.jsx(kL,{children:p.jsx(XN,{router:sz})})}));
